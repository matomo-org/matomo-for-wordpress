/* Matomo Javascript - cb=3831ce2caf6a165e8e3dc861a9075cb1*/

/*! jQuery Browser - v0.1.0 - 3/23/2012
* https://github.com/jquery/jquery-browser
* Copyright (c) 2012 John Resig; Licensed MIT */
(function(a){var b,c=navigator.userAgent||"";a.uaMatch=function(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},b=a.uaMatch(c),a.browser={},b.browser&&(a.browser[b.browser]=!0,a.browser.version=b.version),a.browser.webkit&&(a.browser.safari=!0)})(jQuery)
/*
 *	jQuery dotdotdot 1.7.4
 *
 *	Copyright (c) Fred Heusschen
 *	www.frebsite.nl
 *
 *	Plugin website:
 *	dotdotdot.frebsite.nl
 *
 *	Licensed under the MIT license.
 *	http://en.wikipedia.org/wiki/MIT_License
 */
!function(t,e){function n(t,e,n){var r=t.children(),o=!1;t.empty();for(var i=0,d=r.length;d>i;i++){var l=r.eq(i);if(t.append(l),n&&t.append(n),a(t,e)){l.remove(),o=!0;break}n&&n.detach()}return o}function r(e,n,i,d,l){var s=!1,c="a, table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style",u="script, .dotdotdot-keep";return e.contents().detach().each(function(){var h=this,f=t(h);if("undefined"==typeof h)return!0;if(f.is(u))e.append(f);else{if(s)return!0;e.append(f),!l||f.is(d.after)||f.find(d.after).length||e[e.is(c)?"after":"append"](l),a(i,d)&&(s=3==h.nodeType?o(f,n,i,d,l):r(f,n,i,d,l),s||(f.detach(),s=!0)),s||l&&l.detach()}}),n.addClass("is-truncated"),s}function o(e,n,r,o,d){var c=e[0];if(!c)return!1;var h=s(c),f=-1!==h.indexOf(" ")?" ":"　",p="letter"==o.wrap?"":f,g=h.split(p),v=-1,w=-1,b=0,y=g.length-1;for(o.fallbackToLetter&&0==b&&0==y&&(p="",g=h.split(p),y=g.length-1);y>=b&&(0!=b||0!=y);){var m=Math.floor((b+y)/2);if(m==w)break;w=m,l(c,g.slice(0,w+1).join(p)+o.ellipsis),r.children().each(function(){t(this).toggle().toggle()}),a(r,o)?(y=w,o.fallbackToLetter&&0==b&&0==y&&(p="",g=g[0].split(p),v=-1,w=-1,b=0,y=g.length-1)):(v=w,b=w)}if(-1==v||1==g.length&&0==g[0].length){var x=e.parent();e.detach();var T=d&&d.closest(x).length?d.length:0;x.contents().length>T?c=u(x.contents().eq(-1-T),n):(c=u(x,n,!0),T||x.detach()),c&&(h=i(s(c),o),l(c,h),T&&d&&t(c).parent().append(d))}else h=i(g.slice(0,v+1).join(p),o),l(c,h);return!0}function a(t,e){return t.innerHeight()>e.maxHeight}function i(e,n){for(;t.inArray(e.slice(-1),n.lastCharacter.remove)>-1;)e=e.slice(0,-1);return t.inArray(e.slice(-1),n.lastCharacter.noEllipsis)<0&&(e+=n.ellipsis),e}function d(t){return{width:t.innerWidth(),height:t.innerHeight()}}function l(t,e){t.innerText?t.innerText=e:t.nodeValue?t.nodeValue=e:t.textContent&&(t.textContent=e)}function s(t){return t.innerText?t.innerText:t.nodeValue?t.nodeValue:t.textContent?t.textContent:""}function c(t){do t=t.previousSibling;while(t&&1!==t.nodeType&&3!==t.nodeType);return t}function u(e,n,r){var o,a=e&&e[0];if(a){if(!r){if(3===a.nodeType)return a;if(t.trim(e.text()))return u(e.contents().last(),n)}for(o=c(a);!o;){if(e=e.parent(),e.is(n)||!e.length)return!1;o=c(e[0])}if(o)return u(t(o),n)}return!1}function h(e,n){return e?"string"==typeof e?(e=t(e,n),e.length?e:!1):e.jquery?e:!1:!1}function f(t){for(var e=t.innerHeight(),n=["paddingTop","paddingBottom"],r=0,o=n.length;o>r;r++){var a=parseInt(t.css(n[r]),10);isNaN(a)&&(a=0),e-=a}return e}if(!t.fn.dotdotdot){t.fn.dotdotdot=function(e){if(0==this.length)return t.fn.dotdotdot.debug('No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){t(this).dotdotdot(e)});var o=this;o.data("dotdotdot")&&o.trigger("destroy.dot"),o.data("dotdotdot-style",o.attr("style")||""),o.css("word-wrap","break-word"),"nowrap"===o.css("white-space")&&o.css("white-space","normal"),o.bind_events=function(){return o.bind("update.dot",function(e,d){switch(o.removeClass("is-truncated"),e.preventDefault(),e.stopPropagation(),typeof l.height){case"number":l.maxHeight=l.height;break;case"function":l.maxHeight=l.height.call(o[0]);break;default:l.maxHeight=f(o)}l.maxHeight+=l.tolerance,"undefined"!=typeof d&&(("string"==typeof d||"nodeType"in d&&1===d.nodeType)&&(d=t("<div />").append(d).contents()),d instanceof t&&(i=d)),g=o.wrapInner('<div class="dotdotdot" />').children(),g.contents().detach().end().append(i.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var c=!1,u=!1;return s.afterElement&&(c=s.afterElement.clone(!0),c.show(),s.afterElement.detach()),a(g,l)&&(u="children"==l.wrap?n(g,l,c):r(g,o,g,l,c)),g.replaceWith(g.contents()),g=null,t.isFunction(l.callback)&&l.callback.call(o[0],u,i),s.isTruncated=u,u}).bind("isTruncated.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(o[0],s.isTruncated),s.isTruncated}).bind("originalContent.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(o[0],i),i}).bind("destroy.dot",function(t){t.preventDefault(),t.stopPropagation(),o.unwatch().unbind_events().contents().detach().end().append(i).attr("style",o.data("dotdotdot-style")||"").data("dotdotdot",!1)}),o},o.unbind_events=function(){return o.unbind(".dot"),o},o.watch=function(){if(o.unwatch(),"window"==l.watch){var e=t(window),n=e.width(),r=e.height();e.bind("resize.dot"+s.dotId,function(){n==e.width()&&r==e.height()&&l.windowResizeFix||(n=e.width(),r=e.height(),u&&clearInterval(u),u=setTimeout(function(){o.trigger("update.dot")},100))})}else c=d(o),u=setInterval(function(){if(o.is(":visible")){var t=d(o);(c.width!=t.width||c.height!=t.height)&&(o.trigger("update.dot"),c=t)}},500);return o},o.unwatch=function(){return t(window).unbind("resize.dot"+s.dotId),u&&clearInterval(u),o};var i=o.contents(),l=t.extend(!0,{},t.fn.dotdotdot.defaults,e),s={},c={},u=null,g=null;return l.lastCharacter.remove instanceof Array||(l.lastCharacter.remove=t.fn.dotdotdot.defaultArrays.lastCharacter.remove),l.lastCharacter.noEllipsis instanceof Array||(l.lastCharacter.noEllipsis=t.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),s.afterElement=h(l.after,o),s.isTruncated=!1,s.dotId=p++,o.data("dotdotdot",!0).bind_events().trigger("update.dot"),l.watch&&o.watch(),o},t.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0},t.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","　",",",";",".","!","?"],noEllipsis:[]}},t.fn.dotdotdot.debug=function(){};var p=1,g=t.fn.html;t.fn.html=function(n){return n!=e&&!t.isFunction(n)&&this.data("dotdotdot")?this.trigger("update",[n]):g.apply(this,arguments)};var v=t.fn.text;t.fn.text=function(n){return n!=e&&!t.isFunction(n)&&this.data("dotdotdot")?(n=t("<div />").text(n).html(),this.trigger("update",[n])):v.apply(this,arguments)}}}(jQuery);
/*! sprintf-js | Alexandru Marasteanu <hello@alexei.ro> (http://alexei.ro/) | BSD-3-Clause */

!function(a){function b(){var a=arguments[0],c=b.cache;return c[a]&&c.hasOwnProperty(a)||(c[a]=b.parse(a)),b.format.call(null,c[a],arguments)}function c(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}function d(a,b){return Array(b+1).join(a)}var e={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};b.format=function(a,f){var g,h,i,j,k,l,m,n=1,o=a.length,p="",q=[],r=!0,s="";for(h=0;o>h;h++)if(p=c(a[h]),"string"===p)q[q.length]=a[h];else if("array"===p){if(j=a[h],j[2])for(g=f[n],i=0;i<j[2].length;i++){if(!g.hasOwnProperty(j[2][i]))throw new Error(b("[sprintf] property '%s' does not exist",j[2][i]));g=g[j[2][i]]}else g=j[1]?f[j[1]]:f[n++];if("function"==c(g)&&(g=g()),e.not_string.test(j[8])&&e.not_json.test(j[8])&&"number"!=c(g)&&isNaN(g))throw new TypeError(b("[sprintf] expecting number but found %s",c(g)));switch(e.number.test(j[8])&&(r=g>=0),j[8]){case"b":g=g.toString(2);break;case"c":g=String.fromCharCode(g);break;case"d":case"i":g=parseInt(g,10);break;case"j":g=JSON.stringify(g,null,j[6]?parseInt(j[6]):0);break;case"e":g=j[7]?g.toExponential(j[7]):g.toExponential();break;case"f":g=j[7]?parseFloat(g).toFixed(j[7]):parseFloat(g);break;case"g":g=j[7]?parseFloat(g).toPrecision(j[7]):parseFloat(g);break;case"o":g=g.toString(8);break;case"s":g=(g=String(g))&&j[7]?g.substring(0,j[7]):g;break;case"u":g>>>=0;break;case"x":g=g.toString(16);break;case"X":g=g.toString(16).toUpperCase()}e.json.test(j[8])?q[q.length]=g:(!e.number.test(j[8])||r&&!j[3]?s="":(s=r?"+":"-",g=g.toString().replace(e.sign,"")),l=j[4]?"0"===j[4]?"0":j[4].charAt(1):" ",m=j[6]-(s+g).length,k=j[6]&&m>0?d(l,m):"",q[q.length]=j[5]?s+g+k:"0"===l?s+k+g:k+s+g)}return q.join("")},b.cache={},b.parse=function(a){for(var b=a,c=[],d=[],f=0;b;){if(null!==(c=e.text.exec(b)))d[d.length]=c[0];else if(null!==(c=e.modulo.exec(b)))d[d.length]="%";else{if(null===(c=e.placeholder.exec(b)))throw new SyntaxError("[sprintf] unexpected placeholder");if(c[2]){f|=1;var g=[],h=c[2],i=[];if(null===(i=e.key.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(g[g.length]=i[1];""!==(h=h.substring(i[0].length));)if(null!==(i=e.key_access.exec(h)))g[g.length]=i[1];else{if(null===(i=e.index_access.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");g[g.length]=i[1]}c[2]=g}else f|=2;if(3===f)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");d[d.length]=c}b=b.substring(c[0].length)}return d};var f=function(a,c,d){return d=(c||[]).slice(0),d.splice(0,0,a),b.apply(null,d)};"undefined"!=typeof exports?(exports.sprintf=b,exports.vsprintf=f):(a.sprintf=b,a.vsprintf=f,"function"==typeof define&&define.amd&&define(function(){return{sprintf:b,vsprintf:f}}))}("undefined"==typeof window?this:window);
//# 
/*!
 * Materialize v0.97.6 (http://materializecss.com)
 * Copyright 2014-2015 Materialize
 * MIT License (https://raw.githubusercontent.com/Dogfalo/materialize/master/LICENSE)
 */
if("undefined"==typeof jQuery){var jQuery;jQuery="function"==typeof require?$=require("jquery"):$}jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,b,c,d,e){return jQuery.easing[jQuery.easing.def](a,b,c,d,e)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return 0==b?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return 0==b?c:b==e?c+d:(b/=e/2)<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(1==(b/=e))return c+d;if(g||(g=.3*e),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*(2*Math.PI)/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(1==(b/=e))return c+d;if(g||(g=.3*e),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin((b*e-f)*(2*Math.PI)/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(2==(b/=e/2))return c+d;if(g||(g=e*(.3*1.5)),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return 1>b?-.5*(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*(2*Math.PI)/g))+c:h*Math.pow(2,-10*(b-=1))*Math.sin((b*e-f)*(2*Math.PI)/g)*.5+d+c},easeInBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),(b/=e/2)<1?d/2*(b*b*(((f*=1.525)+1)*b-f))+c:d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,b,c,d,e){return d-jQuery.easing.easeOutBounce(a,e-b,0,d,e)+c},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*(7.5625*b*b)+c:2/2.75>b?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:2.5/2.75>b?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(a,b,c,d,e){return e/2>b?.5*jQuery.easing.easeInBounce(a,2*b,0,d,e)+c:.5*jQuery.easing.easeOutBounce(a,2*b-e,0,d,e)+.5*d+c}}),jQuery.extend(jQuery.easing,{easeInOutMaterial:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:d/4*((b-=2)*b*b+2)+c}}),jQuery.Velocity?console.log("Velocity is already loaded. You may be needlessly importing Velocity again; note that Materialize includes Velocity."):(!function(a){function b(a){var b=a.length,d=c.type(a);return"function"===d||c.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===d||0===b||"number"==typeof b&&b>0&&b-1 in a}if(!a.jQuery){var c=function(a,b){return new c.fn.init(a,b)};c.isWindow=function(a){return null!=a&&a==a.window},c.type=function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?e[g.call(a)]||"object":typeof a},c.isArray=Array.isArray||function(a){return"array"===c.type(a)},c.isPlainObject=function(a){var b;if(!a||"object"!==c.type(a)||a.nodeType||c.isWindow(a))return!1;try{if(a.constructor&&!f.call(a,"constructor")&&!f.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(d){return!1}for(b in a);return void 0===b||f.call(a,b)},c.each=function(a,c,d){var e,f=0,g=a.length,h=b(a);if(d){if(h)for(;g>f&&(e=c.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=c.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=c.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=c.call(a[f],f,a[f]),e===!1)break;return a},c.data=function(a,b,e){if(void 0===e){var f=a[c.expando],g=f&&d[f];if(void 0===b)return g;if(g&&b in g)return g[b]}else if(void 0!==b){var f=a[c.expando]||(a[c.expando]=++c.uuid);return d[f]=d[f]||{},d[f][b]=e,e}},c.removeData=function(a,b){var e=a[c.expando],f=e&&d[e];f&&c.each(b,function(a,b){delete f[b]})},c.extend=function(){var a,b,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[i]||{},i++),"object"!=typeof h&&"function"!==c.type(h)&&(h={}),i===j&&(h=this,i--);j>i;i++)if(null!=(f=arguments[i]))for(e in f)a=h[e],d=f[e],h!==d&&(k&&d&&(c.isPlainObject(d)||(b=c.isArray(d)))?(b?(b=!1,g=a&&c.isArray(a)?a:[]):g=a&&c.isPlainObject(a)?a:{},h[e]=c.extend(k,g,d)):void 0!==d&&(h[e]=d));return h},c.queue=function(a,d,e){function f(a,c){var d=c||[];return null!=a&&(b(Object(a))?!function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;)a[e++]=b[d++];if(c!==c)for(;void 0!==b[d];)a[e++]=b[d++];return a.length=e,a}(d,"string"==typeof a?[a]:a):[].push.call(d,a)),d}if(a){d=(d||"fx")+"queue";var g=c.data(a,d);return e?(!g||c.isArray(e)?g=c.data(a,d,f(e)):g.push(e),g):g||[]}},c.dequeue=function(a,b){c.each(a.nodeType?[a]:a,function(a,d){b=b||"fx";var e=c.queue(d,b),f=e.shift();"inprogress"===f&&(f=e.shift()),f&&("fx"===b&&e.unshift("inprogress"),f.call(d,function(){c.dequeue(d,b)}))})},c.fn=c.prototype={init:function(a){if(a.nodeType)return this[0]=a,this;throw new Error("Not a DOM node.")},offset:function(){var b=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:b.top+(a.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:b.left+(a.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function a(){for(var a=this.offsetParent||document;a&&"html"===!a.nodeType.toLowerCase&&"static"===a.style.position;)a=a.offsetParent;return a||document}var b=this[0],a=a.apply(b),d=this.offset(),e=/^(?:body|html)$/i.test(a.nodeName)?{top:0,left:0}:c(a).offset();return d.top-=parseFloat(b.style.marginTop)||0,d.left-=parseFloat(b.style.marginLeft)||0,a.style&&(e.top+=parseFloat(a.style.borderTopWidth)||0,e.left+=parseFloat(a.style.borderLeftWidth)||0),{top:d.top-e.top,left:d.left-e.left}}};var d={};c.expando="velocity"+(new Date).getTime(),c.uuid=0;for(var e={},f=e.hasOwnProperty,g=e.toString,h="Boolean Number String Function Array Date RegExp Object Error".split(" "),i=0;i<h.length;i++)e["[object "+h[i]+"]"]=h[i].toLowerCase();c.fn.init.prototype=c.fn,a.Velocity={Utilities:c}}}(window),function(a){"object"==typeof module&&"object"==typeof module.exports?module.exports=a():"function"==typeof define&&define.amd?define(a):a()}(function(){return function(a,b,c,d){function e(a){for(var b=-1,c=a?a.length:0,d=[];++b<c;){var e=a[b];e&&d.push(e)}return d}function f(a){return p.isWrapped(a)?a=[].slice.call(a):p.isNode(a)&&(a=[a]),a}function g(a){var b=m.data(a,"velocity");return null===b?d:b}function h(a){return function(b){return Math.round(b*a)*(1/a)}}function i(a,c,d,e){function f(a,b){return 1-3*b+3*a}function g(a,b){return 3*b-6*a}function h(a){return 3*a}function i(a,b,c){return((f(b,c)*a+g(b,c))*a+h(b))*a}function j(a,b,c){return 3*f(b,c)*a*a+2*g(b,c)*a+h(b)}function k(b,c){for(var e=0;p>e;++e){var f=j(c,a,d);if(0===f)return c;var g=i(c,a,d)-b;c-=g/f}return c}function l(){for(var b=0;t>b;++b)x[b]=i(b*u,a,d)}function m(b,c,e){var f,g,h=0;do g=c+(e-c)/2,f=i(g,a,d)-b,f>0?e=g:c=g;while(Math.abs(f)>r&&++h<s);return g}function n(b){for(var c=0,e=1,f=t-1;e!=f&&x[e]<=b;++e)c+=u;--e;var g=(b-x[e])/(x[e+1]-x[e]),h=c+g*u,i=j(h,a,d);return i>=q?k(b,h):0==i?h:m(b,c,c+u)}function o(){y=!0,(a!=c||d!=e)&&l()}var p=4,q=.001,r=1e-7,s=10,t=11,u=1/(t-1),v="Float32Array"in b;if(4!==arguments.length)return!1;for(var w=0;4>w;++w)if("number"!=typeof arguments[w]||isNaN(arguments[w])||!isFinite(arguments[w]))return!1;a=Math.min(a,1),d=Math.min(d,1),a=Math.max(a,0),d=Math.max(d,0);var x=v?new Float32Array(t):new Array(t),y=!1,z=function(b){return y||o(),a===c&&d===e?b:0===b?0:1===b?1:i(n(b),c,e)};z.getControlPoints=function(){return[{x:a,y:c},{x:d,y:e}]};var A="generateBezier("+[a,c,d,e]+")";return z.toString=function(){return A},z}function j(a,b){var c=a;return p.isString(a)?t.Easings[a]||(c=!1):c=p.isArray(a)&&1===a.length?h.apply(null,a):p.isArray(a)&&2===a.length?u.apply(null,a.concat([b])):p.isArray(a)&&4===a.length?i.apply(null,a):!1,c===!1&&(c=t.Easings[t.defaults.easing]?t.defaults.easing:s),c}function k(a){if(a){var b=(new Date).getTime(),c=t.State.calls.length;c>1e4&&(t.State.calls=e(t.State.calls));for(var f=0;c>f;f++)if(t.State.calls[f]){var h=t.State.calls[f],i=h[0],j=h[2],n=h[3],o=!!n,q=null;n||(n=t.State.calls[f][3]=b-16);for(var r=Math.min((b-n)/j.duration,1),s=0,u=i.length;u>s;s++){var w=i[s],y=w.element;if(g(y)){var z=!1;if(j.display!==d&&null!==j.display&&"none"!==j.display){if("flex"===j.display){var A=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];m.each(A,function(a,b){v.setPropertyValue(y,"display",b)})}v.setPropertyValue(y,"display",j.display)}j.visibility!==d&&"hidden"!==j.visibility&&v.setPropertyValue(y,"visibility",j.visibility);for(var B in w)if("element"!==B){var C,D=w[B],E=p.isString(D.easing)?t.Easings[D.easing]:D.easing;if(1===r)C=D.endValue;else{var F=D.endValue-D.startValue;if(C=D.startValue+F*E(r,j,F),!o&&C===D.currentValue)continue}if(D.currentValue=C,"tween"===B)q=C;else{if(v.Hooks.registered[B]){var G=v.Hooks.getRoot(B),H=g(y).rootPropertyValueCache[G];H&&(D.rootPropertyValue=H)}var I=v.setPropertyValue(y,B,D.currentValue+(0===parseFloat(C)?"":D.unitType),D.rootPropertyValue,D.scrollData);v.Hooks.registered[B]&&(g(y).rootPropertyValueCache[G]=v.Normalizations.registered[G]?v.Normalizations.registered[G]("extract",null,I[1]):I[1]),"transform"===I[0]&&(z=!0)}}j.mobileHA&&g(y).transformCache.translate3d===d&&(g(y).transformCache.translate3d="(0px, 0px, 0px)",z=!0),z&&v.flushTransformCache(y)}}j.display!==d&&"none"!==j.display&&(t.State.calls[f][2].display=!1),j.visibility!==d&&"hidden"!==j.visibility&&(t.State.calls[f][2].visibility=!1),j.progress&&j.progress.call(h[1],h[1],r,Math.max(0,n+j.duration-b),n,q),1===r&&l(f)}}t.State.isTicking&&x(k)}function l(a,b){if(!t.State.calls[a])return!1;for(var c=t.State.calls[a][0],e=t.State.calls[a][1],f=t.State.calls[a][2],h=t.State.calls[a][4],i=!1,j=0,k=c.length;k>j;j++){var l=c[j].element;if(b||f.loop||("none"===f.display&&v.setPropertyValue(l,"display",f.display),"hidden"===f.visibility&&v.setPropertyValue(l,"visibility",f.visibility)),f.loop!==!0&&(m.queue(l)[1]===d||!/\.velocityQueueEntryFlag/i.test(m.queue(l)[1]))&&g(l)){g(l).isAnimating=!1,g(l).rootPropertyValueCache={};var n=!1;m.each(v.Lists.transforms3D,function(a,b){var c=/^scale/.test(b)?1:0,e=g(l).transformCache[b];g(l).transformCache[b]!==d&&new RegExp("^\\("+c+"[^.]").test(e)&&(n=!0,delete g(l).transformCache[b])}),f.mobileHA&&(n=!0,delete g(l).transformCache.translate3d),n&&v.flushTransformCache(l),v.Values.removeClass(l,"velocity-animating")}if(!b&&f.complete&&!f.loop&&j===k-1)try{f.complete.call(e,e)}catch(o){setTimeout(function(){throw o},1)}h&&f.loop!==!0&&h(e),g(l)&&f.loop===!0&&!b&&(m.each(g(l).tweensContainer,function(a,b){/^rotate/.test(a)&&360===parseFloat(b.endValue)&&(b.endValue=0,b.startValue=360),/^backgroundPosition/.test(a)&&100===parseFloat(b.endValue)&&"%"===b.unitType&&(b.endValue=0,b.startValue=100)}),t(l,"reverse",{loop:!0,delay:f.delay})),f.queue!==!1&&m.dequeue(l,f.queue)}t.State.calls[a]=!1;for(var p=0,q=t.State.calls.length;q>p;p++)if(t.State.calls[p]!==!1){i=!0;break}i===!1&&(t.State.isTicking=!1,delete t.State.calls,t.State.calls=[])}var m,n=function(){if(c.documentMode)return c.documentMode;for(var a=7;a>4;a--){var b=c.createElement("div");if(b.innerHTML="<!--[if IE "+a+"]><span></span><![endif]-->",b.getElementsByTagName("span").length)return b=null,a}return d}(),o=function(){var a=0;return b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||function(b){var c,d=(new Date).getTime();return c=Math.max(0,16-(d-a)),a=d+c,setTimeout(function(){b(d+c)},c)}}(),p={isString:function(a){return"string"==typeof a},isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)},isNode:function(a){return a&&a.nodeType},isNodeList:function(a){return"object"==typeof a&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(a))&&a.length!==d&&(0===a.length||"object"==typeof a[0]&&a[0].nodeType>0)},isWrapped:function(a){return a&&(a.jquery||b.Zepto&&b.Zepto.zepto.isZ(a))},isSVG:function(a){return b.SVGElement&&a instanceof b.SVGElement},isEmptyObject:function(a){for(var b in a)return!1;return!0}},q=!1;if(a.fn&&a.fn.jquery?(m=a,q=!0):m=b.Velocity.Utilities,8>=n&&!q)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(7>=n)return void(jQuery.fn.velocity=jQuery.fn.animate);var r=400,s="swing",t={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:b.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:c.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:m,Redirects:{},Easings:{},Promise:b.Promise,defaults:{queue:"",duration:r,easing:s,begin:d,complete:d,progress:d,display:d,visibility:d,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(a){m.data(a,"velocity",{isSVG:p.isSVG(a),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:2},debug:!1};b.pageYOffset!==d?(t.State.scrollAnchor=b,t.State.scrollPropertyLeft="pageXOffset",t.State.scrollPropertyTop="pageYOffset"):(t.State.scrollAnchor=c.documentElement||c.body.parentNode||c.body,t.State.scrollPropertyLeft="scrollLeft",t.State.scrollPropertyTop="scrollTop");var u=function(){function a(a){return-a.tension*a.x-a.friction*a.v}function b(b,c,d){var e={x:b.x+d.dx*c,v:b.v+d.dv*c,tension:b.tension,friction:b.friction};return{dx:e.v,dv:a(e)}}function c(c,d){var e={dx:c.v,dv:a(c)},f=b(c,.5*d,e),g=b(c,.5*d,f),h=b(c,d,g),i=1/6*(e.dx+2*(f.dx+g.dx)+h.dx),j=1/6*(e.dv+2*(f.dv+g.dv)+h.dv);return c.x=c.x+i*d,c.v=c.v+j*d,c}return function d(a,b,e){var f,g,h,i={x:-1,v:0,tension:null,friction:null},j=[0],k=0,l=1e-4,m=.016;for(a=parseFloat(a)||500,b=parseFloat(b)||20,e=e||null,i.tension=a,i.friction=b,f=null!==e,f?(k=d(a,b),g=k/e*m):g=m;h=c(h||i,g),j.push(1+h.x),k+=16,Math.abs(h.x)>l&&Math.abs(h.v)>l;);return f?function(a){return j[a*(j.length-1)|0]}:k}}();t.Easings={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},spring:function(a){return 1-Math.cos(4.5*a*Math.PI)*Math.exp(6*-a)}},m.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(a,b){t.Easings[b[0]]=i.apply(null,b[1])});var v=t.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var a=0;a<v.Lists.colors.length;a++){var b="color"===v.Lists.colors[a]?"0 0 0 1":"255 255 255 1";v.Hooks.templates[v.Lists.colors[a]]=["Red Green Blue Alpha",b]}var c,d,e;if(n)for(c in v.Hooks.templates){d=v.Hooks.templates[c],e=d[0].split(" ");var f=d[1].match(v.RegEx.valueSplit);"Color"===e[0]&&(e.push(e.shift()),f.push(f.shift()),v.Hooks.templates[c]=[e.join(" "),f.join(" ")])}for(c in v.Hooks.templates){d=v.Hooks.templates[c],e=d[0].split(" ");for(var a in e){var g=c+e[a],h=a;v.Hooks.registered[g]=[c,h]}}},getRoot:function(a){var b=v.Hooks.registered[a];return b?b[0]:a},cleanRootPropertyValue:function(a,b){return v.RegEx.valueUnwrap.test(b)&&(b=b.match(v.RegEx.valueUnwrap)[1]),v.Values.isCSSNullValue(b)&&(b=v.Hooks.templates[a][1]),b},extractValue:function(a,b){var c=v.Hooks.registered[a];if(c){var d=c[0],e=c[1];return b=v.Hooks.cleanRootPropertyValue(d,b),b.toString().match(v.RegEx.valueSplit)[e]}return b},injectValue:function(a,b,c){var d=v.Hooks.registered[a];if(d){var e,f,g=d[0],h=d[1];return c=v.Hooks.cleanRootPropertyValue(g,c),e=c.toString().match(v.RegEx.valueSplit),e[h]=b,f=e.join(" ")}return c}},Normalizations:{registered:{clip:function(a,b,c){switch(a){case"name":return"clip";case"extract":var d;return v.RegEx.wrappedValueAlreadyExtracted.test(c)?d=c:(d=c.toString().match(v.RegEx.valueUnwrap),d=d?d[1].replace(/,(\s+)?/g," "):c),d;case"inject":return"rect("+c+")"}},blur:function(a,b,c){switch(a){case"name":return t.State.isFirefox?"filter":"-webkit-filter";case"extract":var d=parseFloat(c);if(!d&&0!==d){var e=c.toString().match(/blur\(([0-9]+[A-z]+)\)/i);d=e?e[1]:0}return d;case"inject":return parseFloat(c)?"blur("+c+")":"none"}},opacity:function(a,b,c){if(8>=n)switch(a){case"name":return"filter";case"extract":var d=c.toString().match(/alpha\(opacity=(.*)\)/i);return c=d?d[1]/100:1;case"inject":return b.style.zoom=1,parseFloat(c)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(c),10)+")"}else switch(a){case"name":return"opacity";case"extract":return c;case"inject":return c}}},register:function(){9>=n||t.State.isGingerbread||(v.Lists.transformsBase=v.Lists.transformsBase.concat(v.Lists.transforms3D));for(var a=0;a<v.Lists.transformsBase.length;a++)!function(){var b=v.Lists.transformsBase[a];v.Normalizations.registered[b]=function(a,c,e){switch(a){case"name":return"transform";case"extract":return g(c)===d||g(c).transformCache[b]===d?/^scale/i.test(b)?1:0:g(c).transformCache[b].replace(/[()]/g,"");case"inject":var f=!1;switch(b.substr(0,b.length-1)){case"translate":f=!/(%|px|em|rem|vw|vh|\d)$/i.test(e);break;case"scal":case"scale":t.State.isAndroid&&g(c).transformCache[b]===d&&1>e&&(e=1),f=!/(\d)$/i.test(e);break;case"skew":f=!/(deg|\d)$/i.test(e);break;case"rotate":f=!/(deg|\d)$/i.test(e)}return f||(g(c).transformCache[b]="("+e+")"),g(c).transformCache[b]}}}();for(var a=0;a<v.Lists.colors.length;a++)!function(){var b=v.Lists.colors[a];v.Normalizations.registered[b]=function(a,c,e){switch(a){case"name":return b;case"extract":var f;if(v.RegEx.wrappedValueAlreadyExtracted.test(e))f=e;else{var g,h={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(e)?g=h[e]!==d?h[e]:h.black:v.RegEx.isHex.test(e)?g="rgb("+v.Values.hexToRgb(e).join(" ")+")":/^rgba?\(/i.test(e)||(g=h.black),f=(g||e).toString().match(v.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return 8>=n||3!==f.split(" ").length||(f+=" 1"),f;case"inject":return 8>=n?4===e.split(" ").length&&(e=e.split(/\s+/).slice(0,3).join(" ")):3===e.split(" ").length&&(e+=" 1"),(8>=n?"rgb":"rgba")+"("+e.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(a){return a.replace(/-(\w)/g,function(a,b){return b.toUpperCase()})},SVGAttribute:function(a){var b="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(n||t.State.isAndroid&&!t.State.isChrome)&&(b+="|transform"),new RegExp("^("+b+")$","i").test(a)},prefixCheck:function(a){if(t.State.prefixMatches[a])return[t.State.prefixMatches[a],!0];for(var b=["","Webkit","Moz","ms","O"],c=0,d=b.length;d>c;c++){var e;if(e=0===c?a:b[c]+a.replace(/^\w/,function(a){return a.toUpperCase()}),p.isString(t.State.prefixElement.style[e]))return t.State.prefixMatches[a]=e,[e,!0]}return[a,!1]}},Values:{hexToRgb:function(a){var b,c=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return a=a.replace(c,function(a,b,c,d){return b+b+c+c+d+d}),b=d.exec(a),b?[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]:[0,0,0]},isCSSNullValue:function(a){return 0==a||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(a)},getUnitType:function(a){return/^(rotate|skew)/i.test(a)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(a)?"":"px"},getDisplayType:function(a){var b=a&&a.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(b)?"inline":/^(li)$/i.test(b)?"list-item":/^(tr)$/i.test(b)?"table-row":/^(table)$/i.test(b)?"table":/^(tbody)$/i.test(b)?"table-row-group":"block"},addClass:function(a,b){a.classList?a.classList.add(b):a.className+=(a.className.length?" ":"")+b},removeClass:function(a,b){a.classList?a.classList.remove(b):a.className=a.className.toString().replace(new RegExp("(^|\\s)"+b.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(a,c,e,f){function h(a,c){function e(){j&&v.setPropertyValue(a,"display","none")}var i=0;if(8>=n)i=m.css(a,c);else{var j=!1;if(/^(width|height)$/.test(c)&&0===v.getPropertyValue(a,"display")&&(j=!0,v.setPropertyValue(a,"display",v.Values.getDisplayType(a))),!f){if("height"===c&&"border-box"!==v.getPropertyValue(a,"boxSizing").toString().toLowerCase()){var k=a.offsetHeight-(parseFloat(v.getPropertyValue(a,"borderTopWidth"))||0)-(parseFloat(v.getPropertyValue(a,"borderBottomWidth"))||0)-(parseFloat(v.getPropertyValue(a,"paddingTop"))||0)-(parseFloat(v.getPropertyValue(a,"paddingBottom"))||0);return e(),k}if("width"===c&&"border-box"!==v.getPropertyValue(a,"boxSizing").toString().toLowerCase()){var l=a.offsetWidth-(parseFloat(v.getPropertyValue(a,"borderLeftWidth"))||0)-(parseFloat(v.getPropertyValue(a,"borderRightWidth"))||0)-(parseFloat(v.getPropertyValue(a,"paddingLeft"))||0)-(parseFloat(v.getPropertyValue(a,"paddingRight"))||0);return e(),l}}var o;o=g(a)===d?b.getComputedStyle(a,null):g(a).computedStyle?g(a).computedStyle:g(a).computedStyle=b.getComputedStyle(a,null),"borderColor"===c&&(c="borderTopColor"),i=9===n&&"filter"===c?o.getPropertyValue(c):o[c],(""===i||null===i)&&(i=a.style[c]),e()}if("auto"===i&&/^(top|right|bottom|left)$/i.test(c)){var p=h(a,"position");("fixed"===p||"absolute"===p&&/top|left/i.test(c))&&(i=m(a).position()[c]+"px")}return i}var i;if(v.Hooks.registered[c]){var j=c,k=v.Hooks.getRoot(j);e===d&&(e=v.getPropertyValue(a,v.Names.prefixCheck(k)[0])),v.Normalizations.registered[k]&&(e=v.Normalizations.registered[k]("extract",a,e)),i=v.Hooks.extractValue(j,e)}else if(v.Normalizations.registered[c]){var l,o;l=v.Normalizations.registered[c]("name",a),"transform"!==l&&(o=h(a,v.Names.prefixCheck(l)[0]),v.Values.isCSSNullValue(o)&&v.Hooks.templates[c]&&(o=v.Hooks.templates[c][1])),i=v.Normalizations.registered[c]("extract",a,o)}if(!/^[\d-]/.test(i))if(g(a)&&g(a).isSVG&&v.Names.SVGAttribute(c))if(/^(height|width)$/i.test(c))try{i=a.getBBox()[c]}catch(p){i=0}else i=a.getAttribute(c);else i=h(a,v.Names.prefixCheck(c)[0]);return v.Values.isCSSNullValue(i)&&(i=0),t.debug>=2&&console.log("Get "+c+": "+i),i},setPropertyValue:function(a,c,d,e,f){var h=c;if("scroll"===c)f.container?f.container["scroll"+f.direction]=d:"Left"===f.direction?b.scrollTo(d,f.alternateValue):b.scrollTo(f.alternateValue,d);else if(v.Normalizations.registered[c]&&"transform"===v.Normalizations.registered[c]("name",a))v.Normalizations.registered[c]("inject",a,d),h="transform",d=g(a).transformCache[c];else{if(v.Hooks.registered[c]){var i=c,j=v.Hooks.getRoot(c);e=e||v.getPropertyValue(a,j),d=v.Hooks.injectValue(i,d,e),c=j}if(v.Normalizations.registered[c]&&(d=v.Normalizations.registered[c]("inject",a,d),c=v.Normalizations.registered[c]("name",a)),h=v.Names.prefixCheck(c)[0],8>=n)try{a.style[h]=d}catch(k){t.debug&&console.log("Browser does not support ["+d+"] for ["+h+"]")}else g(a)&&g(a).isSVG&&v.Names.SVGAttribute(c)?a.setAttribute(c,d):a.style[h]=d;t.debug>=2&&console.log("Set "+c+" ("+h+"): "+d)}return[h,d]},flushTransformCache:function(a){function b(b){return parseFloat(v.getPropertyValue(a,b))}var c="";if((n||t.State.isAndroid&&!t.State.isChrome)&&g(a).isSVG){var d={translate:[b("translateX"),b("translateY")],skewX:[b("skewX")],skewY:[b("skewY")],scale:1!==b("scale")?[b("scale"),b("scale")]:[b("scaleX"),b("scaleY")],rotate:[b("rotateZ"),0,0]};m.each(g(a).transformCache,function(a){/^translate/i.test(a)?a="translate":/^scale/i.test(a)?a="scale":/^rotate/i.test(a)&&(a="rotate"),d[a]&&(c+=a+"("+d[a].join(" ")+") ",delete d[a])})}else{var e,f;m.each(g(a).transformCache,function(b){return e=g(a).transformCache[b],"transformPerspective"===b?(f=e,!0):(9===n&&"rotateZ"===b&&(b="rotate"),void(c+=b+e+" "))}),f&&(c="perspective"+f+" "+c)}v.setPropertyValue(a,"transform",c)}};v.Hooks.register(),v.Normalizations.register(),t.hook=function(a,b,c){var e=d;return a=f(a),m.each(a,function(a,f){if(g(f)===d&&t.init(f),c===d)e===d&&(e=t.CSS.getPropertyValue(f,b));else{var h=t.CSS.setPropertyValue(f,b,c);"transform"===h[0]&&t.CSS.flushTransformCache(f),e=h}}),e};var w=function(){function a(){return h?B.promise||null:i}function e(){function a(a){function l(a,b){var c=d,e=d,g=d;return p.isArray(a)?(c=a[0],!p.isArray(a[1])&&/^[\d-]/.test(a[1])||p.isFunction(a[1])||v.RegEx.isHex.test(a[1])?g=a[1]:(p.isString(a[1])&&!v.RegEx.isHex.test(a[1])||p.isArray(a[1]))&&(e=b?a[1]:j(a[1],h.duration),a[2]!==d&&(g=a[2]))):c=a,b||(e=e||h.easing),p.isFunction(c)&&(c=c.call(f,y,x)),p.isFunction(g)&&(g=g.call(f,y,x)),[c||0,e,g]}function n(a,b){var c,d;return d=(b||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(a){return c=a,""}),c||(c=v.Values.getUnitType(a)),[d,c]}function r(){var a={myParent:f.parentNode||c.body,position:v.getPropertyValue(f,"position"),fontSize:v.getPropertyValue(f,"fontSize")},d=a.position===I.lastPosition&&a.myParent===I.lastParent,e=a.fontSize===I.lastFontSize;I.lastParent=a.myParent,I.lastPosition=a.position,I.lastFontSize=a.fontSize;var h=100,i={};if(e&&d)i.emToPx=I.lastEmToPx,i.percentToPxWidth=I.lastPercentToPxWidth,i.percentToPxHeight=I.lastPercentToPxHeight;else{var j=g(f).isSVG?c.createElementNS("http://www.w3.org/2000/svg","rect"):c.createElement("div");t.init(j),a.myParent.appendChild(j),m.each(["overflow","overflowX","overflowY"],function(a,b){t.CSS.setPropertyValue(j,b,"hidden")}),t.CSS.setPropertyValue(j,"position",a.position),t.CSS.setPropertyValue(j,"fontSize",a.fontSize),t.CSS.setPropertyValue(j,"boxSizing","content-box"),m.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(a,b){t.CSS.setPropertyValue(j,b,h+"%")}),t.CSS.setPropertyValue(j,"paddingLeft",h+"em"),i.percentToPxWidth=I.lastPercentToPxWidth=(parseFloat(v.getPropertyValue(j,"width",null,!0))||1)/h,i.percentToPxHeight=I.lastPercentToPxHeight=(parseFloat(v.getPropertyValue(j,"height",null,!0))||1)/h,i.emToPx=I.lastEmToPx=(parseFloat(v.getPropertyValue(j,"paddingLeft"))||1)/h,a.myParent.removeChild(j)}return null===I.remToPx&&(I.remToPx=parseFloat(v.getPropertyValue(c.body,"fontSize"))||16),null===I.vwToPx&&(I.vwToPx=parseFloat(b.innerWidth)/100,I.vhToPx=parseFloat(b.innerHeight)/100),i.remToPx=I.remToPx,i.vwToPx=I.vwToPx,i.vhToPx=I.vhToPx,t.debug>=1&&console.log("Unit ratios: "+JSON.stringify(i),f),i}if(h.begin&&0===y)try{h.begin.call(o,o)}catch(u){setTimeout(function(){throw u},1)}if("scroll"===C){var w,z,A,D=/^x$/i.test(h.axis)?"Left":"Top",E=parseFloat(h.offset)||0;h.container?p.isWrapped(h.container)||p.isNode(h.container)?(h.container=h.container[0]||h.container,w=h.container["scroll"+D],A=w+m(f).position()[D.toLowerCase()]+E):h.container=null:(w=t.State.scrollAnchor[t.State["scrollProperty"+D]],z=t.State.scrollAnchor[t.State["scrollProperty"+("Left"===D?"Top":"Left")]],A=m(f).offset()[D.toLowerCase()]+E),i={scroll:{rootPropertyValue:!1,startValue:w,currentValue:w,endValue:A,unitType:"",easing:h.easing,scrollData:{container:h.container,direction:D,alternateValue:z}},element:f},t.debug&&console.log("tweensContainer (scroll): ",i.scroll,f)}else if("reverse"===C){if(!g(f).tweensContainer)return void m.dequeue(f,h.queue);"none"===g(f).opts.display&&(g(f).opts.display="auto"),"hidden"===g(f).opts.visibility&&(g(f).opts.visibility="visible"),g(f).opts.loop=!1,g(f).opts.begin=null,g(f).opts.complete=null,s.easing||delete h.easing,s.duration||delete h.duration,h=m.extend({},g(f).opts,h);var F=m.extend(!0,{},g(f).tweensContainer);for(var G in F)if("element"!==G){var H=F[G].startValue;F[G].startValue=F[G].currentValue=F[G].endValue,F[G].endValue=H,p.isEmptyObject(s)||(F[G].easing=h.easing),t.debug&&console.log("reverse tweensContainer ("+G+"): "+JSON.stringify(F[G]),f)}i=F}else if("start"===C){var F;g(f).tweensContainer&&g(f).isAnimating===!0&&(F=g(f).tweensContainer),m.each(q,function(a,b){if(RegExp("^"+v.Lists.colors.join("$|^")+"$").test(a)){var c=l(b,!0),e=c[0],f=c[1],g=c[2];if(v.RegEx.isHex.test(e)){for(var h=["Red","Green","Blue"],i=v.Values.hexToRgb(e),j=g?v.Values.hexToRgb(g):d,k=0;k<h.length;k++){var m=[i[k]];f&&m.push(f),j!==d&&m.push(j[k]),q[a+h[k]]=m}delete q[a]}}});for(var K in q){var L=l(q[K]),M=L[0],N=L[1],O=L[2];K=v.Names.camelCase(K);var P=v.Hooks.getRoot(K),Q=!1;if(g(f).isSVG||"tween"===P||v.Names.prefixCheck(P)[1]!==!1||v.Normalizations.registered[P]!==d){(h.display!==d&&null!==h.display&&"none"!==h.display||h.visibility!==d&&"hidden"!==h.visibility)&&/opacity|filter/.test(K)&&!O&&0!==M&&(O=0),h._cacheValues&&F&&F[K]?(O===d&&(O=F[K].endValue+F[K].unitType),Q=g(f).rootPropertyValueCache[P]):v.Hooks.registered[K]?O===d?(Q=v.getPropertyValue(f,P),O=v.getPropertyValue(f,K,Q)):Q=v.Hooks.templates[P][1]:O===d&&(O=v.getPropertyValue(f,K));var R,S,T,U=!1;if(R=n(K,O),O=R[0],T=R[1],R=n(K,M),M=R[0].replace(/^([+-\/*])=/,function(a,b){return U=b,""}),S=R[1],O=parseFloat(O)||0,M=parseFloat(M)||0,"%"===S&&(/^(fontSize|lineHeight)$/.test(K)?(M/=100,S="em"):/^scale/.test(K)?(M/=100,S=""):/(Red|Green|Blue)$/i.test(K)&&(M=M/100*255,S="")),/[\/*]/.test(U))S=T;else if(T!==S&&0!==O)if(0===M)S=T;else{e=e||r();var V=/margin|padding|left|right|width|text|word|letter/i.test(K)||/X$/.test(K)||"x"===K?"x":"y";
switch(T){case"%":O*="x"===V?e.percentToPxWidth:e.percentToPxHeight;break;case"px":break;default:O*=e[T+"ToPx"]}switch(S){case"%":O*=1/("x"===V?e.percentToPxWidth:e.percentToPxHeight);break;case"px":break;default:O*=1/e[S+"ToPx"]}}switch(U){case"+":M=O+M;break;case"-":M=O-M;break;case"*":M=O*M;break;case"/":M=O/M}i[K]={rootPropertyValue:Q,startValue:O,currentValue:O,endValue:M,unitType:S,easing:N},t.debug&&console.log("tweensContainer ("+K+"): "+JSON.stringify(i[K]),f)}else t.debug&&console.log("Skipping ["+P+"] due to a lack of browser support.")}i.element=f}i.element&&(v.Values.addClass(f,"velocity-animating"),J.push(i),""===h.queue&&(g(f).tweensContainer=i,g(f).opts=h),g(f).isAnimating=!0,y===x-1?(t.State.calls.push([J,o,h,null,B.resolver]),t.State.isTicking===!1&&(t.State.isTicking=!0,k())):y++)}var e,f=this,h=m.extend({},t.defaults,s),i={};switch(g(f)===d&&t.init(f),parseFloat(h.delay)&&h.queue!==!1&&m.queue(f,h.queue,function(a){t.velocityQueueEntryFlag=!0,g(f).delayTimer={setTimeout:setTimeout(a,parseFloat(h.delay)),next:a}}),h.duration.toString().toLowerCase()){case"fast":h.duration=200;break;case"normal":h.duration=r;break;case"slow":h.duration=600;break;default:h.duration=parseFloat(h.duration)||1}t.mock!==!1&&(t.mock===!0?h.duration=h.delay=1:(h.duration*=parseFloat(t.mock)||1,h.delay*=parseFloat(t.mock)||1)),h.easing=j(h.easing,h.duration),h.begin&&!p.isFunction(h.begin)&&(h.begin=null),h.progress&&!p.isFunction(h.progress)&&(h.progress=null),h.complete&&!p.isFunction(h.complete)&&(h.complete=null),h.display!==d&&null!==h.display&&(h.display=h.display.toString().toLowerCase(),"auto"===h.display&&(h.display=t.CSS.Values.getDisplayType(f))),h.visibility!==d&&null!==h.visibility&&(h.visibility=h.visibility.toString().toLowerCase()),h.mobileHA=h.mobileHA&&t.State.isMobile&&!t.State.isGingerbread,h.queue===!1?h.delay?setTimeout(a,h.delay):a():m.queue(f,h.queue,function(b,c){return c===!0?(B.promise&&B.resolver(o),!0):(t.velocityQueueEntryFlag=!0,void a(b))}),""!==h.queue&&"fx"!==h.queue||"inprogress"===m.queue(f)[0]||m.dequeue(f)}var h,i,n,o,q,s,u=arguments[0]&&(arguments[0].p||m.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||p.isString(arguments[0].properties));if(p.isWrapped(this)?(h=!1,n=0,o=this,i=this):(h=!0,n=1,o=u?arguments[0].elements||arguments[0].e:arguments[0]),o=f(o)){u?(q=arguments[0].properties||arguments[0].p,s=arguments[0].options||arguments[0].o):(q=arguments[n],s=arguments[n+1]);var x=o.length,y=0;if(!/^(stop|finish)$/i.test(q)&&!m.isPlainObject(s)){var z=n+1;s={};for(var A=z;A<arguments.length;A++)p.isArray(arguments[A])||!/^(fast|normal|slow)$/i.test(arguments[A])&&!/^\d/.test(arguments[A])?p.isString(arguments[A])||p.isArray(arguments[A])?s.easing=arguments[A]:p.isFunction(arguments[A])&&(s.complete=arguments[A]):s.duration=arguments[A]}var B={promise:null,resolver:null,rejecter:null};h&&t.Promise&&(B.promise=new t.Promise(function(a,b){B.resolver=a,B.rejecter=b}));var C;switch(q){case"scroll":C="scroll";break;case"reverse":C="reverse";break;case"finish":case"stop":m.each(o,function(a,b){g(b)&&g(b).delayTimer&&(clearTimeout(g(b).delayTimer.setTimeout),g(b).delayTimer.next&&g(b).delayTimer.next(),delete g(b).delayTimer)});var D=[];return m.each(t.State.calls,function(a,b){b&&m.each(b[1],function(c,e){var f=s===d?"":s;return f===!0||b[2].queue===f||s===d&&b[2].queue===!1?void m.each(o,function(c,d){d===e&&((s===!0||p.isString(s))&&(m.each(m.queue(d,p.isString(s)?s:""),function(a,b){p.isFunction(b)&&b(null,!0)}),m.queue(d,p.isString(s)?s:"",[])),"stop"===q?(g(d)&&g(d).tweensContainer&&f!==!1&&m.each(g(d).tweensContainer,function(a,b){b.endValue=b.currentValue}),D.push(a)):"finish"===q&&(b[2].duration=1))}):!0})}),"stop"===q&&(m.each(D,function(a,b){l(b,!0)}),B.promise&&B.resolver(o)),a();default:if(!m.isPlainObject(q)||p.isEmptyObject(q)){if(p.isString(q)&&t.Redirects[q]){var E=m.extend({},s),F=E.duration,G=E.delay||0;return E.backwards===!0&&(o=m.extend(!0,[],o).reverse()),m.each(o,function(a,b){parseFloat(E.stagger)?E.delay=G+parseFloat(E.stagger)*a:p.isFunction(E.stagger)&&(E.delay=G+E.stagger.call(b,a,x)),E.drag&&(E.duration=parseFloat(F)||(/^(callout|transition)/.test(q)?1e3:r),E.duration=Math.max(E.duration*(E.backwards?1-a/x:(a+1)/x),.75*E.duration,200)),t.Redirects[q].call(b,b,E||{},a,x,o,B.promise?B:d)}),a()}var H="Velocity: First argument ("+q+") was not a property map, a known action, or a registered redirect. Aborting.";return B.promise?B.rejecter(new Error(H)):console.log(H),a()}C="start"}var I={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},J=[];m.each(o,function(a,b){p.isNode(b)&&e.call(b)});var K,E=m.extend({},t.defaults,s);if(E.loop=parseInt(E.loop),K=2*E.loop-1,E.loop)for(var L=0;K>L;L++){var M={delay:E.delay,progress:E.progress};L===K-1&&(M.display=E.display,M.visibility=E.visibility,M.complete=E.complete),w(o,"reverse",M)}return a()}};t=m.extend(w,t),t.animate=w;var x=b.requestAnimationFrame||o;return t.State.isMobile||c.hidden===d||c.addEventListener("visibilitychange",function(){c.hidden?(x=function(a){return setTimeout(function(){a(!0)},16)},k()):x=b.requestAnimationFrame||o}),a.Velocity=t,a!==b&&(a.fn.velocity=w,a.fn.velocity.defaults=t.defaults),m.each(["Down","Up"],function(a,b){t.Redirects["slide"+b]=function(a,c,e,f,g,h){var i=m.extend({},c),j=i.begin,k=i.complete,l={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},n={};i.display===d&&(i.display="Down"===b?"inline"===t.CSS.Values.getDisplayType(a)?"inline-block":"block":"none"),i.begin=function(){j&&j.call(g,g);for(var c in l){n[c]=a.style[c];var d=t.CSS.getPropertyValue(a,c);l[c]="Down"===b?[d,0]:[0,d]}n.overflow=a.style.overflow,a.style.overflow="hidden"},i.complete=function(){for(var b in n)a.style[b]=n[b];k&&k.call(g,g),h&&h.resolver(g)},t(a,l,i)}}),m.each(["In","Out"],function(a,b){t.Redirects["fade"+b]=function(a,c,e,f,g,h){var i=m.extend({},c),j={opacity:"In"===b?1:0},k=i.complete;i.complete=e!==f-1?i.begin=null:function(){k&&k.call(g,g),h&&h.resolver(g)},i.display===d&&(i.display="In"===b?"auto":"none"),t(this,j,i)}}),t}(window.jQuery||window.Zepto||window,window,document)})),!function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(k(a,c),b)}function f(a,b,c){return Array.isArray(a)?(g(a,c[b],c),!0):!1}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a}function i(a,b){return h(a,b,!0)}function j(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&h(d,c)}function k(a,b){return function(){return a.apply(b,arguments)}}function l(a,b){return typeof a==ka?a.apply(b?b[0]||d:d,b):a}function m(a,b){return a===d?b:a}function n(a,b,c){g(r(b),function(b){a.addEventListener(b,c,!1)})}function o(a,b,c){g(r(b),function(b){a.removeEventListener(b,c,!1)})}function p(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function q(a,b){return a.indexOf(b)>-1}function r(a){return a.trim().split(/\s+/g)}function s(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function t(a){return Array.prototype.slice.call(a,0)}function u(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];s(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function v(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ia.length;){if(c=ia[g],e=c?c+f:b,e in a)return e;g++}return d}function w(){return oa++}function x(a){var b=a.ownerDocument;return b.defaultView||b.parentWindow}function y(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){l(a.options.enable,[a])&&c.handler(b)},this.init()}function z(a){var b,c=a.options.inputClass;return new(b=c?c:ra?N:sa?Q:qa?S:M)(a,A)}function A(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&ya&&0===d-e,g=b&(Aa|Ba)&&0===d-e;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,B(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function B(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=E(b)),e>1&&!c.firstMultiple?c.firstMultiple=E(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=F(d);b.timeStamp=na(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=J(h,i),b.distance=I(h,i),C(c,b),b.offsetDirection=H(b.deltaX,b.deltaY),b.scale=g?L(g.pointers,d):1,b.rotation=g?K(g.pointers,d):0,D(c,b);var j=a.element;p(b.srcEvent.target,j)&&(j=b.srcEvent.target),b.target=j}function C(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};(b.eventType===ya||f.eventType===Aa)&&(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function D(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Ba&&(i>xa||h.velocity===d)){var j=h.deltaX-b.deltaX,k=h.deltaY-b.deltaY,l=G(i,j,k);e=l.x,f=l.y,c=ma(l.x)>ma(l.y)?l.x:l.y,g=H(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function E(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:la(a.pointers[c].clientX),clientY:la(a.pointers[c].clientY)},c++;return{timeStamp:na(),pointers:b,center:F(b),deltaX:a.deltaX,deltaY:a.deltaY}}function F(a){var b=a.length;if(1===b)return{x:la(a[0].clientX),y:la(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:la(c/b),y:la(d/b)}}function G(a,b,c){return{x:b/a||0,y:c/a||0}}function H(a,b){return a===b?Ca:ma(a)>=ma(b)?a>0?Da:Ea:b>0?Fa:Ga}function I(a,b,c){c||(c=Ka);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function J(a,b,c){c||(c=Ka);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function K(a,b){return J(b[1],b[0],La)-J(a[1],a[0],La)}function L(a,b){return I(b[0],b[1],La)/I(a[0],a[1],La)}function M(){this.evEl=Na,this.evWin=Oa,this.allow=!0,this.pressed=!1,y.apply(this,arguments)}function N(){this.evEl=Ra,this.evWin=Sa,y.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function O(){this.evTarget=Ua,this.evWin=Va,this.started=!1,y.apply(this,arguments)}function P(a,b){var c=t(a.touches),d=t(a.changedTouches);return b&(Aa|Ba)&&(c=u(c.concat(d),"identifier",!0)),[c,d]}function Q(){this.evTarget=Xa,this.targetIds={},y.apply(this,arguments)}function R(a,b){var c=t(a.touches),d=this.targetIds;if(b&(ya|za)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=t(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return p(a.target,i)}),b===ya)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Aa|Ba)&&delete d[g[e].identifier],e++;return h.length?[u(f.concat(h),"identifier",!0),h]:void 0}function S(){y.apply(this,arguments);var a=k(this.handler,this);this.touch=new Q(this.manager,a),this.mouse=new M(this.manager,a)}function T(a,b){this.manager=a,this.set(b)}function U(a){if(q(a,bb))return bb;var b=q(a,cb),c=q(a,db);return b&&c?cb+" "+db:b||c?b?cb:db:q(a,ab)?ab:_a}function V(a){this.id=w(),this.manager=null,this.options=i(a||{},this.defaults),this.options.enable=m(this.options.enable,!0),this.state=eb,this.simultaneous={},this.requireFail=[]}function W(a){return a&jb?"cancel":a&hb?"end":a&gb?"move":a&fb?"start":""}function X(a){return a==Ga?"down":a==Fa?"up":a==Da?"left":a==Ea?"right":""}function Y(a,b){var c=b.manager;return c?c.get(a):a}function Z(){V.apply(this,arguments)}function $(){Z.apply(this,arguments),this.pX=null,this.pY=null}function _(){Z.apply(this,arguments)}function aa(){V.apply(this,arguments),this._timer=null,this._input=null}function ba(){Z.apply(this,arguments)}function ca(){Z.apply(this,arguments)}function da(){V.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ea(a,b){return b=b||{},b.recognizers=m(b.recognizers,ea.defaults.preset),new fa(a,b)}function fa(a,b){b=b||{},this.options=i(b,ea.defaults),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.element=a,this.input=z(this),this.touchAction=new T(this,this.options.touchAction),ga(this,!0),g(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function ga(a,b){var c=a.element;g(a.options.cssProps,function(a,d){c.style[v(c.style,d)]=b?a:""})}function ha(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var ia=["","webkit","moz","MS","ms","o"],ja=b.createElement("div"),ka="function",la=Math.round,ma=Math.abs,na=Date.now,oa=1,pa=/mobile|tablet|ip(ad|hone|od)|android/i,qa="ontouchstart"in a,ra=v(a,"PointerEvent")!==d,sa=qa&&pa.test(navigator.userAgent),ta="touch",ua="pen",va="mouse",wa="kinect",xa=25,ya=1,za=2,Aa=4,Ba=8,Ca=1,Da=2,Ea=4,Fa=8,Ga=16,Ha=Da|Ea,Ia=Fa|Ga,Ja=Ha|Ia,Ka=["x","y"],La=["clientX","clientY"];y.prototype={handler:function(){},init:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(x(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&o(this.element,this.evEl,this.domHandler),this.evTarget&&o(this.target,this.evTarget,this.domHandler),this.evWin&&o(x(this.element),this.evWin,this.domHandler)}};var Ma={mousedown:ya,mousemove:za,mouseup:Aa},Na="mousedown",Oa="mousemove mouseup";j(M,y,{handler:function(a){var b=Ma[a.type];b&ya&&0===a.button&&(this.pressed=!0),b&za&&1!==a.which&&(b=Aa),this.pressed&&this.allow&&(b&Aa&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:va,srcEvent:a}))}});var Pa={pointerdown:ya,pointermove:za,pointerup:Aa,pointercancel:Ba,pointerout:Ba},Qa={2:ta,3:ua,4:va,5:wa},Ra="pointerdown",Sa="pointermove pointerup pointercancel";a.MSPointerEvent&&(Ra="MSPointerDown",Sa="MSPointerMove MSPointerUp MSPointerCancel"),j(N,y,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Pa[d],f=Qa[a.pointerType]||a.pointerType,g=f==ta,h=s(b,a.pointerId,"pointerId");e&ya&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Aa|Ba)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Ta={touchstart:ya,touchmove:za,touchend:Aa,touchcancel:Ba},Ua="touchstart",Va="touchstart touchmove touchend touchcancel";j(O,y,{handler:function(a){var b=Ta[a.type];if(b===ya&&(this.started=!0),this.started){var c=P.call(this,a,b);b&(Aa|Ba)&&0===c[0].length-c[1].length&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:ta,srcEvent:a})}}});var Wa={touchstart:ya,touchmove:za,touchend:Aa,touchcancel:Ba},Xa="touchstart touchmove touchend touchcancel";j(Q,y,{handler:function(a){var b=Wa[a.type],c=R.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:ta,srcEvent:a})}}),j(S,y,{handler:function(a,b,c){var d=c.pointerType==ta,e=c.pointerType==va;if(d)this.mouse.allow=!1;else if(e&&!this.mouse.allow)return;b&(Aa|Ba)&&(this.mouse.allow=!0),this.callback(a,b,c)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ya=v(ja.style,"touchAction"),Za=Ya!==d,$a="compute",_a="auto",ab="manipulation",bb="none",cb="pan-x",db="pan-y";T.prototype={set:function(a){a==$a&&(a=this.compute()),Za&&(this.manager.element.style[Ya]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){l(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),U(a.join(" "))},preventDefaults:function(a){if(!Za){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=q(d,bb),f=q(d,db),g=q(d,cb);return e||f&&c&Ha||g&&c&Ia?this.preventSrc(b):void 0}},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var eb=1,fb=2,gb=4,hb=8,ib=hb,jb=16,kb=32;V.prototype={defaults:{},set:function(a){return h(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=Y(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=Y(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=Y(a,this),-1===s(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=Y(a,this);var b=s(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(c.options.event+(b?W(d):""),a)}var c=this,d=this.state;hb>d&&b(!0),b(),d>=hb&&b(!0)},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=kb)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(kb|eb)))return!1;a++}return!0},recognize:function(a){var b=h({},a);return l(this.options.enable,[this,b])?(this.state&(ib|jb|kb)&&(this.state=eb),this.state=this.process(b),void(this.state&(fb|gb|hb|jb)&&this.tryEmit(b))):(this.reset(),void(this.state=kb))},process:function(){},getTouchAction:function(){},reset:function(){}},j(Z,V,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(fb|gb),e=this.attrTest(a);return d&&(c&Ba||!e)?b|jb:d||e?c&Aa?b|hb:b&fb?b|gb:fb:kb}}),j($,Z,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ja},getTouchAction:function(){var a=this.options.direction,b=[];return a&Ha&&b.push(db),a&Ia&&b.push(cb),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Ha?(e=0===f?Ca:0>f?Da:Ea,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Ca:0>g?Fa:Ga,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return Z.prototype.attrTest.call(this,a)&&(this.state&fb||!(this.state&fb)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this._super.emit.call(this,a)}}),j(_,Z,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&fb)},emit:function(a){if(this._super.emit.call(this,a),1!==a.scale){var b=a.scale<1?"in":"out";this.manager.emit(this.options.event+b,a)}}}),j(aa,V,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[_a]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Aa|Ba)&&!f)this.reset();else if(a.eventType&ya)this.reset(),this._timer=e(function(){this.state=ib,this.tryEmit()},b.time,this);else if(a.eventType&Aa)return ib;return kb},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===ib&&(a&&a.eventType&Aa?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=na(),this.manager.emit(this.options.event,this._input)))}}),j(ba,Z,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&fb)}}),j(ca,Z,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Ha|Ia,pointers:1},getTouchAction:function(){return $.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Ha|Ia)?b=a.velocity:c&Ha?b=a.velocityX:c&Ia&&(b=a.velocityY),this._super.attrTest.call(this,a)&&c&a.direction&&a.distance>this.options.threshold&&ma(b)>this.options.velocity&&a.eventType&Aa},emit:function(a){var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),j(da,V,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[ab]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&ya&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Aa)return this.failTimeout();var g=this.pTime?a.timeStamp-this.pTime<b.interval:!0,h=!this.pCenter||I(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i)return this.hasRequireFailures()?(this._timer=e(function(){this.state=ib,this.tryEmit()},b.interval,this),fb):ib}return kb},failTimeout:function(){return this._timer=e(function(){this.state=kb},this.options.interval,this),kb},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ib&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ea.VERSION="2.0.4",ea.defaults={domEvents:!1,touchAction:$a,enable:!0,inputTarget:null,inputClass:null,preset:[[ba,{enable:!1}],[_,{enable:!1},["rotate"]],[ca,{direction:Ha}],[$,{direction:Ha},["swipe"]],[da],[da,{event:"doubletap",taps:2},["tap"]],[aa]],cssProps:{userSelect:"default",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var lb=1,mb=2;fa.prototype={set:function(a){return h(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?mb:lb},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&ib)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===mb||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(fb|gb|hb)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof V)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;var b=this.recognizers;return a=this.get(a),b.splice(s(b,a),1),this.touchAction.update(),this},on:function(a,b){var c=this.handlers;return g(r(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this},off:function(a,b){var c=this.handlers;return g(r(a),function(a){b?c[a].splice(s(c[a],b),1):delete c[a]}),this},emit:function(a,b){this.options.domEvents&&ha(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&ga(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},h(ea,{INPUT_START:ya,INPUT_MOVE:za,INPUT_END:Aa,INPUT_CANCEL:Ba,STATE_POSSIBLE:eb,STATE_BEGAN:fb,STATE_CHANGED:gb,STATE_ENDED:hb,STATE_RECOGNIZED:ib,STATE_CANCELLED:jb,STATE_FAILED:kb,DIRECTION_NONE:Ca,DIRECTION_LEFT:Da,DIRECTION_RIGHT:Ea,DIRECTION_UP:Fa,DIRECTION_DOWN:Ga,DIRECTION_HORIZONTAL:Ha,DIRECTION_VERTICAL:Ia,DIRECTION_ALL:Ja,Manager:fa,Input:y,TouchAction:T,TouchInput:Q,MouseInput:M,PointerEventInput:N,TouchMouseInput:S,SingleTouchInput:O,Recognizer:V,AttrRecognizer:Z,Tap:da,Pan:$,Swipe:ca,Pinch:_,Rotate:ba,Press:aa,on:n,off:o,each:g,merge:i,extend:h,inherit:j,bindFn:k,prefixed:v}),typeof define==ka&&define.amd?define(function(){return ea}):"undefined"!=typeof module&&module.exports?module.exports=ea:a[c]=ea}(window,document,"Hammer"),function(a){"function"==typeof define&&define.amd?define(["jquery","hammerjs"],a):"object"==typeof exports?a(require("jquery"),require("hammerjs")):a(jQuery,Hammer)}(function(a,b){function c(c,d){var e=a(c);e.data("hammer")||e.data("hammer",new b(e[0],d))}a.fn.hammer=function(a){return this.each(function(){c(this,a)})},b.Manager.prototype.emit=function(b){return function(c,d){b.call(this,c,d),a(this.element).trigger({type:c,gesture:d})}}(b.Manager.prototype.emit)}),function(a){a.Package?Materialize={}:a.Materialize={}}(window),Materialize.guid=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}}(),Materialize.elementOrParentIsFixed=function(a){var b=$(a),c=b.add(b.parents()),d=!1;return c.each(function(){return"fixed"===$(this).css("position")?(d=!0,!1):void 0}),d};var Vel;Vel=$?$.Velocity:jQuery?jQuery.Velocity:Velocity,function(a){a.fn.collapsible=function(b){var c={accordion:void 0};return b=a.extend(c,b),this.each(function(){function c(b){h=g.find("> li > .collapsible-header"),b.hasClass("active")?b.parent().addClass("active"):b.parent().removeClass("active"),b.parent().hasClass("active")?b.siblings(".collapsible-body").stop(!0,!1).slideDown({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){a(this).css("height","")}}):b.siblings(".collapsible-body").stop(!0,!1).slideUp({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){a(this).css("height","")}}),h.not(b).removeClass("active").parent().removeClass("active"),h.not(b).parent().children(".collapsible-body").stop(!0,!1).slideUp({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){a(this).css("height","")}})}function d(b){b.hasClass("active")?b.parent().addClass("active"):b.parent().removeClass("active"),b.parent().hasClass("active")?b.siblings(".collapsible-body").stop(!0,!1).slideDown({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){a(this).css("height","")}}):b.siblings(".collapsible-body").stop(!0,!1).slideUp({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){a(this).css("height","")}})}function e(a){var b=f(a);return b.length>0}function f(a){return a.closest("li > .collapsible-header")}var g=a(this),h=a(this).find("> li > .collapsible-header"),i=g.data("collapsible");g.off("click.collapse","> li > .collapsible-header"),h.off("click.collapse"),g.on("click.collapse","> li > .collapsible-header",function(g){var h=a(this),j=a(g.target);e(j)&&(j=f(j)),j.toggleClass("active"),b.accordion||"accordion"===i||void 0===i?c(j):(d(j),h.hasClass("active")&&d(h))});var h=g.find("> li > .collapsible-header");b.accordion||"accordion"===i||void 0===i?c(h.filter(".active").first()):h.filter(".active").each(function(){d(a(this))})})},a(document).ready(function(){a(".collapsible").collapsible()})}(jQuery),function(a){a.fn.scrollTo=function(b){return a(this).scrollTop(a(this).scrollTop()-a(this).offset().top+a(b).offset().top),this},a.fn.dropdown=function(b){var c={inDuration:300,outDuration:225,constrain_width:!0,hover:!1,gutter:0,belowOrigin:!1,alignment:"left"};this.each(function(){function d(){void 0!==g.data("induration")&&(h.inDuration=g.data("inDuration")),void 0!==g.data("outduration")&&(h.outDuration=g.data("outDuration")),void 0!==g.data("constrainwidth")&&(h.constrain_width=g.data("constrainwidth")),void 0!==g.data("hover")&&(h.hover=g.data("hover")),void 0!==g.data("gutter")&&(h.gutter=g.data("gutter")),void 0!==g.data("beloworigin")&&(h.belowOrigin=g.data("beloworigin")),void 0!==g.data("alignment")&&(h.alignment=g.data("alignment"))}function e(b){"focus"===b&&(i=!0),d(),j.addClass("active"),g.addClass("active"),h.constrain_width===!0?j.css("width",g.outerWidth()):j.css("white-space","nowrap");var c=window.innerHeight,e=g.innerHeight(),f=g.offset().left,k=g.offset().top-a(window).scrollTop(),l=h.alignment,m=0,n=0,o=0;h.belowOrigin===!0&&(o=e);var p=0,q=g.parent();if(!q.is("body")&&q[0].scrollHeight>q[0].clientHeight&&(p=q[0].scrollTop),f+j.innerWidth()>a(window).width()?l="right":f-j.innerWidth()+g.innerWidth()<0&&(l="left"),k+j.innerHeight()>c)if(k+e-j.innerHeight()<0){var r=c-k-o;j.css("max-height",r)}else o||(o+=e),o-=j.innerHeight();if("left"===l)m=h.gutter,n=g.position().left+m;else if("right"===l){var s=g.position().left+g.outerWidth()-j.outerWidth();m=-h.gutter,n=s+m}j.css({position:"absolute",top:g.position().top+o+p,left:n}),j.stop(!0,!0).css("opacity",0).slideDown({queue:!1,duration:h.inDuration,easing:"easeOutCubic",complete:function(){a(this).css("height","")}}).animate({opacity:1},{queue:!1,duration:h.inDuration,easing:"easeOutSine"})}function f(){i=!1,j.fadeOut(h.outDuration),j.removeClass("active"),g.removeClass("active"),setTimeout(function(){j.css("max-height","")},h.outDuration)}var g=a(this),h=a.extend({},c,b),i=!1,j=a("#"+g.attr("data-activates"));if(d(),g.after(j),h.hover){var k=!1;g.unbind("click."+g.attr("id")),g.on("mouseenter",function(a){k===!1&&(e(),k=!0)}),g.on("mouseleave",function(b){var c=b.toElement||b.relatedTarget;a(c).closest(".dropdown-content").is(j)||(j.stop(!0,!0),f(),k=!1)}),j.on("mouseleave",function(b){var c=b.toElement||b.relatedTarget;a(c).closest(".dropdown-button").is(g)||(j.stop(!0,!0),f(),k=!1)})}else g.unbind("click."+g.attr("id")),g.bind("click."+g.attr("id"),function(b){i||(g[0]!=b.currentTarget||g.hasClass("active")||0!==a(b.target).closest(".dropdown-content").length?g.hasClass("active")&&(f(),a(document).unbind("click."+j.attr("id")+" touchstart."+j.attr("id"))):(b.preventDefault(),e("click")),j.hasClass("active")&&a(document).bind("click."+j.attr("id")+" touchstart."+j.attr("id"),function(b){j.is(b.target)||g.is(b.target)||g.find(b.target).length||(f(),a(document).unbind("click."+j.attr("id")+" touchstart."+j.attr("id")))}))});g.on("open",function(a,b){e(b)}),g.on("close",f)})},a(document).ready(function(){a(".dropdown-button").dropdown()})}(jQuery),function(a){var b=0,c=0,d=function(){return c++,"materialize-lean-overlay-"+c};a.fn.extend({openModal:function(c){var e=a("body"),f=e.innerWidth();e.css("overflow","hidden"),e.width(f);var g={opacity:.5,in_duration:350,out_duration:250,ready:void 0,complete:void 0,dismissible:!0,starting_top:"4%"},h=a(this);h.hasClass("open")||(overlayID=d(),$overlay=a('<div class="lean-overlay"></div>'),lStack=++b,$overlay.attr("id",overlayID).css("z-index",1e3+2*lStack),h.data("overlay-id",overlayID).css("z-index",1e3+2*lStack+1),h.addClass("open"),a("body").append($overlay),c=a.extend(g,c),c.dismissible&&($overlay.click(function(){h.closeModal(c)}),a(document).on("keyup.leanModal"+overlayID,function(a){27===a.keyCode&&h.closeModal(c)})),h.find(".modal-close").on("click.close",function(a){h.closeModal(c)}),$overlay.css({display:"block",opacity:0}),h.css({display:"block",opacity:0}),$overlay.velocity({opacity:c.opacity},{duration:c.in_duration,queue:!1,ease:"easeOutCubic"}),h.data("associated-overlay",$overlay[0]),h.hasClass("bottom-sheet")?h.velocity({bottom:"0",opacity:1},{duration:c.in_duration,queue:!1,ease:"easeOutCubic",complete:function(){"function"==typeof c.ready&&c.ready()}}):(a.Velocity.hook(h,"scaleX",.7),h.css({top:c.starting_top}),h.velocity({top:"10%",opacity:1,scaleX:"1"},{duration:c.in_duration,queue:!1,ease:"easeOutCubic",complete:function(){"function"==typeof c.ready&&c.ready()}})))}}),a.fn.extend({closeModal:function(c){var d={out_duration:250,complete:void 0},e=a(this),f=e.data("overlay-id"),g=a("#"+f);e.removeClass("open"),c=a.extend(d,c),a("body").css({overflow:"",width:""}),e.find(".modal-close").off("click.close"),
a(document).off("keyup.leanModal"+f),g.velocity({opacity:0},{duration:c.out_duration,queue:!1,ease:"easeOutQuart"}),e.hasClass("bottom-sheet")?e.velocity({bottom:"-100%",opacity:0},{duration:c.out_duration,queue:!1,ease:"easeOutCubic",complete:function(){g.css({display:"none"}),"function"==typeof c.complete&&c.complete(),g.remove(),b--}}):e.velocity({top:c.starting_top,opacity:0,scaleX:.7},{duration:c.out_duration,complete:function(){a(this).css("display","none"),"function"==typeof c.complete&&c.complete(),g.remove(),b--}})}}),a.fn.extend({leanModal:function(b){return this.each(function(){var c={starting_top:"4%"},d=a.extend(c,b);a(this).click(function(b){d.starting_top=(a(this).offset().top-a(window).scrollTop())/1.15;var c=a(this).attr("href")||"#"+a(this).data("target");a(c).openModal(d),b.preventDefault()})})}})}(jQuery),function(a){a.fn.materialbox=function(){return this.each(function(){function b(){f=!1;var b=i.parent(".material-placeholder"),d=(window.innerWidth,window.innerHeight,i.data("width")),g=i.data("height");i.velocity("stop",!0),a("#materialbox-overlay").velocity("stop",!0),a(".materialbox-caption").velocity("stop",!0),a("#materialbox-overlay").velocity({opacity:0},{duration:h,queue:!1,easing:"easeOutQuad",complete:function(){e=!1,a(this).remove()}}),i.velocity({width:d,height:g,left:0,top:0},{duration:h,queue:!1,easing:"easeOutQuad"}),a(".materialbox-caption").velocity({opacity:0},{duration:h,queue:!1,easing:"easeOutQuad",complete:function(){b.css({height:"",width:"",position:"",top:"",left:""}),i.css({height:"",top:"",left:"",width:"","max-width":"",position:"","z-index":""}),i.removeClass("active"),f=!0,a(this).remove(),c&&c.css("overflow","")}})}if(!a(this).hasClass("initialized")){a(this).addClass("initialized");var c,d,e=!1,f=!0,g=275,h=200,i=a(this),j=a("<div></div>").addClass("material-placeholder");i.wrap(j),i.on("click",function(){var h=i.parent(".material-placeholder"),j=window.innerWidth,k=window.innerHeight,l=i.width(),m=i.height();if(f===!1)return b(),!1;if(e&&f===!0)return b(),!1;f=!1,i.addClass("active"),e=!0,h.css({width:h[0].getBoundingClientRect().width,height:h[0].getBoundingClientRect().height,position:"relative",top:0,left:0}),c=void 0,d=h[0].parentNode;for(;null!==d&&!a(d).is(document);){var n=a(d);"visible"!==n.css("overflow")&&(n.css("overflow","visible"),c=void 0===c?n:c.add(n)),d=d.parentNode}i.css({position:"absolute","z-index":1e3}).data("width",l).data("height",m);var o=a('<div id="materialbox-overlay"></div>').css({opacity:0}).click(function(){f===!0&&b()});if(i.before(o),o.velocity({opacity:1},{duration:g,queue:!1,easing:"easeOutQuad"}),""!==i.data("caption")){var p=a('<div class="materialbox-caption"></div>');p.text(i.data("caption")),a("body").append(p),p.css({display:"inline"}),p.velocity({opacity:1},{duration:g,queue:!1,easing:"easeOutQuad"})}var q=0,r=l/j,s=m/k,t=0,u=0;r>s?(q=m/l,t=.9*j,u=.9*j*q):(q=l/m,t=.9*k*q,u=.9*k),i.hasClass("responsive-img")?i.velocity({"max-width":t,width:l},{duration:0,queue:!1,complete:function(){i.css({left:0,top:0}).velocity({height:u,width:t,left:a(document).scrollLeft()+j/2-i.parent(".material-placeholder").offset().left-t/2,top:a(document).scrollTop()+k/2-i.parent(".material-placeholder").offset().top-u/2},{duration:g,queue:!1,easing:"easeOutQuad",complete:function(){f=!0}})}}):i.css("left",0).css("top",0).velocity({height:u,width:t,left:a(document).scrollLeft()+j/2-i.parent(".material-placeholder").offset().left-t/2,top:a(document).scrollTop()+k/2-i.parent(".material-placeholder").offset().top-u/2},{duration:g,queue:!1,easing:"easeOutQuad",complete:function(){f=!0}})}),a(window).scroll(function(){e&&b()}),a(document).keyup(function(a){27===a.keyCode&&f===!0&&e&&b()})}})},a(document).ready(function(){a(".materialboxed").materialbox()})}(jQuery),function(a){a.fn.parallax=function(){var b=a(window).width();return this.each(function(c){function d(c){var d;d=601>b?e.height()>0?e.height():e.children("img").height():e.height()>0?e.height():500;var f=e.children("img").first(),g=f.height(),h=g-d,i=e.offset().top+d,j=e.offset().top,k=a(window).scrollTop(),l=window.innerHeight,m=k+l,n=(m-j)/(d+l),o=Math.round(h*n);c&&f.css("display","block"),i>k&&k+l>j&&f.css("transform","translate3D(-50%,"+o+"px, 0)")}var e=a(this);e.addClass("parallax"),e.children("img").one("load",function(){d(!0)}).each(function(){this.complete&&a(this).load()}),a(window).scroll(function(){b=a(window).width(),d(!1)}),a(window).resize(function(){b=a(window).width(),d(!1)})})}}(jQuery),function(a){var b={init:function(){return this.each(function(){var b=a(this);a(window).width();b.width("100%");var c,d,e=b.find("li.tab a"),f=b.width(),g=Math.max(f,b[0].scrollWidth)/e.length,h=0;c=a(e.filter('[href="'+location.hash+'"]')),0===c.length&&(c=a(this).find("li.tab a.active").first()),0===c.length&&(c=a(this).find("li.tab a").first()),c.addClass("active"),h=e.index(c),0>h&&(h=0),void 0!==c[0]&&(d=a(c[0].hash)),b.append('<div class="indicator"></div>');var i=b.find(".indicator");b.is(":visible")&&(i.css({right:f-(h+1)*g}),i.css({left:h*g})),a(window).resize(function(){f=b.width(),g=Math.max(f,b[0].scrollWidth)/e.length,0>h&&(h=0),0!==g&&0!==f&&(i.css({right:f-(h+1)*g}),i.css({left:h*g}))}),e.not(c).each(function(){a(this.hash).hide()}),b.on("click","a",function(j){if(a(this).parent().hasClass("disabled"))return void j.preventDefault();f=b.width(),g=Math.max(f,b[0].scrollWidth)/e.length,c.removeClass("active"),void 0!==d&&d.hide(),c=a(this),d=a(this.hash),e=b.find("li.tab a"),c.addClass("active");var k=h;h=e.index(a(this)),0>h&&(h=0),void 0!==d&&d.show(),h-k>=0?(i.velocity({right:f-(h+1)*g},{duration:300,queue:!1,easing:"easeOutQuad"}),i.velocity({left:h*g},{duration:300,queue:!1,easing:"easeOutQuad",delay:90})):(i.velocity({left:h*g},{duration:300,queue:!1,easing:"easeOutQuad"}),i.velocity({right:f-(h+1)*g},{duration:300,queue:!1,easing:"easeOutQuad",delay:90})),j.preventDefault()})})},select_tab:function(a){this.find('a[href="#'+a+'"]').trigger("click")}};a.fn.tabs=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.tooltip"):b.init.apply(this,arguments)},a(document).ready(function(){a("ul.tabs").tabs()})}(jQuery),function(a){a.fn.materialtooltip=function(c){var d=5,e={delay:350};return"remove"===c?(this.each(function(){a("#"+a(this).attr("data-tooltip-id")).remove(),a(this).off("mouseenter.tooltip mouseleave.tooltip")}),!1):(c=a.extend(e,c),this.each(function(){var e=Materialize.guid(),f=a(this);f.attr("data-tooltip-id",e);var g=a("<span></span>").text(f.attr("data-tooltip")),h=a("<div></div>");h.addClass("material-tooltip").append(g).appendTo(a("body")).attr("id",e);var i=a("<div></div>").addClass("backdrop");i.appendTo(h),i.css({top:0,left:0}),f.off("mouseenter.tooltip mouseleave.tooltip");var j,k=!1;f.on({"mouseenter.tooltip":function(a){var e=f.attr("data-delay");e=void 0===e||""===e?c.delay:e,j=setTimeout(function(){k=!0,h.velocity("stop"),i.velocity("stop"),h.css({display:"block",left:"0px",top:"0px"}),h.children("span").text(f.attr("data-tooltip"));var a,c,e,g=f.outerWidth(),j=f.outerHeight(),l=f.attr("data-position"),m=h.outerHeight(),n=h.outerWidth(),o="0px",p="0px",q=8;"top"===l?(a=f.offset().top-m-d,c=f.offset().left+g/2-n/2,e=b(c,a,n,m),o="-10px",i.css({borderRadius:"14px 14px 0 0",transformOrigin:"50% 90%",marginTop:m,marginLeft:n/2-i.width()/2})):"left"===l?(a=f.offset().top+j/2-m/2,c=f.offset().left-n-d,e=b(c,a,n,m),p="-10px",i.css({width:"14px",height:"14px",borderRadius:"14px 0 0 14px",transformOrigin:"95% 50%",marginTop:m/2,marginLeft:n})):"right"===l?(a=f.offset().top+j/2-m/2,c=f.offset().left+g+d,e=b(c,a,n,m),p="+10px",i.css({width:"14px",height:"14px",borderRadius:"0 14px 14px 0",transformOrigin:"5% 50%",marginTop:m/2,marginLeft:"0px"})):(a=f.offset().top+f.outerHeight()+d,c=f.offset().left+g/2-n/2,e=b(c,a,n,m),o="+10px",i.css({marginLeft:n/2-i.width()/2})),h.css({top:e.y,left:e.x}),q=n/8,8>q&&(q=8),("right"===l||"left"===l)&&(q=n/10,6>q&&(q=6)),h.velocity({marginTop:o,marginLeft:p},{duration:350,queue:!1}).velocity({opacity:1},{duration:300,delay:50,queue:!1}),i.css({display:"block"}).velocity({opacity:1},{duration:55,delay:0,queue:!1}).velocity({scale:q},{duration:300,delay:0,queue:!1,easing:"easeInOutQuad"})},e)},"mouseleave.tooltip":function(){k=!1,clearTimeout(j),setTimeout(function(){1!=k&&(h.velocity({opacity:0,marginTop:0,marginLeft:0},{duration:225,queue:!1}),i.velocity({opacity:0,scale:1},{duration:225,queue:!1,complete:function(){i.css("display","none"),h.css("display","none"),k=!1}}))},225)}})}))};var b=function(b,c,d,e){var f=b,g=c;return 0>f?f=4:f+d>window.innerWidth&&(f-=f+d-window.innerWidth),0>g?g=4:g+e>window.innerHeight+a(window).scrollTop&&(g-=g+e-window.innerHeight),{x:f,y:g}};a(document).ready(function(){a(".tooltipped").tooltip()})}(jQuery),function(a){"use strict";function b(a){return null!==a&&a===a.window}function c(a){return b(a)?a:9===a.nodeType&&a.defaultView}function d(a){var b,d,e={top:0,left:0},f=a&&a.ownerDocument;return b=f.documentElement,"undefined"!=typeof a.getBoundingClientRect&&(e=a.getBoundingClientRect()),d=c(f),{top:e.top+d.pageYOffset-b.clientTop,left:e.left+d.pageXOffset-b.clientLeft}}function e(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b+=c+":"+a[c]+";");return b}function f(a){if(k.allowEvent(a)===!1)return null;for(var b=null,c=a.target||a.srcElement;null!==c.parentElement;){if(!(c instanceof SVGElement||-1===c.className.indexOf("waves-effect"))){b=c;break}if(c.classList.contains("waves-effect")){b=c;break}c=c.parentElement}return b}function g(b){var c=f(b);null!==c&&(j.show(b,c),"ontouchstart"in a&&(c.addEventListener("touchend",j.hide,!1),c.addEventListener("touchcancel",j.hide,!1)),c.addEventListener("mouseup",j.hide,!1),c.addEventListener("mouseleave",j.hide,!1))}var h=h||{},i=document.querySelectorAll.bind(document),j={duration:750,show:function(a,b){if(2===a.button)return!1;var c=b||this,f=document.createElement("div");f.className="waves-ripple",c.appendChild(f);var g=d(c),h=a.pageY-g.top,i=a.pageX-g.left,k="scale("+c.clientWidth/100*10+")";"touches"in a&&(h=a.touches[0].pageY-g.top,i=a.touches[0].pageX-g.left),f.setAttribute("data-hold",Date.now()),f.setAttribute("data-scale",k),f.setAttribute("data-x",i),f.setAttribute("data-y",h);var l={top:h+"px",left:i+"px"};f.className=f.className+" waves-notransition",f.setAttribute("style",e(l)),f.className=f.className.replace("waves-notransition",""),l["-webkit-transform"]=k,l["-moz-transform"]=k,l["-ms-transform"]=k,l["-o-transform"]=k,l.transform=k,l.opacity="1",l["-webkit-transition-duration"]=j.duration+"ms",l["-moz-transition-duration"]=j.duration+"ms",l["-o-transition-duration"]=j.duration+"ms",l["transition-duration"]=j.duration+"ms",l["-webkit-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",l["-moz-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",l["-o-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",l["transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",f.setAttribute("style",e(l))},hide:function(a){k.touchup(a);var b=this,c=(1.4*b.clientWidth,null),d=b.getElementsByClassName("waves-ripple");if(!(d.length>0))return!1;c=d[d.length-1];var f=c.getAttribute("data-x"),g=c.getAttribute("data-y"),h=c.getAttribute("data-scale"),i=Date.now()-Number(c.getAttribute("data-hold")),l=350-i;0>l&&(l=0),setTimeout(function(){var a={top:g+"px",left:f+"px",opacity:"0","-webkit-transition-duration":j.duration+"ms","-moz-transition-duration":j.duration+"ms","-o-transition-duration":j.duration+"ms","transition-duration":j.duration+"ms","-webkit-transform":h,"-moz-transform":h,"-ms-transform":h,"-o-transform":h,transform:h};c.setAttribute("style",e(a)),setTimeout(function(){try{b.removeChild(c)}catch(a){return!1}},j.duration)},l)},wrapInput:function(a){for(var b=0;b<a.length;b++){var c=a[b];if("input"===c.tagName.toLowerCase()){var d=c.parentNode;if("i"===d.tagName.toLowerCase()&&-1!==d.className.indexOf("waves-effect"))continue;var e=document.createElement("i");e.className=c.className+" waves-input-wrapper";var f=c.getAttribute("style");f||(f=""),e.setAttribute("style",f),c.className="waves-button-input",c.removeAttribute("style"),d.replaceChild(e,c),e.appendChild(c)}}}},k={touches:0,allowEvent:function(a){var b=!0;return"touchstart"===a.type?k.touches+=1:"touchend"===a.type||"touchcancel"===a.type?setTimeout(function(){k.touches>0&&(k.touches-=1)},500):"mousedown"===a.type&&k.touches>0&&(b=!1),b},touchup:function(a){k.allowEvent(a)}};h.displayEffect=function(b){b=b||{},"duration"in b&&(j.duration=b.duration),j.wrapInput(i(".waves-effect")),"ontouchstart"in a&&document.body.addEventListener("touchstart",g,!1),document.body.addEventListener("mousedown",g,!1)},h.attach=function(b){"input"===b.tagName.toLowerCase()&&(j.wrapInput([b]),b=b.parentElement),"ontouchstart"in a&&b.addEventListener("touchstart",g,!1),b.addEventListener("mousedown",g,!1)},a.Waves=h,document.addEventListener("DOMContentLoaded",function(){h.displayEffect()},!1)}(window),Materialize.toast=function(a,b,c,d){function e(a){var b=document.createElement("div");if(b.classList.add("toast"),c)for(var e=c.split(" "),f=0,g=e.length;g>f;f++)b.classList.add(e[f]);("object"==typeof HTMLElement?a instanceof HTMLElement:a&&"object"==typeof a&&null!==a&&1===a.nodeType&&"string"==typeof a.nodeName)?b.appendChild(a):a instanceof jQuery?b.appendChild(a[0]):b.innerHTML=a;var h=new Hammer(b,{prevent_default:!1});return h.on("pan",function(a){var c=a.deltaX,d=80;b.classList.contains("panning")||b.classList.add("panning");var e=1-Math.abs(c/d);0>e&&(e=0),Vel(b,{left:c,opacity:e},{duration:50,queue:!1,easing:"easeOutQuad"})}),h.on("panend",function(a){var c=a.deltaX,e=80;Math.abs(c)>e?Vel(b,{marginTop:"-40px"},{duration:375,easing:"easeOutExpo",queue:!1,complete:function(){"function"==typeof d&&d(),b.parentNode.removeChild(b)}}):(b.classList.remove("panning"),Vel(b,{left:0,opacity:1},{duration:300,easing:"easeOutExpo",queue:!1}))}),b}c=c||"";var f=document.getElementById("toast-container");null===f&&(f=document.createElement("div"),f.id="toast-container",document.body.appendChild(f));var g=e(a);a&&f.appendChild(g),g.style.top="35px",g.style.opacity=0,Vel(g,{top:"0px",opacity:1},{duration:300,easing:"easeOutCubic",queue:!1});var h=b,i=setInterval(function(){null===g.parentNode&&window.clearInterval(i),g.classList.contains("panning")||(h-=20),0>=h&&(Vel(g,{opacity:0,marginTop:"-40px"},{duration:375,easing:"easeOutExpo",queue:!1,complete:function(){"function"==typeof d&&d(),this[0].parentNode.removeChild(this[0])}}),window.clearInterval(i))},20)},function(a){var b={init:function(b){var c={menuWidth:240,edge:"left",closeOnClick:!1};b=a.extend(c,b),a(this).each(function(){function c(c){g=!1,h=!1,a("body").css({overflow:"",width:""}),a("#sidenav-overlay").velocity({opacity:0},{duration:200,queue:!1,easing:"easeOutQuad",complete:function(){a(this).remove()}}),"left"===b.edge?(f.css({width:"",right:"",left:"0"}),e.velocity({translateX:"-100%"},{duration:200,queue:!1,easing:"easeOutCubic",complete:function(){c===!0&&(e.removeAttr("style"),e.css("width",b.menuWidth))}})):(f.css({width:"",right:"0",left:""}),e.velocity({translateX:"100%"},{duration:200,queue:!1,easing:"easeOutCubic",complete:function(){c===!0&&(e.removeAttr("style"),e.css("width",b.menuWidth))}}))}var d=a(this),e=a("#"+d.attr("data-activates"));240!=b.menuWidth&&e.css("width",b.menuWidth);var f=a('<div class="drag-target"></div>');a("body").append(f),"left"==b.edge?(e.css("transform","translateX(-100%)"),f.css({left:0})):(e.addClass("right-aligned").css("transform","translateX(100%)"),f.css({right:0})),e.hasClass("fixed")&&window.innerWidth>992&&e.css("transform","translateX(0)"),e.hasClass("fixed")&&a(window).resize(function(){window.innerWidth>992?0!=a("#sidenav-overlay").length&&h?c(!0):e.css("transform","translateX(0%)"):h===!1&&("left"===b.edge?e.css("transform","translateX(-100%)"):e.css("transform","translateX(100%)"))}),b.closeOnClick===!0&&e.on("click.itemclick","a:not(.collapsible-header)",function(){c()});var g=!1,h=!1;f.on("click",function(){c()}),f.hammer({prevent_default:!1}).bind("pan",function(d){if("touch"==d.gesture.pointerType){var f=(d.gesture.direction,d.gesture.center.x),g=(d.gesture.center.y,d.gesture.velocityX,a("body")),i=g.innerWidth();if(g.css("overflow","hidden"),g.width(i),0===a("#sidenav-overlay").length){var j=a('<div id="sidenav-overlay"></div>');j.css("opacity",0).click(function(){c()}),a("body").append(j)}if("left"===b.edge&&(f>b.menuWidth?f=b.menuWidth:0>f&&(f=0)),"left"===b.edge)f<b.menuWidth/2?h=!1:f>=b.menuWidth/2&&(h=!0),e.css("transform","translateX("+(f-b.menuWidth)+"px)");else{f<window.innerWidth-b.menuWidth/2?h=!0:f>=window.innerWidth-b.menuWidth/2&&(h=!1);var k=f-b.menuWidth/2;0>k&&(k=0),e.css("transform","translateX("+k+"px)")}var l;"left"===b.edge?(l=f/b.menuWidth,a("#sidenav-overlay").velocity({opacity:l},{duration:10,queue:!1,easing:"easeOutQuad"})):(l=Math.abs((f-window.innerWidth)/b.menuWidth),a("#sidenav-overlay").velocity({opacity:l},{duration:10,queue:!1,easing:"easeOutQuad"}))}}).bind("panend",function(c){if("touch"==c.gesture.pointerType){var d=c.gesture.velocityX,i=c.gesture.center.x,j=i-b.menuWidth,k=i-b.menuWidth/2;j>0&&(j=0),0>k&&(k=0),g=!1,"left"===b.edge?h&&.3>=d||-.5>d?(0!=j&&e.velocity({translateX:[0,j]},{duration:300,queue:!1,easing:"easeOutQuad"}),a("#sidenav-overlay").velocity({opacity:1},{duration:50,queue:!1,easing:"easeOutQuad"}),f.css({width:"50%",right:0,left:""})):(!h||d>.3)&&(a("body").css({overflow:"",width:""}),e.velocity({translateX:[-1*b.menuWidth-10,j]},{duration:200,queue:!1,easing:"easeOutQuad"}),a("#sidenav-overlay").velocity({opacity:0},{duration:200,queue:!1,easing:"easeOutQuad",complete:function(){a(this).remove()}}),f.css({width:"10px",right:"",left:0})):h&&d>=-.3||d>.5?(e.velocity({translateX:[0,k]},{duration:300,queue:!1,easing:"easeOutQuad"}),a("#sidenav-overlay").velocity({opacity:1},{duration:50,queue:!1,easing:"easeOutQuad"}),f.css({width:"50%",right:"",left:0})):(!h||-.3>d)&&(a("body").css({overflow:"",width:""}),e.velocity({translateX:[b.menuWidth+10,k]},{duration:200,queue:!1,easing:"easeOutQuad"}),a("#sidenav-overlay").velocity({opacity:0},{duration:200,queue:!1,easing:"easeOutQuad",complete:function(){a(this).remove()}}),f.css({width:"10px",right:0,left:""}))}}),d.click(function(){if(h===!0)h=!1,g=!1,c();else{var d=a("body"),i=d.innerWidth();d.css("overflow","hidden"),d.width(i),a("body").append(f),"left"===b.edge?(f.css({width:"50%",right:0,left:""}),e.velocity({translateX:[0,-1*b.menuWidth]},{duration:300,queue:!1,easing:"easeOutQuad"})):(f.css({width:"50%",right:"",left:0}),e.velocity({translateX:[0,b.menuWidth]},{duration:300,queue:!1,easing:"easeOutQuad"}));var j=a('<div id="sidenav-overlay"></div>');j.css("opacity",0).click(function(){h=!1,g=!1,c(),j.velocity({opacity:0},{duration:300,queue:!1,easing:"easeOutQuad",complete:function(){a(this).remove()}})}),a("body").append(j),j.velocity({opacity:1},{duration:300,queue:!1,easing:"easeOutQuad",complete:function(){h=!0,g=!1}})}return!1})})},show:function(){this.trigger("click")},hide:function(){a("#sidenav-overlay").trigger("click")}};a.fn.sideNav=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.sideNav"):b.init.apply(this,arguments)}}(jQuery),function(a){function b(b,c,d,e){var f=a();return a.each(g,function(a,g){if(g.height()>0){var h=g.offset().top,i=g.offset().left,j=i+g.width(),k=h+g.height(),l=!(i>c||e>j||h>d||b>k);l&&f.push(g)}}),f}function c(){++j;var c=f.scrollTop(),d=f.scrollLeft(),e=d+f.width(),g=c+f.height(),i=b(c+k.top+200,e+k.right,g+k.bottom,d+k.left);a.each(i,function(a,b){var c=b.data("scrollSpy:ticks");"number"!=typeof c&&b.triggerHandler("scrollSpy:enter"),b.data("scrollSpy:ticks",j)}),a.each(h,function(a,b){var c=b.data("scrollSpy:ticks");"number"==typeof c&&c!==j&&(b.triggerHandler("scrollSpy:exit"),b.data("scrollSpy:ticks",null))}),h=i}function d(){f.trigger("scrollSpy:winSize")}function e(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:l(),g=null,f=a.apply(d,e),d=e=null};return function(){var j=l();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e),d=e=null):g||c.trailing===!1||(g=setTimeout(i,k)),f}}var f=a(window),g=[],h=[],i=!1,j=0,k={top:0,right:0,bottom:0,left:0},l=Date.now||function(){return(new Date).getTime()};a.scrollSpy=function(b,d){var h=[];b=a(b),b.each(function(b,c){g.push(a(c)),a(c).data("scrollSpy:id",b),a('a[href="#'+a(c).attr("id")+'"]').click(function(b){b.preventDefault();var c=a(this.hash).offset().top+1;a("html, body").animate({scrollTop:c-200},{duration:400,queue:!1,easing:"easeOutCubic"})})}),d=d||{throttle:100},k.top=d.offsetTop||0,k.right=d.offsetRight||0,k.bottom=d.offsetBottom||0,k.left=d.offsetLeft||0;var j=e(c,d.throttle||100),l=function(){a(document).ready(j)};return i||(f.on("scroll",l),f.on("resize",l),i=!0),setTimeout(l,0),b.on("scrollSpy:enter",function(){h=a.grep(h,function(a){return 0!=a.height()});var b=a(this);h[0]?(a('a[href="#'+h[0].attr("id")+'"]').removeClass("active"),b.data("scrollSpy:id")<h[0].data("scrollSpy:id")?h.unshift(a(this)):h.push(a(this))):h.push(a(this)),a('a[href="#'+h[0].attr("id")+'"]').addClass("active")}),b.on("scrollSpy:exit",function(){if(h=a.grep(h,function(a){return 0!=a.height()}),h[0]){a('a[href="#'+h[0].attr("id")+'"]').removeClass("active");var b=a(this);h=a.grep(h,function(a){return a.attr("id")!=b.attr("id")}),h[0]&&a('a[href="#'+h[0].attr("id")+'"]').addClass("active")}}),b},a.winSizeSpy=function(b){return a.winSizeSpy=function(){return f},b=b||{throttle:100},f.on("resize",e(d,b.throttle||100))},a.fn.scrollSpy=function(b){return a.scrollSpy(a(this),b)}}(jQuery),function(a){a(document).ready(function(){function b(b){var c=b.css("font-family"),d=b.css("font-size");d&&e.css("font-size",d),c&&e.css("font-family",c),"off"===b.attr("wrap")&&e.css("overflow-wrap","normal").css("white-space","pre"),e.text(b.val()+"\n");var f=e.html().replace(/\n/g,"<br>");e.html(f),b.is(":visible")?e.css("width",b.width()):e.css("width",a(window).width()/2),b.css("height",e.height())}Materialize.updateTextFields=function(){var b="input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], textarea";a(b).each(function(b,c){a(c).val().length>0||c.autofocus||void 0!==a(this).attr("placeholder")||a(c)[0].validity.badInput===!0?a(this).siblings("label, i").addClass("active"):a(this).siblings("label, i").removeClass("active")})};var c="input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], textarea";a(document).on("change",c,function(){(0!==a(this).val().length||void 0!==a(this).attr("placeholder"))&&a(this).siblings("label").addClass("active"),validate_field(a(this))}),a(document).ready(function(){Materialize.updateTextFields()}),a(document).on("reset",function(b){var d=a(b.target);d.is("form")&&(d.find(c).removeClass("valid").removeClass("invalid"),d.find(c).each(function(){""===a(this).attr("value")&&a(this).siblings("label, i").removeClass("active")}),d.find("select.initialized").each(function(){var a=d.find("option[selected]").text();d.siblings("input.select-dropdown").val(a)}))}),a(document).on("focus",c,function(){a(this).siblings("label, i").addClass("active")}),a(document).on("blur",c,function(){var b=a(this);0===b.val().length&&b[0].validity.badInput!==!0&&void 0===b.attr("placeholder")&&b.siblings("label, i").removeClass("active"),0===b.val().length&&b[0].validity.badInput!==!0&&void 0!==b.attr("placeholder")&&b.siblings("i").removeClass("active"),validate_field(b)}),window.validate_field=function(a){var b=void 0!==a.attr("length"),c=parseInt(a.attr("length")),d=a.val().length;0===a.val().length&&a[0].validity.badInput===!1?a.hasClass("validate")&&(a.removeClass("valid"),a.removeClass("invalid")):a.hasClass("validate")&&(a.is(":valid")&&b&&c>=d||a.is(":valid")&&!b?(a.removeClass("invalid"),a.addClass("valid")):(a.removeClass("valid"),a.addClass("invalid")))};var d="input[type=radio], input[type=checkbox]";a(document).on("keyup.radio",d,function(b){if(9===b.which){a(this).addClass("tabbed");var c=a(this);return void c.one("blur",function(b){a(this).removeClass("tabbed")})}});var e=a(".hiddendiv").first();e.length||(e=a('<div class="hiddendiv common"></div>'),a("body").append(e));var f=".materialize-textarea";a(f).each(function(){var c=a(this);c.val().length&&b(c)}),a("body").on("keyup keydown autoresize",f,function(){b(a(this))}),a(document).on("change",'.file-field input[type="file"]',function(){for(var b=a(this).closest(".file-field"),c=b.find("input.file-path"),d=a(this)[0].files,e=[],f=0;f<d.length;f++)e.push(d[f].name);c.val(e.join(", ")),c.trigger("change")});var g,h="input[type=range]",i=!1;a(h).each(function(){var b=a('<span class="thumb"><span class="value"></span></span>');a(this).after(b)});var j=".range-field";a(document).on("change",h,function(b){var c=a(this).siblings(".thumb");c.find(".value").html(a(this).val())}),a(document).on("input mousedown touchstart",h,function(b){var c=a(this).siblings(".thumb"),d=a(this).outerWidth();c.length<=0&&(c=a('<span class="thumb"><span class="value"></span></span>'),a(this).after(c)),c.find(".value").html(a(this).val()),i=!0,a(this).addClass("active"),c.hasClass("active")||c.velocity({height:"30px",width:"30px",top:"-20px",marginLeft:"-15px"},{duration:300,easing:"easeOutExpo"}),"input"!==b.type&&(g=void 0===b.pageX||null===b.pageX?b.originalEvent.touches[0].pageX-a(this).offset().left:b.pageX-a(this).offset().left,0>g?g=0:g>d&&(g=d),c.addClass("active").css("left",g)),c.find(".value").html(a(this).val())}),a(document).on("mouseup touchend",j,function(){i=!1,a(this).removeClass("active")}),a(document).on("mousemove touchmove",j,function(b){var c,d=a(this).children(".thumb");if(i){d.hasClass("active")||d.velocity({height:"30px",width:"30px",top:"-20px",marginLeft:"-15px"},{duration:300,easing:"easeOutExpo"}),c=void 0===b.pageX||null===b.pageX?b.originalEvent.touches[0].pageX-a(this).offset().left:b.pageX-a(this).offset().left;var e=a(this).outerWidth();0>c?c=0:c>e&&(c=e),d.addClass("active").css("left",c),d.find(".value").html(d.siblings(h).val())}}),a(document).on("mouseout touchleave",j,function(){if(!i){var b=a(this).children(".thumb");b.hasClass("active")&&b.velocity({height:"0",width:"0",top:"10px",marginLeft:"-6px"},{duration:100}),b.removeClass("active")}})}),a.fn.material_select=function(b){function c(a,b,c){var e=a.indexOf(b),f=-1===e;return f?a.push(b):a.splice(e,1),c.siblings("ul.dropdown-content").find("li").eq(b).toggleClass("active"),c.find("option").eq(b).prop("selected",f),d(a,c),f}function d(a,b){for(var c="",d=0,e=a.length;e>d;d++){var f=b.find("option").eq(a[d]).text();c+=0===d?f:", "+f}""===c&&(c=b.find("option:disabled").eq(0).text()),b.siblings("input.select-dropdown").val(c)}a(this).each(function(){var d=a(this);if(!d.hasClass("browser-default")){var e=d.attr("multiple")?!0:!1,f=d.data("select-id");if(f&&(d.parent().find("span.caret").remove(),d.parent().find("input").remove(),d.unwrap(),a("ul#select-options-"+f).remove()),"destroy"===b)return void d.data("select-id",null).removeClass("initialized");var g=Materialize.guid();d.data("select-id",g);var h=a('<div class="select-wrapper"></div>');h.addClass(d.attr("class"));var i=a('<ul id="select-options-'+g+'" class="dropdown-content select-dropdown '+(e?"multiple-select-dropdown":"")+'"></ul>'),j=d.children("option, optgroup"),k=[],l=!1,m=d.find("option:selected").html()||d.find("option:first").html()||"",n=function(b,c,d){var e=c.is(":disabled")?"disabled ":"",f="optgroup-option"===d?"optgroup-option ":"",g=c.data("icon"),h=c.attr("class");if(g){var j="";return h&&(j=' class="'+h+'"'),"multiple"===d?i.append(a('<li class="'+e+'"><img src="'+g+'"'+j+'><span><input type="checkbox"'+e+"/><label></label>"+c.html()+"</span></li>")):i.append(a('<li class="'+e+f+'"><img src="'+g+'"'+j+"><span>"+c.html()+"</span></li>")),!0}"multiple"===d?i.append(a('<li class="'+e+'"><span><input type="checkbox"'+e+"/><label></label>"+c.html()+"</span></li>")):i.append(a('<li class="'+e+f+'"><span>'+c.html()+"</span></li>"))};j.length&&j.each(function(){if(a(this).is("option"))e?n(d,a(this),"multiple"):n(d,a(this));else if(a(this).is("optgroup")){var b=a(this).children("option");i.append(a('<li class="optgroup"><span>'+a(this).attr("label")+"</span></li>")),b.each(function(){n(d,a(this),"optgroup-option")})}}),i.find("li:not(.optgroup)").each(function(f){a(this).click(function(g){if(!a(this).hasClass("disabled")&&!a(this).hasClass("optgroup")){var h=!0;e?(a('input[type="checkbox"]',this).prop("checked",function(a,b){return!b}),h=c(k,a(this).index(),d),q.trigger("focus")):(i.find("li").removeClass("active"),a(this).toggleClass("active"),q.val(a(this).text())),r(i,a(this)),d.find("option").eq(f).prop("selected",h),d.trigger("change"),"undefined"!=typeof b&&b()}g.stopPropagation()})}),d.wrap(h);var o=a('<span class="caret">&#9660;</span>');d.is(":disabled")&&o.addClass("disabled");var p=m.replace(/"/g,"&quot;"),q=a('<input type="text" class="select-dropdown" readonly="true" '+(d.is(":disabled")?"disabled":"")+' data-activates="select-options-'+g+'" value="'+p+'"/>');d.before(q),q.before(o),q.after(i),d.is(":disabled")||q.dropdown({hover:!1,closeOnClick:!1}),d.attr("tabindex")&&a(q[0]).attr("tabindex",d.attr("tabindex")),d.addClass("initialized"),q.on({focus:function(){if(a("ul.select-dropdown").not(i[0]).is(":visible")&&a("input.select-dropdown").trigger("close"),!i.is(":visible")){a(this).trigger("open",["focus"]);var b=a(this).val(),c=i.find("li").filter(function(){return a(this).text().toLowerCase()===b.toLowerCase()})[0];r(i,c)}},click:function(a){a.stopPropagation()}}),q.on("blur",function(){e||a(this).trigger("close"),i.find("li.selected").removeClass("selected")}),i.hover(function(){l=!0},function(){l=!1}),a(window).on({click:function(){e&&(l||q.trigger("close"))}}),e&&d.find("option:selected:not(:disabled)").each(function(){var b=a(this).index();c(k,b,d),i.find("li").eq(b).find(":checkbox").prop("checked",!0)});var r=function(b,c){if(c){b.find("li.selected").removeClass("selected");var d=a(c);d.addClass("selected"),i.scrollTo(d)}},s=[],t=function(b){if(9==b.which)return void q.trigger("close");if(40==b.which&&!i.is(":visible"))return void q.trigger("open");if(13!=b.which||i.is(":visible")){b.preventDefault();var c=String.fromCharCode(b.which).toLowerCase(),d=[9,13,27,38,40];if(c&&-1===d.indexOf(b.which)){s.push(c);var f=s.join(""),g=i.find("li").filter(function(){return 0===a(this).text().toLowerCase().indexOf(f)})[0];g&&r(i,g)}if(13==b.which){var h=i.find("li.selected:not(.disabled)")[0];h&&(a(h).trigger("click"),e||q.trigger("close"))}40==b.which&&(g=i.find("li.selected").length?i.find("li.selected").next("li:not(.disabled)")[0]:i.find("li:not(.disabled)")[0],r(i,g)),27==b.which&&q.trigger("close"),38==b.which&&(g=i.find("li.selected").prev("li:not(.disabled)")[0],g&&r(i,g)),setTimeout(function(){s=[]},1e3)}};q.on("keydown",t)}})}}(jQuery),function(a){var b={init:function(b){var c={indicators:!0,height:400,transition:500,interval:6e3};return b=a.extend(c,b),this.each(function(){function c(a,b){a.hasClass("center-align")?a.velocity({opacity:0,translateY:-100},{duration:b,queue:!1}):a.hasClass("right-align")?a.velocity({opacity:0,translateX:100},{duration:b,queue:!1}):a.hasClass("left-align")&&a.velocity({opacity:0,translateX:-100},{duration:b,queue:!1})}function d(a){a>=j.length?a=0:0>a&&(a=j.length-1),k=i.find(".active").index(),k!=a&&(e=j.eq(k),$caption=e.find(".caption"),e.removeClass("active"),e.velocity({opacity:0},{duration:b.transition,queue:!1,easing:"easeOutQuad",complete:function(){
j.not(".active").velocity({opacity:0,translateX:0,translateY:0},{duration:0,queue:!1})}}),c($caption,b.transition),b.indicators&&f.eq(k).removeClass("active"),j.eq(a).velocity({opacity:1},{duration:b.transition,queue:!1,easing:"easeOutQuad"}),j.eq(a).find(".caption").velocity({opacity:1,translateX:0,translateY:0},{duration:b.transition,delay:b.transition,queue:!1,easing:"easeOutQuad"}),j.eq(a).addClass("active"),b.indicators&&f.eq(a).addClass("active"))}var e,f,g,h=a(this),i=h.find("ul.slides").first(),j=i.find("li"),k=i.find(".active").index();-1!=k&&(e=j.eq(k)),h.hasClass("fullscreen")||(b.indicators?h.height(b.height+40):h.height(b.height),i.height(b.height)),j.find(".caption").each(function(){c(a(this),0)}),j.find("img").each(function(){var b="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";a(this).attr("src")!==b&&(a(this).css("background-image","url("+a(this).attr("src")+")"),a(this).attr("src",b))}),b.indicators&&(f=a('<ul class="indicators"></ul>'),j.each(function(c){var e=a('<li class="indicator-item"></li>');e.click(function(){var c=i.parent(),e=c.find(a(this)).index();d(e),clearInterval(g),g=setInterval(function(){k=i.find(".active").index(),j.length==k+1?k=0:k+=1,d(k)},b.transition+b.interval)}),f.append(e)}),h.append(f),f=h.find("ul.indicators").find("li.indicator-item")),e?e.show():(j.first().addClass("active").velocity({opacity:1},{duration:b.transition,queue:!1,easing:"easeOutQuad"}),k=0,e=j.eq(k),b.indicators&&f.eq(k).addClass("active")),e.find("img").each(function(){e.find(".caption").velocity({opacity:1,translateX:0,translateY:0},{duration:b.transition,queue:!1,easing:"easeOutQuad"})}),g=setInterval(function(){k=i.find(".active").index(),d(k+1)},b.transition+b.interval);var l=!1,m=!1,n=!1;h.hammer({prevent_default:!1}).bind("pan",function(a){if("touch"===a.gesture.pointerType){clearInterval(g);var b=a.gesture.direction,c=a.gesture.deltaX,d=a.gesture.velocityX;$curr_slide=i.find(".active"),$curr_slide.velocity({translateX:c},{duration:50,queue:!1,easing:"easeOutQuad"}),4===b&&(c>h.innerWidth()/2||-.65>d)?n=!0:2===b&&(c<-1*h.innerWidth()/2||d>.65)&&(m=!0);var e;m&&(e=$curr_slide.next(),0===e.length&&(e=j.first()),e.velocity({opacity:1},{duration:300,queue:!1,easing:"easeOutQuad"})),n&&(e=$curr_slide.prev(),0===e.length&&(e=j.last()),e.velocity({opacity:1},{duration:300,queue:!1,easing:"easeOutQuad"}))}}).bind("panend",function(a){"touch"===a.gesture.pointerType&&($curr_slide=i.find(".active"),l=!1,curr_index=i.find(".active").index(),!n&&!m||j.length<=1?$curr_slide.velocity({translateX:0},{duration:300,queue:!1,easing:"easeOutQuad"}):m?(d(curr_index+1),$curr_slide.velocity({translateX:-1*h.innerWidth()},{duration:300,queue:!1,easing:"easeOutQuad",complete:function(){$curr_slide.velocity({opacity:0,translateX:0},{duration:0,queue:!1})}})):n&&(d(curr_index-1),$curr_slide.velocity({translateX:h.innerWidth()},{duration:300,queue:!1,easing:"easeOutQuad",complete:function(){$curr_slide.velocity({opacity:0,translateX:0},{duration:0,queue:!1})}})),m=!1,n=!1,clearInterval(g),g=setInterval(function(){k=i.find(".active").index(),j.length==k+1?k=0:k+=1,d(k)},b.transition+b.interval))}),h.on("sliderPause",function(){clearInterval(g)}),h.on("sliderStart",function(){clearInterval(g),g=setInterval(function(){k=i.find(".active").index(),j.length==k+1?k=0:k+=1,d(k)},b.transition+b.interval)}),h.on("sliderNext",function(){k=i.find(".active").index(),d(k+1)}),h.on("sliderPrev",function(){k=i.find(".active").index(),d(k-1)})})},pause:function(){a(this).trigger("sliderPause")},start:function(){a(this).trigger("sliderStart")},next:function(){a(this).trigger("sliderNext")},prev:function(){a(this).trigger("sliderPrev")}};a.fn.slider=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.tooltip"):b.init.apply(this,arguments)}}(jQuery),function(a){a(document).ready(function(){a(document).on("click.card",".card",function(b){a(this).find("> .card-reveal").length&&(a(b.target).is(a(".card-reveal .card-title"))||a(b.target).is(a(".card-reveal .card-title i"))?a(this).find(".card-reveal").velocity({translateY:0},{duration:225,queue:!1,easing:"easeInOutQuad",complete:function(){a(this).css({display:"none"})}}):(a(b.target).is(a(".card .activator"))||a(b.target).is(a(".card .activator i")))&&(a(b.target).closest(".card").css("overflow","hidden"),a(this).find(".card-reveal").css({display:"block"}).velocity("stop",!1).velocity({translateY:"-100%"},{duration:300,queue:!1,easing:"easeInOutQuad"}))),a(".card-reveal").closest(".card").css("overflow","hidden")})})}(jQuery),function(a){a(document).ready(function(){a(document).on("click.chip",".chip .material-icons",function(b){a(this).parent().remove()})})}(jQuery),function(a){a.fn.pushpin=function(b){var c={top:0,bottom:1/0,offset:0};return b=a.extend(c,b),$index=0,this.each(function(){function c(a){a.removeClass("pin-top"),a.removeClass("pinned"),a.removeClass("pin-bottom")}function d(d,e){d.each(function(){b.top<=e&&b.bottom>=e&&!a(this).hasClass("pinned")&&(c(a(this)),a(this).css("top",b.offset),a(this).addClass("pinned")),e<b.top&&!a(this).hasClass("pin-top")&&(c(a(this)),a(this).css("top",0),a(this).addClass("pin-top")),e>b.bottom&&!a(this).hasClass("pin-bottom")&&(c(a(this)),a(this).addClass("pin-bottom"),a(this).css("top",b.bottom-g))})}var e=Materialize.guid(),f=a(this),g=a(this).offset().top;d(f,a(window).scrollTop()),a(window).on("scroll."+e,function(){var c=a(window).scrollTop()+b.offset;d(f,c)})})}}(jQuery),function(a){a(document).ready(function(){a.fn.reverse=[].reverse,a(document).on("mouseenter.fixedActionBtn",".fixed-action-btn:not(.click-to-toggle)",function(c){var d=a(this);b(d)}),a(document).on("mouseleave.fixedActionBtn",".fixed-action-btn:not(.click-to-toggle)",function(b){var d=a(this);c(d)}),a(document).on("click.fixedActionBtn",".fixed-action-btn.click-to-toggle > a",function(d){var e=a(this),f=e.parent();f.hasClass("active")?c(f):b(f)})}),a.fn.extend({openFAB:function(){b(a(this))},closeFAB:function(){c(a(this))}});var b=function(b){if($this=b,$this.hasClass("active")===!1){var c,d,e=$this.hasClass("horizontal");e===!0?d=40:c=40,$this.addClass("active"),$this.find("ul .btn-floating").velocity({scaleY:".4",scaleX:".4",translateY:c+"px",translateX:d+"px"},{duration:0});var f=0;$this.find("ul .btn-floating").reverse().each(function(){a(this).velocity({opacity:"1",scaleX:"1",scaleY:"1",translateY:"0",translateX:"0"},{duration:80,delay:f}),f+=40})}},c=function(a){$this=a;var b,c,d=$this.hasClass("horizontal");d===!0?c=40:b=40,$this.removeClass("active");$this.find("ul .btn-floating").velocity("stop",!0),$this.find("ul .btn-floating").velocity({opacity:"0",scaleX:".4",scaleY:".4",translateY:b+"px",translateX:c+"px"},{duration:80})}}(jQuery),function(a){Materialize.fadeInImage=function(b){var c=a(b);c.css({opacity:0}),a(c).velocity({opacity:1},{duration:650,queue:!1,easing:"easeOutSine"}),a(c).velocity({opacity:1},{duration:1300,queue:!1,easing:"swing",step:function(b,c){c.start=100;var d=b/100,e=150-(100-b)/1.75;100>e&&(e=100),b>=0&&a(this).css({"-webkit-filter":"grayscale("+d+")brightness("+e+"%)",filter:"grayscale("+d+")brightness("+e+"%)"})}})},Materialize.showStaggeredList=function(b){var c=0;a(b).find("li").velocity({translateX:"-100px"},{duration:0}),a(b).find("li").each(function(){a(this).velocity({opacity:"1",translateX:"0"},{duration:800,delay:c,easing:[60,10]}),c+=120})},a(document).ready(function(){var b=!1,c=!1;a(".dismissable").each(function(){a(this).hammer({prevent_default:!1}).bind("pan",function(d){if("touch"===d.gesture.pointerType){var e=a(this),f=d.gesture.direction,g=d.gesture.deltaX,h=d.gesture.velocityX;e.velocity({translateX:g},{duration:50,queue:!1,easing:"easeOutQuad"}),4===f&&(g>e.innerWidth()/2||-.75>h)&&(b=!0),2===f&&(g<-1*e.innerWidth()/2||h>.75)&&(c=!0)}}).bind("panend",function(d){if(Math.abs(d.gesture.deltaX)<a(this).innerWidth()/2&&(c=!1,b=!1),"touch"===d.gesture.pointerType){var e=a(this);if(b||c){var f;f=b?e.innerWidth():-1*e.innerWidth(),e.velocity({translateX:f},{duration:100,queue:!1,easing:"easeOutQuad",complete:function(){e.css("border","none"),e.velocity({height:0,padding:0},{duration:200,queue:!1,easing:"easeOutQuad",complete:function(){e.remove()}})}})}else e.velocity({translateX:0},{duration:100,queue:!1,easing:"easeOutQuad"});b=!1,c=!1}})})})}(jQuery),function(a){Materialize.scrollFire=function(a){var b=!1;window.addEventListener("scroll",function(){b=!0}),setInterval(function(){if(b){b=!1;for(var c=window.pageYOffset+window.innerHeight,d=0;d<a.length;d++){var e=a[d],f=e.selector,g=e.offset,h=e.callback,i=document.querySelector(f);if(null!==i){var j=i.getBoundingClientRect().top+window.pageYOffset;if(c>j+g&&e.done!==!0){if("function"==typeof h)h.call(this);else if("string"==typeof h){var k=new Function(h);k()}e.done=!0}}}}},100)}}(jQuery),function(a){"function"==typeof define&&define.amd?define("picker",["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):this.Picker=a(jQuery)}(function(a){function b(f,g,i,l){function m(){return b._.node("div",b._.node("div",b._.node("div",b._.node("div",y.component.nodes(t.open),v.box),v.wrap),v.frame),v.holder)}function n(){w.data(g,y).addClass(v.input).attr("tabindex",-1).val(w.data("value")?y.get("select",u.format):f.value),u.editable||w.on("focus."+t.id+" click."+t.id,function(a){a.preventDefault(),y.$root.eq(0).focus()}).on("keydown."+t.id,q),e(f,{haspopup:!0,expanded:!1,readonly:!1,owns:f.id+"_root"})}function o(){y.$root.on({keydown:q,focusin:function(a){y.$root.removeClass(v.focused),a.stopPropagation()},"mousedown click":function(b){var c=b.target;c!=y.$root.children()[0]&&(b.stopPropagation(),"mousedown"!=b.type||a(c).is("input, select, textarea, button, option")||(b.preventDefault(),y.$root.eq(0).focus()))}}).on({focus:function(){w.addClass(v.target)},blur:function(){w.removeClass(v.target)}}).on("focus.toOpen",r).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var b=a(this),c=b.data(),d=b.hasClass(v.navDisabled)||b.hasClass(v.disabled),e=h();e=e&&(e.type||e.href),(d||e&&!a.contains(y.$root[0],e))&&y.$root.eq(0).focus(),!d&&c.nav?y.set("highlight",y.component.item.highlight,{nav:c.nav}):!d&&"pick"in c?y.set("select",c.pick):c.clear?y.clear().close(!0):c.close&&y.close(!0)}),e(y.$root[0],"hidden",!0)}function p(){var b;u.hiddenName===!0?(b=f.name,f.name=""):(b=["string"==typeof u.hiddenPrefix?u.hiddenPrefix:"","string"==typeof u.hiddenSuffix?u.hiddenSuffix:"_submit"],b=b[0]+f.name+b[1]),y._hidden=a('<input type=hidden name="'+b+'"'+(w.data("value")||f.value?' value="'+y.get("select",u.formatSubmit)+'"':"")+">")[0],w.on("change."+t.id,function(){y._hidden.value=f.value?y.get("select",u.formatSubmit):""}),u.container?a(u.container).append(y._hidden):w.after(y._hidden)}function q(a){var b=a.keyCode,c=/^(8|46)$/.test(b);return 27==b?(y.close(),!1):void((32==b||c||!t.open&&y.component.key[b])&&(a.preventDefault(),a.stopPropagation(),c?y.clear().close():y.open()))}function r(a){a.stopPropagation(),"focus"==a.type&&y.$root.addClass(v.focused),y.open()}if(!f)return b;var s=!1,t={id:f.id||"P"+Math.abs(~~(Math.random()*new Date))},u=i?a.extend(!0,{},i.defaults,l):l||{},v=a.extend({},b.klasses(),u.klass),w=a(f),x=function(){return this.start()},y=x.prototype={constructor:x,$node:w,start:function(){return t&&t.start?y:(t.methods={},t.start=!0,t.open=!1,t.type=f.type,f.autofocus=f==h(),f.readOnly=!u.editable,f.id=f.id||t.id,"text"!=f.type&&(f.type="text"),y.component=new i(y,u),y.$root=a(b._.node("div",m(),v.picker,'id="'+f.id+'_root" tabindex="0"')),o(),u.formatSubmit&&p(),n(),u.container?a(u.container).append(y.$root):w.after(y.$root),y.on({start:y.component.onStart,render:y.component.onRender,stop:y.component.onStop,open:y.component.onOpen,close:y.component.onClose,set:y.component.onSet}).on({start:u.onStart,render:u.onRender,stop:u.onStop,open:u.onOpen,close:u.onClose,set:u.onSet}),s=c(y.$root.children()[0]),f.autofocus&&y.open(),y.trigger("start").trigger("render"))},render:function(a){return a?y.$root.html(m()):y.$root.find("."+v.box).html(y.component.nodes(t.open)),y.trigger("render")},stop:function(){return t.start?(y.close(),y._hidden&&y._hidden.parentNode.removeChild(y._hidden),y.$root.remove(),w.removeClass(v.input).removeData(g),setTimeout(function(){w.off("."+t.id)},0),f.type=t.type,f.readOnly=!1,y.trigger("stop"),t.methods={},t.start=!1,y):y},open:function(c){return t.open?y:(w.addClass(v.active),e(f,"expanded",!0),setTimeout(function(){y.$root.addClass(v.opened),e(y.$root[0],"hidden",!1)},0),c!==!1&&(t.open=!0,s&&k.css("overflow","hidden").css("padding-right","+="+d()),y.$root.eq(0).focus(),j.on("click."+t.id+" focusin."+t.id,function(a){var b=a.target;b!=f&&b!=document&&3!=a.which&&y.close(b===y.$root.children()[0])}).on("keydown."+t.id,function(c){var d=c.keyCode,e=y.component.key[d],f=c.target;27==d?y.close(!0):f!=y.$root[0]||!e&&13!=d?a.contains(y.$root[0],f)&&13==d&&(c.preventDefault(),f.click()):(c.preventDefault(),e?b._.trigger(y.component.key.go,y,[b._.trigger(e)]):y.$root.find("."+v.highlighted).hasClass(v.disabled)||y.set("select",y.component.item.highlight).close())})),y.trigger("open"))},close:function(a){return a&&(y.$root.off("focus.toOpen").eq(0).focus(),setTimeout(function(){y.$root.on("focus.toOpen",r)},0)),w.removeClass(v.active),e(f,"expanded",!1),setTimeout(function(){y.$root.removeClass(v.opened+" "+v.focused),e(y.$root[0],"hidden",!0)},0),t.open?(t.open=!1,s&&k.css("overflow","").css("padding-right","-="+d()),j.off("."+t.id),y.trigger("close")):y},clear:function(a){return y.set("clear",null,a)},set:function(b,c,d){var e,f,g=a.isPlainObject(b),h=g?b:{};if(d=g&&a.isPlainObject(c)?c:d||{},b){g||(h[b]=c);for(e in h)f=h[e],e in y.component.item&&(void 0===f&&(f=null),y.component.set(e,f,d)),("select"==e||"clear"==e)&&w.val("clear"==e?"":y.get(e,u.format)).trigger("change");y.render()}return d.muted?y:y.trigger("set",h)},get:function(a,c){if(a=a||"value",null!=t[a])return t[a];if("valueSubmit"==a){if(y._hidden)return y._hidden.value;a="value"}if("value"==a)return f.value;if(a in y.component.item){if("string"==typeof c){var d=y.component.get(a);return d?b._.trigger(y.component.formats.toString,y.component,[c,d]):""}return y.component.get(a)}},on:function(b,c,d){var e,f,g=a.isPlainObject(b),h=g?b:{};if(b){g||(h[b]=c);for(e in h)f=h[e],d&&(e="_"+e),t.methods[e]=t.methods[e]||[],t.methods[e].push(f)}return y},off:function(){var a,b,c=arguments;for(a=0,namesCount=c.length;a<namesCount;a+=1)b=c[a],b in t.methods&&delete t.methods[b];return y},trigger:function(a,c){var d=function(a){var d=t.methods[a];d&&d.map(function(a){b._.trigger(a,y,[c])})};return d("_"+a),d(a),y}};return new x}function c(a){var b,c="position";return a.currentStyle?b=a.currentStyle[c]:window.getComputedStyle&&(b=getComputedStyle(a)[c]),"fixed"==b}function d(){if(k.height()<=i.height())return 0;var b=a('<div style="visibility:hidden;width:100px" />').appendTo("body"),c=b[0].offsetWidth;b.css("overflow","scroll");var d=a('<div style="width:100%" />').appendTo(b),e=d[0].offsetWidth;return b.remove(),c-e}function e(b,c,d){if(a.isPlainObject(c))for(var e in c)f(b,e,c[e]);else f(b,c,d)}function f(a,b,c){a.setAttribute(("role"==b?"":"aria-")+b,c)}function g(b,c){a.isPlainObject(b)||(b={attribute:c}),c="";for(var d in b){var e=("role"==d?"":"aria-")+d,f=b[d];c+=null==f?"":e+'="'+b[d]+'"'}return c}function h(){try{return document.activeElement}catch(a){}}var i=a(window),j=a(document),k=a(document.documentElement);return b.klasses=function(a){return a=a||"picker",{picker:a,opened:a+"--opened",focused:a+"--focused",input:a+"__input",active:a+"__input--active",target:a+"__input--target",holder:a+"__holder",frame:a+"__frame",wrap:a+"__wrap",box:a+"__box"}},b._={group:function(a){for(var c,d="",e=b._.trigger(a.min,a);e<=b._.trigger(a.max,a,[e]);e+=a.i)c=b._.trigger(a.item,a,[e]),d+=b._.node(a.node,c[0],c[1],c[2]);return d},node:function(b,c,d,e){return c?(c=a.isArray(c)?c.join(""):c,d=d?' class="'+d+'"':"",e=e?" "+e:"","<"+b+d+e+">"+c+"</"+b+">"):""},lead:function(a){return(10>a?"0":"")+a},trigger:function(a,b,c){return"function"==typeof a?a.apply(b,c||[]):a},digits:function(a){return/\d/.test(a[1])?2:1},isDate:function(a){return{}.toString.call(a).indexOf("Date")>-1&&this.isInteger(a.getDate())},isInteger:function(a){return{}.toString.call(a).indexOf("Number")>-1&&a%1===0},ariaAttr:g},b.extend=function(c,d){a.fn[c]=function(e,f){var g=this.data(c);return"picker"==e?g:g&&"string"==typeof e?b._.trigger(g[e],g,[f]):this.each(function(){var f=a(this);f.data(c)||new b(this,c,d,e)})},a.fn[c].defaults=d.defaults},b}),function(a){"function"==typeof define&&define.amd?define(["picker","jquery"],a):"object"==typeof exports?module.exports=a(require("./picker.js"),require("jquery")):a(Picker,jQuery)}(function(a,b){function c(a,b){var c=this,d=a.$node[0],e=d.value,f=a.$node.data("value"),g=f||e,h=f?b.formatSubmit:b.format,i=function(){return d.currentStyle?"rtl"==d.currentStyle.direction:"rtl"==getComputedStyle(a.$root[0]).direction};c.settings=b,c.$node=a.$node,c.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},c.item={},c.item.clear=null,c.item.disable=(b.disable||[]).slice(0),c.item.enable=-function(a){return a[0]===!0?a.shift():-1}(c.item.disable),c.set("min",b.min).set("max",b.max).set("now"),g?c.set("select",g,{format:h}):c.set("select",null).set("highlight",c.item.now),c.key={40:7,38:-7,39:function(){return i()?-1:1},37:function(){return i()?1:-1},go:function(a){var b=c.item.highlight,d=new Date(b.year,b.month,b.date+a);c.set("highlight",d,{interval:a}),this.render()}},a.on("render",function(){a.$root.find("."+b.klass.selectMonth).on("change",function(){var c=this.value;c&&(a.set("highlight",[a.get("view").year,c,a.get("highlight").date]),a.$root.find("."+b.klass.selectMonth).trigger("focus"))}),a.$root.find("."+b.klass.selectYear).on("change",function(){var c=this.value;c&&(a.set("highlight",[c,a.get("view").month,a.get("highlight").date]),a.$root.find("."+b.klass.selectYear).trigger("focus"))})},1).on("open",function(){var d="";c.disabled(c.get("now"))&&(d=":not(."+b.klass.buttonToday+")"),a.$root.find("button"+d+", select").attr("disabled",!1)},1).on("close",function(){a.$root.find("button, select").attr("disabled",!0)},1)}var d=7,e=6,f=a._;c.prototype.set=function(a,b,c){var d=this,e=d.item;return null===b?("clear"==a&&(a="select"),e[a]=b,d):(e["enable"==a?"disable":"flip"==a?"enable":a]=d.queue[a].split(" ").map(function(e){return b=d[e](a,b,c)}).pop(),"select"==a?d.set("highlight",e.select,c):"highlight"==a?d.set("view",e.highlight,c):a.match(/^(flip|min|max|disable|enable)$/)&&(e.select&&d.disabled(e.select)&&d.set("select",e.select,c),e.highlight&&d.disabled(e.highlight)&&d.set("highlight",e.highlight,c)),d)},c.prototype.get=function(a){return this.item[a]},c.prototype.create=function(a,c,d){var e,g=this;return c=void 0===c?a:c,c==-(1/0)||c==1/0?e=c:b.isPlainObject(c)&&f.isInteger(c.pick)?c=c.obj:b.isArray(c)?(c=new Date(c[0],c[1],c[2]),c=f.isDate(c)?c:g.create().obj):c=f.isInteger(c)||f.isDate(c)?g.normalize(new Date(c),d):g.now(a,c,d),{year:e||c.getFullYear(),month:e||c.getMonth(),date:e||c.getDate(),day:e||c.getDay(),obj:e||c,pick:e||c.getTime()}},c.prototype.createRange=function(a,c){var d=this,e=function(a){return a===!0||b.isArray(a)||f.isDate(a)?d.create(a):a};return f.isInteger(a)||(a=e(a)),f.isInteger(c)||(c=e(c)),f.isInteger(a)&&b.isPlainObject(c)?a=[c.year,c.month,c.date+a]:f.isInteger(c)&&b.isPlainObject(a)&&(c=[a.year,a.month,a.date+c]),{from:e(a),to:e(c)}},c.prototype.withinRange=function(a,b){return a=this.createRange(a.from,a.to),b.pick>=a.from.pick&&b.pick<=a.to.pick},c.prototype.overlapRanges=function(a,b){var c=this;return a=c.createRange(a.from,a.to),b=c.createRange(b.from,b.to),c.withinRange(a,b.from)||c.withinRange(a,b.to)||c.withinRange(b,a.from)||c.withinRange(b,a.to)},c.prototype.now=function(a,b,c){return b=new Date,c&&c.rel&&b.setDate(b.getDate()+c.rel),this.normalize(b,c)},c.prototype.navigate=function(a,c,d){var e,f,g,h,i=b.isArray(c),j=b.isPlainObject(c),k=this.item.view;if(i||j){for(j?(f=c.year,g=c.month,h=c.date):(f=+c[0],g=+c[1],h=+c[2]),d&&d.nav&&k&&k.month!==g&&(f=k.year,g=k.month),e=new Date(f,g+(d&&d.nav?d.nav:0),1),f=e.getFullYear(),g=e.getMonth();new Date(f,g,h).getMonth()!==g;)h-=1;c=[f,g,h]}return c},c.prototype.normalize=function(a){return a.setHours(0,0,0,0),a},c.prototype.measure=function(a,b){var c=this;return b?"string"==typeof b?b=c.parse(a,b):f.isInteger(b)&&(b=c.now(a,b,{rel:b})):b="min"==a?-(1/0):1/0,b},c.prototype.viewset=function(a,b){return this.create([b.year,b.month,1])},c.prototype.validate=function(a,c,d){var e,g,h,i,j=this,k=c,l=d&&d.interval?d.interval:1,m=-1===j.item.enable,n=j.item.min,o=j.item.max,p=m&&j.item.disable.filter(function(a){if(b.isArray(a)){var d=j.create(a).pick;d<c.pick?e=!0:d>c.pick&&(g=!0)}return f.isInteger(a)}).length;if((!d||!d.nav)&&(!m&&j.disabled(c)||m&&j.disabled(c)&&(p||e||g)||!m&&(c.pick<=n.pick||c.pick>=o.pick)))for(m&&!p&&(!g&&l>0||!e&&0>l)&&(l*=-1);j.disabled(c)&&(Math.abs(l)>1&&(c.month<k.month||c.month>k.month)&&(c=k,l=l>0?1:-1),c.pick<=n.pick?(h=!0,l=1,c=j.create([n.year,n.month,n.date+(c.pick===n.pick?0:-1)])):c.pick>=o.pick&&(i=!0,l=-1,c=j.create([o.year,o.month,o.date+(c.pick===o.pick?0:1)])),!h||!i);)c=j.create([c.year,c.month,c.date+l]);return c},c.prototype.disabled=function(a){var c=this,d=c.item.disable.filter(function(d){return f.isInteger(d)?a.day===(c.settings.firstDay?d:d-1)%7:b.isArray(d)||f.isDate(d)?a.pick===c.create(d).pick:b.isPlainObject(d)?c.withinRange(d,a):void 0});return d=d.length&&!d.filter(function(a){return b.isArray(a)&&"inverted"==a[3]||b.isPlainObject(a)&&a.inverted}).length,-1===c.item.enable?!d:d||a.pick<c.item.min.pick||a.pick>c.item.max.pick},c.prototype.parse=function(a,b,c){var d=this,e={};return b&&"string"==typeof b?(c&&c.format||(c=c||{},c.format=d.settings.format),d.formats.toArray(c.format).map(function(a){var c=d.formats[a],g=c?f.trigger(c,d,[b,e]):a.replace(/^!/,"").length;c&&(e[a]=b.substr(0,g)),b=b.substr(g)}),[e.yyyy||e.yy,+(e.mm||e.m)-1,e.dd||e.d]):b},c.prototype.formats=function(){function a(a,b,c){var d=a.match(/\w+/)[0];return c.mm||c.m||(c.m=b.indexOf(d)+1),d.length}function b(a){return a.match(/\w+/)[0].length}return{d:function(a,b){return a?f.digits(a):b.date},dd:function(a,b){return a?2:f.lead(b.date)},ddd:function(a,c){return a?b(a):this.settings.weekdaysShort[c.day]},dddd:function(a,c){return a?b(a):this.settings.weekdaysFull[c.day]},m:function(a,b){return a?f.digits(a):b.month+1},mm:function(a,b){return a?2:f.lead(b.month+1)},mmm:function(b,c){var d=this.settings.monthsShort;return b?a(b,d,c):d[c.month]},mmmm:function(b,c){var d=this.settings.monthsFull;return b?a(b,d,c):d[c.month]},yy:function(a,b){return a?2:(""+b.year).slice(2)},yyyy:function(a,b){return a?4:b.year},toArray:function(a){return a.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(a,b){var c=this;return c.formats.toArray(a).map(function(a){return f.trigger(c.formats[a],c,[0,b])||a.replace(/^!/,"")}).join("")}}}(),c.prototype.isDateExact=function(a,c){var d=this;return f.isInteger(a)&&f.isInteger(c)||"boolean"==typeof a&&"boolean"==typeof c?a===c:(f.isDate(a)||b.isArray(a))&&(f.isDate(c)||b.isArray(c))?d.create(a).pick===d.create(c).pick:b.isPlainObject(a)&&b.isPlainObject(c)?d.isDateExact(a.from,c.from)&&d.isDateExact(a.to,c.to):!1},c.prototype.isDateOverlap=function(a,c){var d=this,e=d.settings.firstDay?1:0;return f.isInteger(a)&&(f.isDate(c)||b.isArray(c))?(a=a%7+e,a===d.create(c).day+1):f.isInteger(c)&&(f.isDate(a)||b.isArray(a))?(c=c%7+e,c===d.create(a).day+1):b.isPlainObject(a)&&b.isPlainObject(c)?d.overlapRanges(a,c):!1},c.prototype.flipEnable=function(a){var b=this.item;b.enable=a||(-1==b.enable?1:-1)},c.prototype.deactivate=function(a,c){var d=this,e=d.item.disable.slice(0);return"flip"==c?d.flipEnable():c===!1?(d.flipEnable(1),e=[]):c===!0?(d.flipEnable(-1),e=[]):c.map(function(a){for(var c,g=0;g<e.length;g+=1)if(d.isDateExact(a,e[g])){c=!0;break}c||(f.isInteger(a)||f.isDate(a)||b.isArray(a)||b.isPlainObject(a)&&a.from&&a.to)&&e.push(a)}),e},c.prototype.activate=function(a,c){var d=this,e=d.item.disable,g=e.length;return"flip"==c?d.flipEnable():c===!0?(d.flipEnable(1),e=[]):c===!1?(d.flipEnable(-1),e=[]):c.map(function(a){var c,h,i,j;for(i=0;g>i;i+=1){if(h=e[i],d.isDateExact(h,a)){c=e[i]=null,j=!0;break}if(d.isDateOverlap(h,a)){b.isPlainObject(a)?(a.inverted=!0,c=a):b.isArray(a)?(c=a,c[3]||c.push("inverted")):f.isDate(a)&&(c=[a.getFullYear(),a.getMonth(),a.getDate(),"inverted"]);break}}if(c)for(i=0;g>i;i+=1)if(d.isDateExact(e[i],a)){e[i]=null;break}if(j)for(i=0;g>i;i+=1)if(d.isDateOverlap(e[i],a)){e[i]=null;break}c&&e.push(c)}),e.filter(function(a){return null!=a})},c.prototype.nodes=function(a){var b=this,c=b.settings,g=b.item,h=g.now,i=g.select,j=g.highlight,k=g.view,l=g.disable,m=g.min,n=g.max,o=function(a,b){return c.firstDay&&(a.push(a.shift()),b.push(b.shift())),f.node("thead",f.node("tr",f.group({min:0,max:d-1,i:1,node:"th",item:function(d){return[a[d],c.klass.weekdays,'scope=col title="'+b[d]+'"']}})))}((c.showWeekdaysFull?c.weekdaysFull:c.weekdaysLetter).slice(0),c.weekdaysFull.slice(0)),p=function(a){return f.node("div"," ",c.klass["nav"+(a?"Next":"Prev")]+(a&&k.year>=n.year&&k.month>=n.month||!a&&k.year<=m.year&&k.month<=m.month?" "+c.klass.navDisabled:""),"data-nav="+(a||-1)+" "+f.ariaAttr({role:"button",controls:b.$node[0].id+"_table"})+' title="'+(a?c.labelMonthNext:c.labelMonthPrev)+'"')},q=function(d){var e=c.showMonthsShort?c.monthsShort:c.monthsFull;return"short_months"==d&&(e=c.monthsShort),c.selectMonths&&void 0==d?f.node("select",f.group({min:0,max:11,i:1,node:"option",item:function(a){return[e[a],0,"value="+a+(k.month==a?" selected":"")+(k.year==m.year&&a<m.month||k.year==n.year&&a>n.month?" disabled":"")]}}),c.klass.selectMonth+" browser-default",(a?"":"disabled")+" "+f.ariaAttr({controls:b.$node[0].id+"_table"})+' title="'+c.labelMonthSelect+'"'):"short_months"==d?null!=i?f.node("div",e[i.month]):f.node("div",e[k.month]):f.node("div",e[k.month],c.klass.month)},r=function(d){var e=k.year,g=c.selectYears===!0?5:~~(c.selectYears/2);if(g){var h=m.year,i=n.year,j=e-g,l=e+g;if(h>j&&(l+=h-j,j=h),l>i){var o=j-h,p=l-i;j-=o>p?p:o,l=i}if(c.selectYears&&void 0==d)return f.node("select",f.group({min:j,max:l,i:1,node:"option",item:function(a){return[a,0,"value="+a+(e==a?" selected":"")]}}),c.klass.selectYear+" browser-default",(a?"":"disabled")+" "+f.ariaAttr({controls:b.$node[0].id+"_table"})+' title="'+c.labelYearSelect+'"')}return"raw"==d?f.node("div",e):f.node("div",e,c.klass.year)};return createDayLabel=function(){return null!=i?f.node("div",i.date):f.node("div",h.date)},createWeekdayLabel=function(){var a;a=null!=i?i.day:h.day;var b=c.weekdaysFull[a];return b},f.node("div",f.node("div",createWeekdayLabel(),"picker__weekday-display")+f.node("div",q("short_months"),c.klass.month_display)+f.node("div",createDayLabel(),c.klass.day_display)+f.node("div",r("raw"),c.klass.year_display),c.klass.date_display)+f.node("div",f.node("div",(c.selectYears?q()+r():q()+r())+p()+p(1),c.klass.header)+f.node("table",o+f.node("tbody",f.group({min:0,max:e-1,i:1,node:"tr",item:function(a){var e=c.firstDay&&0===b.create([k.year,k.month,1]).day?-7:0;return[f.group({min:d*a-k.day+e+1,max:function(){return this.min+d-1},i:1,node:"td",item:function(a){a=b.create([k.year,k.month,a+(c.firstDay?1:0)]);var d=i&&i.pick==a.pick,e=j&&j.pick==a.pick,g=l&&b.disabled(a)||a.pick<m.pick||a.pick>n.pick,o=f.trigger(b.formats.toString,b,[c.format,a]);return[f.node("div",a.date,function(b){return b.push(k.month==a.month?c.klass.infocus:c.klass.outfocus),h.pick==a.pick&&b.push(c.klass.now),d&&b.push(c.klass.selected),e&&b.push(c.klass.highlighted),g&&b.push(c.klass.disabled),b.join(" ")}([c.klass.day]),"data-pick="+a.pick+" "+f.ariaAttr({role:"gridcell",label:o,selected:d&&b.$node.val()===o?!0:null,activedescendant:e?!0:null,disabled:g?!0:null})),"",f.ariaAttr({role:"presentation"})]}})]}})),c.klass.table,'id="'+b.$node[0].id+'_table" '+f.ariaAttr({role:"grid",controls:b.$node[0].id,readonly:!0})),c.klass.calendar_container)+f.node("div",f.node("button",c.today,"btn-flat picker__today","type=button data-pick="+h.pick+(a&&!b.disabled(h)?"":" disabled")+" "+f.ariaAttr({controls:b.$node[0].id}))+f.node("button",c.clear,"btn-flat picker__clear","type=button data-clear=1"+(a?"":" disabled")+" "+f.ariaAttr({controls:b.$node[0].id}))+f.node("button",c.close,"btn-flat picker__close","type=button data-close=true "+(a?"":" disabled")+" "+f.ariaAttr({controls:b.$node[0].id})),c.klass.footer)},c.defaults=function(a){return{labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysLetter:["S","M","T","W","T","F","S"],today:"Today",clear:"Clear",close:"Close",format:"d mmmm, yyyy",klass:{table:a+"table",header:a+"header",date_display:a+"date-display",day_display:a+"day-display",month_display:a+"month-display",year_display:a+"year-display",calendar_container:a+"calendar-container",navPrev:a+"nav--prev",navNext:a+"nav--next",navDisabled:a+"nav--disabled",month:a+"month",year:a+"year",selectMonth:a+"select--month",selectYear:a+"select--year",weekdays:a+"weekday",day:a+"day",disabled:a+"day--disabled",selected:a+"day--selected",highlighted:a+"day--highlighted",now:a+"day--today",infocus:a+"day--infocus",outfocus:a+"day--outfocus",footer:a+"footer",buttonClear:a+"button--clear",buttonToday:a+"button--today",buttonClose:a+"button--close"}}}(a.klasses().picker+"__"),a.extend("pickadate",c)}),function(a){function b(){var b=+a(this).attr("length"),c=+a(this).val().length,d=b>=c;a(this).parent().find('span[class="character-counter"]').html(c+"/"+b),e(d,a(this))}function c(b){var c=b.parent().find('span[class="character-counter"]');c.length||(c=a("<span/>").addClass("character-counter").css("float","right").css("font-size","12px").css("height",1),b.parent().append(c))}function d(){a(this).parent().find('span[class="character-counter"]').html("")}function e(a,b){var c=b.hasClass("invalid");a&&c?b.removeClass("invalid"):a||c||(b.removeClass("valid"),b.addClass("invalid"))}a.fn.characterCounter=function(){return this.each(function(){var e=a(this),f=e.parent().find('span[class="character-counter"]');if(!f.length){var g=void 0!==e.attr("length");g&&(e.on("input",b),e.on("focus",b),e.on("blur",d),c(e))}})},a(document).ready(function(){a("input, textarea").characterCounter()})}(jQuery),function(a){var b={init:function(b){var c={time_constant:200,dist:-100,shift:0,padding:0,full_width:!1};return b=a.extend(c,b),this.each(function(){function c(){"undefined"!=typeof window.ontouchstart&&(F[0].addEventListener("touchstart",k),F[0].addEventListener("touchmove",l),F[0].addEventListener("touchend",m)),F[0].addEventListener("mousedown",k),F[0].addEventListener("mousemove",l),F[0].addEventListener("mouseup",m),F[0].addEventListener("click",j)}function d(a){return a.targetTouches&&a.targetTouches.length>=1?a.targetTouches[0].clientX:a.clientX}function e(a){return a.targetTouches&&a.targetTouches.length>=1?a.targetTouches[0].clientY:a.clientY}function f(a){return a>=s?a%s:0>a?f(s+a%s):a}function g(a){var c,d,e,g,h,i,j;for(o="number"==typeof a?a:o,p=Math.floor((o+r/2)/r),e=o-p*r,g=0>e?1:-1,h=-g*e*2/r,b.full_width?j="translateX(0)":(j="translateX("+(F[0].clientWidth-item_width)/2+"px) ",
j+="translateY("+(F[0].clientHeight-item_width)/2+"px)"),i=n[f(p)],i.style[z]=j+" translateX("+-e/2+"px) translateX("+g*b.shift*h*c+"px) translateZ("+b.dist*h+"px)",i.style.zIndex=0,b.full_width?tweenedOpacity=1:tweenedOpacity=1-.2*h,i.style.opacity=tweenedOpacity,d=s>>1,c=1;d>=c;++c)b.full_width?(zTranslation=b.dist,tweenedOpacity=c===d&&0>e?1-h:1):(zTranslation=b.dist*(2*c+h*g),tweenedOpacity=1-.2*(2*c+h*g)),i=n[f(p+c)],i.style[z]=j+" translateX("+(b.shift+(r*c-e)/2)+"px) translateZ("+zTranslation+"px)",i.style.zIndex=-c,i.style.opacity=tweenedOpacity,b.full_width?(zTranslation=b.dist,tweenedOpacity=c===d&&e>0?1-h:1):(zTranslation=b.dist*(2*c-h*g),tweenedOpacity=1-.2*(2*c-h*g)),i=n[f(p-c)],i.style[z]=j+" translateX("+(-b.shift+(-r*c-e)/2)+"px) translateZ("+zTranslation+"px)",i.style.zIndex=-c,i.style.opacity=tweenedOpacity;i=n[f(p)],i.style[z]=j+" translateX("+-e/2+"px) translateX("+g*b.shift*h+"px) translateZ("+b.dist*h+"px)",i.style.zIndex=0,b.full_width?tweenedOpacity=1:tweenedOpacity=1-.2*h,i.style.opacity=tweenedOpacity}function h(){var a,b,c,d;a=Date.now(),b=a-B,B=a,c=o-A,A=o,d=1e3*c/(1+b),x=.8*d+.2*x}function i(){var a,c;v&&(a=Date.now()-B,c=v*Math.exp(-a/b.time_constant),c>2||-2>c?(g(w-c),requestAnimationFrame(i)):g(w))}function j(c){if(D)return c.preventDefault(),c.stopPropagation(),!1;if(!b.full_width){var d=a(c.target).closest(".carousel-item").index(),e=p%s-d;0>e?Math.abs(e+s)<Math.abs(e)&&(e+=s):e>0&&Math.abs(e-s)<e&&(e-=s),0>e?a(this).trigger("carouselNext",[Math.abs(e)]):e>0&&a(this).trigger("carouselPrev",[e])}}function k(a){q=!0,D=!1,E=!1,t=d(a),u=e(a),x=v=0,A=o,B=Date.now(),clearInterval(C),C=setInterval(h,100)}function l(a){var b,c,f;if(q)if(b=d(a),y=e(a),c=t-b,f=Math.abs(u-y),30>f&&!E)(c>2||-2>c)&&(D=!0,t=b,g(o+c));else{if(D)return a.preventDefault(),a.stopPropagation(),!1;E=!0}return D?(a.preventDefault(),a.stopPropagation(),!1):void 0}function m(a){return q=!1,clearInterval(C),w=o,(x>10||-10>x)&&(v=.9*x,w=o+v),w=Math.round(w/r)*r,v=w-o,B=Date.now(),requestAnimationFrame(i),a.preventDefault(),a.stopPropagation(),!1}var n,o,p,q,r,s,t,u,v,w,x,z,A,B,C,D,E,F=a(this);return F.hasClass("initialized")?!0:(b.full_width&&(b.dist=0,imageHeight=F.find(".carousel-item img").first().load(function(){F.css("height",a(this).height())})),F.addClass("initialized"),q=!1,o=w=0,n=[],item_width=F.find(".carousel-item").first().innerWidth(),r=2*item_width+b.padding,F.find(".carousel-item").each(function(){n.push(a(this)[0])}),s=n.length,z="transform",["webkit","Moz","O","ms"].every(function(a){var b=a+"Transform";return"undefined"!=typeof document.body.style[b]?(z=b,!1):!0}),window.onresize=g,c(),g(o),a(this).on("carouselNext",function(a,b){void 0===b&&(b=1),w=o+r*b,o!==w&&(v=w-o,B=Date.now(),requestAnimationFrame(i))}),void a(this).on("carouselPrev",function(a,b){void 0===b&&(b=1),w=o-r*b,o!==w&&(v=w-o,B=Date.now(),requestAnimationFrame(i))}))})},next:function(b){a(this).trigger("carouselNext",[b])},prev:function(b){a(this).trigger("carouselPrev",[b])}};a.fn.carousel=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.carousel"):b.init.apply(this,arguments)}}(jQuery);
/*!
 * Copyright 2007, 2008, 2009, 2010  Matthieu Aubry
 * All rights reserved.
 *
 * @link https://github.com/piwik/piwik/blob/master/libs/jquery/jquery.truncate.js
 * @license http://www.opensource.org/licenses/bsd-license.php BSD License
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 * * Redistributions of source code must retain the above copyright
 *   notice, this list of conditions and the following disclaimer.
 *
 * * Redistributions in binary form must reproduce the above copyright
 *   notice, this list of conditions and the following disclaimer in the
 *   documentation and/or other materials provided with the distribution.
 *
 * * Neither the name of Matthieu Aubry nor the names of its contributors
 *   may be used to endorse or promote products derived from this
 *   software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
jQuery.fn.truncate=function(max){return this.each(function(){var trail='...';v=jQuery.trim(jQuery(this).text());while(max<v.length){c=v.charAt(max);newStringTruncated=v.substring(0,max)+trail;charToRemove='"';regExp=new RegExp("["+charToRemove+"]","g");vCleaned=v.replace(regExp,"&amp;quot;").replace(/</g,'&amp;lt;').replace(/>/g,'&amp;gt;');newStringTruncated=newStringTruncated.replace(regExp,"'").replace(/</g,'&lt;').replace(/>/g,'&gt;');html='<span class="truncated" title="'+vCleaned+'">'+newStringTruncated+'</span>';jQuery(this).html(html);break;max--;}});};
/*!
 * jQuery.scrollTo
 * Copyright (c) 2007-2014 Ariel Flesler - aflesler<a>gmail<d>com | http://flesler.blogspot.com
 * Licensed under MIT
 * http://flesler.blogspot.com/2007/10/jqueryscrollto.html
 * @projectDescription Easy element scrolling using jQuery.
 * @author Ariel Flesler
 * @version 1.4.14
 */
!function(e){"use strict";e(["jquery"],function(e){var t=e.scrollTo=function(t,n,o){return e(window).scrollTo(t,n,o)};function n(t){return e.isFunction(t)||e.isPlainObject(t)?t:{top:t,left:t}}return t.defaults={axis:"xy",duration:0,limit:!0},t.window=function(t){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){if(!(!this.nodeName||-1!=e.inArray(this.nodeName.toLowerCase(),["iframe","#document","html","body"])))return this;var t=(this.contentWindow||this).document||this.ownerDocument||this;return/webkit/i.test(navigator.userAgent)&&!/chrom/i.test(navigator.userAgent)||"BackCompat"==t.compatMode?t.body:t.documentElement})},e.fn.scrollTo=function(o,i,r){return"object"==typeof i&&(r=i,i=0),"function"==typeof r&&(r={onAfter:r}),"max"==o&&(o=9e9),r=e.extend({},t.defaults,r),i=i||r.duration,r.queue=r.queue&&r.axis.length>1,r.queue&&(i/=2),r.offset=n(r.offset),r.over=n(r.over),this._scrollable().each(function(){if(null!=o){var s,u=this,a=e(u),f=o,c={},l=a.is("html,body");switch(typeof f){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(f)){f=n(f);break}if(!(f=l?e(f):e(f,this)).length)return;case"object":(f.is||f.style)&&(s=(f=e(f)).offset())}var d=e.isFunction(r.offset)&&r.offset(u,f)||r.offset;e.each(r.axis.split(""),function(e,n){var o="x"==n?"Left":"Top",i=o.toLowerCase(),h="scroll"+o,p=u[h],w=t.max(u,n);if(s)c[h]=s[i]+(l?0:p-a.offset()[i]),r.margin&&(c[h]-=parseInt(f.css("margin"+o))||0,c[h]-=parseInt(f.css("border"+o+"Width"))||0),c[h]+=d[i]||0,r.over[i]&&(c[h]+=f["x"==n?"width":"height"]()*r.over[i]);else{var y=f[i];c[h]=y.slice&&"%"==y.slice(-1)?parseFloat(y)/100*w:y}r.limit&&/^\d+$/.test(c[h])&&(c[h]=c[h]<=0?0:Math.min(c[h],w)),!e&&r.queue&&(p!=c[h]&&m(r.onAfterFirst),delete c[h])}),m(r.onAfter)}function m(e){a.animate(c,i,r.easing,e&&function(){e.call(this,f,r)})}}).end()},t.max=function(t,n){var o="x"==n?"Width":"Height",i="scroll"+o;if(!e(t).is("html,body"))return t[i]-e(t)[o.toLowerCase()]();var r="client"+o,s=t.ownerDocument.documentElement,u=t.ownerDocument.body;return Math.max(s[i],u[i])-Math.min(s[r],u[r])},t})}("function"==typeof define&&define.amd?define:function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)});
/*!
 * jScrollPane - v2.0.23 - 2016-01-28
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2014 Kelvin Luck
 * Dual licensed under the MIT or GPL licenses.
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){a.fn.jScrollPane=function(b){function c(b,c){function d(c){var f,h,j,k,l,o,p=!1,q=!1;if(N=c,void 0===O)l=b.scrollTop(),o=b.scrollLeft(),b.css({overflow:"hidden",padding:0}),P=b.innerWidth()+rb,Q=b.innerHeight(),b.width(P),O=a('<div class="jspPane" />').css("padding",qb).append(b.children()),R=a('<div class="jspContainer" />').css({width:P+"px",height:Q+"px"}).append(O).appendTo(b);else{if(b.css("width",""),p=N.stickToBottom&&A(),q=N.stickToRight&&B(),k=b.innerWidth()+rb!=P||b.outerHeight()!=Q,k&&(P=b.innerWidth()+rb,Q=b.innerHeight(),R.css({width:P+"px",height:Q+"px"})),!k&&sb==S&&O.outerHeight()==T)return void b.width(P);sb=S,O.css("width",""),b.width(P),R.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}O.css("overflow","auto"),S=c.contentWidth?c.contentWidth:O[0].scrollWidth,T=O[0].scrollHeight,O.css("overflow",""),U=S/P,V=T/Q,W=V>1,X=U>1,X||W?(b.addClass("jspScrollable"),f=N.maintainPosition&&($||bb),f&&(h=y(),j=z()),e(),g(),i(),f&&(w(q?S-P:h,!1),v(p?T-Q:j,!1)),F(),C(),L(),N.enableKeyboardNavigation&&H(),N.clickOnTrack&&m(),J(),N.hijackInternalLinks&&K()):(b.removeClass("jspScrollable"),O.css({top:0,left:0,width:R.width()-rb}),D(),G(),I(),n()),N.autoReinitialise&&!pb?pb=setInterval(function(){d(N)},N.autoReinitialiseDelay):!N.autoReinitialise&&pb&&clearInterval(pb),l&&b.scrollTop(0)&&v(l,!1),o&&b.scrollLeft(0)&&w(o,!1),b.trigger("jsp-initialised",[X||W])}function e(){W&&(R.append(a('<div class="jspVerticalBar" />').append(a('<div class="jspCap jspCapTop" />'),a('<div class="jspTrack" />').append(a('<div class="jspDrag" />').append(a('<div class="jspDragTop" />'),a('<div class="jspDragBottom" />'))),a('<div class="jspCap jspCapBottom" />'))),cb=R.find(">.jspVerticalBar"),db=cb.find(">.jspTrack"),Y=db.find(">.jspDrag"),N.showArrows&&(hb=a('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",k(0,-1)).bind("click.jsp",E),ib=a('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",k(0,1)).bind("click.jsp",E),N.arrowScrollOnHover&&(hb.bind("mouseover.jsp",k(0,-1,hb)),ib.bind("mouseover.jsp",k(0,1,ib))),j(db,N.verticalArrowPositions,hb,ib)),fb=Q,R.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){fb-=a(this).outerHeight()}),Y.hover(function(){Y.addClass("jspHover")},function(){Y.removeClass("jspHover")}).bind("mousedown.jsp",function(b){a("html").bind("dragstart.jsp selectstart.jsp",E),Y.addClass("jspActive");var c=b.pageY-Y.position().top;return a("html").bind("mousemove.jsp",function(a){p(a.pageY-c,!1)}).bind("mouseup.jsp mouseleave.jsp",o),!1}),f())}function f(){db.height(fb+"px"),$=0,eb=N.verticalGutter+db.outerWidth(),O.width(P-eb-rb);try{0===cb.position().left&&O.css("margin-left",eb+"px")}catch(a){}}function g(){X&&(R.append(a('<div class="jspHorizontalBar" />').append(a('<div class="jspCap jspCapLeft" />'),a('<div class="jspTrack" />').append(a('<div class="jspDrag" />').append(a('<div class="jspDragLeft" />'),a('<div class="jspDragRight" />'))),a('<div class="jspCap jspCapRight" />'))),jb=R.find(">.jspHorizontalBar"),kb=jb.find(">.jspTrack"),_=kb.find(">.jspDrag"),N.showArrows&&(nb=a('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",k(-1,0)).bind("click.jsp",E),ob=a('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",k(1,0)).bind("click.jsp",E),N.arrowScrollOnHover&&(nb.bind("mouseover.jsp",k(-1,0,nb)),ob.bind("mouseover.jsp",k(1,0,ob))),j(kb,N.horizontalArrowPositions,nb,ob)),_.hover(function(){_.addClass("jspHover")},function(){_.removeClass("jspHover")}).bind("mousedown.jsp",function(b){a("html").bind("dragstart.jsp selectstart.jsp",E),_.addClass("jspActive");var c=b.pageX-_.position().left;return a("html").bind("mousemove.jsp",function(a){r(a.pageX-c,!1)}).bind("mouseup.jsp mouseleave.jsp",o),!1}),lb=R.innerWidth(),h())}function h(){R.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){lb-=a(this).outerWidth()}),kb.width(lb+"px"),bb=0}function i(){if(X&&W){var b=kb.outerHeight(),c=db.outerWidth();fb-=b,a(jb).find(">.jspCap:visible,>.jspArrow").each(function(){lb+=a(this).outerWidth()}),lb-=c,Q-=c,P-=b,kb.parent().append(a('<div class="jspCorner" />').css("width",b+"px")),f(),h()}X&&O.width(R.outerWidth()-rb+"px"),T=O.outerHeight(),V=T/Q,X&&(mb=Math.ceil(1/U*lb),mb>N.horizontalDragMaxWidth?mb=N.horizontalDragMaxWidth:mb<N.horizontalDragMinWidth&&(mb=N.horizontalDragMinWidth),_.width(mb+"px"),ab=lb-mb,s(bb)),W&&(gb=Math.ceil(1/V*fb),gb>N.verticalDragMaxHeight?gb=N.verticalDragMaxHeight:gb<N.verticalDragMinHeight&&(gb=N.verticalDragMinHeight),Y.height(gb+"px"),Z=fb-gb,q($))}function j(a,b,c,d){var e,f="before",g="after";"os"==b&&(b=/Mac/.test(navigator.platform)?"after":"split"),b==f?g=b:b==g&&(f=b,e=c,c=d,d=e),a[f](c)[g](d)}function k(a,b,c){return function(){return l(a,b,this,c),this.blur(),!1}}function l(b,c,d,e){d=a(d).addClass("jspActive");var f,g,h=!0,i=function(){0!==b&&tb.scrollByX(b*N.arrowButtonSpeed),0!==c&&tb.scrollByY(c*N.arrowButtonSpeed),g=setTimeout(i,h?N.initialDelay:N.arrowRepeatFreq),h=!1};i(),f=e?"mouseout.jsp":"mouseup.jsp",e=e||a("html"),e.bind(f,function(){d.removeClass("jspActive"),g&&clearTimeout(g),g=null,e.unbind(f)})}function m(){n(),W&&db.bind("mousedown.jsp",function(b){if(void 0===b.originalTarget||b.originalTarget==b.currentTarget){var c,d=a(this),e=d.offset(),f=b.pageY-e.top-$,g=!0,h=function(){var a=d.offset(),e=b.pageY-a.top-gb/2,j=Q*N.scrollPagePercent,k=Z*j/(T-Q);if(0>f)$-k>e?tb.scrollByY(-j):p(e);else{if(!(f>0))return void i();e>$+k?tb.scrollByY(j):p(e)}c=setTimeout(h,g?N.initialDelay:N.trackClickRepeatFreq),g=!1},i=function(){c&&clearTimeout(c),c=null,a(document).unbind("mouseup.jsp",i)};return h(),a(document).bind("mouseup.jsp",i),!1}}),X&&kb.bind("mousedown.jsp",function(b){if(void 0===b.originalTarget||b.originalTarget==b.currentTarget){var c,d=a(this),e=d.offset(),f=b.pageX-e.left-bb,g=!0,h=function(){var a=d.offset(),e=b.pageX-a.left-mb/2,j=P*N.scrollPagePercent,k=ab*j/(S-P);if(0>f)bb-k>e?tb.scrollByX(-j):r(e);else{if(!(f>0))return void i();e>bb+k?tb.scrollByX(j):r(e)}c=setTimeout(h,g?N.initialDelay:N.trackClickRepeatFreq),g=!1},i=function(){c&&clearTimeout(c),c=null,a(document).unbind("mouseup.jsp",i)};return h(),a(document).bind("mouseup.jsp",i),!1}})}function n(){kb&&kb.unbind("mousedown.jsp"),db&&db.unbind("mousedown.jsp")}function o(){a("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),Y&&Y.removeClass("jspActive"),_&&_.removeClass("jspActive")}function p(c,d){if(W){0>c?c=0:c>Z&&(c=Z);var e=new a.Event("jsp-will-scroll-y");if(b.trigger(e,[c]),!e.isDefaultPrevented()){var f=c||0,g=0===f,h=f==Z,i=c/Z,j=-i*(T-Q);void 0===d&&(d=N.animateScroll),d?tb.animate(Y,"top",c,q,function(){b.trigger("jsp-user-scroll-y",[-j,g,h])}):(Y.css("top",c),q(c),b.trigger("jsp-user-scroll-y",[-j,g,h]))}}}function q(a){void 0===a&&(a=Y.position().top),R.scrollTop(0),$=a||0;var c=0===$,d=$==Z,e=a/Z,f=-e*(T-Q);(ub!=c||wb!=d)&&(ub=c,wb=d,b.trigger("jsp-arrow-change",[ub,wb,vb,xb])),t(c,d),O.css("top",f),b.trigger("jsp-scroll-y",[-f,c,d]).trigger("scroll")}function r(c,d){if(X){0>c?c=0:c>ab&&(c=ab);var e=new a.Event("jsp-will-scroll-x");if(b.trigger(e,[c]),!e.isDefaultPrevented()){var f=c||0,g=0===f,h=f==ab,i=c/ab,j=-i*(S-P);void 0===d&&(d=N.animateScroll),d?tb.animate(_,"left",c,s,function(){b.trigger("jsp-user-scroll-x",[-j,g,h])}):(_.css("left",c),s(c),b.trigger("jsp-user-scroll-x",[-j,g,h]))}}}function s(a){void 0===a&&(a=_.position().left),R.scrollTop(0),bb=a||0;var c=0===bb,d=bb==ab,e=a/ab,f=-e*(S-P);(vb!=c||xb!=d)&&(vb=c,xb=d,b.trigger("jsp-arrow-change",[ub,wb,vb,xb])),u(c,d),O.css("left",f),b.trigger("jsp-scroll-x",[-f,c,d]).trigger("scroll")}function t(a,b){N.showArrows&&(hb[a?"addClass":"removeClass"]("jspDisabled"),ib[b?"addClass":"removeClass"]("jspDisabled"))}function u(a,b){N.showArrows&&(nb[a?"addClass":"removeClass"]("jspDisabled"),ob[b?"addClass":"removeClass"]("jspDisabled"))}function v(a,b){var c=a/(T-Q);p(c*Z,b)}function w(a,b){var c=a/(S-P);r(c*ab,b)}function x(b,c,d){var e,f,g,h,i,j,k,l,m,n=0,o=0;try{e=a(b)}catch(p){return}for(f=e.outerHeight(),g=e.outerWidth(),R.scrollTop(0),R.scrollLeft(0);!e.is(".jspPane");)if(n+=e.position().top,o+=e.position().left,e=e.offsetParent(),/^body|html$/i.test(e[0].nodeName))return;h=z(),j=h+Q,h>n||c?l=n-N.horizontalGutter:n+f>j&&(l=n-Q+f+N.horizontalGutter),isNaN(l)||v(l,d),i=y(),k=i+P,i>o||c?m=o-N.horizontalGutter:o+g>k&&(m=o-P+g+N.horizontalGutter),isNaN(m)||w(m,d)}function y(){return-O.position().left}function z(){return-O.position().top}function A(){var a=T-Q;return a>20&&a-z()<10}function B(){var a=S-P;return a>20&&a-y()<10}function C(){R.unbind(zb).bind(zb,function(a,b,c,d){bb||(bb=0),$||($=0);var e=bb,f=$,g=a.deltaFactor||N.mouseWheelSpeed;return tb.scrollBy(c*g,-d*g,!1),e==bb&&f==$})}function D(){R.unbind(zb)}function E(){return!1}function F(){O.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(a){x(a.target,!1)})}function G(){O.find(":input,a").unbind("focus.jsp")}function H(){function c(){var a=bb,b=$;switch(d){case 40:tb.scrollByY(N.keyboardSpeed,!1);break;case 38:tb.scrollByY(-N.keyboardSpeed,!1);break;case 34:case 32:tb.scrollByY(Q*N.scrollPagePercent,!1);break;case 33:tb.scrollByY(-Q*N.scrollPagePercent,!1);break;case 39:tb.scrollByX(N.keyboardSpeed,!1);break;case 37:tb.scrollByX(-N.keyboardSpeed,!1)}return e=a!=bb||b!=$}var d,e,f=[];X&&f.push(jb[0]),W&&f.push(cb[0]),O.bind("focus.jsp",function(){b.focus()}),b.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(b){if(b.target===this||f.length&&a(b.target).closest(f).length){var g=bb,h=$;switch(b.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:d=b.keyCode,c();break;case 35:v(T-Q),d=null;break;case 36:v(0),d=null}return e=b.keyCode==d&&g!=bb||h!=$,!e}}).bind("keypress.jsp",function(b){return b.keyCode==d&&c(),b.target===this||f.length&&a(b.target).closest(f).length?!e:void 0}),N.hideFocus?(b.css("outline","none"),"hideFocus"in R[0]&&b.attr("hideFocus",!0)):(b.css("outline",""),"hideFocus"in R[0]&&b.attr("hideFocus",!1))}function I(){b.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp"),O.unbind(".jsp")}function J(){if(location.hash&&location.hash.length>1){var b,c,d=escape(location.hash.substr(1));try{b=a("#"+d+', a[name="'+d+'"]')}catch(e){return}b.length&&O.find(d)&&(0===R.scrollTop()?c=setInterval(function(){R.scrollTop()>0&&(x(b,!0),a(document).scrollTop(R.position().top),clearInterval(c))},50):(x(b,!0),a(document).scrollTop(R.position().top)))}}function K(){a(document.body).data("jspHijack")||(a(document.body).data("jspHijack",!0),a(document.body).delegate('a[href*="#"]',"click",function(b){var c,d,e,f,g,h,i=this.href.substr(0,this.href.indexOf("#")),j=location.href;if(-1!==location.href.indexOf("#")&&(j=location.href.substr(0,location.href.indexOf("#"))),i===j){c=escape(this.href.substr(this.href.indexOf("#")+1));try{d=a("#"+c+', a[name="'+c+'"]')}catch(k){return}d.length&&(e=d.closest(".jspScrollable"),f=e.data("jsp"),f.scrollToElement(d,!0),e[0].scrollIntoView&&(g=a(window).scrollTop(),h=d.offset().top,(g>h||h>g+a(window).height())&&e[0].scrollIntoView()),b.preventDefault())}}))}function L(){var a,b,c,d,e,f=!1;R.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(g){var h=g.originalEvent.touches[0];a=y(),b=z(),c=h.pageX,d=h.pageY,e=!1,f=!0}).bind("touchmove.jsp",function(g){if(f){var h=g.originalEvent.touches[0],i=bb,j=$;return tb.scrollTo(a+c-h.pageX,b+d-h.pageY),e=e||Math.abs(c-h.pageX)>5||Math.abs(d-h.pageY)>5,i==bb&&j==$}}).bind("touchend.jsp",function(){f=!1}).bind("click.jsp-touchclick",function(){return e?(e=!1,!1):void 0})}function M(){var a=z(),c=y();b.removeClass("jspScrollable").unbind(".jsp"),O.unbind(".jsp"),b.replaceWith(yb.append(O.children())),yb.scrollTop(a),yb.scrollLeft(c),pb&&clearInterval(pb)}var N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb=this,ub=!0,vb=!0,wb=!1,xb=!1,yb=b.clone(!1,!1).empty(),zb=a.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";"border-box"===b.css("box-sizing")?(qb=0,rb=0):(qb=b.css("paddingTop")+" "+b.css("paddingRight")+" "+b.css("paddingBottom")+" "+b.css("paddingLeft"),rb=(parseInt(b.css("paddingLeft"),10)||0)+(parseInt(b.css("paddingRight"),10)||0)),a.extend(tb,{reinitialise:function(b){b=a.extend({},N,b),d(b)},scrollToElement:function(a,b,c){x(a,b,c)},scrollTo:function(a,b,c){w(a,c),v(b,c)},scrollToX:function(a,b){w(a,b)},scrollToY:function(a,b){v(a,b)},scrollToPercentX:function(a,b){w(a*(S-P),b)},scrollToPercentY:function(a,b){v(a*(T-Q),b)},scrollBy:function(a,b,c){tb.scrollByX(a,c),tb.scrollByY(b,c)},scrollByX:function(a,b){var c=y()+Math[0>a?"floor":"ceil"](a),d=c/(S-P);r(d*ab,b)},scrollByY:function(a,b){var c=z()+Math[0>a?"floor":"ceil"](a),d=c/(T-Q);p(d*Z,b)},positionDragX:function(a,b){r(a,b)},positionDragY:function(a,b){p(a,b)},animate:function(a,b,c,d,e){var f={};f[b]=c,a.animate(f,{duration:N.animateDuration,easing:N.animateEase,queue:!1,step:d,complete:e})},getContentPositionX:function(){return y()},getContentPositionY:function(){return z()},getContentWidth:function(){return S},getContentHeight:function(){return T},getPercentScrolledX:function(){return y()/(S-P)},getPercentScrolledY:function(){return z()/(T-Q)},getIsScrollableH:function(){return X},getIsScrollableV:function(){return W},getContentPane:function(){return O},scrollToBottom:function(a){p(Z,a)},hijackInternalLinks:a.noop,destroy:function(){M()}}),d(c)}return b=a.extend({},a.fn.jScrollPane.defaults,b),a.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){b[this]=b[this]||b.speed}),this.each(function(){var d=a(this),e=d.data("jsp");e?e.reinitialise(b):(a("script",d).filter('[type="text/javascript"],:not([type])').remove(),e=new c(d,b),d.data("jsp",e))})},a.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:void 0,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}});
/*!
 * jQuery Mousewheel 3.1.13
 *
 * Copyright 2015 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});
(function($){var mwheelI={pos:[-260,-260]},minDif=3,doc=document,root=doc.documentElement,body=doc.body,longDelay,shortDelay;function unsetPos(){if(this===mwheelI.elem){mwheelI.pos=[-260,-260];mwheelI.elem=false;minDif=3;}}
$.event.special.mwheelIntent={setup:function(){var jElm=$(this).bind('mousewheel',$.event.special.mwheelIntent.handler);if(this!==doc&&this!==root&&this!==body){jElm.bind('mouseleave',unsetPos);}
jElm=null;return true;},teardown:function(){$(this).unbind('mousewheel',$.event.special.mwheelIntent.handler).unbind('mouseleave',unsetPos);return true;},handler:function(e,d){var pos=[e.clientX,e.clientY];if(this===mwheelI.elem||Math.abs(mwheelI.pos[0]-pos[0])>minDif||Math.abs(mwheelI.pos[1]-pos[1])>minDif){mwheelI.elem=this;mwheelI.pos=pos;minDif=250;clearTimeout(shortDelay);shortDelay=setTimeout(function(){minDif=10;},200);clearTimeout(longDelay);longDelay=setTimeout(function(){minDif=3;},1500);e=$.extend({},e,{type:'mwheelIntent'});return $.event.dispatch.apply(this,arguments);}}};$.fn.extend({mwheelIntent:function(fn){return fn?this.bind("mwheelIntent",fn):this.trigger("mwheelIntent");},unmwheelIntent:function(fn){return this.unbind("mwheelIntent",fn);}});$(function(){body=doc.body;$(doc).bind('mwheelIntent.mwheelIntentDefault',$.noop);});})(jQuery);
/* mousetrap v1.4.6 craig.is/killing/mice */
(function(J,r,f){function s(a,b,d){a.addEventListener?a.addEventListener(b,d,!1):a.attachEvent("on"+b,d)}function A(a){if("keypress"==a.type){var b=String.fromCharCode(a.which);a.shiftKey||(b=b.toLowerCase());return b}return h[a.which]?h[a.which]:B[a.which]?B[a.which]:String.fromCharCode(a.which).toLowerCase()}function t(a){a=a||{};var b=!1,d;for(d in n)a[d]?b=!0:n[d]=0;b||(u=!1)}function C(a,b,d,c,e,v){var g,k,f=[],h=d.type;if(!l[a])return[];"keyup"==h&&w(a)&&(b=[a]);for(g=0;g<l[a].length;++g)if(k=
l[a][g],!(!c&&k.seq&&n[k.seq]!=k.level||h!=k.action||("keypress"!=h||d.metaKey||d.ctrlKey)&&b.sort().join(",")!==k.modifiers.sort().join(","))){var m=c&&k.seq==c&&k.level==v;(!c&&k.combo==e||m)&&l[a].splice(g,1);f.push(k)}return f}function K(a){var b=[];a.shiftKey&&b.push("shift");a.altKey&&b.push("alt");a.ctrlKey&&b.push("ctrl");a.metaKey&&b.push("meta");return b}function x(a,b,d,c){m.stopCallback(b,b.target||b.srcElement,d,c)||!1!==a(b,d)||(b.preventDefault?b.preventDefault():b.returnValue=!1,b.stopPropagation?
b.stopPropagation():b.cancelBubble=!0)}function y(a){"number"!==typeof a.which&&(a.which=a.keyCode);var b=A(a);b&&("keyup"==a.type&&z===b?z=!1:m.handleKey(b,K(a),a))}function w(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function L(a,b,d,c){function e(b){return function(){u=b;++n[a];clearTimeout(D);D=setTimeout(t,1E3)}}function v(b){x(d,b,a);"keyup"!==c&&(z=A(b));setTimeout(t,10)}for(var g=n[a]=0;g<b.length;++g){var f=g+1===b.length?v:e(c||E(b[g+1]).action);F(b[g],f,c,a,g)}}function E(a,b){var d,
c,e,f=[];d="+"===a?["+"]:a.split("+");for(e=0;e<d.length;++e)c=d[e],G[c]&&(c=G[c]),b&&"keypress"!=b&&H[c]&&(c=H[c],f.push("shift")),w(c)&&f.push(c);d=c;e=b;if(!e){if(!p){p={};for(var g in h)95<g&&112>g||h.hasOwnProperty(g)&&(p[h[g]]=g)}e=p[d]?"keydown":"keypress"}"keypress"==e&&f.length&&(e="keydown");return{key:c,modifiers:f,action:e}}function F(a,b,d,c,e){q[a+":"+d]=b;a=a.replace(/\s+/g," ");var f=a.split(" ");1<f.length?L(a,f,b,d):(d=E(a,d),l[d.key]=l[d.key]||[],C(d.key,d.modifiers,{type:d.action},
c,a,e),l[d.key][c?"unshift":"push"]({callback:b,modifiers:d.modifiers,action:d.action,seq:c,level:e,combo:a}))}var h={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},B={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},H={"~":"`","!":"1",
"@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},G={option:"alt",command:"meta","return":"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},p,l={},q={},n={},D,z=!1,I=!1,u=!1;for(f=1;20>f;++f)h[111+f]="f"+f;for(f=0;9>=f;++f)h[f+96]=f;s(r,"keypress",y);s(r,"keydown",y);s(r,"keyup",y);var m={bind:function(a,b,d){a=a instanceof Array?a:[a];for(var c=0;c<a.length;++c)F(a[c],b,d);return this},
unbind:function(a,b){return m.bind(a,function(){},b)},trigger:function(a,b){if(q[a+":"+b])q[a+":"+b]({},a);return this},reset:function(){l={};q={};return this},stopCallback:function(a,b){return-1<(" "+b.className+" ").indexOf(" mousetrap ")?!1:"INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.isContentEditable},handleKey:function(a,b,d){var c=C(a,b,d),e;b={};var f=0,g=!1;for(e=0;e<c.length;++e)c[e].seq&&(f=Math.max(f,c[e].level));for(e=0;e<c.length;++e)c[e].seq?c[e].level==f&&(g=!0,
b[c[e].seq]=1,x(c[e].callback,d,c[e].combo,c[e].seq)):g||x(c[e].callback,d,c[e].combo);c="keypress"==d.type&&I;d.type!=u||w(a)||c||t(b);I=g&&"keydown"==d.type}};J.Mousetrap=m;"function"===typeof define&&define.amd&&define(m)})(window,document);

/*
 AngularJS v1.6.5
 (c) 2010-2017 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(x){'use strict';function pe(a){if(G(a))t(a.objectMaxDepth)&&(Lc.objectMaxDepth=Tb(a.objectMaxDepth)?a.objectMaxDepth:NaN);else return Lc}function Tb(a){return W(a)&&0<a}function K(a,b){b=b||Error;return function(){var d=arguments[0],c;c="["+(a?a+":":"")+d+"] http://errors.angularjs.org/1.6.5/"+(a?a+"/":"")+d;for(d=1;d<arguments.length;d++){c=c+(1==d?"?":"&")+"p"+(d-1)+"=";var e=encodeURIComponent,f;f=arguments[d];f="function"==typeof f?f.toString().replace(/ \{[\s\S]*$/,""):"undefined"==
typeof f?"undefined":"string"!=typeof f?JSON.stringify(f):f;c+=e(f)}return new b(c)}}function oa(a){if(null==a||Za(a))return!1;if(I(a)||C(a)||z&&a instanceof z)return!0;var b="length"in Object(a)&&a.length;return W(b)&&(0<=b&&(b-1 in a||a instanceof Array)||"function"===typeof a.item)}function p(a,b,d){var c,e;if(a)if(E(a))for(c in a)"prototype"!==c&&"length"!==c&&"name"!==c&&a.hasOwnProperty(c)&&b.call(d,a[c],c,a);else if(I(a)||oa(a)){var f="object"!==typeof a;c=0;for(e=a.length;c<e;c++)(f||c in
a)&&b.call(d,a[c],c,a)}else if(a.forEach&&a.forEach!==p)a.forEach(b,d,a);else if(Mc(a))for(c in a)b.call(d,a[c],c,a);else if("function"===typeof a.hasOwnProperty)for(c in a)a.hasOwnProperty(c)&&b.call(d,a[c],c,a);else for(c in a)wa.call(a,c)&&b.call(d,a[c],c,a);return a}function Nc(a,b,d){for(var c=Object.keys(a).sort(),e=0;e<c.length;e++)b.call(d,a[c[e]],c[e]);return c}function Ub(a){return function(b,d){a(d,b)}}function qe(){return++sb}function Vb(a,b,d){for(var c=a.$$hashKey,e=0,f=b.length;e<f;++e){var g=
b[e];if(G(g)||E(g))for(var k=Object.keys(g),h=0,l=k.length;h<l;h++){var m=k[h],n=g[m];d&&G(n)?ia(n)?a[m]=new Date(n.valueOf()):$a(n)?a[m]=new RegExp(n):n.nodeName?a[m]=n.cloneNode(!0):Wb(n)?a[m]=n.clone():(G(a[m])||(a[m]=I(n)?[]:{}),Vb(a[m],[n],!0)):a[m]=n}}c?a.$$hashKey=c:delete a.$$hashKey;return a}function O(a){return Vb(a,xa.call(arguments,1),!1)}function re(a){return Vb(a,xa.call(arguments,1),!0)}function Q(a){return parseInt(a,10)}function Xb(a,b){return O(Object.create(a),b)}function B(){}
function ab(a){return a}function aa(a){return function(){return a}}function Yb(a){return E(a.toString)&&a.toString!==la}function v(a){return"undefined"===typeof a}function t(a){return"undefined"!==typeof a}function G(a){return null!==a&&"object"===typeof a}function Mc(a){return null!==a&&"object"===typeof a&&!Oc(a)}function C(a){return"string"===typeof a}function W(a){return"number"===typeof a}function ia(a){return"[object Date]"===la.call(a)}function Zb(a){switch(la.call(a)){case "[object Error]":return!0;
case "[object Exception]":return!0;case "[object DOMException]":return!0;default:return a instanceof Error}}function E(a){return"function"===typeof a}function $a(a){return"[object RegExp]"===la.call(a)}function Za(a){return a&&a.window===a}function bb(a){return a&&a.$evalAsync&&a.$watch}function La(a){return"boolean"===typeof a}function se(a){return a&&W(a.length)&&te.test(la.call(a))}function Wb(a){return!(!a||!(a.nodeName||a.prop&&a.attr&&a.find))}function ue(a){var b={};a=a.split(",");var d;for(d=
0;d<a.length;d++)b[a[d]]=!0;return b}function ya(a){return N(a.nodeName||a[0]&&a[0].nodeName)}function cb(a,b){var d=a.indexOf(b);0<=d&&a.splice(d,1);return d}function Ia(a,b,d){function c(a,b,c){c--;if(0>c)return"...";var d=b.$$hashKey,g;if(I(a)){g=0;for(var f=a.length;g<f;g++)b.push(e(a[g],c))}else if(Mc(a))for(g in a)b[g]=e(a[g],c);else if(a&&"function"===typeof a.hasOwnProperty)for(g in a)a.hasOwnProperty(g)&&(b[g]=e(a[g],c));else for(g in a)wa.call(a,g)&&(b[g]=e(a[g],c));d?b.$$hashKey=d:delete b.$$hashKey;
return b}function e(a,b){if(!G(a))return a;var d=g.indexOf(a);if(-1!==d)return k[d];if(Za(a)||bb(a))throw za("cpws");var d=!1,e=f(a);void 0===e&&(e=I(a)?[]:Object.create(Oc(a)),d=!0);g.push(a);k.push(e);return d?c(a,e,b):e}function f(a){switch(la.call(a)){case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Float32Array]":case "[object Float64Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return new a.constructor(e(a.buffer),
a.byteOffset,a.length);case "[object ArrayBuffer]":if(!a.slice){var b=new ArrayBuffer(a.byteLength);(new Uint8Array(b)).set(new Uint8Array(a));return b}return a.slice(0);case "[object Boolean]":case "[object Number]":case "[object String]":case "[object Date]":return new a.constructor(a.valueOf());case "[object RegExp]":return b=new RegExp(a.source,a.toString().match(/[^/]*$/)[0]),b.lastIndex=a.lastIndex,b;case "[object Blob]":return new a.constructor([a],{type:a.type})}if(E(a.cloneNode))return a.cloneNode(!0)}
var g=[],k=[];d=Tb(d)?d:NaN;if(b){if(se(b)||"[object ArrayBuffer]"===la.call(b))throw za("cpta");if(a===b)throw za("cpi");I(b)?b.length=0:p(b,function(a,c){"$$hashKey"!==c&&delete b[c]});g.push(a);k.push(b);return c(a,b,d)}return e(a,d)}function $b(a,b){return a===b||a!==a&&b!==b}function sa(a,b){if(a===b)return!0;if(null===a||null===b)return!1;if(a!==a&&b!==b)return!0;var d=typeof a,c;if(d===typeof b&&"object"===d)if(I(a)){if(!I(b))return!1;if((d=a.length)===b.length){for(c=0;c<d;c++)if(!sa(a[c],
b[c]))return!1;return!0}}else{if(ia(a))return ia(b)?$b(a.getTime(),b.getTime()):!1;if($a(a))return $a(b)?a.toString()===b.toString():!1;if(bb(a)||bb(b)||Za(a)||Za(b)||I(b)||ia(b)||$a(b))return!1;d=R();for(c in a)if("$"!==c.charAt(0)&&!E(a[c])){if(!sa(a[c],b[c]))return!1;d[c]=!0}for(c in b)if(!(c in d)&&"$"!==c.charAt(0)&&t(b[c])&&!E(b[c]))return!1;return!0}return!1}function db(a,b,d){return a.concat(xa.call(b,d))}function Qa(a,b){var d=2<arguments.length?xa.call(arguments,2):[];return!E(b)||b instanceof
RegExp?b:d.length?function(){return arguments.length?b.apply(a,db(d,arguments,0)):b.apply(a,d)}:function(){return arguments.length?b.apply(a,arguments):b.call(a)}}function Pc(a,b){var d=b;"string"===typeof a&&"$"===a.charAt(0)&&"$"===a.charAt(1)?d=void 0:Za(b)?d="$WINDOW":b&&x.document===b?d="$DOCUMENT":bb(b)&&(d="$SCOPE");return d}function eb(a,b){if(!v(a))return W(b)||(b=b?2:null),JSON.stringify(a,Pc,b)}function Qc(a){return C(a)?JSON.parse(a):a}function Rc(a,b){a=a.replace(ve,"");var d=Date.parse("Jan 01, 1970 00:00:00 "+
a)/6E4;return ba(d)?b:d}function ac(a,b,d){d=d?-1:1;var c=a.getTimezoneOffset();b=Rc(b,c);d*=b-c;a=new Date(a.getTime());a.setMinutes(a.getMinutes()+d);return a}function Aa(a){a=z(a).clone().empty();var b=z("<div>").append(a).html();try{return a[0].nodeType===Ma?N(b):b.match(/^(<[^>]+>)/)[1].replace(/^<([\w-]+)/,function(a,b){return"<"+N(b)})}catch(d){return N(b)}}function Sc(a){try{return decodeURIComponent(a)}catch(b){}}function Tc(a){var b={};p((a||"").split("&"),function(a){var c,e,f;a&&(e=a=
a.replace(/\+/g,"%20"),c=a.indexOf("="),-1!==c&&(e=a.substring(0,c),f=a.substring(c+1)),e=Sc(e),t(e)&&(f=t(f)?Sc(f):!0,wa.call(b,e)?I(b[e])?b[e].push(f):b[e]=[b[e],f]:b[e]=f))});return b}function bc(a){var b=[];p(a,function(a,c){I(a)?p(a,function(a){b.push(ma(c,!0)+(!0===a?"":"="+ma(a,!0)))}):b.push(ma(c,!0)+(!0===a?"":"="+ma(a,!0)))});return b.length?b.join("&"):""}function fb(a){return ma(a,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function ma(a,b){return encodeURIComponent(a).replace(/%40/gi,
"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,b?"%20":"+")}function we(a,b){var d,c,e=Na.length;for(c=0;c<e;++c)if(d=Na[c]+b,C(d=a.getAttribute(d)))return d;return null}function xe(a,b){var d,c,e={};p(Na,function(b){b+="app";!d&&a.hasAttribute&&a.hasAttribute(b)&&(d=a,c=a.getAttribute(b))});p(Na,function(b){b+="app";var e;!d&&(e=a.querySelector("["+b.replace(":","\\:")+"]"))&&(d=e,c=e.getAttribute(b))});d&&(ye?(e.strictDi=null!==we(d,"strict-di"),
b(d,c?[c]:[],e)):x.console.error("Angular: disabling automatic bootstrap. <script> protocol indicates an extension, document.location.href does not match."))}function Uc(a,b,d){G(d)||(d={});d=O({strictDi:!1},d);var c=function(){a=z(a);if(a.injector()){var c=a[0]===x.document?"document":Aa(a);throw za("btstrpd",c.replace(/</,"&lt;").replace(/>/,"&gt;"));}b=b||[];b.unshift(["$provide",function(b){b.value("$rootElement",a)}]);d.debugInfoEnabled&&b.push(["$compileProvider",function(a){a.debugInfoEnabled(!0)}]);
b.unshift("ng");c=gb(b,d.strictDi);c.invoke(["$rootScope","$rootElement","$compile","$injector",function(a,b,c,d){a.$apply(function(){b.data("$injector",d);c(b)(a)})}]);return c},e=/^NG_ENABLE_DEBUG_INFO!/,f=/^NG_DEFER_BOOTSTRAP!/;x&&e.test(x.name)&&(d.debugInfoEnabled=!0,x.name=x.name.replace(e,""));if(x&&!f.test(x.name))return c();x.name=x.name.replace(f,"");fa.resumeBootstrap=function(a){p(a,function(a){b.push(a)});return c()};E(fa.resumeDeferredBootstrap)&&fa.resumeDeferredBootstrap()}function ze(){x.name=
"NG_ENABLE_DEBUG_INFO!"+x.name;x.location.reload()}function Ae(a){a=fa.element(a).injector();if(!a)throw za("test");return a.get("$$testability")}function Vc(a,b){b=b||"_";return a.replace(Be,function(a,c){return(c?b:"")+a.toLowerCase()})}function Ce(){var a;if(!Wc){var b=tb();(ta=v(b)?x.jQuery:b?x[b]:void 0)&&ta.fn.on?(z=ta,O(ta.fn,{scope:Ra.scope,isolateScope:Ra.isolateScope,controller:Ra.controller,injector:Ra.injector,inheritedData:Ra.inheritedData}),a=ta.cleanData,ta.cleanData=function(b){for(var c,
e=0,f;null!=(f=b[e]);e++)(c=ta._data(f,"events"))&&c.$destroy&&ta(f).triggerHandler("$destroy");a(b)}):z=S;fa.element=z;Wc=!0}}function hb(a,b,d){if(!a)throw za("areq",b||"?",d||"required");return a}function ub(a,b,d){d&&I(a)&&(a=a[a.length-1]);hb(E(a),b,"not a function, got "+(a&&"object"===typeof a?a.constructor.name||"Object":typeof a));return a}function Oa(a,b){if("hasOwnProperty"===a)throw za("badname",b);}function Xc(a,b,d){if(!b)return a;b=b.split(".");for(var c,e=a,f=b.length,g=0;g<f;g++)c=
b[g],a&&(a=(e=a)[c]);return!d&&E(a)?Qa(e,a):a}function vb(a){for(var b=a[0],d=a[a.length-1],c,e=1;b!==d&&(b=b.nextSibling);e++)if(c||a[e]!==b)c||(c=z(xa.call(a,0,e))),c.push(b);return c||a}function R(){return Object.create(null)}function cc(a){if(null==a)return"";switch(typeof a){case "string":break;case "number":a=""+a;break;default:a=!Yb(a)||I(a)||ia(a)?eb(a):a.toString()}return a}function De(a){function b(a,b,c){return a[b]||(a[b]=c())}var d=K("$injector"),c=K("ng");a=b(a,"angular",Object);a.$$minErr=
a.$$minErr||K;return b(a,"module",function(){var a={};return function(f,g,k){var h={};if("hasOwnProperty"===f)throw c("badname","module");g&&a.hasOwnProperty(f)&&(a[f]=null);return b(a,f,function(){function a(b,c,d,g){g||(g=e);return function(){g[d||"push"]([b,c,arguments]);return p}}function b(a,c,d){d||(d=e);return function(b,e){e&&E(e)&&(e.$$moduleName=f);d.push([a,c,arguments]);return p}}if(!g)throw d("nomod",f);var e=[],q=[],F=[],M=a("$injector","invoke","push",q),p={_invokeQueue:e,_configBlocks:q,
_runBlocks:F,info:function(a){if(t(a)){if(!G(a))throw c("aobj","value");h=a;return this}return h},requires:g,name:f,provider:b("$provide","provider"),factory:b("$provide","factory"),service:b("$provide","service"),value:a("$provide","value"),constant:a("$provide","constant","unshift"),decorator:b("$provide","decorator",q),animation:b("$animateProvider","register"),filter:b("$filterProvider","register"),controller:b("$controllerProvider","register"),directive:b("$compileProvider","directive"),component:b("$compileProvider",
"component"),config:M,run:function(a){F.push(a);return this}};k&&M(k);return p})}})}function ra(a,b){if(I(a)){b=b||[];for(var d=0,c=a.length;d<c;d++)b[d]=a[d]}else if(G(a))for(d in b=b||{},a)if("$"!==d.charAt(0)||"$"!==d.charAt(1))b[d]=a[d];return b||a}function Ee(a,b){var d=[];Tb(b)&&(a=fa.copy(a,null,b));return JSON.stringify(a,function(a,b){b=Pc(a,b);if(G(b)){if(0<=d.indexOf(b))return"...";d.push(b)}return b})}function Fe(a){O(a,{errorHandlingConfig:pe,bootstrap:Uc,copy:Ia,extend:O,merge:re,equals:sa,
element:z,forEach:p,injector:gb,noop:B,bind:Qa,toJson:eb,fromJson:Qc,identity:ab,isUndefined:v,isDefined:t,isString:C,isFunction:E,isObject:G,isNumber:W,isElement:Wb,isArray:I,version:Ge,isDate:ia,lowercase:N,uppercase:wb,callbacks:{$$counter:0},getTestability:Ae,reloadWithDebugInfo:ze,$$minErr:K,$$csp:Ja,$$encodeUriSegment:fb,$$encodeUriQuery:ma,$$stringify:cc});dc=De(x);dc("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:He});a.provider("$compile",Yc).directive({a:Ie,input:Zc,
textarea:Zc,form:Je,script:Ke,select:Le,option:Me,ngBind:Ne,ngBindHtml:Oe,ngBindTemplate:Pe,ngClass:Qe,ngClassEven:Re,ngClassOdd:Se,ngCloak:Te,ngController:Ue,ngForm:Ve,ngHide:We,ngIf:Xe,ngInclude:Ye,ngInit:Ze,ngNonBindable:$e,ngPluralize:af,ngRepeat:bf,ngShow:cf,ngStyle:df,ngSwitch:ef,ngSwitchWhen:ff,ngSwitchDefault:gf,ngOptions:hf,ngTransclude:jf,ngModel:kf,ngList:lf,ngChange:mf,pattern:$c,ngPattern:$c,required:ad,ngRequired:ad,minlength:bd,ngMinlength:bd,maxlength:cd,ngMaxlength:cd,ngValue:nf,
ngModelOptions:of}).directive({ngInclude:pf}).directive(xb).directive(dd);a.provider({$anchorScroll:qf,$animate:rf,$animateCss:sf,$$animateJs:tf,$$animateQueue:uf,$$AnimateRunner:vf,$$animateAsyncRun:wf,$browser:xf,$cacheFactory:yf,$controller:zf,$document:Af,$$isDocumentHidden:Bf,$exceptionHandler:Cf,$filter:ed,$$forceReflow:Df,$interpolate:Ef,$interval:Ff,$http:Gf,$httpParamSerializer:Hf,$httpParamSerializerJQLike:If,$httpBackend:Jf,$xhrFactory:Kf,$jsonpCallbacks:Lf,$location:Mf,$log:Nf,$parse:Of,
$rootScope:Pf,$q:Qf,$$q:Rf,$sce:Sf,$sceDelegate:Tf,$sniffer:Uf,$templateCache:Vf,$templateRequest:Wf,$$testability:Xf,$timeout:Yf,$window:Zf,$$rAF:$f,$$jqLite:ag,$$Map:bg,$$cookieReader:cg})}]).info({angularVersion:"1.6.5"})}function ib(a,b){return b.toUpperCase()}function yb(a){return a.replace(dg,ib)}function ec(a){a=a.nodeType;return 1===a||!a||9===a}function fd(a,b){var d,c,e=b.createDocumentFragment(),f=[];if(fc.test(a)){d=e.appendChild(b.createElement("div"));c=(eg.exec(a)||["",""])[1].toLowerCase();
c=pa[c]||pa._default;d.innerHTML=c[1]+a.replace(fg,"<$1></$2>")+c[2];for(c=c[0];c--;)d=d.lastChild;f=db(f,d.childNodes);d=e.firstChild;d.textContent=""}else f.push(b.createTextNode(a));e.textContent="";e.innerHTML="";p(f,function(a){e.appendChild(a)});return e}function S(a){if(a instanceof S)return a;var b;C(a)&&(a=P(a),b=!0);if(!(this instanceof S)){if(b&&"<"!==a.charAt(0))throw gc("nosel");return new S(a)}if(b){b=x.document;var d;a=(d=gg.exec(a))?[b.createElement(d[1])]:(d=fd(a,b))?d.childNodes:
[];hc(this,a)}else E(a)?gd(a):hc(this,a)}function ic(a){return a.cloneNode(!0)}function zb(a,b){!b&&ec(a)&&z.cleanData([a]);a.querySelectorAll&&z.cleanData(a.querySelectorAll("*"))}function hd(a,b,d,c){if(t(c))throw gc("offargs");var e=(c=Ab(a))&&c.events,f=c&&c.handle;if(f)if(b){var g=function(b){var c=e[b];t(d)&&cb(c||[],d);t(d)&&c&&0<c.length||(a.removeEventListener(b,f),delete e[b])};p(b.split(" "),function(a){g(a);Bb[a]&&g(Bb[a])})}else for(b in e)"$destroy"!==b&&a.removeEventListener(b,f),delete e[b]}
function jc(a,b){var d=a.ng339,c=d&&jb[d];c&&(b?delete c.data[b]:(c.handle&&(c.events.$destroy&&c.handle({},"$destroy"),hd(a)),delete jb[d],a.ng339=void 0))}function Ab(a,b){var d=a.ng339,d=d&&jb[d];b&&!d&&(a.ng339=d=++hg,d=jb[d]={events:{},data:{},handle:void 0});return d}function kc(a,b,d){if(ec(a)){var c,e=t(d),f=!e&&b&&!G(b),g=!b;a=(a=Ab(a,!f))&&a.data;if(e)a[yb(b)]=d;else{if(g)return a;if(f)return a&&a[yb(b)];for(c in b)a[yb(c)]=b[c]}}}function Cb(a,b){return a.getAttribute?-1<(" "+(a.getAttribute("class")||
"")+" ").replace(/[\n\t]/g," ").indexOf(" "+b+" "):!1}function Db(a,b){b&&a.setAttribute&&p(b.split(" "),function(b){a.setAttribute("class",P((" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+P(b)+" "," ")))})}function Eb(a,b){if(b&&a.setAttribute){var d=(" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");p(b.split(" "),function(a){a=P(a);-1===d.indexOf(" "+a+" ")&&(d+=a+" ")});a.setAttribute("class",P(d))}}function hc(a,b){if(b)if(b.nodeType)a[a.length++]=b;else{var d=
b.length;if("number"===typeof d&&b.window!==b){if(d)for(var c=0;c<d;c++)a[a.length++]=b[c]}else a[a.length++]=b}}function id(a,b){return Fb(a,"$"+(b||"ngController")+"Controller")}function Fb(a,b,d){9===a.nodeType&&(a=a.documentElement);for(b=I(b)?b:[b];a;){for(var c=0,e=b.length;c<e;c++)if(t(d=z.data(a,b[c])))return d;a=a.parentNode||11===a.nodeType&&a.host}}function jd(a){for(zb(a,!0);a.firstChild;)a.removeChild(a.firstChild)}function Gb(a,b){b||zb(a);var d=a.parentNode;d&&d.removeChild(a)}function ig(a,
b){b=b||x;if("complete"===b.document.readyState)b.setTimeout(a);else z(b).on("load",a)}function gd(a){function b(){x.document.removeEventListener("DOMContentLoaded",b);x.removeEventListener("load",b);a()}"complete"===x.document.readyState?x.setTimeout(a):(x.document.addEventListener("DOMContentLoaded",b),x.addEventListener("load",b))}function kd(a,b){var d=Hb[b.toLowerCase()];return d&&ld[ya(a)]&&d}function jg(a,b){var d=function(c,d){c.isDefaultPrevented=function(){return c.defaultPrevented};var f=
b[d||c.type],g=f?f.length:0;if(g){if(v(c.immediatePropagationStopped)){var k=c.stopImmediatePropagation;c.stopImmediatePropagation=function(){c.immediatePropagationStopped=!0;c.stopPropagation&&c.stopPropagation();k&&k.call(c)}}c.isImmediatePropagationStopped=function(){return!0===c.immediatePropagationStopped};var h=f.specialHandlerWrapper||kg;1<g&&(f=ra(f));for(var l=0;l<g;l++)c.isImmediatePropagationStopped()||h(a,c,f[l])}};d.elem=a;return d}function kg(a,b,d){d.call(a,b)}function lg(a,b,d){var c=
b.relatedTarget;c&&(c===a||mg.call(a,c))||d.call(a,b)}function ag(){this.$get=function(){return O(S,{hasClass:function(a,b){a.attr&&(a=a[0]);return Cb(a,b)},addClass:function(a,b){a.attr&&(a=a[0]);return Eb(a,b)},removeClass:function(a,b){a.attr&&(a=a[0]);return Db(a,b)}})}}function Sa(a,b){var d=a&&a.$$hashKey;if(d)return"function"===typeof d&&(d=a.$$hashKey()),d;d=typeof a;return d="function"===d||"object"===d&&null!==a?a.$$hashKey=d+":"+(b||qe)():d+":"+a}function md(){this._keys=[];this._values=
[];this._lastKey=NaN;this._lastIndex=-1}function nd(a){a=Function.prototype.toString.call(a).replace(ng,"");return a.match(og)||a.match(pg)}function qg(a){return(a=nd(a))?"function("+(a[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function gb(a,b){function d(a){return function(b,c){if(G(b))p(b,Ub(a));else return a(b,c)}}function c(a,b){Oa(a,"service");if(E(b)||I(b))b=q.instantiate(b);if(!b.$get)throw Ka("pget",a);return n[a+"Provider"]=b}function e(a,b){return function(){var c=w.invoke(b,this);if(v(c))throw Ka("undef",
a);return c}}function f(a,b,d){return c(a,{$get:!1!==d?e(a,b):b})}function g(a){hb(v(a)||I(a),"modulesToLoad","not an array");var b=[],c;p(a,function(a){function d(a){var b,c;b=0;for(c=a.length;b<c;b++){var e=a[b],g=q.get(e[0]);g[e[1]].apply(g,e[2])}}if(!m.get(a)){m.set(a,!0);try{C(a)?(c=dc(a),w.modules[a]=c,b=b.concat(g(c.requires)).concat(c._runBlocks),d(c._invokeQueue),d(c._configBlocks)):E(a)?b.push(q.invoke(a)):I(a)?b.push(q.invoke(a)):ub(a,"module")}catch(e){throw I(a)&&(a=a[a.length-1]),e.message&&
e.stack&&-1===e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),Ka("modulerr",a,e.stack||e.message||e);}}});return b}function k(a,c){function d(b,e){if(a.hasOwnProperty(b)){if(a[b]===h)throw Ka("cdep",b+" <- "+l.join(" <- "));return a[b]}try{return l.unshift(b),a[b]=h,a[b]=c(b,e),a[b]}catch(g){throw a[b]===h&&delete a[b],g;}finally{l.shift()}}function e(a,c,g){var f=[];a=gb.$$annotate(a,b,g);for(var h=0,k=a.length;h<k;h++){var l=a[h];if("string"!==typeof l)throw Ka("itkn",l);f.push(c&&c.hasOwnProperty(l)?
c[l]:d(l,g))}return f}return{invoke:function(a,b,c,d){"string"===typeof c&&(d=c,c=null);c=e(a,c,d);I(a)&&(a=a[a.length-1]);d=a;if(Ba||"function"!==typeof d)d=!1;else{var g=d.$$ngIsClass;La(g)||(g=d.$$ngIsClass=/^(?:class\b|constructor\()/.test(Function.prototype.toString.call(d)));d=g}return d?(c.unshift(null),new (Function.prototype.bind.apply(a,c))):a.apply(b,c)},instantiate:function(a,b,c){var d=I(a)?a[a.length-1]:a;a=e(a,b,c);a.unshift(null);return new (Function.prototype.bind.apply(d,a))},get:d,
annotate:gb.$$annotate,has:function(b){return n.hasOwnProperty(b+"Provider")||a.hasOwnProperty(b)}}}b=!0===b;var h={},l=[],m=new Ib,n={$provide:{provider:d(c),factory:d(f),service:d(function(a,b){return f(a,["$injector",function(a){return a.instantiate(b)}])}),value:d(function(a,b){return f(a,aa(b),!1)}),constant:d(function(a,b){Oa(a,"constant");n[a]=b;F[a]=b}),decorator:function(a,b){var c=q.get(a+"Provider"),d=c.$get;c.$get=function(){var a=w.invoke(d,c);return w.invoke(b,null,{$delegate:a})}}}},
q=n.$injector=k(n,function(a,b){fa.isString(b)&&l.push(b);throw Ka("unpr",l.join(" <- "));}),F={},M=k(F,function(a,b){var c=q.get(a+"Provider",b);return w.invoke(c.$get,c,void 0,a)}),w=M;n.$injectorProvider={$get:aa(M)};w.modules=q.modules=R();var u=g(a),w=M.get("$injector");w.strictDi=b;p(u,function(a){a&&w.invoke(a)});return w}function qf(){var a=!0;this.disableAutoScrolling=function(){a=!1};this.$get=["$window","$location","$rootScope",function(b,d,c){function e(a){var b=null;Array.prototype.some.call(a,
function(a){if("a"===ya(a))return b=a,!0});return b}function f(a){if(a){a.scrollIntoView();var c;c=g.yOffset;E(c)?c=c():Wb(c)?(c=c[0],c="fixed"!==b.getComputedStyle(c).position?0:c.getBoundingClientRect().bottom):W(c)||(c=0);c&&(a=a.getBoundingClientRect().top,b.scrollBy(0,a-c))}else b.scrollTo(0,0)}function g(a){a=C(a)?a:W(a)?a.toString():d.hash();var b;a?(b=k.getElementById(a))?f(b):(b=e(k.getElementsByName(a)))?f(b):"top"===a&&f(null):f(null)}var k=b.document;a&&c.$watch(function(){return d.hash()},
function(a,b){a===b&&""===a||ig(function(){c.$evalAsync(g)})});return g}]}function kb(a,b){if(!a&&!b)return"";if(!a)return b;if(!b)return a;I(a)&&(a=a.join(" "));I(b)&&(b=b.join(" "));return a+" "+b}function rg(a){C(a)&&(a=a.split(" "));var b=R();p(a,function(a){a.length&&(b[a]=!0)});return b}function Ca(a){return G(a)?a:{}}function sg(a,b,d,c){function e(a){try{a.apply(null,xa.call(arguments,1))}finally{if(M--,0===M)for(;w.length;)try{w.pop()()}catch(b){d.error(b)}}}function f(){y=null;k()}function g(){u=
D();u=v(u)?null:u;sa(u,L)&&(u=L);A=L=u}function k(){var a=A;g();if(na!==h.url()||a!==u)na=h.url(),A=u,p(H,function(a){a(h.url(),u)})}var h=this,l=a.location,m=a.history,n=a.setTimeout,q=a.clearTimeout,F={};h.isMock=!1;var M=0,w=[];h.$$completeOutstandingRequest=e;h.$$incOutstandingRequestCount=function(){M++};h.notifyWhenNoOutstandingRequests=function(a){0===M?a():w.push(a)};var u,A,na=l.href,s=b.find("base"),y=null,D=c.history?function(){try{return m.state}catch(a){}}:B;g();h.url=function(b,d,e){v(e)&&
(e=null);l!==a.location&&(l=a.location);m!==a.history&&(m=a.history);if(b){var f=A===e;if(na===b&&(!c.history||f))return h;var k=na&&ja(na)===ja(b);na=b;A=e;!c.history||k&&f?(k||(y=b),d?l.replace(b):k?(d=l,e=b.indexOf("#"),e=-1===e?"":b.substr(e),d.hash=e):l.href=b,l.href!==b&&(y=b)):(m[d?"replaceState":"pushState"](e,"",b),g());y&&(y=b);return h}return y||l.href.replace(/%27/g,"'")};h.state=function(){return u};var H=[],Z=!1,L=null;h.onUrlChange=function(b){if(!Z){if(c.history)z(a).on("popstate",
f);z(a).on("hashchange",f);Z=!0}H.push(b);return b};h.$$applicationDestroyed=function(){z(a).off("hashchange popstate",f)};h.$$checkUrlChange=k;h.baseHref=function(){var a=s.attr("href");return a?a.replace(/^(https?:)?\/\/[^/]*/,""):""};h.defer=function(a,b){var c;M++;c=n(function(){delete F[c];e(a)},b||0);F[c]=!0;return c};h.defer.cancel=function(a){return F[a]?(delete F[a],q(a),e(B),!0):!1}}function xf(){this.$get=["$window","$log","$sniffer","$document",function(a,b,d,c){return new sg(a,c,b,d)}]}
function yf(){this.$get=function(){function a(a,c){function e(a){a!==n&&(q?q===a&&(q=a.n):q=a,f(a.n,a.p),f(a,n),n=a,n.n=null)}function f(a,b){a!==b&&(a&&(a.p=b),b&&(b.n=a))}if(a in b)throw K("$cacheFactory")("iid",a);var g=0,k=O({},c,{id:a}),h=R(),l=c&&c.capacity||Number.MAX_VALUE,m=R(),n=null,q=null;return b[a]={put:function(a,b){if(!v(b)){if(l<Number.MAX_VALUE){var c=m[a]||(m[a]={key:a});e(c)}a in h||g++;h[a]=b;g>l&&this.remove(q.key);return b}},get:function(a){if(l<Number.MAX_VALUE){var b=m[a];
if(!b)return;e(b)}return h[a]},remove:function(a){if(l<Number.MAX_VALUE){var b=m[a];if(!b)return;b===n&&(n=b.p);b===q&&(q=b.n);f(b.n,b.p);delete m[a]}a in h&&(delete h[a],g--)},removeAll:function(){h=R();g=0;m=R();n=q=null},destroy:function(){m=k=h=null;delete b[a]},info:function(){return O({},k,{size:g})}}}var b={};a.info=function(){var a={};p(b,function(b,e){a[e]=b.info()});return a};a.get=function(a){return b[a]};return a}}function Vf(){this.$get=["$cacheFactory",function(a){return a("templates")}]}
function Yc(a,b){function d(a,b,c){var d=/^\s*([@&<]|=(\*?))(\??)\s*([\w$]*)\s*$/,e=R();p(a,function(a,g){if(a in n)e[g]=n[a];else{var f=a.match(d);if(!f)throw ga("iscp",b,g,a,c?"controller bindings definition":"isolate scope definition");e[g]={mode:f[1][0],collection:"*"===f[2],optional:"?"===f[3],attrName:f[4]||g};f[4]&&(n[a]=e[g])}});return e}function c(a){var b=a.charAt(0);if(!b||b!==N(b))throw ga("baddir",a);if(a!==a.trim())throw ga("baddir",a);}function e(a){var b=a.require||a.controller&&a.name;
!I(b)&&G(b)&&p(b,function(a,c){var d=a.match(l);a.substring(d[0].length)||(b[c]=d[0]+c)});return b}var f={},g=/^\s*directive:\s*([\w-]+)\s+(.*)$/,k=/(([\w-]+)(?::([^;]+))?;?)/,h=ue("ngSrc,ngSrcset,src,srcset"),l=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,m=/^(on[a-z]+|formaction)$/,n=R();this.directive=function na(b,d){hb(b,"name");Oa(b,"directive");C(b)?(c(b),hb(d,"directiveFactory"),f.hasOwnProperty(b)||(f[b]=[],a.factory(b+"Directive",["$injector","$exceptionHandler",function(a,c){var d=[];p(f[b],function(g,
f){try{var h=a.invoke(g);E(h)?h={compile:aa(h)}:!h.compile&&h.link&&(h.compile=aa(h.link));h.priority=h.priority||0;h.index=f;h.name=h.name||b;h.require=e(h);var k=h,l=h.restrict;if(l&&(!C(l)||!/[EACM]/.test(l)))throw ga("badrestrict",l,b);k.restrict=l||"EA";h.$$moduleName=g.$$moduleName;d.push(h)}catch(m){c(m)}});return d}])),f[b].push(d)):p(b,Ub(na));return this};this.component=function s(a,b){function c(a){function e(b){return E(b)||I(b)?function(c,d){return a.invoke(b,this,{$element:c,$attrs:d})}:
b}var g=b.template||b.templateUrl?b.template:"",f={controller:d,controllerAs:tg(b.controller)||b.controllerAs||"$ctrl",template:e(g),templateUrl:e(b.templateUrl),transclude:b.transclude,scope:{},bindToController:b.bindings||{},restrict:"E",require:b.require};p(b,function(a,b){"$"===b.charAt(0)&&(f[b]=a)});return f}if(!C(a))return p(a,Ub(Qa(this,s))),this;var d=b.controller||function(){};p(b,function(a,b){"$"===b.charAt(0)&&(c[b]=a,E(d)&&(d[b]=a))});c.$inject=["$injector"];return this.directive(a,
c)};this.aHrefSanitizationWhitelist=function(a){return t(a)?(b.aHrefSanitizationWhitelist(a),this):b.aHrefSanitizationWhitelist()};this.imgSrcSanitizationWhitelist=function(a){return t(a)?(b.imgSrcSanitizationWhitelist(a),this):b.imgSrcSanitizationWhitelist()};var q=!0;this.debugInfoEnabled=function(a){return t(a)?(q=a,this):q};var F=!1;this.preAssignBindingsEnabled=function(a){return t(a)?(F=a,this):F};var M=10;this.onChangesTtl=function(a){return arguments.length?(M=a,this):M};var w=!0;this.commentDirectivesEnabled=
function(a){return arguments.length?(w=a,this):w};var u=!0;this.cssClassDirectivesEnabled=function(a){return arguments.length?(u=a,this):u};this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate","$$sanitizeUri",function(a,b,c,e,n,L,T,J,U,Y){function r(){try{if(!--Ca)throw ja=void 0,ga("infchng",M);T.$apply(function(){for(var a=[],b=0,c=ja.length;b<c;++b)try{ja[b]()}catch(d){a.push(d)}ja=void 0;if(a.length)throw a;})}finally{Ca++}}
function ca(a,b){if(b){var c=Object.keys(b),d,e,g;d=0;for(e=c.length;d<e;d++)g=c[d],this[g]=b[g]}else this.$attr={};this.$$element=a}function Ta(a,b,c){za.innerHTML="<span "+b+">";b=za.firstChild.attributes;var d=b[0];b.removeNamedItem(d.name);d.value=c;a.attributes.setNamedItem(d)}function Da(a,b){try{a.addClass(b)}catch(c){}}function da(a,b,c,d,e){a instanceof z||(a=z(a));var g=K(a,b,a,c,d,e);da.$$addScopeClass(a);var f=null;return function(b,c,d){if(!a)throw ga("multilink");hb(b,"scope");e&&e.needsNewScope&&
(b=b.$parent.$new());d=d||{};var h=d.parentBoundTranscludeFn,k=d.transcludeControllers;d=d.futureParentElement;h&&h.$$boundTransclude&&(h=h.$$boundTransclude);f||(f=(d=d&&d[0])?"foreignobject"!==ya(d)&&la.call(d).match(/SVG/)?"svg":"html":"html");d="html"!==f?z(ka(f,z("<div>").append(a).html())):c?Ra.clone.call(a):a;if(k)for(var l in k)d.data("$"+l+"Controller",k[l].instance);da.$$addScopeInfo(d,b);c&&c(d,b);g&&g(b,d,d,h);c||(a=g=null);return d}}function K(a,b,c,d,e,g){function f(a,c,d,e){var g,k,
l,m,q,n,D;if(H)for(D=Array(c.length),m=0;m<h.length;m+=3)g=h[m],D[g]=c[g];else D=c;m=0;for(q=h.length;m<q;)k=D[h[m++]],c=h[m++],g=h[m++],c?(c.scope?(l=a.$new(),da.$$addScopeInfo(z(k),l)):l=a,n=c.transcludeOnThisElement?V(a,c.transclude,e):!c.templateOnThisElement&&e?e:!e&&b?V(a,b):null,c(g,l,k,d,n)):g&&g(a,k.childNodes,void 0,e)}for(var h=[],k=I(a)||a instanceof z,l,m,q,n,H,D=0;D<a.length;D++){l=new ca;11===Ba&&lb(a,D,k);m=mc(a[D],[],l,0===D?d:void 0,e);(g=m.length?X(m,a[D],l,b,c,null,[],[],g):null)&&
g.scope&&da.$$addScopeClass(l.$$element);l=g&&g.terminal||!(q=a[D].childNodes)||!q.length?null:K(q,g?(g.transcludeOnThisElement||!g.templateOnThisElement)&&g.transclude:b);if(g||l)h.push(D,g,l),n=!0,H=H||g;g=null}return n?f:null}function lb(a,b,c){var d=a[b],e=d.parentNode,g;if(d.nodeType===Ma)for(;;){g=e?d.nextSibling:a[b+1];if(!g||g.nodeType!==Ma)break;d.nodeValue+=g.nodeValue;g.parentNode&&g.parentNode.removeChild(g);c&&g===a[b+1]&&a.splice(b+1,1)}}function V(a,b,c){function d(e,g,f,h,k){e||(e=
a.$new(!1,k),e.$$transcluded=!0);return b(e,g,{parentBoundTranscludeFn:c,transcludeControllers:f,futureParentElement:h})}var e=d.$$slots=R(),g;for(g in b.$$slots)e[g]=b.$$slots[g]?V(a,b.$$slots[g],c):null;return d}function mc(a,b,c,d,e){var g=c.$attr,f;switch(a.nodeType){case 1:f=ya(a);Q(b,Ea(f),"E",d,e);for(var h,l,m,q,n=a.attributes,H=0,D=n&&n.length;H<D;H++){var F=!1,u=!1;h=n[H];l=h.name;m=h.value;h=Ea(l);(q=Na.test(h))&&(l=l.replace(od,"").substr(8).replace(/_(.)/g,function(a,b){return b.toUpperCase()}));
(h=h.match(Oa))&&ba(h[1])&&(F=l,u=l.substr(0,l.length-5)+"end",l=l.substr(0,l.length-6));h=Ea(l.toLowerCase());g[h]=l;if(q||!c.hasOwnProperty(h))c[h]=m,kd(a,h)&&(c[h]=!0);va(a,b,m,h,q);Q(b,h,"A",d,e,F,u)}"input"===f&&"hidden"===a.getAttribute("type")&&a.setAttribute("autocomplete","off");if(!Ka)break;g=a.className;G(g)&&(g=g.animVal);if(C(g)&&""!==g)for(;a=k.exec(g);)h=Ea(a[2]),Q(b,h,"C",d,e)&&(c[h]=P(a[3])),g=g.substr(a.index+a[0].length);break;case Ma:pa(b,a.nodeValue);break;case 8:if(!Ja)break;
nc(a,b,c,d,e)}b.sort(ma);return b}function nc(a,b,c,d,e){try{var f=g.exec(a.nodeValue);if(f){var h=Ea(f[1]);Q(b,h,"M",d,e)&&(c[h]=P(f[2]))}}catch(k){}}function pd(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b)){do{if(!a)throw ga("uterdir",b,c);1===a.nodeType&&(a.hasAttribute(b)&&e++,a.hasAttribute(c)&&e--);d.push(a);a=a.nextSibling}while(0<e)}else d.push(a);return z(d)}function qd(a,b,c){return function(d,e,g,f,h){e=pd(e[0],b,c);return a(d,e,g,f,h)}}function S(a,b,c,d,e,g){var f;return a?
da(b,c,d,e,g):function(){f||(f=da(b,c,d,e,g),b=c=g=null);return f.apply(this,arguments)}}function X(a,b,d,e,g,f,h,k,l){function m(a,b,c,d){if(a){c&&(a=qd(a,c,d));a.require=s.require;a.directiveName=Y;if(L===s||s.$$isolateScope)a=ta(a,{isolateScope:!0});h.push(a)}if(b){c&&(b=qd(b,c,d));b.require=s.require;b.directiveName=Y;if(L===s||s.$$isolateScope)b=ta(b,{isolateScope:!0});k.push(b)}}function q(a,e,g,f,l){function m(a,b,c,d){var e;bb(a)||(d=c,c=b,b=a,a=void 0);U&&(e=T);c||(c=U?ha.parent():ha);if(d){var g=
l.$$slots[d];if(g)return g(a,b,e,c,t);if(v(g))throw ga("noslot",d,Aa(ha));}else return l(a,b,e,c,t)}var n,s,J,y,Z,T,w,ha;b===g?(f=d,ha=d.$$element):(ha=z(g),f=new ca(ha,d));Z=e;L?y=e.$new(!0):H&&(Z=e.$parent);l&&(w=m,w.$$boundTransclude=l,w.isSlotFilled=function(a){return!!l.$$slots[a]});u&&(T=ea(ha,f,w,u,y,e,L));L&&(da.$$addScopeInfo(ha,y,!0,!(M&&(M===L||M===L.$$originalDirective))),da.$$addScopeClass(ha,!0),y.$$isolateBindings=L.$$isolateBindings,s=qa(e,f,y,y.$$isolateBindings,L),s.removeWatches&&
y.$on("$destroy",s.removeWatches));for(n in T){s=u[n];J=T[n];var Y=s.$$bindings.bindToController;if(F){J.bindingInfo=Y?qa(Z,f,J.instance,Y,s):{};var r=J();r!==J.instance&&(J.instance=r,ha.data("$"+s.name+"Controller",r),J.bindingInfo.removeWatches&&J.bindingInfo.removeWatches(),J.bindingInfo=qa(Z,f,J.instance,Y,s))}else J.instance=J(),ha.data("$"+s.name+"Controller",J.instance),J.bindingInfo=qa(Z,f,J.instance,Y,s)}p(u,function(a,b){var c=a.require;a.bindToController&&!I(c)&&G(c)&&O(T[b].instance,
W(b,c,ha,T))});p(T,function(a){var b=a.instance;if(E(b.$onChanges))try{b.$onChanges(a.bindingInfo.initialChanges)}catch(d){c(d)}if(E(b.$onInit))try{b.$onInit()}catch(e){c(e)}E(b.$doCheck)&&(Z.$watch(function(){b.$doCheck()}),b.$doCheck());E(b.$onDestroy)&&Z.$on("$destroy",function(){b.$onDestroy()})});n=0;for(s=h.length;n<s;n++)J=h[n],ua(J,J.isolateScope?y:e,ha,f,J.require&&W(J.directiveName,J.require,ha,T),w);var t=e;L&&(L.template||null===L.templateUrl)&&(t=y);a&&a(t,g.childNodes,void 0,l);for(n=
k.length-1;0<=n;n--)J=k[n],ua(J,J.isolateScope?y:e,ha,f,J.require&&W(J.directiveName,J.require,ha,T),w);p(T,function(a){a=a.instance;E(a.$postLink)&&a.$postLink()})}l=l||{};for(var n=-Number.MAX_VALUE,H=l.newScopeDirective,u=l.controllerDirectives,L=l.newIsolateScopeDirective,M=l.templateDirective,J=l.nonTlbTranscludeDirective,Z=!1,T=!1,U=l.hasElementTranscludeDirective,y=d.$$element=z(b),s,Y,w,r=e,t,Pa=!1,Ta=!1,V,x=0,Da=a.length;x<Da;x++){s=a[x];var B=s.$$start,C=s.$$end;B&&(y=pd(b,B,C));w=void 0;
if(n>s.priority)break;if(V=s.scope)s.templateUrl||(G(V)?(aa("new/isolated scope",L||H,s,y),L=s):aa("new/isolated scope",L,s,y)),H=H||s;Y=s.name;if(!Pa&&(s.replace&&(s.templateUrl||s.template)||s.transclude&&!s.$$tlb)){for(V=x+1;Pa=a[V++];)if(Pa.transclude&&!Pa.$$tlb||Pa.replace&&(Pa.templateUrl||Pa.template)){Ta=!0;break}Pa=!0}!s.templateUrl&&s.controller&&(u=u||R(),aa("'"+Y+"' controller",u[Y],s,y),u[Y]=s);if(V=s.transclude)if(Z=!0,s.$$tlb||(aa("transclusion",J,s,y),J=s),"element"===V)U=!0,n=s.priority,
w=y,y=d.$$element=z(da.$$createComment(Y,d[Y])),b=y[0],oa(g,xa.call(w,0),b),w[0].$$parentNode=w[0].parentNode,r=S(Ta,w,e,n,f&&f.name,{nonTlbTranscludeDirective:J});else{var K=R();if(G(V)){w=[];var N=R(),lb=R();p(V,function(a,b){var c="?"===a.charAt(0);a=c?a.substring(1):a;N[a]=b;K[b]=null;lb[b]=c});p(y.contents(),function(a){var b=N[Ea(ya(a))];b?(lb[b]=!0,K[b]=K[b]||[],K[b].push(a)):w.push(a)});p(lb,function(a,b){if(!a)throw ga("reqslot",b);});for(var lc in K)K[lc]&&(K[lc]=S(Ta,K[lc],e))}else w=z(ic(b)).contents();
y.empty();r=S(Ta,w,e,void 0,void 0,{needsNewScope:s.$$isolateScope||s.$$newScope});r.$$slots=K}if(s.template)if(T=!0,aa("template",M,s,y),M=s,V=E(s.template)?s.template(y,d):s.template,V=Ha(V),s.replace){f=s;w=fc.test(V)?rd(ka(s.templateNamespace,P(V))):[];b=w[0];if(1!==w.length||1!==b.nodeType)throw ga("tplrt",Y,"");oa(g,y,b);Da={$attr:{}};V=mc(b,[],Da);var nc=a.splice(x+1,a.length-(x+1));(L||H)&&$(V,L,H);a=a.concat(V).concat(nc);fa(d,Da);Da=a.length}else y.html(V);if(s.templateUrl)T=!0,aa("template",
M,s,y),M=s,s.replace&&(f=s),q=ia(a.splice(x,a.length-x),y,d,g,Z&&r,h,k,{controllerDirectives:u,newScopeDirective:H!==s&&H,newIsolateScopeDirective:L,templateDirective:M,nonTlbTranscludeDirective:J}),Da=a.length;else if(s.compile)try{t=s.compile(y,d,r);var Q=s.$$originalDirective||s;E(t)?m(null,Qa(Q,t),B,C):t&&m(Qa(Q,t.pre),Qa(Q,t.post),B,C)}catch(ba){c(ba,Aa(y))}s.terminal&&(q.terminal=!0,n=Math.max(n,s.priority))}q.scope=H&&!0===H.scope;q.transcludeOnThisElement=Z;q.templateOnThisElement=T;q.transclude=
r;l.hasElementTranscludeDirective=U;return q}function W(a,b,c,d){var e;if(C(b)){var g=b.match(l);b=b.substring(g[0].length);var f=g[1]||g[3],g="?"===g[2];"^^"===f?c=c.parent():e=(e=d&&d[b])&&e.instance;if(!e){var h="$"+b+"Controller";e=f?c.inheritedData(h):c.data(h)}if(!e&&!g)throw ga("ctreq",b,a);}else if(I(b))for(e=[],f=0,g=b.length;f<g;f++)e[f]=W(a,b[f],c,d);else G(b)&&(e={},p(b,function(b,g){e[g]=W(a,b,c,d)}));return e||null}function ea(a,b,c,d,e,g,f){var h=R(),k;for(k in d){var l=d[k],m={$scope:l===
f||l.$$isolateScope?e:g,$element:a,$attrs:b,$transclude:c},n=l.controller;"@"===n&&(n=b[l.name]);m=L(n,m,!0,l.controllerAs);h[l.name]=m;a.data("$"+l.name+"Controller",m.instance)}return h}function $(a,b,c){for(var d=0,e=a.length;d<e;d++)a[d]=Xb(a[d],{$$isolateScope:b,$$newScope:c})}function Q(b,c,e,g,h,k,l){if(c===h)return null;var m=null;if(f.hasOwnProperty(c)){h=a.get(c+"Directive");for(var n=0,q=h.length;n<q;n++)if(c=h[n],(v(g)||g>c.priority)&&-1!==c.restrict.indexOf(e)){k&&(c=Xb(c,{$$start:k,
$$end:l}));if(!c.$$bindings){var H=m=c,D=c.name,F={isolateScope:null,bindToController:null};G(H.scope)&&(!0===H.bindToController?(F.bindToController=d(H.scope,D,!0),F.isolateScope={}):F.isolateScope=d(H.scope,D,!1));G(H.bindToController)&&(F.bindToController=d(H.bindToController,D,!0));if(F.bindToController&&!H.controller)throw ga("noctrl",D);m=m.$$bindings=F;G(m.isolateScope)&&(c.$$isolateBindings=m.isolateScope)}b.push(c);m=c}}return m}function ba(b){if(f.hasOwnProperty(b))for(var c=a.get(b+"Directive"),
d=0,e=c.length;d<e;d++)if(b=c[d],b.multiElement)return!0;return!1}function fa(a,b){var c=b.$attr,d=a.$attr;p(a,function(d,e){"$"!==e.charAt(0)&&(b[e]&&b[e]!==d&&(d=d.length?d+(("style"===e?";":" ")+b[e]):b[e]),a.$set(e,d,!0,c[e]))});p(b,function(b,e){a.hasOwnProperty(e)||"$"===e.charAt(0)||(a[e]=b,"class"!==e&&"style"!==e&&(d[e]=c[e]))})}function ia(a,b,d,g,f,h,k,l){var m=[],n,q,F=b[0],s=a.shift(),L=Xb(s,{templateUrl:null,transclude:null,replace:null,$$originalDirective:s}),J=E(s.templateUrl)?s.templateUrl(b,
d):s.templateUrl,u=s.templateNamespace;b.empty();e(J).then(function(c){var e,H;c=Ha(c);if(s.replace){c=fc.test(c)?rd(ka(u,P(c))):[];e=c[0];if(1!==c.length||1!==e.nodeType)throw ga("tplrt",s.name,J);c={$attr:{}};oa(g,b,e);var D=mc(e,[],c);G(s.scope)&&$(D,!0);a=D.concat(a);fa(d,c)}else e=F,b.html(c);a.unshift(L);n=X(a,e,d,f,b,s,h,k,l);p(g,function(a,c){a===e&&(g[c]=b[0])});for(q=K(b[0].childNodes,f);m.length;){c=m.shift();H=m.shift();var y=m.shift(),M=m.shift(),D=b[0];if(!c.$$destroyed){if(H!==F){var Z=
H.className;l.hasElementTranscludeDirective&&s.replace||(D=ic(e));oa(y,z(H),D);Da(z(D),Z)}H=n.transcludeOnThisElement?V(c,n.transclude,M):M;n(q,c,D,g,H)}}m=null}).catch(function(a){Zb(a)&&c(a)});return function(a,b,c,d,e){a=e;b.$$destroyed||(m?m.push(b,c,d,a):(n.transcludeOnThisElement&&(a=V(b,n.transclude,e)),n(q,b,c,d,a)))}}function ma(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function aa(a,b,c,d){function e(a){return a?" (module: "+a+")":
""}if(b)throw ga("multidir",b.name,e(b.$$moduleName),c.name,e(c.$$moduleName),a,Aa(d));}function pa(a,c){var d=b(c,!0);d&&a.push({priority:0,compile:function(a){a=a.parent();var b=!!a.length;b&&da.$$addBindingClass(a);return function(a,c){var e=c.parent();b||da.$$addBindingClass(e);da.$$addBindingInfo(e,d.expressions);a.$watch(d,function(a){c[0].nodeValue=a})}}})}function ka(a,b){a=N(a||"html");switch(a){case "svg":case "math":var c=x.document.createElement("div");c.innerHTML="<"+a+">"+b+"</"+a+">";
return c.childNodes[0].childNodes;default:return b}}function ra(a,b){if("srcdoc"===b)return J.HTML;var c=ya(a);if("src"===b||"ngSrc"===b){if(-1===["img","video","audio","source","track"].indexOf(c))return J.RESOURCE_URL}else if("xlinkHref"===b||"form"===c&&"action"===b||"link"===c&&"href"===b)return J.RESOURCE_URL}function va(a,c,d,e,g){var f=ra(a,e),k=h[e]||g,l=b(d,!g,f,k);if(l){if("multiple"===e&&"select"===ya(a))throw ga("selmulti",Aa(a));if(m.test(e))throw ga("nodomevents");c.push({priority:100,
compile:function(){return{pre:function(a,c,g){c=g.$$observers||(g.$$observers=R());var h=g[e];h!==d&&(l=h&&b(h,!0,f,k),d=h);l&&(g[e]=l(a),(c[e]||(c[e]=[])).$$inter=!0,(g.$$observers&&g.$$observers[e].$$scope||a).$watch(l,function(a,b){"class"===e&&a!==b?g.$updateClass(a,b):g.$set(e,a)}))}}}})}}function oa(a,b,c){var d=b[0],e=b.length,g=d.parentNode,f,h;if(a)for(f=0,h=a.length;f<h;f++)if(a[f]===d){a[f++]=c;h=f+e-1;for(var k=a.length;f<k;f++,h++)h<k?a[f]=a[h]:delete a[f];a.length-=e-1;a.context===d&&
(a.context=c);break}g&&g.replaceChild(c,d);a=x.document.createDocumentFragment();for(f=0;f<e;f++)a.appendChild(b[f]);z.hasData(d)&&(z.data(c,z.data(d)),z(d).off("$destroy"));z.cleanData(a.querySelectorAll("*"));for(f=1;f<e;f++)delete b[f];b[0]=c;b.length=1}function ta(a,b){return O(function(){return a.apply(null,arguments)},a,b)}function ua(a,b,d,e,g,f){try{a(b,d,e,g,f)}catch(h){c(h,Aa(d))}}function qa(a,c,d,e,g){function f(b,c,e){E(d.$onChanges)&&!$b(c,e)&&(ja||(a.$$postDigest(r),ja=[]),m||(m={},
ja.push(h)),m[b]&&(e=m[b].previousValue),m[b]=new Jb(e,c))}function h(){d.$onChanges(m);m=void 0}var k=[],l={},m;p(e,function(e,h){var m=e.attrName,q=e.optional,H,D,F,s;switch(e.mode){case "@":q||wa.call(c,m)||(d[h]=c[m]=void 0);q=c.$observe(m,function(a){if(C(a)||La(a))f(h,a,d[h]),d[h]=a});c.$$observers[m].$$scope=a;H=c[m];C(H)?d[h]=b(H)(a):La(H)&&(d[h]=H);l[h]=new Jb(oc,d[h]);k.push(q);break;case "=":if(!wa.call(c,m)){if(q)break;c[m]=void 0}if(q&&!c[m])break;D=n(c[m]);s=D.literal?sa:$b;F=D.assign||
function(){H=d[h]=D(a);throw ga("nonassign",c[m],m,g.name);};H=d[h]=D(a);q=function(b){s(b,d[h])||(s(b,H)?F(a,b=d[h]):d[h]=b);return H=b};q.$stateful=!0;q=e.collection?a.$watchCollection(c[m],q):a.$watch(n(c[m],q),null,D.literal);k.push(q);break;case "<":if(!wa.call(c,m)){if(q)break;c[m]=void 0}if(q&&!c[m])break;D=n(c[m]);var L=D.literal,J=d[h]=D(a);l[h]=new Jb(oc,d[h]);q=a.$watch(D,function(a,b){if(b===a){if(b===J||L&&sa(b,J))return;b=J}f(h,a,b);d[h]=a},L);k.push(q);break;case "&":D=c.hasOwnProperty(m)?
n(c[m]):B;if(D===B&&q)break;d[h]=function(b){return D(a,b)}}});return{initialChanges:l,removeWatches:k.length&&function(){for(var a=0,b=k.length;a<b;++a)k[a]()}}}var Ia=/^\w/,za=x.document.createElement("div"),Ja=w,Ka=u,Ca=M,ja;ca.prototype={$normalize:Ea,$addClass:function(a){a&&0<a.length&&U.addClass(this.$$element,a)},$removeClass:function(a){a&&0<a.length&&U.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=sd(a,b);c&&c.length&&U.addClass(this.$$element,c);(c=sd(b,a))&&c.length&&
U.removeClass(this.$$element,c)},$set:function(a,b,d,e){var g=kd(this.$$element[0],a),f=td[a],h=a;g?(this.$$element.prop(a,b),e=g):f&&(this[f]=b,h=f);this[a]=b;e?this.$attr[a]=e:(e=this.$attr[a])||(this.$attr[a]=e=Vc(a,"-"));g=ya(this.$$element);if("a"===g&&("href"===a||"xlinkHref"===a)||"img"===g&&"src"===a)this[a]=b=Y(b,"src"===a);else if("img"===g&&"srcset"===a&&t(b)){for(var g="",f=P(b),k=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,k=/\s/.test(f)?k:/(,)/,f=f.split(k),k=Math.floor(f.length/2),l=0;l<
k;l++)var m=2*l,g=g+Y(P(f[m]),!0),g=g+(" "+P(f[m+1]));f=P(f[2*l]).split(/\s/);g+=Y(P(f[0]),!0);2===f.length&&(g+=" "+P(f[1]));this[a]=b=g}!1!==d&&(null===b||v(b)?this.$$element.removeAttr(e):Ia.test(e)?this.$$element.attr(e,b):Ta(this.$$element[0],e,b));(a=this.$$observers)&&p(a[h],function(a){try{a(b)}catch(d){c(d)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers=R()),e=d[a]||(d[a]=[]);e.push(b);T.$evalAsync(function(){e.$$inter||!c.hasOwnProperty(a)||v(c[a])||b(c[a])});return function(){cb(e,
b)}}};var Fa=b.startSymbol(),Ga=b.endSymbol(),Ha="{{"===Fa&&"}}"===Ga?ab:function(a){return a.replace(/\{\{/g,Fa).replace(/}}/g,Ga)},Na=/^ngAttr[A-Z]/,Oa=/^(.+)Start$/;da.$$addBindingInfo=q?function(a,b){var c=a.data("$binding")||[];I(b)?c=c.concat(b):c.push(b);a.data("$binding",c)}:B;da.$$addBindingClass=q?function(a){Da(a,"ng-binding")}:B;da.$$addScopeInfo=q?function(a,b,c,d){a.data(c?d?"$isolateScopeNoTemplate":"$isolateScope":"$scope",b)}:B;da.$$addScopeClass=q?function(a,b){Da(a,b?"ng-isolate-scope":
"ng-scope")}:B;da.$$createComment=function(a,b){var c="";q&&(c=" "+(a||"")+": ",b&&(c+=b+" "));return x.document.createComment(c)};return da}]}function Jb(a,b){this.previousValue=a;this.currentValue=b}function Ea(a){return a.replace(od,"").replace(ug,ib)}function sd(a,b){var d="",c=a.split(/\s+/),e=b.split(/\s+/),f=0;a:for(;f<c.length;f++){for(var g=c[f],k=0;k<e.length;k++)if(g===e[k])continue a;d+=(0<d.length?" ":"")+g}return d}function rd(a){a=z(a);var b=a.length;if(1>=b)return a;for(;b--;){var d=
a[b];(8===d.nodeType||d.nodeType===Ma&&""===d.nodeValue.trim())&&vg.call(a,b,1)}return a}function tg(a,b){if(b&&C(b))return b;if(C(a)){var d=ud.exec(a);if(d)return d[3]}}function zf(){var a={},b=!1;this.has=function(b){return a.hasOwnProperty(b)};this.register=function(b,c){Oa(b,"controller");G(b)?O(a,b):a[b]=c};this.allowGlobals=function(){b=!0};this.$get=["$injector","$window",function(d,c){function e(a,b,c,d){if(!a||!G(a.$scope))throw K("$controller")("noscp",d,b);a.$scope[b]=c}return function(f,
g,k,h){var l,m,n;k=!0===k;h&&C(h)&&(n=h);if(C(f)){h=f.match(ud);if(!h)throw vd("ctrlfmt",f);m=h[1];n=n||h[3];f=a.hasOwnProperty(m)?a[m]:Xc(g.$scope,m,!0)||(b?Xc(c,m,!0):void 0);if(!f)throw vd("ctrlreg",m);ub(f,m,!0)}if(k)return k=(I(f)?f[f.length-1]:f).prototype,l=Object.create(k||null),n&&e(g,n,l,m||f.name),O(function(){var a=d.invoke(f,l,g,m);a!==l&&(G(a)||E(a))&&(l=a,n&&e(g,n,l,m||f.name));return l},{instance:l,identifier:n});l=d.instantiate(f,g,m);n&&e(g,n,l,m||f.name);return l}}]}function Af(){this.$get=
["$window",function(a){return z(a.document)}]}function Bf(){this.$get=["$document","$rootScope",function(a,b){function d(){e=c.hidden}var c=a[0],e=c&&c.hidden;a.on("visibilitychange",d);b.$on("$destroy",function(){a.off("visibilitychange",d)});return function(){return e}}]}function Cf(){this.$get=["$log",function(a){return function(b,d){a.error.apply(a,arguments)}}]}function pc(a){return G(a)?ia(a)?a.toISOString():eb(a):a}function Hf(){this.$get=function(){return function(a){if(!a)return"";var b=
[];Nc(a,function(a,c){null===a||v(a)||(I(a)?p(a,function(a){b.push(ma(c)+"="+ma(pc(a)))}):b.push(ma(c)+"="+ma(pc(a))))});return b.join("&")}}}function If(){this.$get=function(){return function(a){function b(a,e,f){null===a||v(a)||(I(a)?p(a,function(a,c){b(a,e+"["+(G(a)?c:"")+"]")}):G(a)&&!ia(a)?Nc(a,function(a,c){b(a,e+(f?"":"[")+c+(f?"":"]"))}):d.push(ma(e)+"="+ma(pc(a))))}if(!a)return"";var d=[];b(a,"",!0);return d.join("&")}}}function qc(a,b){if(C(a)){var d=a.replace(wg,"").trim();if(d){var c=
b("Content-Type");(c=c&&0===c.indexOf(wd))||(c=(c=d.match(xg))&&yg[c[0]].test(d));if(c)try{a=Qc(d)}catch(e){throw rc("baddata",a,e);}}}return a}function xd(a){var b=R(),d;C(a)?p(a.split("\n"),function(a){d=a.indexOf(":");var e=N(P(a.substr(0,d)));a=P(a.substr(d+1));e&&(b[e]=b[e]?b[e]+", "+a:a)}):G(a)&&p(a,function(a,d){var f=N(d),g=P(a);f&&(b[f]=b[f]?b[f]+", "+g:g)});return b}function yd(a){var b;return function(d){b||(b=xd(a));return d?(d=b[N(d)],void 0===d&&(d=null),d):b}}function zd(a,b,d,c){if(E(c))return c(a,
b,d);p(c,function(c){a=c(a,b,d)});return a}function Gf(){var a=this.defaults={transformResponse:[qc],transformRequest:[function(a){return G(a)&&"[object File]"!==la.call(a)&&"[object Blob]"!==la.call(a)&&"[object FormData]"!==la.call(a)?eb(a):a}],headers:{common:{Accept:"application/json, text/plain, */*"},post:ra(sc),put:ra(sc),patch:ra(sc)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer",jsonpCallbackParam:"callback"},b=!1;this.useApplyAsync=function(a){return t(a)?
(b=!!a,this):b};var d=this.interceptors=[];this.$get=["$browser","$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector","$sce",function(c,e,f,g,k,h,l,m){function n(b){function d(a,b){for(var c=0,e=b.length;c<e;){var g=b[c++],f=b[c++];a=a.then(g,f)}b.length=0;return a}function e(a,b){var c,d={};p(a,function(a,e){E(a)?(c=a(b),null!=c&&(d[e]=c)):d[e]=a});return d}function g(a){var b=O({},a);b.data=zd(a.data,a.headers,a.status,f.transformResponse);a=a.status;return 200<=a&&300>
a?b:h.reject(b)}if(!G(b))throw K("$http")("badreq",b);if(!C(m.valueOf(b.url)))throw K("$http")("badreq",b.url);var f=O({method:"get",transformRequest:a.transformRequest,transformResponse:a.transformResponse,paramSerializer:a.paramSerializer,jsonpCallbackParam:a.jsonpCallbackParam},b);f.headers=function(b){var c=a.headers,d=O({},b.headers),g,f,h,c=O({},c.common,c[N(b.method)]);a:for(g in c){f=N(g);for(h in d)if(N(h)===f)continue a;d[g]=c[g]}return e(d,ra(b))}(b);f.method=wb(f.method);f.paramSerializer=
C(f.paramSerializer)?l.get(f.paramSerializer):f.paramSerializer;c.$$incOutstandingRequestCount();var k=[],n=[];b=h.resolve(f);p(u,function(a){(a.request||a.requestError)&&k.unshift(a.request,a.requestError);(a.response||a.responseError)&&n.push(a.response,a.responseError)});b=d(b,k);b=b.then(function(b){var c=b.headers,d=zd(b.data,yd(c),void 0,b.transformRequest);v(d)&&p(c,function(a,b){"content-type"===N(b)&&delete c[b]});v(b.withCredentials)&&!v(a.withCredentials)&&(b.withCredentials=a.withCredentials);
return q(b,d).then(g,g)});b=d(b,n);return b=b.finally(function(){c.$$completeOutstandingRequest(B)})}function q(c,d){function g(a){if(a){var c={};p(a,function(a,d){c[d]=function(c){function d(){a(c)}b?k.$applyAsync(d):k.$$phase?d():k.$apply(d)}});return c}}function l(a,c,d,e){function g(){q(c,a,d,e)}J&&(200<=a&&300>a?J.put(ca,[a,c,xd(d),e]):J.remove(ca));b?k.$applyAsync(g):(g(),k.$$phase||k.$apply())}function q(a,b,d,e){b=-1<=b?b:0;(200<=b&&300>b?L.resolve:L.reject)({data:a,status:b,headers:yd(d),
config:c,statusText:e})}function H(a){q(a.data,a.status,ra(a.headers()),a.statusText)}function u(){var a=n.pendingRequests.indexOf(c);-1!==a&&n.pendingRequests.splice(a,1)}var L=h.defer(),T=L.promise,J,U,Y=c.headers,r="jsonp"===N(c.method),ca=c.url;r?ca=m.getTrustedResourceUrl(ca):C(ca)||(ca=m.valueOf(ca));ca=F(ca,c.paramSerializer(c.params));r&&(ca=M(ca,c.jsonpCallbackParam));n.pendingRequests.push(c);T.then(u,u);!c.cache&&!a.cache||!1===c.cache||"GET"!==c.method&&"JSONP"!==c.method||(J=G(c.cache)?
c.cache:G(a.cache)?a.cache:w);J&&(U=J.get(ca),t(U)?U&&E(U.then)?U.then(H,H):I(U)?q(U[1],U[0],ra(U[2]),U[3]):q(U,200,{},"OK"):J.put(ca,T));v(U)&&((U=Ad(c.url)?f()[c.xsrfCookieName||a.xsrfCookieName]:void 0)&&(Y[c.xsrfHeaderName||a.xsrfHeaderName]=U),e(c.method,ca,d,l,Y,c.timeout,c.withCredentials,c.responseType,g(c.eventHandlers),g(c.uploadEventHandlers)));return T}function F(a,b){0<b.length&&(a+=(-1===a.indexOf("?")?"?":"&")+b);return a}function M(a,b){if(/[&?][^=]+=JSON_CALLBACK/.test(a))throw rc("badjsonp",
a);if((new RegExp("[&?]"+b+"=")).test(a))throw rc("badjsonp",b,a);return a+=(-1===a.indexOf("?")?"?":"&")+b+"=JSON_CALLBACK"}var w=g("$http");a.paramSerializer=C(a.paramSerializer)?l.get(a.paramSerializer):a.paramSerializer;var u=[];p(d,function(a){u.unshift(C(a)?l.get(a):l.invoke(a))});n.pendingRequests=[];(function(a){p(arguments,function(a){n[a]=function(b,c){return n(O({},c||{},{method:a,url:b}))}})})("get","delete","head","jsonp");(function(a){p(arguments,function(a){n[a]=function(b,c,d){return n(O({},
d||{},{method:a,url:b,data:c}))}})})("post","put","patch");n.defaults=a;return n}]}function Kf(){this.$get=function(){return function(){return new x.XMLHttpRequest}}}function Jf(){this.$get=["$browser","$jsonpCallbacks","$document","$xhrFactory",function(a,b,d,c){return zg(a,c,a.defer,b,d[0])}]}function zg(a,b,d,c,e){function f(a,b,d){a=a.replace("JSON_CALLBACK",b);var f=e.createElement("script"),m=null;f.type="text/javascript";f.src=a;f.async=!0;m=function(a){f.removeEventListener("load",m);f.removeEventListener("error",
m);e.body.removeChild(f);f=null;var g=-1,F="unknown";a&&("load"!==a.type||c.wasCalled(b)||(a={type:"error"}),F=a.type,g="error"===a.type?404:200);d&&d(g,F)};f.addEventListener("load",m);f.addEventListener("error",m);e.body.appendChild(f);return m}return function(e,k,h,l,m,n,q,F,M,w){function u(){na&&na();s&&s.abort()}k=k||a.url();if("jsonp"===N(e))var A=c.createCallback(k),na=f(k,A,function(a,b){var e=200===a&&c.getResponse(A);t(D)&&d.cancel(D);na=s=null;l(a,e,"",b);c.removeCallback(A)});else{var s=
b(e,k);s.open(e,k,!0);p(m,function(a,b){t(a)&&s.setRequestHeader(b,a)});s.onload=function(){var a=s.statusText||"",b="response"in s?s.response:s.responseText,c=1223===s.status?204:s.status;0===c&&(c=b?200:"file"===ua(k).protocol?404:0);var e=s.getAllResponseHeaders();t(D)&&d.cancel(D);na=s=null;l(c,b,e,a)};e=function(){t(D)&&d.cancel(D);na=s=null;l(-1,null,null,"")};s.onerror=e;s.onabort=e;s.ontimeout=e;p(M,function(a,b){s.addEventListener(b,a)});p(w,function(a,b){s.upload.addEventListener(b,a)});
q&&(s.withCredentials=!0);if(F)try{s.responseType=F}catch(y){if("json"!==F)throw y;}s.send(v(h)?null:h)}if(0<n)var D=d(u,n);else n&&E(n.then)&&n.then(u)}}function Ef(){var a="{{",b="}}";this.startSymbol=function(b){return b?(a=b,this):a};this.endSymbol=function(a){return a?(b=a,this):b};this.$get=["$parse","$exceptionHandler","$sce",function(d,c,e){function f(a){return"\\\\\\"+a}function g(c){return c.replace(n,a).replace(q,b)}function k(a,b,c,d){var e=a.$watch(function(a){e();return d(a)},b,c);return e}
function h(f,h,q,n){function A(a){try{var b=a;a=q?e.getTrusted(q,b):e.valueOf(b);return n&&!t(a)?a:cc(a)}catch(d){c(Fa.interr(f,d))}}if(!f.length||-1===f.indexOf(a)){var p;h||(h=g(f),p=aa(h),p.exp=f,p.expressions=[],p.$$watchDelegate=k);return p}n=!!n;var s,y,D=0,H=[],Z=[];p=f.length;for(var L=[],T=[];D<p;)if(-1!==(s=f.indexOf(a,D))&&-1!==(y=f.indexOf(b,s+l)))D!==s&&L.push(g(f.substring(D,s))),D=f.substring(s+l,y),H.push(D),Z.push(d(D,A)),D=y+m,T.push(L.length),L.push("");else{D!==p&&L.push(g(f.substring(D)));
break}q&&1<L.length&&Fa.throwNoconcat(f);if(!h||H.length){var J=function(a){for(var b=0,c=H.length;b<c;b++){if(n&&v(a[b]))return;L[T[b]]=a[b]}return L.join("")};return O(function(a){var b=0,d=H.length,e=Array(d);try{for(;b<d;b++)e[b]=Z[b](a);return J(e)}catch(g){c(Fa.interr(f,g))}},{exp:f,expressions:H,$$watchDelegate:function(a,b){var c;return a.$watchGroup(Z,function(d,e){var g=J(d);E(b)&&b.call(this,g,d!==e?c:g,a);c=g})}})}}var l=a.length,m=b.length,n=new RegExp(a.replace(/./g,f),"g"),q=new RegExp(b.replace(/./g,
f),"g");h.startSymbol=function(){return a};h.endSymbol=function(){return b};return h}]}function Ff(){this.$get=["$rootScope","$window","$q","$$q","$browser",function(a,b,d,c,e){function f(f,h,l,m){function n(){q?f.apply(null,F):f(u)}var q=4<arguments.length,F=q?xa.call(arguments,4):[],p=b.setInterval,w=b.clearInterval,u=0,A=t(m)&&!m,r=(A?c:d).defer(),s=r.promise;l=t(l)?l:0;s.$$intervalId=p(function(){A?e.defer(n):a.$evalAsync(n);r.notify(u++);0<l&&u>=l&&(r.resolve(u),w(s.$$intervalId),delete g[s.$$intervalId]);
A||a.$apply()},h);g[s.$$intervalId]=r;return s}var g={};f.cancel=function(a){return a&&a.$$intervalId in g?(g[a.$$intervalId].promise.$$state.pur=!0,g[a.$$intervalId].reject("canceled"),b.clearInterval(a.$$intervalId),delete g[a.$$intervalId],!0):!1};return f}]}function tc(a){a=a.split("/");for(var b=a.length;b--;)a[b]=fb(a[b]);return a.join("/")}function Bd(a,b){var d=ua(a);b.$$protocol=d.protocol;b.$$host=d.hostname;b.$$port=Q(d.port)||Ag[d.protocol]||null}function Cd(a,b){if(Bg.test(a))throw mb("badpath",
a);var d="/"!==a.charAt(0);d&&(a="/"+a);var c=ua(a);b.$$path=decodeURIComponent(d&&"/"===c.pathname.charAt(0)?c.pathname.substring(1):c.pathname);b.$$search=Tc(c.search);b.$$hash=decodeURIComponent(c.hash);b.$$path&&"/"!==b.$$path.charAt(0)&&(b.$$path="/"+b.$$path)}function uc(a,b){return a.slice(0,b.length)===b}function va(a,b){if(uc(b,a))return b.substr(a.length)}function ja(a){var b=a.indexOf("#");return-1===b?a:a.substr(0,b)}function nb(a){return a.replace(/(#.+)|#$/,"$1")}function vc(a,b,d){this.$$html5=
!0;d=d||"";Bd(a,this);this.$$parse=function(a){var d=va(b,a);if(!C(d))throw mb("ipthprfx",a,b);Cd(d,this);this.$$path||(this.$$path="/");this.$$compose()};this.$$compose=function(){var a=bc(this.$$search),d=this.$$hash?"#"+fb(this.$$hash):"";this.$$url=tc(this.$$path)+(a?"?"+a:"")+d;this.$$absUrl=b+this.$$url.substr(1);this.$$urlUpdatedByLocation=!0};this.$$parseLinkUrl=function(c,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;t(f=va(a,c))?(g=f,g=d&&t(f=va(d,f))?b+(va("/",f)||f):a+g):
t(f=va(b,c))?g=b+f:b===c+"/"&&(g=b);g&&this.$$parse(g);return!!g}}function wc(a,b,d){Bd(a,this);this.$$parse=function(c){var e=va(a,c)||va(b,c),f;v(e)||"#"!==e.charAt(0)?this.$$html5?f=e:(f="",v(e)&&(a=c,this.replace())):(f=va(d,e),v(f)&&(f=e));Cd(f,this);c=this.$$path;var e=a,g=/^\/[A-Z]:(\/.*)/;uc(f,e)&&(f=f.replace(e,""));g.exec(f)||(c=(f=g.exec(c))?f[1]:c);this.$$path=c;this.$$compose()};this.$$compose=function(){var b=bc(this.$$search),e=this.$$hash?"#"+fb(this.$$hash):"";this.$$url=tc(this.$$path)+
(b?"?"+b:"")+e;this.$$absUrl=a+(this.$$url?d+this.$$url:"");this.$$urlUpdatedByLocation=!0};this.$$parseLinkUrl=function(b,d){return ja(a)===ja(b)?(this.$$parse(b),!0):!1}}function Dd(a,b,d){this.$$html5=!0;wc.apply(this,arguments);this.$$parseLinkUrl=function(c,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;a===ja(c)?f=c:(g=va(b,c))?f=a+d+g:b===c+"/"&&(f=b);f&&this.$$parse(f);return!!f};this.$$compose=function(){var b=bc(this.$$search),e=this.$$hash?"#"+fb(this.$$hash):"";this.$$url=
tc(this.$$path)+(b?"?"+b:"")+e;this.$$absUrl=a+d+this.$$url;this.$$urlUpdatedByLocation=!0}}function Kb(a){return function(){return this[a]}}function Ed(a,b){return function(d){if(v(d))return this[a];this[a]=b(d);this.$$compose();return this}}function Mf(){var a="!",b={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(b){return t(b)?(a=b,this):a};this.html5Mode=function(a){if(La(a))return b.enabled=a,this;if(G(a)){La(a.enabled)&&(b.enabled=a.enabled);La(a.requireBase)&&(b.requireBase=
a.requireBase);if(La(a.rewriteLinks)||C(a.rewriteLinks))b.rewriteLinks=a.rewriteLinks;return this}return b};this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(d,c,e,f,g){function k(a,b,d){var e=l.url(),g=l.$$state;try{c.url(a,b,d),l.$$state=c.state()}catch(f){throw l.url(e),l.$$state=g,f;}}function h(a,b){d.$broadcast("$locationChangeSuccess",l.absUrl(),a,l.$$state,b)}var l,m;m=c.baseHref();var n=c.url(),q;if(b.enabled){if(!m&&b.requireBase)throw mb("nobase");q=n.substring(0,
n.indexOf("/",n.indexOf("//")+2))+(m||"/");m=e.history?vc:Dd}else q=ja(n),m=wc;var F=q.substr(0,ja(q).lastIndexOf("/")+1);l=new m(q,F,"#"+a);l.$$parseLinkUrl(n,n);l.$$state=c.state();var p=/^\s*(javascript|mailto):/i;f.on("click",function(a){var e=b.rewriteLinks;if(e&&!a.ctrlKey&&!a.metaKey&&!a.shiftKey&&2!==a.which&&2!==a.button){for(var h=z(a.target);"a"!==ya(h[0]);)if(h[0]===f[0]||!(h=h.parent())[0])return;if(!C(e)||!v(h.attr(e))){var e=h.prop("href"),k=h.attr("href")||h.attr("xlink:href");G(e)&&
"[object SVGAnimatedString]"===e.toString()&&(e=ua(e.animVal).href);p.test(e)||!e||h.attr("target")||a.isDefaultPrevented()||!l.$$parseLinkUrl(e,k)||(a.preventDefault(),l.absUrl()!==c.url()&&(d.$apply(),g.angular["ff-684208-preventDefault"]=!0))}}});nb(l.absUrl())!==nb(n)&&c.url(l.absUrl(),!0);var w=!0;c.onUrlChange(function(a,b){uc(a,F)?(d.$evalAsync(function(){var c=l.absUrl(),e=l.$$state,g;a=nb(a);l.$$parse(a);l.$$state=b;g=d.$broadcast("$locationChangeStart",a,c,b,e).defaultPrevented;l.absUrl()===
a&&(g?(l.$$parse(c),l.$$state=e,k(c,!1,e)):(w=!1,h(c,e)))}),d.$$phase||d.$digest()):g.location.href=a});d.$watch(function(){if(w||l.$$urlUpdatedByLocation){l.$$urlUpdatedByLocation=!1;var a=nb(c.url()),b=nb(l.absUrl()),g=c.state(),f=l.$$replace,m=a!==b||l.$$html5&&e.history&&g!==l.$$state;if(w||m)w=!1,d.$evalAsync(function(){var b=l.absUrl(),c=d.$broadcast("$locationChangeStart",b,a,l.$$state,g).defaultPrevented;l.absUrl()===b&&(c?(l.$$parse(a),l.$$state=g):(m&&k(b,f,g===l.$$state?null:l.$$state),
h(a,g)))})}l.$$replace=!1});return l}]}function Nf(){var a=!0,b=this;this.debugEnabled=function(b){return t(b)?(a=b,this):a};this.$get=["$window",function(d){function c(a){Zb(a)&&(a.stack&&f?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line));return a}function e(a){var b=d.console||{},e=b[a]||b.log||B;return function(){var a=[];p(arguments,function(b){a.push(c(b))});return Function.prototype.apply.call(e,b,a)}}
var f=Ba||/\bEdge\//.test(d.navigator&&d.navigator.userAgent);return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){a&&c.apply(b,arguments)}}()}}]}function Cg(a){return a+""}function Dg(a,b){return"undefined"!==typeof a?a:b}function Fd(a,b){return"undefined"===typeof a?b:"undefined"===typeof b?a:a+b}function Eg(a,b){switch(a.type){case r.MemberExpression:if(a.computed)return!1;break;case r.UnaryExpression:return 1;case r.BinaryExpression:return"+"!==
a.operator?1:!1;case r.CallExpression:return!1}return void 0===b?Gd:b}function X(a,b,d){var c,e,f=a.isPure=Eg(a,d);switch(a.type){case r.Program:c=!0;p(a.body,function(a){X(a.expression,b,f);c=c&&a.expression.constant});a.constant=c;break;case r.Literal:a.constant=!0;a.toWatch=[];break;case r.UnaryExpression:X(a.argument,b,f);a.constant=a.argument.constant;a.toWatch=a.argument.toWatch;break;case r.BinaryExpression:X(a.left,b,f);X(a.right,b,f);a.constant=a.left.constant&&a.right.constant;a.toWatch=
a.left.toWatch.concat(a.right.toWatch);break;case r.LogicalExpression:X(a.left,b,f);X(a.right,b,f);a.constant=a.left.constant&&a.right.constant;a.toWatch=a.constant?[]:[a];break;case r.ConditionalExpression:X(a.test,b,f);X(a.alternate,b,f);X(a.consequent,b,f);a.constant=a.test.constant&&a.alternate.constant&&a.consequent.constant;a.toWatch=a.constant?[]:[a];break;case r.Identifier:a.constant=!1;a.toWatch=[a];break;case r.MemberExpression:X(a.object,b,f);a.computed&&X(a.property,b,f);a.constant=a.object.constant&&
(!a.computed||a.property.constant);a.toWatch=[a];break;case r.CallExpression:c=d=a.filter?!b(a.callee.name).$stateful:!1;e=[];p(a.arguments,function(a){X(a,b,f);c=c&&a.constant;a.constant||e.push.apply(e,a.toWatch)});a.constant=c;a.toWatch=d?e:[a];break;case r.AssignmentExpression:X(a.left,b,f);X(a.right,b,f);a.constant=a.left.constant&&a.right.constant;a.toWatch=[a];break;case r.ArrayExpression:c=!0;e=[];p(a.elements,function(a){X(a,b,f);c=c&&a.constant;a.constant||e.push.apply(e,a.toWatch)});a.constant=
c;a.toWatch=e;break;case r.ObjectExpression:c=!0;e=[];p(a.properties,function(a){X(a.value,b,f);c=c&&a.value.constant&&!a.computed;a.value.constant||e.push.apply(e,a.value.toWatch);a.computed&&(X(a.key,b,f),a.key.constant||e.push.apply(e,a.key.toWatch))});a.constant=c;a.toWatch=e;break;case r.ThisExpression:a.constant=!1;a.toWatch=[];break;case r.LocalsExpression:a.constant=!1,a.toWatch=[]}}function Hd(a){if(1===a.length){a=a[0].expression;var b=a.toWatch;return 1!==b.length?b:b[0]!==a?b:void 0}}
function Id(a){return a.type===r.Identifier||a.type===r.MemberExpression}function Jd(a){if(1===a.body.length&&Id(a.body[0].expression))return{type:r.AssignmentExpression,left:a.body[0].expression,right:{type:r.NGValueParameter},operator:"="}}function Kd(a){this.$filter=a}function Ld(a){this.$filter=a}function xc(a,b,d){this.ast=new r(a,d);this.astCompiler=d.csp?new Ld(b):new Kd(b)}function yc(a){return E(a.valueOf)?a.valueOf():Fg.call(a)}function Of(){var a=R(),b={"true":!0,"false":!1,"null":null,
undefined:void 0},d,c;this.addLiteral=function(a,c){b[a]=c};this.setIdentifierFns=function(a,b){d=a;c=b;return this};this.$get=["$filter",function(e){function f(a,b,c){return null==a||null==b?a===b:"object"!==typeof a||(a=yc(a),"object"!==typeof a||c)?a===b||a!==a&&b!==b:!1}function g(a,b,c,d,e){var g=d.inputs,h;if(1===g.length){var k=f,g=g[0];return a.$watch(function(a){var b=g(a);f(b,k,g.isPure)||(h=d(a,void 0,void 0,[b]),k=b&&yc(b));return h},b,c,e)}for(var l=[],m=[],n=0,p=g.length;n<p;n++)l[n]=
f,m[n]=null;return a.$watch(function(a){for(var b=!1,c=0,e=g.length;c<e;c++){var k=g[c](a);if(b||(b=!f(k,l[c],g[c].isPure)))m[c]=k,l[c]=k&&yc(k)}b&&(h=d(a,void 0,void 0,m));return h},b,c,e)}function k(a,b,c,d,e){function f(a){return d(a)}function h(a,c,d){l=a;E(b)&&b(a,c,d);t(a)&&d.$$postDigest(function(){t(l)&&k()})}var k,l;return k=d.inputs?g(a,h,c,d,e):a.$watch(f,h,c)}function h(a,b,c,d){function e(a){var b=!0;p(a,function(a){t(a)||(b=!1)});return b}var g,f;return g=a.$watch(function(a){return d(a)},
function(a,c,d){f=a;E(b)&&b(a,c,d);e(a)&&d.$$postDigest(function(){e(f)&&g()})},c)}function l(a,b,c,d){var e=a.$watch(function(a){e();return d(a)},b,c);return e}function m(a,b){if(!b)return a;var c=a.$$watchDelegate,d=!1,e=c!==h&&c!==k?function(c,e,g,f){g=d&&f?f[0]:a(c,e,g,f);return b(g,c,e)}:function(c,d,e,g){e=a(c,d,e,g);c=b(e,c,d);return t(e)?c:e},d=!a.inputs;c&&c!==g?(e.$$watchDelegate=c,e.inputs=a.inputs):b.$stateful||(e.$$watchDelegate=g,e.inputs=a.inputs?a.inputs:[a]);e.inputs&&(e.inputs=e.inputs.map(function(a){return a.isPure===
Gd?function(b){return a(b)}:a}));return e}var n={csp:Ja().noUnsafeEval,literals:Ia(b),isIdentifierStart:E(d)&&d,isIdentifierContinue:E(c)&&c};return function(b,c){var d,f,p;switch(typeof b){case "string":return p=b=b.trim(),d=a[p],d||(":"===b.charAt(0)&&":"===b.charAt(1)&&(f=!0,b=b.substring(2)),d=new zc(n),d=(new xc(d,e,n)).parse(b),d.constant?d.$$watchDelegate=l:f?d.$$watchDelegate=d.literal?h:k:d.inputs&&(d.$$watchDelegate=g),a[p]=d),m(d,c);case "function":return m(b,c);default:return m(B,c)}}}]}
function Qf(){var a=!0;this.$get=["$rootScope","$exceptionHandler",function(b,d){return Md(function(a){b.$evalAsync(a)},d,a)}];this.errorOnUnhandledRejections=function(b){return t(b)?(a=b,this):a}}function Rf(){var a=!0;this.$get=["$browser","$exceptionHandler",function(b,d){return Md(function(a){b.defer(a)},d,a)}];this.errorOnUnhandledRejections=function(b){return t(b)?(a=b,this):a}}function Md(a,b,d){function c(){return new e}function e(){var a=this.promise=new f;this.resolve=function(b){h(a,b)};
this.reject=function(b){m(a,b)};this.notify=function(b){q(a,b)}}function f(){this.$$state={status:0}}function g(){for(;!t&&s.length;){var a=s.shift();if(!a.pur){a.pur=!0;var c=a.value,c="Possibly unhandled rejection: "+("function"===typeof c?c.toString().replace(/ \{[\s\S]*$/,""):v(c)?"undefined":"string"!==typeof c?Ee(c,void 0):c);Zb(a.value)?b(a.value,c):b(c)}}}function k(b){!d||b.pending||2!==b.status||b.pur||(0===t&&0===s.length&&a(g),s.push(b));!b.processScheduled&&b.pending&&(b.processScheduled=
!0,++t,a(function(){var c,e,f;f=b.pending;b.processScheduled=!1;b.pending=void 0;try{for(var k=0,l=f.length;k<l;++k){b.pur=!0;e=f[k][0];c=f[k][b.status];try{E(c)?h(e,c(b.value)):1===b.status?h(e,b.value):m(e,b.value)}catch(n){m(e,n)}}}finally{--t,d&&0===t&&a(g)}}))}function h(a,b){a.$$state.status||(b===a?n(a,A("qcycle",b)):l(a,b))}function l(a,b){function c(b){f||(f=!0,l(a,b))}function d(b){f||(f=!0,n(a,b))}function e(b){q(a,b)}var g,f=!1;try{if(G(b)||E(b))g=b.then;E(g)?(a.$$state.status=-1,g.call(b,
c,d,e)):(a.$$state.value=b,a.$$state.status=1,k(a.$$state))}catch(h){d(h)}}function m(a,b){a.$$state.status||n(a,b)}function n(a,b){a.$$state.value=b;a.$$state.status=2;k(a.$$state)}function q(c,d){var e=c.$$state.pending;0>=c.$$state.status&&e&&e.length&&a(function(){for(var a,c,g=0,f=e.length;g<f;g++){c=e[g][0];a=e[g][3];try{q(c,E(a)?a(d):d)}catch(h){b(h)}}})}function F(a){var b=new f;m(b,a);return b}function r(a,b,c){var d=null;try{E(c)&&(d=c())}catch(e){return F(e)}return d&&E(d.then)?d.then(function(){return b(a)},
F):b(a)}function w(a,b,c,d){var e=new f;h(e,a);return e.then(b,c,d)}function u(a){if(!E(a))throw A("norslvr",a);var b=new f;a(function(a){h(b,a)},function(a){m(b,a)});return b}var A=K("$q",TypeError),t=0,s=[];O(f.prototype,{then:function(a,b,c){if(v(a)&&v(b)&&v(c))return this;var d=new f;this.$$state.pending=this.$$state.pending||[];this.$$state.pending.push([d,a,b,c]);0<this.$$state.status&&k(this.$$state);return d},"catch":function(a){return this.then(null,a)},"finally":function(a,b){return this.then(function(b){return r(b,
y,a)},function(b){return r(b,F,a)},b)}});var y=w;u.prototype=f.prototype;u.defer=c;u.reject=F;u.when=w;u.resolve=y;u.all=function(a){var b=new f,c=0,d=I(a)?[]:{};p(a,function(a,e){c++;w(a).then(function(a){d[e]=a;--c||h(b,d)},function(a){m(b,a)})});0===c&&h(b,d);return b};u.race=function(a){var b=c();p(a,function(a){w(a).then(b.resolve,b.reject)});return b.promise};return u}function $f(){this.$get=["$window","$timeout",function(a,b){var d=a.requestAnimationFrame||a.webkitRequestAnimationFrame,c=a.cancelAnimationFrame||
a.webkitCancelAnimationFrame||a.webkitCancelRequestAnimationFrame,e=!!d,f=e?function(a){var b=d(a);return function(){c(b)}}:function(a){var c=b(a,16.66,!1);return function(){b.cancel(c)}};f.supported=e;return f}]}function Pf(){function a(a){function b(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null;this.$$listeners={};this.$$listenerCount={};this.$$watchersCount=0;this.$id=++sb;this.$$ChildScope=null}b.prototype=a;return b}var b=10,d=K("$rootScope"),c=null,e=null;this.digestTtl=
function(a){arguments.length&&(b=a);return b};this.$get=["$exceptionHandler","$parse","$browser",function(f,g,k){function h(a){a.currentScope.$$destroyed=!0}function l(a){9===Ba&&(a.$$childHead&&l(a.$$childHead),a.$$nextSibling&&l(a.$$nextSibling));a.$parent=a.$$nextSibling=a.$$prevSibling=a.$$childHead=a.$$childTail=a.$root=a.$$watchers=null}function m(){this.$id=++sb;this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null;this.$root=
this;this.$$destroyed=!1;this.$$listeners={};this.$$listenerCount={};this.$$watchersCount=0;this.$$isolateBindings=null}function n(a){if(A.$$phase)throw d("inprog",A.$$phase);A.$$phase=a}function q(a,b){do a.$$watchersCount+=b;while(a=a.$parent)}function F(a,b,c){do a.$$listenerCount[c]-=b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c];while(a=a.$parent)}function r(){}function w(){for(;y.length;)try{y.shift()()}catch(a){f(a)}e=null}function u(){null===e&&(e=k.defer(function(){A.$apply(w)}))}
m.prototype={constructor:m,$new:function(b,c){var d;c=c||this;b?(d=new m,d.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=a(this)),d=new this.$$ChildScope);d.$parent=c;d.$$prevSibling=c.$$childTail;c.$$childHead?(c.$$childTail.$$nextSibling=d,c.$$childTail=d):c.$$childHead=c.$$childTail=d;(b||c!==this)&&d.$on("$destroy",h);return d},$watch:function(a,b,d,e){var f=g(a);if(f.$$watchDelegate)return f.$$watchDelegate(this,b,d,f,a);var h=this,k=h.$$watchers,l={fn:b,last:r,get:f,exp:e||a,eq:!!d};
c=null;E(b)||(l.fn=B);k||(k=h.$$watchers=[],k.$$digestWatchIndex=-1);k.unshift(l);k.$$digestWatchIndex++;q(this,1);return function(){var a=cb(k,l);0<=a&&(q(h,-1),a<k.$$digestWatchIndex&&k.$$digestWatchIndex--);c=null}},$watchGroup:function(a,b){function c(){h=!1;k?(k=!1,b(e,e,f)):b(e,d,f)}var d=Array(a.length),e=Array(a.length),g=[],f=this,h=!1,k=!0;if(!a.length){var l=!0;f.$evalAsync(function(){l&&b(e,e,f)});return function(){l=!1}}if(1===a.length)return this.$watch(a[0],function(a,c,g){e[0]=a;d[0]=
c;b(e,a===c?e:d,g)});p(a,function(a,b){var k=f.$watch(a,function(a,g){e[b]=a;d[b]=g;h||(h=!0,f.$evalAsync(c))});g.push(k)});return function(){for(;g.length;)g.shift()()}},$watchCollection:function(a,b){function c(a){e=a;var b,d,g,h;if(!v(e)){if(G(e))if(oa(e))for(f!==n&&(f=n,s=f.length=0,l++),a=e.length,s!==a&&(l++,f.length=s=a),b=0;b<a;b++)h=f[b],g=e[b],d=h!==h&&g!==g,d||h===g||(l++,f[b]=g);else{f!==q&&(f=q={},s=0,l++);a=0;for(b in e)wa.call(e,b)&&(a++,g=e[b],h=f[b],b in f?(d=h!==h&&g!==g,d||h===
g||(l++,f[b]=g)):(s++,f[b]=g,l++));if(s>a)for(b in l++,f)wa.call(e,b)||(s--,delete f[b])}else f!==e&&(f=e,l++);return l}}c.$stateful=!0;var d=this,e,f,h,k=1<b.length,l=0,m=g(a,c),n=[],q={},p=!0,s=0;return this.$watch(m,function(){p?(p=!1,b(e,e,d)):b(e,h,d);if(k)if(G(e))if(oa(e)){h=Array(e.length);for(var a=0;a<e.length;a++)h[a]=e[a]}else for(a in h={},e)wa.call(e,a)&&(h[a]=e[a]);else h=e})},$digest:function(){var a,g,h,l,m,q,p,F=b,y,u=[],v,x;n("$digest");k.$$checkUrlChange();this===A&&null!==e&&(k.defer.cancel(e),
w());c=null;do{p=!1;y=this;for(q=0;q<t.length;q++){try{x=t[q],l=x.fn,l(x.scope,x.locals)}catch(z){f(z)}c=null}t.length=0;a:do{if(q=y.$$watchers)for(q.$$digestWatchIndex=q.length;q.$$digestWatchIndex--;)try{if(a=q[q.$$digestWatchIndex])if(m=a.get,(g=m(y))!==(h=a.last)&&!(a.eq?sa(g,h):ba(g)&&ba(h)))p=!0,c=a,a.last=a.eq?Ia(g,null):g,l=a.fn,l(g,h===r?g:h,y),5>F&&(v=4-F,u[v]||(u[v]=[]),u[v].push({msg:E(a.exp)?"fn: "+(a.exp.name||a.exp.toString()):a.exp,newVal:g,oldVal:h}));else if(a===c){p=!1;break a}}catch(B){f(B)}if(!(q=
y.$$watchersCount&&y.$$childHead||y!==this&&y.$$nextSibling))for(;y!==this&&!(q=y.$$nextSibling);)y=y.$parent}while(y=q);if((p||t.length)&&!F--)throw A.$$phase=null,d("infdig",b,u);}while(p||t.length);for(A.$$phase=null;D<s.length;)try{s[D++]()}catch(G){f(G)}s.length=D=0;k.$$checkUrlChange()},$destroy:function(){if(!this.$$destroyed){var a=this.$parent;this.$broadcast("$destroy");this.$$destroyed=!0;this===A&&k.$$applicationDestroyed();q(this,-this.$$watchersCount);for(var b in this.$$listenerCount)F(this,
this.$$listenerCount[b],b);a&&a.$$childHead===this&&(a.$$childHead=this.$$nextSibling);a&&a.$$childTail===this&&(a.$$childTail=this.$$prevSibling);this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling);this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling);this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=B;this.$on=this.$watch=this.$watchGroup=function(){return B};this.$$listeners={};this.$$nextSibling=null;l(this)}},$eval:function(a,b){return g(a)(this,
b)},$evalAsync:function(a,b){A.$$phase||t.length||k.defer(function(){t.length&&A.$digest()});t.push({scope:this,fn:g(a),locals:b})},$$postDigest:function(a){s.push(a)},$apply:function(a){try{n("$apply");try{return this.$eval(a)}finally{A.$$phase=null}}catch(b){f(b)}finally{try{A.$digest()}catch(c){throw f(c),c;}}},$applyAsync:function(a){function b(){c.$eval(a)}var c=this;a&&y.push(b);a=g(a);u()},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]);c.push(b);var d=this;do d.$$listenerCount[a]||
(d.$$listenerCount[a]=0),d.$$listenerCount[a]++;while(d=d.$parent);var e=this;return function(){var d=c.indexOf(b);-1!==d&&(c[d]=null,F(e,1,a))}},$emit:function(a,b){var c=[],d,e=this,g=!1,h={name:a,targetScope:e,stopPropagation:function(){g=!0},preventDefault:function(){h.defaultPrevented=!0},defaultPrevented:!1},k=db([h],arguments,1),l,m;do{d=e.$$listeners[a]||c;h.currentScope=e;l=0;for(m=d.length;l<m;l++)if(d[l])try{d[l].apply(null,k)}catch(n){f(n)}else d.splice(l,1),l--,m--;if(g)return h.currentScope=
null,h;e=e.$parent}while(e);h.currentScope=null;return h},$broadcast:function(a,b){var c=this,d=this,e={name:a,targetScope:this,preventDefault:function(){e.defaultPrevented=!0},defaultPrevented:!1};if(!this.$$listenerCount[a])return e;for(var g=db([e],arguments,1),h,k;c=d;){e.currentScope=c;d=c.$$listeners[a]||[];h=0;for(k=d.length;h<k;h++)if(d[h])try{d[h].apply(null,g)}catch(l){f(l)}else d.splice(h,1),h--,k--;if(!(d=c.$$listenerCount[a]&&c.$$childHead||c!==this&&c.$$nextSibling))for(;c!==this&&!(d=
c.$$nextSibling);)c=c.$parent}e.currentScope=null;return e}};var A=new m,t=A.$$asyncQueue=[],s=A.$$postDigestQueue=[],y=A.$$applyAsyncQueue=[],D=0;return A}]}function He(){var a=/^\s*(https?|ftp|mailto|tel|file):/,b=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(b){return t(b)?(a=b,this):a};this.imgSrcSanitizationWhitelist=function(a){return t(a)?(b=a,this):b};this.$get=function(){return function(d,c){var e=c?b:a,f;f=ua(d).href;return""===f||f.match(e)?d:"unsafe:"+
f}}}function Gg(a){if("self"===a)return a;if(C(a)){if(-1<a.indexOf("***"))throw qa("iwcard",a);a=Nd(a).replace(/\\\*\\\*/g,".*").replace(/\\\*/g,"[^:/.?&;]*");return new RegExp("^"+a+"$")}if($a(a))return new RegExp("^"+a.source+"$");throw qa("imatcher");}function Od(a){var b=[];t(a)&&p(a,function(a){b.push(Gg(a))});return b}function Tf(){this.SCE_CONTEXTS=ka;var a=["self"],b=[];this.resourceUrlWhitelist=function(b){arguments.length&&(a=Od(b));return a};this.resourceUrlBlacklist=function(a){arguments.length&&
(b=Od(a));return b};this.$get=["$injector",function(d){function c(a,b){return"self"===a?Ad(b):!!a.exec(b.href)}function e(a){var b=function(a){this.$$unwrapTrustedValue=function(){return a}};a&&(b.prototype=new a);b.prototype.valueOf=function(){return this.$$unwrapTrustedValue()};b.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()};return b}var f=function(a){throw qa("unsafe");};d.has("$sanitize")&&(f=d.get("$sanitize"));var g=e(),k={};k[ka.HTML]=e(g);k[ka.CSS]=e(g);k[ka.URL]=
e(g);k[ka.JS]=e(g);k[ka.RESOURCE_URL]=e(k[ka.URL]);return{trustAs:function(a,b){var c=k.hasOwnProperty(a)?k[a]:null;if(!c)throw qa("icontext",a,b);if(null===b||v(b)||""===b)return b;if("string"!==typeof b)throw qa("itype",a);return new c(b)},getTrusted:function(d,e){if(null===e||v(e)||""===e)return e;var g=k.hasOwnProperty(d)?k[d]:null;if(g&&e instanceof g)return e.$$unwrapTrustedValue();if(d===ka.RESOURCE_URL){var g=ua(e.toString()),n,q,p=!1;n=0;for(q=a.length;n<q;n++)if(c(a[n],g)){p=!0;break}if(p)for(n=
0,q=b.length;n<q;n++)if(c(b[n],g)){p=!1;break}if(p)return e;throw qa("insecurl",e.toString());}if(d===ka.HTML)return f(e);throw qa("unsafe");},valueOf:function(a){return a instanceof g?a.$$unwrapTrustedValue():a}}}]}function Sf(){var a=!0;this.enabled=function(b){arguments.length&&(a=!!b);return a};this.$get=["$parse","$sceDelegate",function(b,d){if(a&&8>Ba)throw qa("iequirks");var c=ra(ka);c.isEnabled=function(){return a};c.trustAs=d.trustAs;c.getTrusted=d.getTrusted;c.valueOf=d.valueOf;a||(c.trustAs=
c.getTrusted=function(a,b){return b},c.valueOf=ab);c.parseAs=function(a,d){var e=b(d);return e.literal&&e.constant?e:b(d,function(b){return c.getTrusted(a,b)})};var e=c.parseAs,f=c.getTrusted,g=c.trustAs;p(ka,function(a,b){var d=N(b);c[("parse_as_"+d).replace(Ac,ib)]=function(b){return e(a,b)};c[("get_trusted_"+d).replace(Ac,ib)]=function(b){return f(a,b)};c[("trust_as_"+d).replace(Ac,ib)]=function(b){return g(a,b)}});return c}]}function Uf(){this.$get=["$window","$document",function(a,b){var d={},
c=!((!a.nw||!a.nw.process)&&a.chrome&&(a.chrome.app&&a.chrome.app.runtime||!a.chrome.app&&a.chrome.runtime&&a.chrome.runtime.id))&&a.history&&a.history.pushState,e=Q((/android (\d+)/.exec(N((a.navigator||{}).userAgent))||[])[1]),f=/Boxee/i.test((a.navigator||{}).userAgent),g=b[0]||{},k=g.body&&g.body.style,h=!1,l=!1;k&&(h=!!("transition"in k||"webkitTransition"in k),l=!!("animation"in k||"webkitAnimation"in k));return{history:!(!c||4>e||f),hasEvent:function(a){if("input"===a&&Ba)return!1;if(v(d[a])){var b=
g.createElement("div");d[a]="on"+a in b}return d[a]},csp:Ja(),transitions:h,animations:l,android:e}}]}function Wf(){var a;this.httpOptions=function(b){return b?(a=b,this):a};this.$get=["$exceptionHandler","$templateCache","$http","$q","$sce",function(b,d,c,e,f){function g(k,h){g.totalPendingRequests++;if(!C(k)||v(d.get(k)))k=f.getTrustedResourceUrl(k);var l=c.defaults&&c.defaults.transformResponse;I(l)?l=l.filter(function(a){return a!==qc}):l===qc&&(l=null);return c.get(k,O({cache:d,transformResponse:l},
a)).finally(function(){g.totalPendingRequests--}).then(function(a){d.put(k,a.data);return a.data},function(a){h||(a=Hg("tpload",k,a.status,a.statusText),b(a));return e.reject(a)})}g.totalPendingRequests=0;return g}]}function Xf(){this.$get=["$rootScope","$browser","$location",function(a,b,d){return{findBindings:function(a,b,d){a=a.getElementsByClassName("ng-binding");var g=[];p(a,function(a){var c=fa.element(a).data("$binding");c&&p(c,function(c){d?(new RegExp("(^|\\s)"+Nd(b)+"(\\s|\\||$)")).test(c)&&
g.push(a):-1!==c.indexOf(b)&&g.push(a)})});return g},findModels:function(a,b,d){for(var g=["ng-","data-ng-","ng\\:"],k=0;k<g.length;++k){var h=a.querySelectorAll("["+g[k]+"model"+(d?"=":"*=")+'"'+b+'"]');if(h.length)return h}},getLocation:function(){return d.url()},setLocation:function(b){b!==d.url()&&(d.url(b),a.$digest())},whenStable:function(a){b.notifyWhenNoOutstandingRequests(a)}}}]}function Yf(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(a,b,d,c,e){function f(f,
h,l){E(f)||(l=h,h=f,f=B);var m=xa.call(arguments,3),n=t(l)&&!l,q=(n?c:d).defer(),p=q.promise,r;r=b.defer(function(){try{q.resolve(f.apply(null,m))}catch(b){q.reject(b),e(b)}finally{delete g[p.$$timeoutId]}n||a.$apply()},h);p.$$timeoutId=r;g[r]=q;return p}var g={};f.cancel=function(a){return a&&a.$$timeoutId in g?(g[a.$$timeoutId].promise.$$state.pur=!0,g[a.$$timeoutId].reject("canceled"),delete g[a.$$timeoutId],b.defer.cancel(a.$$timeoutId)):!1};return f}]}function ua(a){Ba&&(ea.setAttribute("href",
a),a=ea.href);ea.setAttribute("href",a);return{href:ea.href,protocol:ea.protocol?ea.protocol.replace(/:$/,""):"",host:ea.host,search:ea.search?ea.search.replace(/^\?/,""):"",hash:ea.hash?ea.hash.replace(/^#/,""):"",hostname:ea.hostname,port:ea.port,pathname:"/"===ea.pathname.charAt(0)?ea.pathname:"/"+ea.pathname}}function Ad(a){a=C(a)?ua(a):a;return a.protocol===Pd.protocol&&a.host===Pd.host}function Zf(){this.$get=aa(x)}function Qd(a){function b(a){try{return decodeURIComponent(a)}catch(b){return a}}
var d=a[0]||{},c={},e="";return function(){var a,g,k,h,l;try{a=d.cookie||""}catch(m){a=""}if(a!==e)for(e=a,a=e.split("; "),c={},k=0;k<a.length;k++)g=a[k],h=g.indexOf("="),0<h&&(l=b(g.substring(0,h)),v(c[l])&&(c[l]=b(g.substring(h+1))));return c}}function cg(){this.$get=Qd}function ed(a){function b(d,c){if(G(d)){var e={};p(d,function(a,c){e[c]=b(c,a)});return e}return a.factory(d+"Filter",c)}this.register=b;this.$get=["$injector",function(a){return function(b){return a.get(b+"Filter")}}];b("currency",
Rd);b("date",Sd);b("filter",Ig);b("json",Jg);b("limitTo",Kg);b("lowercase",Lg);b("number",Td);b("orderBy",Ud);b("uppercase",Mg)}function Ig(){return function(a,b,d,c){if(!oa(a)){if(null==a)return a;throw K("filter")("notarray",a);}c=c||"$";var e;switch(Bc(b)){case "function":break;case "boolean":case "null":case "number":case "string":e=!0;case "object":b=Ng(b,d,c,e);break;default:return a}return Array.prototype.filter.call(a,b)}}function Ng(a,b,d,c){var e=G(a)&&d in a;!0===b?b=sa:E(b)||(b=function(a,
b){if(v(a))return!1;if(null===a||null===b)return a===b;if(G(b)||G(a)&&!Yb(a))return!1;a=N(""+a);b=N(""+b);return-1!==a.indexOf(b)});return function(f){return e&&!G(f)?Ga(f,a[d],b,d,!1):Ga(f,a,b,d,c)}}function Ga(a,b,d,c,e,f){var g=Bc(a),k=Bc(b);if("string"===k&&"!"===b.charAt(0))return!Ga(a,b.substring(1),d,c,e);if(I(a))return a.some(function(a){return Ga(a,b,d,c,e)});switch(g){case "object":var h;if(e){for(h in a)if(h.charAt&&"$"!==h.charAt(0)&&Ga(a[h],b,d,c,!0))return!0;return f?!1:Ga(a,b,d,c,!1)}if("object"===
k){for(h in b)if(f=b[h],!E(f)&&!v(f)&&(g=h===c,!Ga(g?a:a[h],f,d,c,g,g)))return!1;return!0}return d(a,b);case "function":return!1;default:return d(a,b)}}function Bc(a){return null===a?"null":typeof a}function Rd(a){var b=a.NUMBER_FORMATS;return function(a,c,e){v(c)&&(c=b.CURRENCY_SYM);v(e)&&(e=b.PATTERNS[1].maxFrac);return null==a?a:Vd(a,b.PATTERNS[1],b.GROUP_SEP,b.DECIMAL_SEP,e).replace(/\u00A4/g,c)}}function Td(a){var b=a.NUMBER_FORMATS;return function(a,c){return null==a?a:Vd(a,b.PATTERNS[0],b.GROUP_SEP,
b.DECIMAL_SEP,c)}}function Og(a){var b=0,d,c,e,f,g;-1<(c=a.indexOf(Wd))&&(a=a.replace(Wd,""));0<(e=a.search(/e/i))?(0>c&&(c=e),c+=+a.slice(e+1),a=a.substring(0,e)):0>c&&(c=a.length);for(e=0;a.charAt(e)===Cc;e++);if(e===(g=a.length))d=[0],c=1;else{for(g--;a.charAt(g)===Cc;)g--;c-=e;d=[];for(f=0;e<=g;e++,f++)d[f]=+a.charAt(e)}c>Xd&&(d=d.splice(0,Xd-1),b=c-1,c=1);return{d:d,e:b,i:c}}function Pg(a,b,d,c){var e=a.d,f=e.length-a.i;b=v(b)?Math.min(Math.max(d,f),c):+b;d=b+a.i;c=e[d];if(0<d){e.splice(Math.max(a.i,
d));for(var g=d;g<e.length;g++)e[g]=0}else for(f=Math.max(0,f),a.i=1,e.length=Math.max(1,d=b+1),e[0]=0,g=1;g<d;g++)e[g]=0;if(5<=c)if(0>d-1){for(c=0;c>d;c--)e.unshift(0),a.i++;e.unshift(1);a.i++}else e[d-1]++;for(;f<Math.max(0,b);f++)e.push(0);if(b=e.reduceRight(function(a,b,c,d){b+=a;d[c]=b%10;return Math.floor(b/10)},0))e.unshift(b),a.i++}function Vd(a,b,d,c,e){if(!C(a)&&!W(a)||isNaN(a))return"";var f=!isFinite(a),g=!1,k=Math.abs(a)+"",h="";if(f)h="\u221e";else{g=Og(k);Pg(g,e,b.minFrac,b.maxFrac);
h=g.d;k=g.i;e=g.e;f=[];for(g=h.reduce(function(a,b){return a&&!b},!0);0>k;)h.unshift(0),k++;0<k?f=h.splice(k,h.length):(f=h,h=[0]);k=[];for(h.length>=b.lgSize&&k.unshift(h.splice(-b.lgSize,h.length).join(""));h.length>b.gSize;)k.unshift(h.splice(-b.gSize,h.length).join(""));h.length&&k.unshift(h.join(""));h=k.join(d);f.length&&(h+=c+f.join(""));e&&(h+="e+"+e)}return 0>a&&!g?b.negPre+h+b.negSuf:b.posPre+h+b.posSuf}function Lb(a,b,d,c){var e="";if(0>a||c&&0>=a)c?a=-a+1:(a=-a,e="-");for(a=""+a;a.length<
b;)a=Cc+a;d&&(a=a.substr(a.length-b));return e+a}function $(a,b,d,c,e){d=d||0;return function(f){f=f["get"+a]();if(0<d||f>-d)f+=d;0===f&&-12===d&&(f=12);return Lb(f,b,c,e)}}function ob(a,b,d){return function(c,e){var f=c["get"+a](),g=wb((d?"STANDALONE":"")+(b?"SHORT":"")+a);return e[g][f]}}function Yd(a){var b=(new Date(a,0,1)).getDay();return new Date(a,0,(4>=b?5:12)-b)}function Zd(a){return function(b){var d=Yd(b.getFullYear());b=+new Date(b.getFullYear(),b.getMonth(),b.getDate()+(4-b.getDay()))-
+d;b=1+Math.round(b/6048E5);return Lb(b,a)}}function Dc(a,b){return 0>=a.getFullYear()?b.ERAS[0]:b.ERAS[1]}function Sd(a){function b(a){var b;if(b=a.match(d)){a=new Date(0);var f=0,g=0,k=b[8]?a.setUTCFullYear:a.setFullYear,h=b[8]?a.setUTCHours:a.setHours;b[9]&&(f=Q(b[9]+b[10]),g=Q(b[9]+b[11]));k.call(a,Q(b[1]),Q(b[2])-1,Q(b[3]));f=Q(b[4]||0)-f;g=Q(b[5]||0)-g;k=Q(b[6]||0);b=Math.round(1E3*parseFloat("0."+(b[7]||0)));h.call(a,f,g,k,b)}return a}var d=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;
return function(c,d,f){var g="",k=[],h,l;d=d||"mediumDate";d=a.DATETIME_FORMATS[d]||d;C(c)&&(c=Qg.test(c)?Q(c):b(c));W(c)&&(c=new Date(c));if(!ia(c)||!isFinite(c.getTime()))return c;for(;d;)(l=Rg.exec(d))?(k=db(k,l,1),d=k.pop()):(k.push(d),d=null);var m=c.getTimezoneOffset();f&&(m=Rc(f,m),c=ac(c,f,!0));p(k,function(b){h=Sg[b];g+=h?h(c,a.DATETIME_FORMATS,m):"''"===b?"'":b.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return g}}function Jg(){return function(a,b){v(b)&&(b=2);return eb(a,b)}}function Kg(){return function(a,
b,d){b=Infinity===Math.abs(Number(b))?Number(b):Q(b);if(ba(b))return a;W(a)&&(a=a.toString());if(!oa(a))return a;d=!d||isNaN(d)?0:Q(d);d=0>d?Math.max(0,a.length+d):d;return 0<=b?Ec(a,d,d+b):0===d?Ec(a,b,a.length):Ec(a,Math.max(0,d+b),d)}}function Ec(a,b,d){return C(a)?a.slice(b,d):xa.call(a,b,d)}function Ud(a){function b(b){return b.map(function(b){var c=1,d=ab;if(E(b))d=b;else if(C(b)){if("+"===b.charAt(0)||"-"===b.charAt(0))c="-"===b.charAt(0)?-1:1,b=b.substring(1);if(""!==b&&(d=a(b),d.constant))var e=
d(),d=function(a){return a[e]}}return{get:d,descending:c}})}function d(a){switch(typeof a){case "number":case "boolean":case "string":return!0;default:return!1}}function c(a,b){var c=0,d=a.type,h=b.type;if(d===h){var h=a.value,l=b.value;"string"===d?(h=h.toLowerCase(),l=l.toLowerCase()):"object"===d&&(G(h)&&(h=a.index),G(l)&&(l=b.index));h!==l&&(c=h<l?-1:1)}else c=d<h?-1:1;return c}return function(a,f,g,k){if(null==a)return a;if(!oa(a))throw K("orderBy")("notarray",a);I(f)||(f=[f]);0===f.length&&
(f=["+"]);var h=b(f),l=g?-1:1,m=E(k)?k:c;a=Array.prototype.map.call(a,function(a,b){return{value:a,tieBreaker:{value:b,type:"number",index:b},predicateValues:h.map(function(c){var e=c.get(a);c=typeof e;if(null===e)c="string",e="null";else if("object"===c)a:{if(E(e.valueOf)&&(e=e.valueOf(),d(e)))break a;Yb(e)&&(e=e.toString(),d(e))}return{value:e,type:c,index:b}})}});a.sort(function(a,b){for(var d=0,e=h.length;d<e;d++){var g=m(a.predicateValues[d],b.predicateValues[d]);if(g)return g*h[d].descending*
l}return(m(a.tieBreaker,b.tieBreaker)||c(a.tieBreaker,b.tieBreaker))*l});return a=a.map(function(a){return a.value})}}function Ua(a){E(a)&&(a={link:a});a.restrict=a.restrict||"AC";return aa(a)}function Mb(a,b,d,c,e){this.$$controls=[];this.$error={};this.$$success={};this.$pending=void 0;this.$name=e(b.name||b.ngForm||"")(d);this.$dirty=!1;this.$valid=this.$pristine=!0;this.$submitted=this.$invalid=!1;this.$$parentForm=Nb;this.$$element=a;this.$$animate=c;$d(this)}function $d(a){a.$$classCache={};
a.$$classCache[ae]=!(a.$$classCache[pb]=a.$$element.hasClass(pb))}function be(a){function b(a,b,c){c&&!a.$$classCache[b]?(a.$$animate.addClass(a.$$element,b),a.$$classCache[b]=!0):!c&&a.$$classCache[b]&&(a.$$animate.removeClass(a.$$element,b),a.$$classCache[b]=!1)}function d(a,c,d){c=c?"-"+Vc(c,"-"):"";b(a,pb+c,!0===d);b(a,ae+c,!1===d)}var c=a.set,e=a.unset;a.clazz.prototype.$setValidity=function(a,g,k){v(g)?(this.$pending||(this.$pending={}),c(this.$pending,a,k)):(this.$pending&&e(this.$pending,
a,k),ce(this.$pending)&&(this.$pending=void 0));La(g)?g?(e(this.$error,a,k),c(this.$$success,a,k)):(c(this.$error,a,k),e(this.$$success,a,k)):(e(this.$error,a,k),e(this.$$success,a,k));this.$pending?(b(this,"ng-pending",!0),this.$valid=this.$invalid=void 0,d(this,"",null)):(b(this,"ng-pending",!1),this.$valid=ce(this.$error),this.$invalid=!this.$valid,d(this,"",this.$valid));g=this.$pending&&this.$pending[a]?void 0:this.$error[a]?!1:this.$$success[a]?!0:null;d(this,a,g);this.$$parentForm.$setValidity(a,
g,this)}}function ce(a){if(a)for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function Fc(a){a.$formatters.push(function(b){return a.$isEmpty(b)?b:b.toString()})}function Va(a,b,d,c,e,f){var g=N(b[0].type);if(!e.android){var k=!1;b.on("compositionstart",function(){k=!0});b.on("compositionend",function(){k=!1;l()})}var h,l=function(a){h&&(f.defer.cancel(h),h=null);if(!k){var e=b.val();a=a&&a.type;"password"===g||d.ngTrim&&"false"===d.ngTrim||(e=P(e));(c.$viewValue!==e||""===e&&c.$$hasNativeValidators)&&
c.$setViewValue(e,a)}};if(e.hasEvent("input"))b.on("input",l);else{var m=function(a,b,c){h||(h=f.defer(function(){h=null;b&&b.value===c||l(a)}))};b.on("keydown",function(a){var b=a.keyCode;91===b||15<b&&19>b||37<=b&&40>=b||m(a,this,this.value)});if(e.hasEvent("paste"))b.on("paste cut",m)}b.on("change",l);if(de[g]&&c.$$hasNativeValidators&&g===d.type)b.on("keydown wheel mousedown",function(a){if(!h){var b=this.validity,c=b.badInput,d=b.typeMismatch;h=f.defer(function(){h=null;b.badInput===c&&b.typeMismatch===
d||l(a)})}});c.$render=function(){var a=c.$isEmpty(c.$viewValue)?"":c.$viewValue;b.val()!==a&&b.val(a)}}function Ob(a,b){return function(d,c){var e,f;if(ia(d))return d;if(C(d)){'"'===d.charAt(0)&&'"'===d.charAt(d.length-1)&&(d=d.substring(1,d.length-1));if(Tg.test(d))return new Date(d);a.lastIndex=0;if(e=a.exec(d))return e.shift(),f=c?{yyyy:c.getFullYear(),MM:c.getMonth()+1,dd:c.getDate(),HH:c.getHours(),mm:c.getMinutes(),ss:c.getSeconds(),sss:c.getMilliseconds()/1E3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,
ss:0,sss:0},p(e,function(a,c){c<b.length&&(f[b[c]]=+a)}),new Date(f.yyyy,f.MM-1,f.dd,f.HH,f.mm,f.ss||0,1E3*f.sss||0)}return NaN}}function qb(a,b,d,c){return function(e,f,g,k,h,l,m){function n(a){return a&&!(a.getTime&&a.getTime()!==a.getTime())}function q(a){return t(a)&&!ia(a)?d(a)||void 0:a}Gc(e,f,g,k);Va(e,f,g,k,h,l);var p=k&&k.$options.getOption("timezone"),r;k.$$parserName=a;k.$parsers.push(function(a){if(k.$isEmpty(a))return null;if(b.test(a))return a=d(a,r),p&&(a=ac(a,p)),a});k.$formatters.push(function(a){if(a&&
!ia(a))throw rb("datefmt",a);if(n(a))return(r=a)&&p&&(r=ac(r,p,!0)),m("date")(a,c,p);r=null;return""});if(t(g.min)||g.ngMin){var w;k.$validators.min=function(a){return!n(a)||v(w)||d(a)>=w};g.$observe("min",function(a){w=q(a);k.$validate()})}if(t(g.max)||g.ngMax){var u;k.$validators.max=function(a){return!n(a)||v(u)||d(a)<=u};g.$observe("max",function(a){u=q(a);k.$validate()})}}}function Gc(a,b,d,c){(c.$$hasNativeValidators=G(b[0].validity))&&c.$parsers.push(function(a){var c=b.prop("validity")||{};
return c.badInput||c.typeMismatch?void 0:a})}function ee(a){a.$$parserName="number";a.$parsers.push(function(b){if(a.$isEmpty(b))return null;if(Ug.test(b))return parseFloat(b)});a.$formatters.push(function(b){if(!a.$isEmpty(b)){if(!W(b))throw rb("numfmt",b);b=b.toString()}return b})}function Wa(a){t(a)&&!W(a)&&(a=parseFloat(a));return ba(a)?void 0:a}function Hc(a){var b=a.toString(),d=b.indexOf(".");return-1===d?-1<a&&1>a&&(a=/e-(\d+)$/.exec(b))?Number(a[1]):0:b.length-d-1}function fe(a,b,d){a=Number(a);
var c=(a|0)!==a,e=(b|0)!==b,f=(d|0)!==d;if(c||e||f){var g=c?Hc(a):0,k=e?Hc(b):0,h=f?Hc(d):0,g=Math.max(g,k,h),g=Math.pow(10,g);a*=g;b*=g;d*=g;c&&(a=Math.round(a));e&&(b=Math.round(b));f&&(d=Math.round(d))}return 0===(a-b)%d}function ge(a,b,d,c,e){if(t(c)){a=a(c);if(!a.constant)throw rb("constexpr",d,c);return a(b)}return e}function Ic(a,b){function d(a,b){if(!a||!a.length)return[];if(!b||!b.length)return a;var c=[],d=0;a:for(;d<a.length;d++){for(var e=a[d],f=0;f<b.length;f++)if(e===b[f])continue a;
c.push(e)}return c}function c(a){var b=a;I(a)?b=a.map(c).join(" "):G(a)&&(b=Object.keys(a).filter(function(b){return a[b]}).join(" "));return b}function e(a){var b=a;if(I(a))b=a.map(e);else if(G(a)){var c=!1,b=Object.keys(a).filter(function(b){b=a[b];!c&&v(b)&&(c=!0);return b});c&&b.push(void 0)}return b}a="ngClass"+a;var f;return["$parse",function(g){return{restrict:"AC",link:function(k,h,l){function m(a,b){var c=[];p(a,function(a){if(0<b||A[a])A[a]=(A[a]||0)+b,A[a]===+(0<b)&&c.push(a)});return c.join(" ")}
function n(a){if(a===b){var c=s,c=m(c&&c.split(" "),1);l.$addClass(c)}else c=s,c=m(c&&c.split(" "),-1),l.$removeClass(c);v=a}function q(a){a=c(a);a!==s&&r(a)}function r(a){if(v===b){var c=s&&s.split(" "),e=a&&a.split(" "),g=d(c,e),c=d(e,c),g=m(g,-1),c=m(c,1);l.$addClass(c);l.$removeClass(g)}s=a}var t=l[a].trim(),w=":"===t.charAt(0)&&":"===t.charAt(1),t=g(t,w?e:c),u=w?q:r,A=h.data("$classCounts"),v=!0,s;A||(A=R(),h.data("$classCounts",A));"ngClass"!==a&&(f||(f=g("$index",function(a){return a&1})),
k.$watch(f,n));k.$watch(t,u,w)}}}]}function Pb(a,b,d,c,e,f,g,k,h){this.$modelValue=this.$viewValue=Number.NaN;this.$$rawModelValue=void 0;this.$validators={};this.$asyncValidators={};this.$parsers=[];this.$formatters=[];this.$viewChangeListeners=[];this.$untouched=!0;this.$touched=!1;this.$pristine=!0;this.$dirty=!1;this.$valid=!0;this.$invalid=!1;this.$error={};this.$$success={};this.$pending=void 0;this.$name=h(d.name||"",!1)(a);this.$$parentForm=Nb;this.$options=Qb;this.$$parsedNgModel=e(d.ngModel);
this.$$parsedNgModelAssign=this.$$parsedNgModel.assign;this.$$ngModelGet=this.$$parsedNgModel;this.$$ngModelSet=this.$$parsedNgModelAssign;this.$$pendingDebounce=null;this.$$parserValid=void 0;this.$$currentValidationRunId=0;Object.defineProperty(this,"$$scope",{value:a});this.$$attr=d;this.$$element=c;this.$$animate=f;this.$$timeout=g;this.$$parse=e;this.$$q=k;this.$$exceptionHandler=b;$d(this);Vg(this)}function Vg(a){a.$$scope.$watch(function(b){b=a.$$ngModelGet(b);if(b!==a.$modelValue&&(a.$modelValue===
a.$modelValue||b===b)){a.$modelValue=a.$$rawModelValue=b;a.$$parserValid=void 0;for(var d=a.$formatters,c=d.length,e=b;c--;)e=d[c](e);a.$viewValue!==e&&(a.$$updateEmptyClasses(e),a.$viewValue=a.$$lastCommittedViewValue=e,a.$render(),a.$$runValidators(a.$modelValue,a.$viewValue,B))}return b})}function Jc(a){this.$$options=a}function he(a,b){p(b,function(b,c){t(a[c])||(a[c]=b)})}function Ha(a,b){a.prop("selected",b);a.attr("selected",b)}var Lc={objectMaxDepth:5},Wg=/^\/(.+)\/([a-z]*)$/,wa=Object.prototype.hasOwnProperty,
N=function(a){return C(a)?a.toLowerCase():a},wb=function(a){return C(a)?a.toUpperCase():a},Ba,z,ta,xa=[].slice,vg=[].splice,Xg=[].push,la=Object.prototype.toString,Oc=Object.getPrototypeOf,za=K("ng"),fa=x.angular||(x.angular={}),dc,sb=0;Ba=x.document.documentMode;var ba=Number.isNaN||function(a){return a!==a};B.$inject=[];ab.$inject=[];var I=Array.isArray,te=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array]$/,P=function(a){return C(a)?a.trim():a},Nd=function(a){return a.replace(/([-()[\]{}+?*.$^|,:#<!\\])/g,
"\\$1").replace(/\x08/g,"\\x08")},Ja=function(){if(!t(Ja.rules)){var a=x.document.querySelector("[ng-csp]")||x.document.querySelector("[data-ng-csp]");if(a){var b=a.getAttribute("ng-csp")||a.getAttribute("data-ng-csp");Ja.rules={noUnsafeEval:!b||-1!==b.indexOf("no-unsafe-eval"),noInlineStyle:!b||-1!==b.indexOf("no-inline-style")}}else{a=Ja;try{new Function(""),b=!1}catch(d){b=!0}a.rules={noUnsafeEval:b,noInlineStyle:!1}}}return Ja.rules},tb=function(){if(t(tb.name_))return tb.name_;var a,b,d=Na.length,
c,e;for(b=0;b<d;++b)if(c=Na[b],a=x.document.querySelector("["+c.replace(":","\\:")+"jq]")){e=a.getAttribute(c+"jq");break}return tb.name_=e},ve=/:/g,Na=["ng-","data-ng-","ng:","x-ng-"],ye=function(a){var b=a.currentScript;if(!b)return!0;if(!(b instanceof x.HTMLScriptElement||b instanceof x.SVGScriptElement))return!1;b=b.attributes;return[b.getNamedItem("src"),b.getNamedItem("href"),b.getNamedItem("xlink:href")].every(function(b){if(!b)return!0;if(!b.value)return!1;var c=a.createElement("a");c.href=
b.value;if(a.location.origin===c.origin)return!0;switch(c.protocol){case "http:":case "https:":case "ftp:":case "blob:":case "file:":case "data:":return!0;default:return!1}})}(x.document),Be=/[A-Z]/g,Wc=!1,Ma=3,Ge={full:"1.6.5",major:1,minor:6,dot:5,codeName:"toffee-salinization"};S.expando="ng339";var jb=S.cache={},hg=1;S._data=function(a){return this.cache[a[this.expando]]||{}};var dg=/-([a-z])/g,Yg=/^-ms-/,Bb={mouseleave:"mouseout",mouseenter:"mouseover"},gc=K("jqLite"),gg=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,
fc=/<|&#?\w+;/,eg=/<([\w:-]+)/,fg=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,pa={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};pa.optgroup=pa.option;pa.tbody=pa.tfoot=pa.colgroup=pa.caption=pa.thead;pa.th=pa.td;var mg=x.Node.prototype.contains||function(a){return!!(this.compareDocumentPosition(a)&
16)},Ra=S.prototype={ready:gd,toString:function(){var a=[];p(this,function(b){a.push(""+b)});return"["+a.join(", ")+"]"},eq:function(a){return 0<=a?z(this[a]):z(this[this.length+a])},length:0,push:Xg,sort:[].sort,splice:[].splice},Hb={};p("multiple selected checked disabled readOnly required open".split(" "),function(a){Hb[N(a)]=a});var ld={};p("input select option textarea button form details".split(" "),function(a){ld[a]=!0});var td={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",
ngPattern:"pattern",ngStep:"step"};p({data:kc,removeData:jc,hasData:function(a){for(var b in jb[a.ng339])return!0;return!1},cleanData:function(a){for(var b=0,d=a.length;b<d;b++)jc(a[b])}},function(a,b){S[b]=a});p({data:kc,inheritedData:Fb,scope:function(a){return z.data(a,"$scope")||Fb(a.parentNode||a,["$isolateScope","$scope"])},isolateScope:function(a){return z.data(a,"$isolateScope")||z.data(a,"$isolateScopeNoTemplate")},controller:id,injector:function(a){return Fb(a,"$injector")},removeAttr:function(a,
b){a.removeAttribute(b)},hasClass:Cb,css:function(a,b,d){b=yb(b.replace(Yg,"ms-"));if(t(d))a.style[b]=d;else return a.style[b]},attr:function(a,b,d){var c=a.nodeType;if(c!==Ma&&2!==c&&8!==c&&a.getAttribute){var c=N(b),e=Hb[c];if(t(d))null===d||!1===d&&e?a.removeAttribute(b):a.setAttribute(b,e?c:d);else return a=a.getAttribute(b),e&&null!==a&&(a=c),null===a?void 0:a}},prop:function(a,b,d){if(t(d))a[b]=d;else return a[b]},text:function(){function a(a,d){if(v(d)){var c=a.nodeType;return 1===c||c===Ma?
a.textContent:""}a.textContent=d}a.$dv="";return a}(),val:function(a,b){if(v(b)){if(a.multiple&&"select"===ya(a)){var d=[];p(a.options,function(a){a.selected&&d.push(a.value||a.text)});return d}return a.value}a.value=b},html:function(a,b){if(v(b))return a.innerHTML;zb(a,!0);a.innerHTML=b},empty:jd},function(a,b){S.prototype[b]=function(b,c){var e,f,g=this.length;if(a!==jd&&v(2===a.length&&a!==Cb&&a!==id?b:c)){if(G(b)){for(e=0;e<g;e++)if(a===kc)a(this[e],b);else for(f in b)a(this[e],f,b[f]);return this}e=
a.$dv;g=v(e)?Math.min(g,1):g;for(f=0;f<g;f++){var k=a(this[f],b,c);e=e?e+k:k}return e}for(e=0;e<g;e++)a(this[e],b,c);return this}});p({removeData:jc,on:function(a,b,d,c){if(t(c))throw gc("onargs");if(ec(a)){c=Ab(a,!0);var e=c.events,f=c.handle;f||(f=c.handle=jg(a,e));c=0<=b.indexOf(" ")?b.split(" "):[b];for(var g=c.length,k=function(b,c,g){var k=e[b];k||(k=e[b]=[],k.specialHandlerWrapper=c,"$destroy"===b||g||a.addEventListener(b,f));k.push(d)};g--;)b=c[g],Bb[b]?(k(Bb[b],lg),k(b,void 0,!0)):k(b)}},
off:hd,one:function(a,b,d){a=z(a);a.on(b,function e(){a.off(b,d);a.off(b,e)});a.on(b,d)},replaceWith:function(a,b){var d,c=a.parentNode;zb(a);p(new S(b),function(b){d?c.insertBefore(b,d.nextSibling):c.replaceChild(b,a);d=b})},children:function(a){var b=[];p(a.childNodes,function(a){1===a.nodeType&&b.push(a)});return b},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,b){var d=a.nodeType;if(1===d||11===d){b=new S(b);for(var d=0,c=b.length;d<c;d++)a.appendChild(b[d])}},
prepend:function(a,b){if(1===a.nodeType){var d=a.firstChild;p(new S(b),function(b){a.insertBefore(b,d)})}},wrap:function(a,b){var d=z(b).eq(0).clone()[0],c=a.parentNode;c&&c.replaceChild(d,a);d.appendChild(a)},remove:Gb,detach:function(a){Gb(a,!0)},after:function(a,b){var d=a,c=a.parentNode;if(c){b=new S(b);for(var e=0,f=b.length;e<f;e++){var g=b[e];c.insertBefore(g,d.nextSibling);d=g}}},addClass:Eb,removeClass:Db,toggleClass:function(a,b,d){b&&p(b.split(" "),function(b){var e=d;v(e)&&(e=!Cb(a,b));
(e?Eb:Db)(a,b)})},parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},next:function(a){return a.nextElementSibling},find:function(a,b){return a.getElementsByTagName?a.getElementsByTagName(b):[]},clone:ic,triggerHandler:function(a,b,d){var c,e,f=b.type||b,g=Ab(a);if(g=(g=g&&g.events)&&g[f])c={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===
this.immediatePropagationStopped},stopPropagation:B,type:f,target:a},b.type&&(c=O(c,b)),b=ra(g),e=d?[c].concat(d):[c],p(b,function(b){c.isImmediatePropagationStopped()||b.apply(a,e)})}},function(a,b){S.prototype[b]=function(b,c,e){for(var f,g=0,k=this.length;g<k;g++)v(f)?(f=a(this[g],b,c,e),t(f)&&(f=z(f))):hc(f,a(this[g],b,c,e));return t(f)?f:this}});S.prototype.bind=S.prototype.on;S.prototype.unbind=S.prototype.off;var Zg=Object.create(null);md.prototype={_idx:function(a){if(a===this._lastKey)return this._lastIndex;
this._lastKey=a;return this._lastIndex=this._keys.indexOf(a)},_transformKey:function(a){return ba(a)?Zg:a},get:function(a){a=this._transformKey(a);a=this._idx(a);if(-1!==a)return this._values[a]},set:function(a,b){a=this._transformKey(a);var d=this._idx(a);-1===d&&(d=this._lastIndex=this._keys.length);this._keys[d]=a;this._values[d]=b},delete:function(a){a=this._transformKey(a);a=this._idx(a);if(-1===a)return!1;this._keys.splice(a,1);this._values.splice(a,1);this._lastKey=NaN;this._lastIndex=-1;return!0}};
var Ib=md,bg=[function(){this.$get=[function(){return Ib}]}],og=/^([^(]+?)=>/,pg=/^[^(]*\(\s*([^)]*)\)/m,$g=/,/,ah=/^\s*(_?)(\S+?)\1\s*$/,ng=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,Ka=K("$injector");gb.$$annotate=function(a,b,d){var c;if("function"===typeof a){if(!(c=a.$inject)){c=[];if(a.length){if(b)throw C(d)&&d||(d=a.name||qg(a)),Ka("strictdi",d);b=nd(a);p(b[1].split($g),function(a){a.replace(ah,function(a,b,d){c.push(d)})})}a.$inject=c}}else I(a)?(b=a.length-1,ub(a[b],"fn"),c=a.slice(0,b)):ub(a,"fn",
!0);return c};var ie=K("$animate"),tf=function(){this.$get=B},uf=function(){var a=new Ib,b=[];this.$get=["$$AnimateRunner","$rootScope",function(d,c){function e(a,b,c){var d=!1;b&&(b=C(b)?b.split(" "):I(b)?b:[],p(b,function(b){b&&(d=!0,a[b]=c)}));return d}function f(){p(b,function(b){var c=a.get(b);if(c){var d=rg(b.attr("class")),e="",f="";p(c,function(a,b){a!==!!d[b]&&(a?e+=(e.length?" ":"")+b:f+=(f.length?" ":"")+b)});p(b,function(a){e&&Eb(a,e);f&&Db(a,f)});a.delete(b)}});b.length=0}return{enabled:B,
on:B,off:B,pin:B,push:function(g,k,h,l){l&&l();h=h||{};h.from&&g.css(h.from);h.to&&g.css(h.to);if(h.addClass||h.removeClass)if(k=h.addClass,l=h.removeClass,h=a.get(g)||{},k=e(h,k,!0),l=e(h,l,!1),k||l)a.set(g,h),b.push(g),1===b.length&&c.$$postDigest(f);g=new d;g.complete();return g}}}]},rf=["$provide",function(a){var b=this,d=null,c=null;this.$$registeredAnimations=Object.create(null);this.register=function(c,d){if(c&&"."!==c.charAt(0))throw ie("notcsel",c);var g=c+"-animation";b.$$registeredAnimations[c.substr(1)]=
g;a.factory(g,d)};this.customFilter=function(a){1===arguments.length&&(c=E(a)?a:null);return c};this.classNameFilter=function(a){if(1===arguments.length&&(d=a instanceof RegExp?a:null)&&/[(\s|\/)]ng-animate[(\s|\/)]/.test(d.toString()))throw d=null,ie("nongcls","ng-animate");return d};this.$get=["$$animateQueue",function(a){function b(a,c,d){if(d){var e;a:{for(e=0;e<d.length;e++){var f=d[e];if(1===f.nodeType){e=f;break a}}e=void 0}!e||e.parentNode||e.previousElementSibling||(d=null)}d?d.after(a):
c.prepend(a)}return{on:a.on,off:a.off,pin:a.pin,enabled:a.enabled,cancel:function(a){a.end&&a.end()},enter:function(c,d,h,l){d=d&&z(d);h=h&&z(h);d=d||h.parent();b(c,d,h);return a.push(c,"enter",Ca(l))},move:function(c,d,h,l){d=d&&z(d);h=h&&z(h);d=d||h.parent();b(c,d,h);return a.push(c,"move",Ca(l))},leave:function(b,c){return a.push(b,"leave",Ca(c),function(){b.remove()})},addClass:function(b,c,d){d=Ca(d);d.addClass=kb(d.addclass,c);return a.push(b,"addClass",d)},removeClass:function(b,c,d){d=Ca(d);
d.removeClass=kb(d.removeClass,c);return a.push(b,"removeClass",d)},setClass:function(b,c,d,f){f=Ca(f);f.addClass=kb(f.addClass,c);f.removeClass=kb(f.removeClass,d);return a.push(b,"setClass",f)},animate:function(b,c,d,f,m){m=Ca(m);m.from=m.from?O(m.from,c):c;m.to=m.to?O(m.to,d):d;m.tempClasses=kb(m.tempClasses,f||"ng-inline-animate");return a.push(b,"animate",m)}}}]}],wf=function(){this.$get=["$$rAF",function(a){function b(b){d.push(b);1<d.length||a(function(){for(var a=0;a<d.length;a++)d[a]();d=
[]})}var d=[];return function(){var a=!1;b(function(){a=!0});return function(d){a?d():b(d)}}}]},vf=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$$isDocumentHidden","$timeout",function(a,b,d,c,e){function f(a){this.setHost(a);var b=d();this._doneCallbacks=[];this._tick=function(a){c()?e(a,0,!1):b(a)};this._state=0}f.chain=function(a,b){function c(){if(d===a.length)b(!0);else a[d](function(a){!1===a?b(!1):(d++,c())})}var d=0;c()};f.all=function(a,b){function c(f){e=e&&f;++d===a.length&&
b(e)}var d=0,e=!0;p(a,function(a){a.done(c)})};f.prototype={setHost:function(a){this.host=a||{}},done:function(a){2===this._state?a():this._doneCallbacks.push(a)},progress:B,getPromise:function(){if(!this.promise){var b=this;this.promise=a(function(a,c){b.done(function(b){!1===b?c():a()})})}return this.promise},then:function(a,b){return this.getPromise().then(a,b)},"catch":function(a){return this.getPromise()["catch"](a)},"finally":function(a){return this.getPromise()["finally"](a)},pause:function(){this.host.pause&&
this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end();this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel();this._resolve(!1)},complete:function(a){var b=this;0===b._state&&(b._state=1,b._tick(function(){b._resolve(a)}))},_resolve:function(a){2!==this._state&&(p(this._doneCallbacks,function(b){b(a)}),this._doneCallbacks.length=0,this._state=2)}};return f}]},sf=function(){this.$get=["$$rAF","$q","$$AnimateRunner",
function(a,b,d){return function(b,e){function f(){a(function(){g.addClass&&(b.addClass(g.addClass),g.addClass=null);g.removeClass&&(b.removeClass(g.removeClass),g.removeClass=null);g.to&&(b.css(g.to),g.to=null);k||h.complete();k=!0});return h}var g=e||{};g.$$prepared||(g=Ia(g));g.cleanupStyles&&(g.from=g.to=null);g.from&&(b.css(g.from),g.from=null);var k,h=new d;return{start:f,end:f}}}]},ga=K("$compile"),oc=new function(){};Yc.$inject=["$provide","$$sanitizeUriProvider"];Jb.prototype.isFirstChange=
function(){return this.previousValue===oc};var od=/^((?:x|data)[:\-_])/i,ug=/[:\-_]+(.)/g,vd=K("$controller"),ud=/^(\S+)(\s+as\s+([\w$]+))?$/,Df=function(){this.$get=["$document",function(a){return function(b){b?!b.nodeType&&b instanceof z&&(b=b[0]):b=a[0].body;return b.offsetWidth+1}}]},wd="application/json",sc={"Content-Type":wd+";charset=utf-8"},xg=/^\[|^\{(?!\{)/,yg={"[":/]$/,"{":/}$/},wg=/^\)]\}',?\n/,rc=K("$http"),Fa=fa.$interpolateMinErr=K("$interpolate");Fa.throwNoconcat=function(a){throw Fa("noconcat",
a);};Fa.interr=function(a,b){return Fa("interr",a,b.toString())};var Lf=function(){this.$get=function(){function a(a){var b=function(a){b.data=a;b.called=!0};b.id=a;return b}var b=fa.callbacks,d={};return{createCallback:function(c){c="_"+(b.$$counter++).toString(36);var e="angular.callbacks."+c,f=a(c);d[e]=b[c]=f;return e},wasCalled:function(a){return d[a].called},getResponse:function(a){return d[a].data},removeCallback:function(a){delete b[d[a].id];delete d[a]}}}},bh=/^([^?#]*)(\?([^#]*))?(#(.*))?$/,
Ag={http:80,https:443,ftp:21},mb=K("$location"),Bg=/^\s*[\\/]{2,}/,ch={$$absUrl:"",$$html5:!1,$$replace:!1,absUrl:Kb("$$absUrl"),url:function(a){if(v(a))return this.$$url;var b=bh.exec(a);(b[1]||""===a)&&this.path(decodeURIComponent(b[1]));(b[2]||b[1]||""===a)&&this.search(b[3]||"");this.hash(b[5]||"");return this},protocol:Kb("$$protocol"),host:Kb("$$host"),port:Kb("$$port"),path:Ed("$$path",function(a){a=null!==a?a.toString():"";return"/"===a.charAt(0)?a:"/"+a}),search:function(a,b){switch(arguments.length){case 0:return this.$$search;
case 1:if(C(a)||W(a))a=a.toString(),this.$$search=Tc(a);else if(G(a))a=Ia(a,{}),p(a,function(b,c){null==b&&delete a[c]}),this.$$search=a;else throw mb("isrcharg");break;default:v(b)||null===b?delete this.$$search[a]:this.$$search[a]=b}this.$$compose();return this},hash:Ed("$$hash",function(a){return null!==a?a.toString():""}),replace:function(){this.$$replace=!0;return this}};p([Dd,wc,vc],function(a){a.prototype=Object.create(ch);a.prototype.state=function(b){if(!arguments.length)return this.$$state;
if(a!==vc||!this.$$html5)throw mb("nostate");this.$$state=v(b)?null:b;this.$$urlUpdatedByLocation=!0;return this}});var Xa=K("$parse"),Fg={}.constructor.prototype.valueOf,Rb=R();p("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(a){Rb[a]=!0});var dh={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},zc=function(a){this.options=a};zc.prototype={constructor:zc,lex:function(a){this.text=a;this.index=0;for(this.tokens=[];this.index<this.text.length;)if(a=this.text.charAt(this.index),
'"'===a||"'"===a)this.readString(a);else if(this.isNumber(a)||"."===a&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(a,"(){}[].,;:?"))this.tokens.push({index:this.index,text:a}),this.index++;else if(this.isWhitespace(a))this.index++;else{var b=a+this.peek(),d=b+this.peek(2),c=Rb[b],e=Rb[d];Rb[a]||c||e?(a=e?d:c?b:a,this.tokens.push({index:this.index,text:a,operator:!0}),this.index+=a.length):this.throwError("Unexpected next character ",
this.index,this.index+1)}return this.tokens},is:function(a,b){return-1!==b.indexOf(a)},peek:function(a){a=a||1;return this.index+a<this.text.length?this.text.charAt(this.index+a):!1},isNumber:function(a){return"0"<=a&&"9">=a&&"string"===typeof a},isWhitespace:function(a){return" "===a||"\r"===a||"\t"===a||"\n"===a||"\v"===a||"\u00a0"===a},isIdentifierStart:function(a){return this.options.isIdentifierStart?this.options.isIdentifierStart(a,this.codePointAt(a)):this.isValidIdentifierStart(a)},isValidIdentifierStart:function(a){return"a"<=
a&&"z">=a||"A"<=a&&"Z">=a||"_"===a||"$"===a},isIdentifierContinue:function(a){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(a,this.codePointAt(a)):this.isValidIdentifierContinue(a)},isValidIdentifierContinue:function(a,b){return this.isValidIdentifierStart(a,b)||this.isNumber(a)},codePointAt:function(a){return 1===a.length?a.charCodeAt(0):(a.charCodeAt(0)<<10)+a.charCodeAt(1)-56613888},peekMultichar:function(){var a=this.text.charAt(this.index),b=this.peek();if(!b)return a;
var d=a.charCodeAt(0),c=b.charCodeAt(0);return 55296<=d&&56319>=d&&56320<=c&&57343>=c?a+b:a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,b,d){d=d||this.index;b=t(b)?"s "+b+"-"+this.index+" ["+this.text.substring(b,d)+"]":" "+d;throw Xa("lexerr",a,b,this.text);},readNumber:function(){for(var a="",b=this.index;this.index<this.text.length;){var d=N(this.text.charAt(this.index));if("."===d||this.isNumber(d))a+=d;else{var c=this.peek();if("e"===d&&this.isExpOperator(c))a+=
d;else if(this.isExpOperator(d)&&c&&this.isNumber(c)&&"e"===a.charAt(a.length-1))a+=d;else if(!this.isExpOperator(d)||c&&this.isNumber(c)||"e"!==a.charAt(a.length-1))break;else this.throwError("Invalid exponent")}this.index++}this.tokens.push({index:b,text:a,constant:!0,value:Number(a)})},readIdent:function(){var a=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var b=this.peekMultichar();if(!this.isIdentifierContinue(b))break;this.index+=b.length}this.tokens.push({index:a,
text:this.text.slice(a,this.index),identifier:!0})},readString:function(a){var b=this.index;this.index++;for(var d="",c=a,e=!1;this.index<this.text.length;){var f=this.text.charAt(this.index),c=c+f;if(e)"u"===f?(e=this.text.substring(this.index+1,this.index+5),e.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+e+"]"),this.index+=4,d+=String.fromCharCode(parseInt(e,16))):d+=dh[f]||f,e=!1;else if("\\"===f)e=!0;else{if(f===a){this.index++;this.tokens.push({index:b,text:c,constant:!0,
value:d});return}d+=f}this.index++}this.throwError("Unterminated quote",b)}};var r=function(a,b){this.lexer=a;this.options=b};r.Program="Program";r.ExpressionStatement="ExpressionStatement";r.AssignmentExpression="AssignmentExpression";r.ConditionalExpression="ConditionalExpression";r.LogicalExpression="LogicalExpression";r.BinaryExpression="BinaryExpression";r.UnaryExpression="UnaryExpression";r.CallExpression="CallExpression";r.MemberExpression="MemberExpression";r.Identifier="Identifier";r.Literal=
"Literal";r.ArrayExpression="ArrayExpression";r.Property="Property";r.ObjectExpression="ObjectExpression";r.ThisExpression="ThisExpression";r.LocalsExpression="LocalsExpression";r.NGValueParameter="NGValueParameter";r.prototype={ast:function(a){this.text=a;this.tokens=this.lexer.lex(a);a=this.program();0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]);return a},program:function(){for(var a=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&a.push(this.expressionStatement()),
!this.expect(";"))return{type:r.Program,body:a}},expressionStatement:function(){return{type:r.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var a=this.expression();this.expect("|");)a=this.filter(a);return a},expression:function(){return this.assignment()},assignment:function(){var a=this.ternary();if(this.expect("=")){if(!Id(a))throw Xa("lval");a={type:r.AssignmentExpression,left:a,right:this.assignment(),operator:"="}}return a},ternary:function(){var a=this.logicalOR(),
b,d;return this.expect("?")&&(b=this.expression(),this.consume(":"))?(d=this.expression(),{type:r.ConditionalExpression,test:a,alternate:b,consequent:d}):a},logicalOR:function(){for(var a=this.logicalAND();this.expect("||");)a={type:r.LogicalExpression,operator:"||",left:a,right:this.logicalAND()};return a},logicalAND:function(){for(var a=this.equality();this.expect("&&");)a={type:r.LogicalExpression,operator:"&&",left:a,right:this.equality()};return a},equality:function(){for(var a=this.relational(),
b;b=this.expect("==","!=","===","!==");)a={type:r.BinaryExpression,operator:b.text,left:a,right:this.relational()};return a},relational:function(){for(var a=this.additive(),b;b=this.expect("<",">","<=",">=");)a={type:r.BinaryExpression,operator:b.text,left:a,right:this.additive()};return a},additive:function(){for(var a=this.multiplicative(),b;b=this.expect("+","-");)a={type:r.BinaryExpression,operator:b.text,left:a,right:this.multiplicative()};return a},multiplicative:function(){for(var a=this.unary(),
b;b=this.expect("*","/","%");)a={type:r.BinaryExpression,operator:b.text,left:a,right:this.unary()};return a},unary:function(){var a;return(a=this.expect("+","-","!"))?{type:r.UnaryExpression,operator:a.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var a;this.expect("(")?(a=this.filterChain(),this.consume(")")):this.expect("[")?a=this.arrayDeclaration():this.expect("{")?a=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?a=Ia(this.selfReferential[this.consume().text]):
this.options.literals.hasOwnProperty(this.peek().text)?a={type:r.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?a=this.identifier():this.peek().constant?a=this.constant():this.throwError("not a primary expression",this.peek());for(var b;b=this.expect("(","[",".");)"("===b.text?(a={type:r.CallExpression,callee:a,arguments:this.parseArguments()},this.consume(")")):"["===b.text?(a={type:r.MemberExpression,object:a,property:this.expression(),computed:!0},this.consume("]")):
"."===b.text?a={type:r.MemberExpression,object:a,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return a},filter:function(a){a=[a];for(var b={type:r.CallExpression,callee:this.identifier(),arguments:a,filter:!0};this.expect(":");)a.push(this.expression());return b},parseArguments:function(){var a=[];if(")"!==this.peekToken().text){do a.push(this.filterChain());while(this.expect(","))}return a},identifier:function(){var a=this.consume();a.identifier||this.throwError("is not a valid identifier",
a);return{type:r.Identifier,name:a.text}},constant:function(){return{type:r.Literal,value:this.consume().value}},arrayDeclaration:function(){var a=[];if("]"!==this.peekToken().text){do{if(this.peek("]"))break;a.push(this.expression())}while(this.expect(","))}this.consume("]");return{type:r.ArrayExpression,elements:a}},object:function(){var a=[],b;if("}"!==this.peekToken().text){do{if(this.peek("}"))break;b={type:r.Property,kind:"init"};this.peek().constant?(b.key=this.constant(),b.computed=!1,this.consume(":"),
b.value=this.expression()):this.peek().identifier?(b.key=this.identifier(),b.computed=!1,this.peek(":")?(this.consume(":"),b.value=this.expression()):b.value=b.key):this.peek("[")?(this.consume("["),b.key=this.expression(),this.consume("]"),b.computed=!0,this.consume(":"),b.value=this.expression()):this.throwError("invalid key",this.peek());a.push(b)}while(this.expect(","))}this.consume("}");return{type:r.ObjectExpression,properties:a}},throwError:function(a,b){throw Xa("syntax",b.text,a,b.index+
1,this.text,this.text.substring(b.index));},consume:function(a){if(0===this.tokens.length)throw Xa("ueoe",this.text);var b=this.expect(a);b||this.throwError("is unexpected, expecting ["+a+"]",this.peek());return b},peekToken:function(){if(0===this.tokens.length)throw Xa("ueoe",this.text);return this.tokens[0]},peek:function(a,b,d,c){return this.peekAhead(0,a,b,d,c)},peekAhead:function(a,b,d,c,e){if(this.tokens.length>a){a=this.tokens[a];var f=a.text;if(f===b||f===d||f===c||f===e||!(b||d||c||e))return a}return!1},
expect:function(a,b,d,c){return(a=this.peek(a,b,d,c))?(this.tokens.shift(),a):!1},selfReferential:{"this":{type:r.ThisExpression},$locals:{type:r.LocalsExpression}}};var Gd=2;Kd.prototype={compile:function(a){var b=this;this.state={nextId:0,filters:{},fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]};X(a,b.$filter);var d="",c;this.stage="assign";if(c=Jd(a))this.state.computing="assign",d=this.nextId(),this.recurse(c,d),this.return_(d),d="fn.assign="+this.generateFunction("assign",
"s,v,l");c=Hd(a.body);b.stage="inputs";p(c,function(a,c){var d="fn"+c;b.state[d]={vars:[],body:[],own:{}};b.state.computing=d;var k=b.nextId();b.recurse(a,k);b.return_(k);b.state.inputs.push({name:d,isPure:a.isPure});a.watchId=c});this.state.computing="fn";this.stage="main";this.recurse(a);a='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+d+this.watchFns()+"return fn;";a=(new Function("$filter","getStringValue","ifDefined","plus",a))(this.$filter,
Cg,Dg,Fd);this.state=this.stage=void 0;return a},USE:"use",STRICT:"strict",watchFns:function(){var a=[],b=this.state.inputs,d=this;p(b,function(b){a.push("var "+b.name+"="+d.generateFunction(b.name,"s"));b.isPure&&a.push(b.name,".isPure="+JSON.stringify(b.isPure)+";")});b.length&&a.push("fn.inputs=["+b.map(function(a){return a.name}).join(",")+"];");return a.join("")},generateFunction:function(a,b){return"function("+b+"){"+this.varsPrefix(a)+this.body(a)+"};"},filterPrefix:function(){var a=[],b=this;
p(this.state.filters,function(d,c){a.push(d+"=$filter("+b.escape(c)+")")});return a.length?"var "+a.join(",")+";":""},varsPrefix:function(a){return this.state[a].vars.length?"var "+this.state[a].vars.join(",")+";":""},body:function(a){return this.state[a].body.join("")},recurse:function(a,b,d,c,e,f){var g,k,h=this,l,m,n;c=c||B;if(!f&&t(a.watchId))b=b||this.nextId(),this.if_("i",this.lazyAssign(b,this.computedMember("i",a.watchId)),this.lazyRecurse(a,b,d,c,e,!0));else switch(a.type){case r.Program:p(a.body,
function(b,c){h.recurse(b.expression,void 0,void 0,function(a){k=a});c!==a.body.length-1?h.current().body.push(k,";"):h.return_(k)});break;case r.Literal:m=this.escape(a.value);this.assign(b,m);c(b||m);break;case r.UnaryExpression:this.recurse(a.argument,void 0,void 0,function(a){k=a});m=a.operator+"("+this.ifDefined(k,0)+")";this.assign(b,m);c(m);break;case r.BinaryExpression:this.recurse(a.left,void 0,void 0,function(a){g=a});this.recurse(a.right,void 0,void 0,function(a){k=a});m="+"===a.operator?
this.plus(g,k):"-"===a.operator?this.ifDefined(g,0)+a.operator+this.ifDefined(k,0):"("+g+")"+a.operator+"("+k+")";this.assign(b,m);c(m);break;case r.LogicalExpression:b=b||this.nextId();h.recurse(a.left,b);h.if_("&&"===a.operator?b:h.not(b),h.lazyRecurse(a.right,b));c(b);break;case r.ConditionalExpression:b=b||this.nextId();h.recurse(a.test,b);h.if_(b,h.lazyRecurse(a.alternate,b),h.lazyRecurse(a.consequent,b));c(b);break;case r.Identifier:b=b||this.nextId();d&&(d.context="inputs"===h.stage?"s":this.assign(this.nextId(),
this.getHasOwnProperty("l",a.name)+"?l:s"),d.computed=!1,d.name=a.name);h.if_("inputs"===h.stage||h.not(h.getHasOwnProperty("l",a.name)),function(){h.if_("inputs"===h.stage||"s",function(){e&&1!==e&&h.if_(h.isNull(h.nonComputedMember("s",a.name)),h.lazyAssign(h.nonComputedMember("s",a.name),"{}"));h.assign(b,h.nonComputedMember("s",a.name))})},b&&h.lazyAssign(b,h.nonComputedMember("l",a.name)));c(b);break;case r.MemberExpression:g=d&&(d.context=this.nextId())||this.nextId();b=b||this.nextId();h.recurse(a.object,
g,void 0,function(){h.if_(h.notNull(g),function(){a.computed?(k=h.nextId(),h.recurse(a.property,k),h.getStringValue(k),e&&1!==e&&h.if_(h.not(h.computedMember(g,k)),h.lazyAssign(h.computedMember(g,k),"{}")),m=h.computedMember(g,k),h.assign(b,m),d&&(d.computed=!0,d.name=k)):(e&&1!==e&&h.if_(h.isNull(h.nonComputedMember(g,a.property.name)),h.lazyAssign(h.nonComputedMember(g,a.property.name),"{}")),m=h.nonComputedMember(g,a.property.name),h.assign(b,m),d&&(d.computed=!1,d.name=a.property.name))},function(){h.assign(b,
"undefined")});c(b)},!!e);break;case r.CallExpression:b=b||this.nextId();a.filter?(k=h.filter(a.callee.name),l=[],p(a.arguments,function(a){var b=h.nextId();h.recurse(a,b);l.push(b)}),m=k+"("+l.join(",")+")",h.assign(b,m),c(b)):(k=h.nextId(),g={},l=[],h.recurse(a.callee,k,g,function(){h.if_(h.notNull(k),function(){p(a.arguments,function(b){h.recurse(b,a.constant?void 0:h.nextId(),void 0,function(a){l.push(a)})});m=g.name?h.member(g.context,g.name,g.computed)+"("+l.join(",")+")":k+"("+l.join(",")+
")";h.assign(b,m)},function(){h.assign(b,"undefined")});c(b)}));break;case r.AssignmentExpression:k=this.nextId();g={};this.recurse(a.left,void 0,g,function(){h.if_(h.notNull(g.context),function(){h.recurse(a.right,k);m=h.member(g.context,g.name,g.computed)+a.operator+k;h.assign(b,m);c(b||m)})},1);break;case r.ArrayExpression:l=[];p(a.elements,function(b){h.recurse(b,a.constant?void 0:h.nextId(),void 0,function(a){l.push(a)})});m="["+l.join(",")+"]";this.assign(b,m);c(b||m);break;case r.ObjectExpression:l=
[];n=!1;p(a.properties,function(a){a.computed&&(n=!0)});n?(b=b||this.nextId(),this.assign(b,"{}"),p(a.properties,function(a){a.computed?(g=h.nextId(),h.recurse(a.key,g)):g=a.key.type===r.Identifier?a.key.name:""+a.key.value;k=h.nextId();h.recurse(a.value,k);h.assign(h.member(b,g,a.computed),k)})):(p(a.properties,function(b){h.recurse(b.value,a.constant?void 0:h.nextId(),void 0,function(a){l.push(h.escape(b.key.type===r.Identifier?b.key.name:""+b.key.value)+":"+a)})}),m="{"+l.join(",")+"}",this.assign(b,
m));c(b||m);break;case r.ThisExpression:this.assign(b,"s");c(b||"s");break;case r.LocalsExpression:this.assign(b,"l");c(b||"l");break;case r.NGValueParameter:this.assign(b,"v"),c(b||"v")}},getHasOwnProperty:function(a,b){var d=a+"."+b,c=this.current().own;c.hasOwnProperty(d)||(c[d]=this.nextId(!1,a+"&&("+this.escape(b)+" in "+a+")"));return c[d]},assign:function(a,b){if(a)return this.current().body.push(a,"=",b,";"),a},filter:function(a){this.state.filters.hasOwnProperty(a)||(this.state.filters[a]=
this.nextId(!0));return this.state.filters[a]},ifDefined:function(a,b){return"ifDefined("+a+","+this.escape(b)+")"},plus:function(a,b){return"plus("+a+","+b+")"},return_:function(a){this.current().body.push("return ",a,";")},if_:function(a,b,d){if(!0===a)b();else{var c=this.current().body;c.push("if(",a,"){");b();c.push("}");d&&(c.push("else{"),d(),c.push("}"))}},not:function(a){return"!("+a+")"},isNull:function(a){return a+"==null"},notNull:function(a){return a+"!=null"},nonComputedMember:function(a,
b){var d=/[^$_a-zA-Z0-9]/g;return/^[$_a-zA-Z][$_a-zA-Z0-9]*$/.test(b)?a+"."+b:a+'["'+b.replace(d,this.stringEscapeFn)+'"]'},computedMember:function(a,b){return a+"["+b+"]"},member:function(a,b,d){return d?this.computedMember(a,b):this.nonComputedMember(a,b)},getStringValue:function(a){this.assign(a,"getStringValue("+a+")")},lazyRecurse:function(a,b,d,c,e,f){var g=this;return function(){g.recurse(a,b,d,c,e,f)}},lazyAssign:function(a,b){var d=this;return function(){d.assign(a,b)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,
stringEscapeFn:function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)},escape:function(a){if(C(a))return"'"+a.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(W(a))return a.toString();if(!0===a)return"true";if(!1===a)return"false";if(null===a)return"null";if("undefined"===typeof a)return"undefined";throw Xa("esc");},nextId:function(a,b){var d="v"+this.state.nextId++;a||this.current().vars.push(d+(b?"="+b:""));return d},current:function(){return this.state[this.state.computing]}};
Ld.prototype={compile:function(a){var b=this;X(a,b.$filter);var d,c;if(d=Jd(a))c=this.recurse(d);d=Hd(a.body);var e;d&&(e=[],p(d,function(a,c){var d=b.recurse(a);d.isPure=a.isPure;a.input=d;e.push(d);a.watchId=c}));var f=[];p(a.body,function(a){f.push(b.recurse(a.expression))});a=0===a.body.length?B:1===a.body.length?f[0]:function(a,b){var c;p(f,function(d){c=d(a,b)});return c};c&&(a.assign=function(a,b,d){return c(a,d,b)});e&&(a.inputs=e);return a},recurse:function(a,b,d){var c,e,f=this,g;if(a.input)return this.inputs(a.input,
a.watchId);switch(a.type){case r.Literal:return this.value(a.value,b);case r.UnaryExpression:return e=this.recurse(a.argument),this["unary"+a.operator](e,b);case r.BinaryExpression:return c=this.recurse(a.left),e=this.recurse(a.right),this["binary"+a.operator](c,e,b);case r.LogicalExpression:return c=this.recurse(a.left),e=this.recurse(a.right),this["binary"+a.operator](c,e,b);case r.ConditionalExpression:return this["ternary?:"](this.recurse(a.test),this.recurse(a.alternate),this.recurse(a.consequent),
b);case r.Identifier:return f.identifier(a.name,b,d);case r.MemberExpression:return c=this.recurse(a.object,!1,!!d),a.computed||(e=a.property.name),a.computed&&(e=this.recurse(a.property)),a.computed?this.computedMember(c,e,b,d):this.nonComputedMember(c,e,b,d);case r.CallExpression:return g=[],p(a.arguments,function(a){g.push(f.recurse(a))}),a.filter&&(e=this.$filter(a.callee.name)),a.filter||(e=this.recurse(a.callee,!0)),a.filter?function(a,c,d,f){for(var n=[],q=0;q<g.length;++q)n.push(g[q](a,c,
d,f));a=e.apply(void 0,n,f);return b?{context:void 0,name:void 0,value:a}:a}:function(a,c,d,f){var n=e(a,c,d,f),q;if(null!=n.value){q=[];for(var p=0;p<g.length;++p)q.push(g[p](a,c,d,f));q=n.value.apply(n.context,q)}return b?{value:q}:q};case r.AssignmentExpression:return c=this.recurse(a.left,!0,1),e=this.recurse(a.right),function(a,d,f,g){var n=c(a,d,f,g);a=e(a,d,f,g);n.context[n.name]=a;return b?{value:a}:a};case r.ArrayExpression:return g=[],p(a.elements,function(a){g.push(f.recurse(a))}),function(a,
c,d,e){for(var f=[],q=0;q<g.length;++q)f.push(g[q](a,c,d,e));return b?{value:f}:f};case r.ObjectExpression:return g=[],p(a.properties,function(a){a.computed?g.push({key:f.recurse(a.key),computed:!0,value:f.recurse(a.value)}):g.push({key:a.key.type===r.Identifier?a.key.name:""+a.key.value,computed:!1,value:f.recurse(a.value)})}),function(a,c,d,e){for(var f={},q=0;q<g.length;++q)g[q].computed?f[g[q].key(a,c,d,e)]=g[q].value(a,c,d,e):f[g[q].key]=g[q].value(a,c,d,e);return b?{value:f}:f};case r.ThisExpression:return function(a){return b?
{value:a}:a};case r.LocalsExpression:return function(a,c){return b?{value:c}:c};case r.NGValueParameter:return function(a,c,d){return b?{value:d}:d}}},"unary+":function(a,b){return function(d,c,e,f){d=a(d,c,e,f);d=t(d)?+d:0;return b?{value:d}:d}},"unary-":function(a,b){return function(d,c,e,f){d=a(d,c,e,f);d=t(d)?-d:-0;return b?{value:d}:d}},"unary!":function(a,b){return function(d,c,e,f){d=!a(d,c,e,f);return b?{value:d}:d}},"binary+":function(a,b,d){return function(c,e,f,g){var k=a(c,e,f,g);c=b(c,
e,f,g);k=Fd(k,c);return d?{value:k}:k}},"binary-":function(a,b,d){return function(c,e,f,g){var k=a(c,e,f,g);c=b(c,e,f,g);k=(t(k)?k:0)-(t(c)?c:0);return d?{value:k}:k}},"binary*":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)*b(c,e,f,g);return d?{value:c}:c}},"binary/":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)/b(c,e,f,g);return d?{value:c}:c}},"binary%":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)%b(c,e,f,g);return d?{value:c}:c}},"binary===":function(a,b,d){return function(c,
e,f,g){c=a(c,e,f,g)===b(c,e,f,g);return d?{value:c}:c}},"binary!==":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)!==b(c,e,f,g);return d?{value:c}:c}},"binary==":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)==b(c,e,f,g);return d?{value:c}:c}},"binary!=":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)!=b(c,e,f,g);return d?{value:c}:c}},"binary<":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)<b(c,e,f,g);return d?{value:c}:c}},"binary>":function(a,b,d){return function(c,e,
f,g){c=a(c,e,f,g)>b(c,e,f,g);return d?{value:c}:c}},"binary<=":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)<=b(c,e,f,g);return d?{value:c}:c}},"binary>=":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)>=b(c,e,f,g);return d?{value:c}:c}},"binary&&":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)&&b(c,e,f,g);return d?{value:c}:c}},"binary||":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)||b(c,e,f,g);return d?{value:c}:c}},"ternary?:":function(a,b,d,c){return function(e,f,
g,k){e=a(e,f,g,k)?b(e,f,g,k):d(e,f,g,k);return c?{value:e}:e}},value:function(a,b){return function(){return b?{context:void 0,name:void 0,value:a}:a}},identifier:function(a,b,d){return function(c,e,f,g){c=e&&a in e?e:c;d&&1!==d&&c&&null==c[a]&&(c[a]={});e=c?c[a]:void 0;return b?{context:c,name:a,value:e}:e}},computedMember:function(a,b,d,c){return function(e,f,g,k){var h=a(e,f,g,k),l,m;null!=h&&(l=b(e,f,g,k),l+="",c&&1!==c&&h&&!h[l]&&(h[l]={}),m=h[l]);return d?{context:h,name:l,value:m}:m}},nonComputedMember:function(a,
b,d,c){return function(e,f,g,k){e=a(e,f,g,k);c&&1!==c&&e&&null==e[b]&&(e[b]={});f=null!=e?e[b]:void 0;return d?{context:e,name:b,value:f}:f}},inputs:function(a,b){return function(d,c,e,f){return f?f[b]:a(d,c,e)}}};xc.prototype={constructor:xc,parse:function(a){a=this.ast.ast(a);var b=this.astCompiler.compile(a);b.literal=0===a.body.length||1===a.body.length&&(a.body[0].expression.type===r.Literal||a.body[0].expression.type===r.ArrayExpression||a.body[0].expression.type===r.ObjectExpression);b.constant=
a.constant;return b}};var qa=K("$sce"),ka={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},Ac=/_([a-z])/g,Hg=K("$compile"),ea=x.document.createElement("a"),Pd=ua(x.location.href);Qd.$inject=["$document"];ed.$inject=["$provide"];var Xd=22,Wd=".",Cc="0";Rd.$inject=["$locale"];Td.$inject=["$locale"];var Sg={yyyy:$("FullYear",4,0,!1,!0),yy:$("FullYear",2,0,!0,!0),y:$("FullYear",1,0,!1,!0),MMMM:ob("Month"),MMM:ob("Month",!0),MM:$("Month",2,1),M:$("Month",1,1),LLLL:ob("Month",!1,!0),
dd:$("Date",2),d:$("Date",1),HH:$("Hours",2),H:$("Hours",1),hh:$("Hours",2,-12),h:$("Hours",1,-12),mm:$("Minutes",2),m:$("Minutes",1),ss:$("Seconds",2),s:$("Seconds",1),sss:$("Milliseconds",3),EEEE:ob("Day"),EEE:ob("Day",!0),a:function(a,b){return 12>a.getHours()?b.AMPMS[0]:b.AMPMS[1]},Z:function(a,b,d){a=-1*d;return a=(0<=a?"+":"")+(Lb(Math[0<a?"floor":"ceil"](a/60),2)+Lb(Math.abs(a%60),2))},ww:Zd(2),w:Zd(1),G:Dc,GG:Dc,GGG:Dc,GGGG:function(a,b){return 0>=a.getFullYear()?b.ERANAMES[0]:b.ERANAMES[1]}},
Rg=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))([\s\S]*)/,Qg=/^-?\d+$/;Sd.$inject=["$locale"];var Lg=aa(N),Mg=aa(wb);Ud.$inject=["$parse"];var Ie=aa({restrict:"E",compile:function(a,b){if(!b.href&&!b.xlinkHref)return function(a,b){if("a"===b[0].nodeName.toLowerCase()){var e="[object SVGAnimatedString]"===la.call(b.prop("href"))?"xlink:href":"href";b.on("click",function(a){b.attr(e)||a.preventDefault()})}}}}),xb={};p(Hb,function(a,b){function d(a,d,e){a.$watch(e[c],
function(a){e.$set(b,!!a)})}if("multiple"!==a){var c=Ea("ng-"+b),e=d;"checked"===a&&(e=function(a,b,e){e.ngModel!==e[c]&&d(a,b,e)});xb[c]=function(){return{restrict:"A",priority:100,link:e}}}});p(td,function(a,b){xb[b]=function(){return{priority:100,link:function(a,c,e){if("ngPattern"===b&&"/"===e.ngPattern.charAt(0)&&(c=e.ngPattern.match(Wg))){e.$set("ngPattern",new RegExp(c[1],c[2]));return}a.$watch(e[b],function(a){e.$set(b,a)})}}}});p(["src","srcset","href"],function(a){var b=Ea("ng-"+a);xb[b]=
function(){return{priority:99,link:function(d,c,e){var f=a,g=a;"href"===a&&"[object SVGAnimatedString]"===la.call(c.prop("href"))&&(g="xlinkHref",e.$attr[g]="xlink:href",f=null);e.$observe(b,function(b){b?(e.$set(g,b),Ba&&f&&c.prop(f,e[g])):"href"===a&&e.$set(g,null)})}}}});var Nb={$addControl:B,$$renameControl:function(a,b){a.$name=b},$removeControl:B,$setValidity:B,$setDirty:B,$setPristine:B,$setSubmitted:B};Mb.$inject=["$element","$attrs","$scope","$animate","$interpolate"];Mb.prototype={$rollbackViewValue:function(){p(this.$$controls,
function(a){a.$rollbackViewValue()})},$commitViewValue:function(){p(this.$$controls,function(a){a.$commitViewValue()})},$addControl:function(a){Oa(a.$name,"input");this.$$controls.push(a);a.$name&&(this[a.$name]=a);a.$$parentForm=this},$$renameControl:function(a,b){var d=a.$name;this[d]===a&&delete this[d];this[b]=a;a.$name=b},$removeControl:function(a){a.$name&&this[a.$name]===a&&delete this[a.$name];p(this.$pending,function(b,d){this.$setValidity(d,null,a)},this);p(this.$error,function(b,d){this.$setValidity(d,
null,a)},this);p(this.$$success,function(b,d){this.$setValidity(d,null,a)},this);cb(this.$$controls,a);a.$$parentForm=Nb},$setDirty:function(){this.$$animate.removeClass(this.$$element,Ya);this.$$animate.addClass(this.$$element,Sb);this.$dirty=!0;this.$pristine=!1;this.$$parentForm.$setDirty()},$setPristine:function(){this.$$animate.setClass(this.$$element,Ya,Sb+" ng-submitted");this.$dirty=!1;this.$pristine=!0;this.$submitted=!1;p(this.$$controls,function(a){a.$setPristine()})},$setUntouched:function(){p(this.$$controls,
function(a){a.$setUntouched()})},$setSubmitted:function(){this.$$animate.addClass(this.$$element,"ng-submitted");this.$submitted=!0;this.$$parentForm.$setSubmitted()}};be({clazz:Mb,set:function(a,b,d){var c=a[b];c?-1===c.indexOf(d)&&c.push(d):a[b]=[d]},unset:function(a,b,d){var c=a[b];c&&(cb(c,d),0===c.length&&delete a[b])}});var je=function(a){return["$timeout","$parse",function(b,d){function c(a){return""===a?d('this[""]').assign:d(a).assign||B}return{name:"form",restrict:a?"EAC":"E",require:["form",
"^^?form"],controller:Mb,compile:function(d,f){d.addClass(Ya).addClass(pb);var g=f.name?"name":a&&f.ngForm?"ngForm":!1;return{pre:function(a,d,e,f){var n=f[0];if(!("action"in e)){var q=function(b){a.$apply(function(){n.$commitViewValue();n.$setSubmitted()});b.preventDefault()};d[0].addEventListener("submit",q);d.on("$destroy",function(){b(function(){d[0].removeEventListener("submit",q)},0,!1)})}(f[1]||n.$$parentForm).$addControl(n);var p=g?c(n.$name):B;g&&(p(a,n),e.$observe(g,function(b){n.$name!==
b&&(p(a,void 0),n.$$parentForm.$$renameControl(n,b),p=c(n.$name),p(a,n))}));d.on("$destroy",function(){n.$$parentForm.$removeControl(n);p(a,void 0);O(n,Nb)})}}}}}]},Je=je(),Ve=je(!0),Tg=/^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,eh=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,fh=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,
Ug=/^\s*(-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,ke=/^(\d{4,})-(\d{2})-(\d{2})$/,le=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Kc=/^(\d{4,})-W(\d\d)$/,me=/^(\d{4,})-(\d\d)$/,ne=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,de=R();p(["date","datetime-local","month","time","week"],function(a){de[a]=!0});var oe={text:function(a,b,d,c,e,f){Va(a,b,d,c,e,f);Fc(c)},date:qb("date",ke,Ob(ke,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":qb("datetimelocal",le,Ob(le,"yyyy MM dd HH mm ss sss".split(" ")),
"yyyy-MM-ddTHH:mm:ss.sss"),time:qb("time",ne,Ob(ne,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:qb("week",Kc,function(a,b){if(ia(a))return a;if(C(a)){Kc.lastIndex=0;var d=Kc.exec(a);if(d){var c=+d[1],e=+d[2],f=d=0,g=0,k=0,h=Yd(c),e=7*(e-1);b&&(d=b.getHours(),f=b.getMinutes(),g=b.getSeconds(),k=b.getMilliseconds());return new Date(c,0,h.getDate()+e,d,f,g,k)}}return NaN},"yyyy-Www"),month:qb("month",me,Ob(me,["yyyy","MM"]),"yyyy-MM"),number:function(a,b,d,c,e,f){Gc(a,b,d,c);ee(c);Va(a,b,d,c,e,f);var g,
k;if(t(d.min)||d.ngMin)c.$validators.min=function(a){return c.$isEmpty(a)||v(g)||a>=g},d.$observe("min",function(a){g=Wa(a);c.$validate()});if(t(d.max)||d.ngMax)c.$validators.max=function(a){return c.$isEmpty(a)||v(k)||a<=k},d.$observe("max",function(a){k=Wa(a);c.$validate()});if(t(d.step)||d.ngStep){var h;c.$validators.step=function(a,b){return c.$isEmpty(b)||v(h)||fe(b,g||0,h)};d.$observe("step",function(a){h=Wa(a);c.$validate()})}},url:function(a,b,d,c,e,f){Va(a,b,d,c,e,f);Fc(c);c.$$parserName=
"url";c.$validators.url=function(a,b){var d=a||b;return c.$isEmpty(d)||eh.test(d)}},email:function(a,b,d,c,e,f){Va(a,b,d,c,e,f);Fc(c);c.$$parserName="email";c.$validators.email=function(a,b){var d=a||b;return c.$isEmpty(d)||fh.test(d)}},radio:function(a,b,d,c){var e=!d.ngTrim||"false"!==P(d.ngTrim);v(d.name)&&b.attr("name",++sb);b.on("click",function(a){var g;b[0].checked&&(g=d.value,e&&(g=P(g)),c.$setViewValue(g,a&&a.type))});c.$render=function(){var a=d.value;e&&(a=P(a));b[0].checked=a===c.$viewValue};
d.$observe("value",c.$render)},range:function(a,b,d,c,e,f){function g(a,c){b.attr(a,d[a]);d.$observe(a,c)}function k(a){n=Wa(a);ba(c.$modelValue)||(m?(a=b.val(),n>a&&(a=n,b.val(a)),c.$setViewValue(a)):c.$validate())}function h(a){q=Wa(a);ba(c.$modelValue)||(m?(a=b.val(),q<a&&(b.val(q),a=q<n?n:q),c.$setViewValue(a)):c.$validate())}function l(a){p=Wa(a);ba(c.$modelValue)||(m&&c.$viewValue!==b.val()?c.$setViewValue(b.val()):c.$validate())}Gc(a,b,d,c);ee(c);Va(a,b,d,c,e,f);var m=c.$$hasNativeValidators&&
"range"===b[0].type,n=m?0:void 0,q=m?100:void 0,p=m?1:void 0,r=b[0].validity;a=t(d.min);e=t(d.max);f=t(d.step);var w=c.$render;c.$render=m&&t(r.rangeUnderflow)&&t(r.rangeOverflow)?function(){w();c.$setViewValue(b.val())}:w;a&&(c.$validators.min=m?function(){return!0}:function(a,b){return c.$isEmpty(b)||v(n)||b>=n},g("min",k));e&&(c.$validators.max=m?function(){return!0}:function(a,b){return c.$isEmpty(b)||v(q)||b<=q},g("max",h));f&&(c.$validators.step=m?function(){return!r.stepMismatch}:function(a,
b){return c.$isEmpty(b)||v(p)||fe(b,n||0,p)},g("step",l))},checkbox:function(a,b,d,c,e,f,g,k){var h=ge(k,a,"ngTrueValue",d.ngTrueValue,!0),l=ge(k,a,"ngFalseValue",d.ngFalseValue,!1);b.on("click",function(a){c.$setViewValue(b[0].checked,a&&a.type)});c.$render=function(){b[0].checked=c.$viewValue};c.$isEmpty=function(a){return!1===a};c.$formatters.push(function(a){return sa(a,h)});c.$parsers.push(function(a){return a?h:l})},hidden:B,button:B,submit:B,reset:B,file:B},Zc=["$browser","$sniffer","$filter",
"$parse",function(a,b,d,c){return{restrict:"E",require:["?ngModel"],link:{pre:function(e,f,g,k){k[0]&&(oe[N(g.type)]||oe.text)(e,f,g,k[0],b,a,d,c)}}}}],gh=/^(true|false|\d+)$/,nf=function(){function a(a,d,c){var e=t(c)?c:9===Ba?"":null;a.prop("value",e);d.$set("value",c)}return{restrict:"A",priority:100,compile:function(b,d){return gh.test(d.ngValue)?function(b,d,f){b=b.$eval(f.ngValue);a(d,f,b)}:function(b,d,f){b.$watch(f.ngValue,function(b){a(d,f,b)})}}}},Ne=["$compile",function(a){return{restrict:"AC",
compile:function(b){a.$$addBindingClass(b);return function(b,c,e){a.$$addBindingInfo(c,e.ngBind);c=c[0];b.$watch(e.ngBind,function(a){c.textContent=cc(a)})}}}}],Pe=["$interpolate","$compile",function(a,b){return{compile:function(d){b.$$addBindingClass(d);return function(c,d,f){c=a(d.attr(f.$attr.ngBindTemplate));b.$$addBindingInfo(d,c.expressions);d=d[0];f.$observe("ngBindTemplate",function(a){d.textContent=v(a)?"":a})}}}}],Oe=["$sce","$parse","$compile",function(a,b,d){return{restrict:"A",compile:function(c,
e){var f=b(e.ngBindHtml),g=b(e.ngBindHtml,function(b){return a.valueOf(b)});d.$$addBindingClass(c);return function(b,c,e){d.$$addBindingInfo(c,e.ngBindHtml);b.$watch(g,function(){var d=f(b);c.html(a.getTrustedHtml(d)||"")})}}}}],mf=aa({restrict:"A",require:"ngModel",link:function(a,b,d,c){c.$viewChangeListeners.push(function(){a.$eval(d.ngChange)})}}),Qe=Ic("",!0),Se=Ic("Odd",0),Re=Ic("Even",1),Te=Ua({compile:function(a,b){b.$set("ngCloak",void 0);a.removeClass("ng-cloak")}}),Ue=[function(){return{restrict:"A",
scope:!0,controller:"@",priority:500}}],dd={},hh={blur:!0,focus:!0};p("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(a){var b=Ea("ng-"+a);dd[b]=["$parse","$rootScope",function(d,c){return{restrict:"A",compile:function(e,f){var g=d(f[b]);return function(b,d){d.on(a,function(d){var e=function(){g(b,{$event:d})};hh[a]&&c.$$phase?b.$evalAsync(e):b.$apply(e)})}}}}]});var Xe=["$animate","$compile",
function(a,b){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(d,c,e,f,g){var k,h,l;d.$watch(e.ngIf,function(d){d?h||g(function(d,f){h=f;d[d.length++]=b.$$createComment("end ngIf",e.ngIf);k={clone:d};a.enter(d,c.parent(),c)}):(l&&(l.remove(),l=null),h&&(h.$destroy(),h=null),k&&(l=vb(k.clone),a.leave(l).done(function(a){!1!==a&&(l=null)}),k=null))})}}}],Ye=["$templateRequest","$anchorScroll","$animate",function(a,b,d){return{restrict:"ECA",priority:400,
terminal:!0,transclude:"element",controller:fa.noop,compile:function(c,e){var f=e.ngInclude||e.src,g=e.onload||"",k=e.autoscroll;return function(c,e,m,n,q){var p=0,r,w,u,A=function(){w&&(w.remove(),w=null);r&&(r.$destroy(),r=null);u&&(d.leave(u).done(function(a){!1!==a&&(w=null)}),w=u,u=null)};c.$watch(f,function(f){var m=function(a){!1===a||!t(k)||k&&!c.$eval(k)||b()},y=++p;f?(a(f,!0).then(function(a){if(!c.$$destroyed&&y===p){var b=c.$new();n.template=a;a=q(b,function(a){A();d.enter(a,null,e).done(m)});
r=b;u=a;r.$emit("$includeContentLoaded",f);c.$eval(g)}},function(){c.$$destroyed||y!==p||(A(),c.$emit("$includeContentError",f))}),c.$emit("$includeContentRequested",f)):(A(),n.template=null)})}}}}],pf=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(b,d,c,e){la.call(d[0]).match(/SVG/)?(d.empty(),a(fd(e.template,x.document).childNodes)(b,function(a){d.append(a)},{futureParentElement:d})):(d.html(e.template),a(d.contents())(b))}}}],Ze=Ua({priority:450,compile:function(){return{pre:function(a,
b,d){a.$eval(d.ngInit)}}}}),lf=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(a,b,d,c){var e=d.ngList||", ",f="false"!==d.ngTrim,g=f?P(e):e;c.$parsers.push(function(a){if(!v(a)){var b=[];a&&p(a.split(g),function(a){a&&b.push(f?P(a):a)});return b}});c.$formatters.push(function(a){if(I(a))return a.join(e)});c.$isEmpty=function(a){return!a||!a.length}}}},pb="ng-valid",ae="ng-invalid",Ya="ng-pristine",Sb="ng-dirty",rb=K("ngModel");Pb.$inject="$scope $exceptionHandler $attrs $element $parse $animate $timeout $q $interpolate".split(" ");
Pb.prototype={$$initGetterSetters:function(){if(this.$options.getOption("getterSetter")){var a=this.$$parse(this.$$attr.ngModel+"()"),b=this.$$parse(this.$$attr.ngModel+"($$$p)");this.$$ngModelGet=function(b){var c=this.$$parsedNgModel(b);E(c)&&(c=a(b));return c};this.$$ngModelSet=function(a,c){E(this.$$parsedNgModel(a))?b(a,{$$$p:c}):this.$$parsedNgModelAssign(a,c)}}else if(!this.$$parsedNgModel.assign)throw rb("nonassign",this.$$attr.ngModel,Aa(this.$$element));},$render:B,$isEmpty:function(a){return v(a)||
""===a||null===a||a!==a},$$updateEmptyClasses:function(a){this.$isEmpty(a)?(this.$$animate.removeClass(this.$$element,"ng-not-empty"),this.$$animate.addClass(this.$$element,"ng-empty")):(this.$$animate.removeClass(this.$$element,"ng-empty"),this.$$animate.addClass(this.$$element,"ng-not-empty"))},$setPristine:function(){this.$dirty=!1;this.$pristine=!0;this.$$animate.removeClass(this.$$element,Sb);this.$$animate.addClass(this.$$element,Ya)},$setDirty:function(){this.$dirty=!0;this.$pristine=!1;this.$$animate.removeClass(this.$$element,
Ya);this.$$animate.addClass(this.$$element,Sb);this.$$parentForm.$setDirty()},$setUntouched:function(){this.$touched=!1;this.$untouched=!0;this.$$animate.setClass(this.$$element,"ng-untouched","ng-touched")},$setTouched:function(){this.$touched=!0;this.$untouched=!1;this.$$animate.setClass(this.$$element,"ng-touched","ng-untouched")},$rollbackViewValue:function(){this.$$timeout.cancel(this.$$pendingDebounce);this.$viewValue=this.$$lastCommittedViewValue;this.$render()},$validate:function(){if(!ba(this.$modelValue)){var a=
this.$$lastCommittedViewValue,b=this.$$rawModelValue,d=this.$valid,c=this.$modelValue,e=this.$options.getOption("allowInvalid"),f=this;this.$$runValidators(b,a,function(a){e||d===a||(f.$modelValue=a?b:void 0,f.$modelValue!==c&&f.$$writeModelToScope())})}},$$runValidators:function(a,b,d){function c(){var c=!0;p(h.$validators,function(d,e){var g=Boolean(d(a,b));c=c&&g;f(e,g)});return c?!0:(p(h.$asyncValidators,function(a,b){f(b,null)}),!1)}function e(){var c=[],d=!0;p(h.$asyncValidators,function(e,
g){var h=e(a,b);if(!h||!E(h.then))throw rb("nopromise",h);f(g,void 0);c.push(h.then(function(){f(g,!0)},function(){d=!1;f(g,!1)}))});c.length?h.$$q.all(c).then(function(){g(d)},B):g(!0)}function f(a,b){k===h.$$currentValidationRunId&&h.$setValidity(a,b)}function g(a){k===h.$$currentValidationRunId&&d(a)}this.$$currentValidationRunId++;var k=this.$$currentValidationRunId,h=this;(function(){var a=h.$$parserName||"parse";if(v(h.$$parserValid))f(a,null);else return h.$$parserValid||(p(h.$validators,function(a,
b){f(b,null)}),p(h.$asyncValidators,function(a,b){f(b,null)})),f(a,h.$$parserValid),h.$$parserValid;return!0})()?c()?e():g(!1):g(!1)},$commitViewValue:function(){var a=this.$viewValue;this.$$timeout.cancel(this.$$pendingDebounce);if(this.$$lastCommittedViewValue!==a||""===a&&this.$$hasNativeValidators)this.$$updateEmptyClasses(a),this.$$lastCommittedViewValue=a,this.$pristine&&this.$setDirty(),this.$$parseAndValidate()},$$parseAndValidate:function(){var a=this.$$lastCommittedViewValue,b=this;if(this.$$parserValid=
v(a)?void 0:!0)for(var d=0;d<this.$parsers.length;d++)if(a=this.$parsers[d](a),v(a)){this.$$parserValid=!1;break}ba(this.$modelValue)&&(this.$modelValue=this.$$ngModelGet(this.$$scope));var c=this.$modelValue,e=this.$options.getOption("allowInvalid");this.$$rawModelValue=a;e&&(this.$modelValue=a,b.$modelValue!==c&&b.$$writeModelToScope());this.$$runValidators(a,this.$$lastCommittedViewValue,function(d){e||(b.$modelValue=d?a:void 0,b.$modelValue!==c&&b.$$writeModelToScope())})},$$writeModelToScope:function(){this.$$ngModelSet(this.$$scope,
this.$modelValue);p(this.$viewChangeListeners,function(a){try{a()}catch(b){this.$$exceptionHandler(b)}},this)},$setViewValue:function(a,b){this.$viewValue=a;this.$options.getOption("updateOnDefault")&&this.$$debounceViewValueCommit(b)},$$debounceViewValueCommit:function(a){var b=this.$options.getOption("debounce");W(b[a])?b=b[a]:W(b["default"])&&(b=b["default"]);this.$$timeout.cancel(this.$$pendingDebounce);var d=this;0<b?this.$$pendingDebounce=this.$$timeout(function(){d.$commitViewValue()},b):this.$$scope.$root.$$phase?
this.$commitViewValue():this.$$scope.$apply(function(){d.$commitViewValue()})},$overrideModelOptions:function(a){this.$options=this.$options.createChild(a)}};be({clazz:Pb,set:function(a,b){a[b]=!0},unset:function(a,b){delete a[b]}});var kf=["$rootScope",function(a){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:Pb,priority:1,compile:function(b){b.addClass(Ya).addClass("ng-untouched").addClass(pb);return{pre:function(a,b,e,f){var g=f[0];b=f[1]||g.$$parentForm;if(f=f[2])g.$options=
f.$options;g.$$initGetterSetters();b.$addControl(g);e.$observe("name",function(a){g.$name!==a&&g.$$parentForm.$$renameControl(g,a)});a.$on("$destroy",function(){g.$$parentForm.$removeControl(g)})},post:function(b,c,e,f){function g(){k.$setTouched()}var k=f[0];if(k.$options.getOption("updateOn"))c.on(k.$options.getOption("updateOn"),function(a){k.$$debounceViewValueCommit(a&&a.type)});c.on("blur",function(){k.$touched||(a.$$phase?b.$evalAsync(g):b.$apply(g))})}}}}}],Qb,ih=/(\s+|^)default(\s+|$)/;Jc.prototype=
{getOption:function(a){return this.$$options[a]},createChild:function(a){var b=!1;a=O({},a);p(a,function(d,c){"$inherit"===d?"*"===c?b=!0:(a[c]=this.$$options[c],"updateOn"===c&&(a.updateOnDefault=this.$$options.updateOnDefault)):"updateOn"===c&&(a.updateOnDefault=!1,a[c]=P(d.replace(ih,function(){a.updateOnDefault=!0;return" "})))},this);b&&(delete a["*"],he(a,this.$$options));he(a,Qb.$$options);return new Jc(a)}};Qb=new Jc({updateOn:"",updateOnDefault:!0,debounce:0,getterSetter:!1,allowInvalid:!1,
timezone:null});var of=function(){function a(a,d){this.$$attrs=a;this.$$scope=d}a.$inject=["$attrs","$scope"];a.prototype={$onInit:function(){var a=this.parentCtrl?this.parentCtrl.$options:Qb,d=this.$$scope.$eval(this.$$attrs.ngModelOptions);this.$options=a.createChild(d)}};return{restrict:"A",priority:10,require:{parentCtrl:"?^^ngModelOptions"},bindToController:!0,controller:a}},$e=Ua({terminal:!0,priority:1E3}),jh=K("ngOptions"),kh=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([$\w][$\w]*)|(?:\(\s*([$\w][$\w]*)\s*,\s*([$\w][$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,
hf=["$compile","$document","$parse",function(a,b,d){function c(a,b,c){function e(a,b,c,d,f){this.selectValue=a;this.viewValue=b;this.label=c;this.group=d;this.disabled=f}function f(a){var b;if(!p&&oa(a))b=a;else{b=[];for(var c in a)a.hasOwnProperty(c)&&"$"!==c.charAt(0)&&b.push(c)}return b}var n=a.match(kh);if(!n)throw jh("iexp",a,Aa(b));var q=n[5]||n[7],p=n[6];a=/ as /.test(n[0])&&n[1];var r=n[9];b=d(n[2]?n[1]:q);var w=a&&d(a)||b,t=r&&d(r),A=r?function(a,b){return t(c,b)}:function(a){return Sa(a)},
v=function(a,b){return A(a,z(a,b))},s=d(n[2]||n[1]),y=d(n[3]||""),D=d(n[4]||""),H=d(n[8]),x={},z=p?function(a,b){x[p]=b;x[q]=a;return x}:function(a){x[q]=a;return x};return{trackBy:r,getTrackByValue:v,getWatchables:d(H,function(a){var b=[];a=a||[];for(var d=f(a),e=d.length,g=0;g<e;g++){var k=a===d?g:d[g],l=a[k],k=z(l,k),l=A(l,k);b.push(l);if(n[2]||n[1])l=s(c,k),b.push(l);n[4]&&(k=D(c,k),b.push(k))}return b}),getOptions:function(){for(var a=[],b={},d=H(c)||[],g=f(d),k=g.length,n=0;n<k;n++){var q=d===
g?n:g[n],p=z(d[q],q),t=w(c,p),q=A(t,p),u=s(c,p),F=y(c,p),p=D(c,p),t=new e(q,t,u,F,p);a.push(t);b[q]=t}return{items:a,selectValueMap:b,getOptionFromViewValue:function(a){return b[v(a)]},getViewValueFromOption:function(a){return r?Ia(a.viewValue):a.viewValue}}}}}var e=x.document.createElement("option"),f=x.document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(a,b,c,d){d[0].registerOption=B},post:function(d,k,h,l){function m(a){var b=(a=A.getOptionFromViewValue(a))&&
a.element;b&&!b.selected&&(b.selected=!0);return a}function n(a,b){a.element=b;b.disabled=a.disabled;a.label!==b.label&&(b.label=a.label,b.textContent=a.label);b.value=a.selectValue}var q=l[0],r=l[1],v=h.multiple;l=0;for(var w=k.children(),u=w.length;l<u;l++)if(""===w[l].value){q.hasEmptyOption=!0;q.emptyOption=w.eq(l);break}k.empty();l=!!q.emptyOption;z(e.cloneNode(!1)).val("?");var A,x=c(h.ngOptions,k,d),s=b[0].createDocumentFragment();q.generateUnknownOptionValue=function(a){return"?"};v?(q.writeValue=
function(a){if(A){var b=a&&a.map(m)||[];A.items.forEach(function(a){a.element.selected&&-1===Array.prototype.indexOf.call(b,a)&&(a.element.selected=!1)})}},q.readValue=function(){var a=k.val()||[],b=[];p(a,function(a){(a=A.selectValueMap[a])&&!a.disabled&&b.push(A.getViewValueFromOption(a))});return b},x.trackBy&&d.$watchCollection(function(){if(I(r.$viewValue))return r.$viewValue.map(function(a){return x.getTrackByValue(a)})},function(){r.$render()})):(q.writeValue=function(a){if(A){var b=k[0].options[k[0].selectedIndex],
c=A.getOptionFromViewValue(a);b&&b.removeAttribute("selected");c?(k[0].value!==c.selectValue&&(q.removeUnknownOption(),k[0].value=c.selectValue,c.element.selected=!0),c.element.setAttribute("selected","selected")):q.selectUnknownOrEmptyOption(a)}},q.readValue=function(){var a=A.selectValueMap[k.val()];return a&&!a.disabled?(q.unselectEmptyOption(),q.removeUnknownOption(),A.getViewValueFromOption(a)):null},x.trackBy&&d.$watch(function(){return x.getTrackByValue(r.$viewValue)},function(){r.$render()}));
l&&(a(q.emptyOption)(d),k.prepend(q.emptyOption),8===q.emptyOption[0].nodeType?(q.hasEmptyOption=!1,q.registerOption=function(a,b){""===b.val()&&(q.hasEmptyOption=!0,q.emptyOption=b,q.emptyOption.removeClass("ng-scope"),r.$render(),b.on("$destroy",function(){var a=q.$isEmptyOptionSelected();q.hasEmptyOption=!1;q.emptyOption=void 0;a&&r.$render()}))}):q.emptyOption.removeClass("ng-scope"));d.$watchCollection(x.getWatchables,function(){var a=A&&q.readValue();if(A)for(var b=A.items.length-1;0<=b;b--){var c=
A.items[b];t(c.group)?Gb(c.element.parentNode):Gb(c.element)}A=x.getOptions();var d={};A.items.forEach(function(a){var b;if(t(a.group)){b=d[a.group];b||(b=f.cloneNode(!1),s.appendChild(b),b.label=null===a.group?"null":a.group,d[a.group]=b);var c=e.cloneNode(!1);b.appendChild(c);n(a,c)}else b=e.cloneNode(!1),s.appendChild(b),n(a,b)});k[0].appendChild(s);r.$render();r.$isEmpty(a)||(b=q.readValue(),(x.trackBy||v?sa(a,b):a===b)||(r.$setViewValue(b),r.$render()))})}}}}],af=["$locale","$interpolate","$log",
function(a,b,d){var c=/{}/g,e=/^when(Minus)?(.+)$/;return{link:function(f,g,k){function h(a){g.text(a||"")}var l=k.count,m=k.$attr.when&&g.attr(k.$attr.when),n=k.offset||0,q=f.$eval(m)||{},r={},t=b.startSymbol(),w=b.endSymbol(),u=t+l+"-"+n+w,A=fa.noop,x;p(k,function(a,b){var c=e.exec(b);c&&(c=(c[1]?"-":"")+N(c[2]),q[c]=g.attr(k.$attr[b]))});p(q,function(a,d){r[d]=b(a.replace(c,u))});f.$watch(l,function(b){var c=parseFloat(b),e=ba(c);e||c in q||(c=a.pluralCat(c-n));c===x||e&&ba(x)||(A(),e=r[c],v(e)?
(null!=b&&d.debug("ngPluralize: no rule defined for '"+c+"' in "+m),A=B,h()):A=f.$watch(e,h),x=c)})}}}],bf=["$parse","$animate","$compile",function(a,b,d){var c=K("ngRepeat"),e=function(a,b,c,d,e,m,n){a[c]=d;e&&(a[e]=m);a.$index=b;a.$first=0===b;a.$last=b===n-1;a.$middle=!(a.$first||a.$last);a.$odd=!(a.$even=0===(b&1))};return{restrict:"A",multiElement:!0,transclude:"element",priority:1E3,terminal:!0,$$tlb:!0,compile:function(f,g){var k=g.ngRepeat,h=d.$$createComment("end ngRepeat",k),l=k.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);
if(!l)throw c("iexp",k);var m=l[1],n=l[2],q=l[3],r=l[4],l=m.match(/^(?:(\s*[$\w]+)|\(\s*([$\w]+)\s*,\s*([$\w]+)\s*\))$/);if(!l)throw c("iidexp",m);var t=l[3]||l[1],w=l[2];if(q&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(q)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(q)))throw c("badident",q);var u,v,x,s,y={$id:Sa};r?u=a(r):(x=function(a,b){return Sa(b)},s=function(a){return a});return function(a,d,f,g,l){u&&(v=function(b,c,d){w&&(y[w]=b);y[t]=c;y.$index=
d;return u(a,y)});var m=R();a.$watchCollection(n,function(f){var g,n,r=d[0],u,y=R(),F,z,E,B,G,C,I;q&&(a[q]=f);if(oa(f))G=f,n=v||x;else for(I in n=v||s,G=[],f)wa.call(f,I)&&"$"!==I.charAt(0)&&G.push(I);F=G.length;I=Array(F);for(g=0;g<F;g++)if(z=f===G?g:G[g],E=f[z],B=n(z,E,g),m[B])C=m[B],delete m[B],y[B]=C,I[g]=C;else{if(y[B])throw p(I,function(a){a&&a.scope&&(m[a.id]=a)}),c("dupes",k,B,E);I[g]={id:B,scope:void 0,clone:void 0};y[B]=!0}for(u in m){C=m[u];B=vb(C.clone);b.leave(B);if(B[0].parentNode)for(g=
0,n=B.length;g<n;g++)B[g].$$NG_REMOVED=!0;C.scope.$destroy()}for(g=0;g<F;g++)if(z=f===G?g:G[g],E=f[z],C=I[g],C.scope){u=r;do u=u.nextSibling;while(u&&u.$$NG_REMOVED);C.clone[0]!==u&&b.move(vb(C.clone),null,r);r=C.clone[C.clone.length-1];e(C.scope,g,t,E,w,z,F)}else l(function(a,c){C.scope=c;var d=h.cloneNode(!1);a[a.length++]=d;b.enter(a,null,r);r=d;C.clone=a;y[C.id]=C;e(C.scope,g,t,E,w,z,F)});m=y})}}}}],cf=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(b,d,c){b.$watch(c.ngShow,
function(b){a[b?"removeClass":"addClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],We=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(b,d,c){b.$watch(c.ngHide,function(b){a[b?"addClass":"removeClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],df=Ua(function(a,b,d){a.$watch(d.ngStyle,function(a,d){d&&a!==d&&p(d,function(a,c){b.css(c,"")});a&&b.css(a)},!0)}),ef=["$animate","$compile",function(a,b){return{require:"ngSwitch",controller:["$scope",function(){this.cases=
{}}],link:function(d,c,e,f){var g=[],k=[],h=[],l=[],m=function(a,b){return function(c){!1!==c&&a.splice(b,1)}};d.$watch(e.ngSwitch||e.on,function(c){for(var d,e;h.length;)a.cancel(h.pop());d=0;for(e=l.length;d<e;++d){var r=vb(k[d].clone);l[d].$destroy();(h[d]=a.leave(r)).done(m(h,d))}k.length=0;l.length=0;(g=f.cases["!"+c]||f.cases["?"])&&p(g,function(c){c.transclude(function(d,e){l.push(e);var f=c.element;d[d.length++]=b.$$createComment("end ngSwitchWhen");k.push({clone:d});a.enter(d,f.parent(),
f)})})})}}}],ff=Ua({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,b,d,c,e){a=d.ngSwitchWhen.split(d.ngSwitchWhenSeparator).sort().filter(function(a,b,c){return c[b-1]!==a});p(a,function(a){c.cases["!"+a]=c.cases["!"+a]||[];c.cases["!"+a].push({transclude:e,element:b})})}}),gf=Ua({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,b,d,c,e){c.cases["?"]=c.cases["?"]||[];c.cases["?"].push({transclude:e,element:b})}}),lh=K("ngTransclude"),
jf=["$compile",function(a){return{restrict:"EAC",terminal:!0,compile:function(b){var d=a(b.contents());b.empty();return function(a,b,f,g,k){function h(){d(a,function(a){b.append(a)})}if(!k)throw lh("orphan",Aa(b));f.ngTransclude===f.$attr.ngTransclude&&(f.ngTransclude="");f=f.ngTransclude||f.ngTranscludeSlot;k(function(a,c){var d;if(d=a.length)a:{d=0;for(var f=a.length;d<f;d++){var g=a[d];if(g.nodeType!==Ma||g.nodeValue.trim()){d=!0;break a}}d=void 0}d?b.append(a):(h(),c.$destroy())},null,f);f&&!k.isSlotFilled(f)&&
h()}}}}],Ke=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(b,d){"text/ng-template"===d.type&&a.put(d.id,b[0].text)}}}],mh={$setViewValue:B,$render:B},nh=["$element","$scope",function(a,b){function d(){g||(g=!0,b.$$postDigest(function(){g=!1;e.ngModelCtrl.$render()}))}function c(a){k||(k=!0,b.$$postDigest(function(){b.$$destroyed||(k=!1,e.ngModelCtrl.$setViewValue(e.readValue()),a&&e.ngModelCtrl.$render())}))}var e=this,f=new Ib;e.selectValueMap={};e.ngModelCtrl=mh;
e.multiple=!1;e.unknownOption=z(x.document.createElement("option"));e.hasEmptyOption=!1;e.emptyOption=void 0;e.renderUnknownOption=function(b){b=e.generateUnknownOptionValue(b);e.unknownOption.val(b);a.prepend(e.unknownOption);Ha(e.unknownOption,!0);a.val(b)};e.updateUnknownOption=function(b){b=e.generateUnknownOptionValue(b);e.unknownOption.val(b);Ha(e.unknownOption,!0);a.val(b)};e.generateUnknownOptionValue=function(a){return"? "+Sa(a)+" ?"};e.removeUnknownOption=function(){e.unknownOption.parent()&&
e.unknownOption.remove()};e.selectEmptyOption=function(){e.emptyOption&&(a.val(""),Ha(e.emptyOption,!0))};e.unselectEmptyOption=function(){e.hasEmptyOption&&Ha(e.emptyOption,!1)};b.$on("$destroy",function(){e.renderUnknownOption=B});e.readValue=function(){var b=a.val(),b=b in e.selectValueMap?e.selectValueMap[b]:b;return e.hasOption(b)?b:null};e.writeValue=function(b){var c=a[0].options[a[0].selectedIndex];c&&Ha(z(c),!1);e.hasOption(b)?(e.removeUnknownOption(),c=Sa(b),a.val(c in e.selectValueMap?
c:b),Ha(z(a[0].options[a[0].selectedIndex]),!0)):e.selectUnknownOrEmptyOption(b)};e.addOption=function(a,b){if(8!==b[0].nodeType){Oa(a,'"option value"');""===a&&(e.hasEmptyOption=!0,e.emptyOption=b);var c=f.get(a)||0;f.set(a,c+1);d()}};e.removeOption=function(a){var b=f.get(a);b&&(1===b?(f.delete(a),""===a&&(e.hasEmptyOption=!1,e.emptyOption=void 0)):f.set(a,b-1))};e.hasOption=function(a){return!!f.get(a)};e.$hasEmptyOption=function(){return e.hasEmptyOption};e.$isUnknownOptionSelected=function(){return a[0].options[0]===
e.unknownOption[0]};e.$isEmptyOptionSelected=function(){return e.hasEmptyOption&&a[0].options[a[0].selectedIndex]===e.emptyOption[0]};e.selectUnknownOrEmptyOption=function(a){null==a&&e.emptyOption?(e.removeUnknownOption(),e.selectEmptyOption()):e.unknownOption.parent().length?e.updateUnknownOption(a):e.renderUnknownOption(a)};var g=!1,k=!1;e.registerOption=function(a,b,f,g,k){if(f.$attr.ngValue){var p,r=NaN;f.$observe("value",function(a){var d,f=b.prop("selected");t(r)&&(e.removeOption(p),delete e.selectValueMap[r],
d=!0);r=Sa(a);p=a;e.selectValueMap[r]=a;e.addOption(a,b);b.attr("value",r);d&&f&&c()})}else g?f.$observe("value",function(a){e.readValue();var d,f=b.prop("selected");t(p)&&(e.removeOption(p),d=!0);p=a;e.addOption(a,b);d&&f&&c()}):k?a.$watch(k,function(a,d){f.$set("value",a);var g=b.prop("selected");d!==a&&e.removeOption(d);e.addOption(a,b);d&&g&&c()}):e.addOption(f.value,b);f.$observe("disabled",function(a){if("true"===a||a&&b.prop("selected"))e.multiple?c(!0):(e.ngModelCtrl.$setViewValue(null),e.ngModelCtrl.$render())});
b.on("$destroy",function(){var a=e.readValue(),b=f.value;e.removeOption(b);d();(e.multiple&&a&&-1!==a.indexOf(b)||a===b)&&c(!0)})}}],Le=function(){return{restrict:"E",require:["select","?ngModel"],controller:nh,priority:1,link:{pre:function(a,b,d,c){var e=c[0],f=c[1];if(f){if(e.ngModelCtrl=f,b.on("change",function(){e.removeUnknownOption();a.$apply(function(){f.$setViewValue(e.readValue())})}),d.multiple){e.multiple=!0;e.readValue=function(){var a=[];p(b.find("option"),function(b){b.selected&&!b.disabled&&
(b=b.value,a.push(b in e.selectValueMap?e.selectValueMap[b]:b))});return a};e.writeValue=function(a){p(b.find("option"),function(b){var c=!!a&&(-1!==Array.prototype.indexOf.call(a,b.value)||-1!==Array.prototype.indexOf.call(a,e.selectValueMap[b.value]));c!==b.selected&&Ha(z(b),c)})};var g,k=NaN;a.$watch(function(){k!==f.$viewValue||sa(g,f.$viewValue)||(g=ra(f.$viewValue),f.$render());k=f.$viewValue});f.$isEmpty=function(a){return!a||0===a.length}}}else e.registerOption=B},post:function(a,b,d,c){var e=
c[1];if(e){var f=c[0];e.$render=function(){f.writeValue(e.$viewValue)}}}}}},Me=["$interpolate",function(a){return{restrict:"E",priority:100,compile:function(b,d){var c,e;t(d.ngValue)||(t(d.value)?c=a(d.value,!0):(e=a(b.text(),!0))||d.$set("value",b.text()));return function(a,b,d){var h=b.parent();(h=h.data("$selectController")||h.parent().data("$selectController"))&&h.registerOption(a,b,d,c,e)}}}}],ad=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,d,c){c&&(d.required=!0,c.$validators.required=
function(a,b){return!d.required||!c.$isEmpty(b)},d.$observe("required",function(){c.$validate()}))}}},$c=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,d,c){if(c){var e,f=d.ngPattern||d.pattern;d.$observe("pattern",function(a){C(a)&&0<a.length&&(a=new RegExp("^"+a+"$"));if(a&&!a.test)throw K("ngPattern")("noregexp",f,a,Aa(b));e=a||void 0;c.$validate()});c.$validators.pattern=function(a,b){return c.$isEmpty(b)||v(e)||e.test(b)}}}}},cd=function(){return{restrict:"A",require:"?ngModel",
link:function(a,b,d,c){if(c){var e=-1;d.$observe("maxlength",function(a){a=Q(a);e=ba(a)?-1:a;c.$validate()});c.$validators.maxlength=function(a,b){return 0>e||c.$isEmpty(b)||b.length<=e}}}}},bd=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,d,c){if(c){var e=0;d.$observe("minlength",function(a){e=Q(a)||0;c.$validate()});c.$validators.minlength=function(a,b){return c.$isEmpty(b)||b.length>=e}}}}};x.angular.bootstrap?x.console&&console.log("WARNING: Tried to load angular more than once."):
(Ce(),Fe(fa),fa.module("ngLocale",[],["$provide",function(a){function b(a){a+="";var b=a.indexOf(".");return-1==b?0:a.length-b-1}a.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:"January February March April May June July August September October November December".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
STANDALONEMONTH:"January February March April May June July August September October November December".split(" "),WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,
minFrac:2,minInt:1,negPre:"-\u00a4",negSuf:"",posPre:"\u00a4",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(a,c){var e=a|0,f=c;void 0===f&&(f=Math.min(b(a),3));Math.pow(10,f);return 1==e&&0==f?"one":"other"}})}]),z(function(){xe(x.document,Uc)}))})(window);!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>');
//# 

/*
 AngularJS v1.6.5
 (c) 2010-2017 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(s,d){'use strict';function J(d){var k=[];w(k,B).chars(d);return k.join("")}var x=d.$$minErr("$sanitize"),C,k,D,E,p,B,F,G,w;d.module("ngSanitize",[]).provider("$sanitize",function(){function g(a,e){var c={},b=a.split(","),f;for(f=0;f<b.length;f++)c[e?p(b[f]):b[f]]=!0;return c}function K(a){for(var e={},c=0,b=a.length;c<b;c++){var f=a[c];e[f.name]=f.value}return e}function H(a){return a.replace(/&/g,"&amp;").replace(L,function(a){var c=a.charCodeAt(0);a=a.charCodeAt(1);return"&#"+(1024*(c-
55296)+(a-56320)+65536)+";"}).replace(M,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function I(a){for(;a;){if(a.nodeType===s.Node.ELEMENT_NODE)for(var e=a.attributes,c=0,b=e.length;c<b;c++){var f=e[c],h=f.name.toLowerCase();if("xmlns:ns1"===h||0===h.lastIndexOf("ns1:",0))a.removeAttributeNode(f),c--,b--}(e=a.firstChild)&&I(e);a=t("nextSibling",a)}}function t(a,e){var c=e[a];if(c&&F.call(e,c))throw x("elclob",e.outerHTML||e.outerText);return c}var y=!1;this.$get=
["$$sanitizeUri",function(a){y&&k(n,z);return function(e){var c=[];G(e,w(c,function(b,c){return!/^unsafe:/.test(a(b,c))}));return c.join("")}}];this.enableSvg=function(a){return E(a)?(y=a,this):y};C=d.bind;k=d.extend;D=d.forEach;E=d.isDefined;p=d.lowercase;B=d.noop;G=function(a,e){null===a||void 0===a?a="":"string"!==typeof a&&(a=""+a);var c=u(a);if(!c)return"";var b=5;do{if(0===b)throw x("uinput");b--;a=c.innerHTML;c=u(a)}while(a!==c.innerHTML);for(b=c.firstChild;b;){switch(b.nodeType){case 1:e.start(b.nodeName.toLowerCase(),
K(b.attributes));break;case 3:e.chars(b.textContent)}var f;if(!(f=b.firstChild)&&(1===b.nodeType&&e.end(b.nodeName.toLowerCase()),f=t("nextSibling",b),!f))for(;null==f;){b=t("parentNode",b);if(b===c)break;f=t("nextSibling",b);1===b.nodeType&&e.end(b.nodeName.toLowerCase())}b=f}for(;b=c.firstChild;)c.removeChild(b)};w=function(a,e){var c=!1,b=C(a,a.push);return{start:function(a,h){a=p(a);!c&&A[a]&&(c=a);c||!0!==n[a]||(b("<"),b(a),D(h,function(c,h){var d=p(h),g="img"===a&&"src"===d||"background"===
d;!0!==v[d]||!0===m[d]&&!e(c,g)||(b(" "),b(h),b('="'),b(H(c)),b('"'))}),b(">"))},end:function(a){a=p(a);c||!0!==n[a]||!0===h[a]||(b("</"),b(a),b(">"));a==c&&(c=!1)},chars:function(a){c||b(H(a))}}};F=s.Node.prototype.contains||function(a){return!!(this.compareDocumentPosition(a)&16)};var L=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,M=/([^#-~ |!])/g,h=g("area,br,col,hr,img,wbr"),q=g("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),l=g("rp,rt"),r=k({},l,q),q=k({},q,g("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul")),
l=k({},l,g("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),z=g("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan"),A=g("script,style"),n=k({},h,q,l,r),m=g("background,cite,href,longdesc,src,xlink:href"),r=g("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),
l=g("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",
!0),v=k({},m,l,r),u=function(a,e){function c(b){b="<remove></remove>"+b;try{var c=(new a.DOMParser).parseFromString(b,"text/html").body;c.firstChild.remove();return c}catch(e){}}function b(a){d.innerHTML=a;e.documentMode&&I(d);return d}var h;if(e&&e.implementation)h=e.implementation.createHTMLDocument("inert");else throw x("noinert");var d=(h.documentElement||h.getDocumentElement()).querySelector("body");d.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>';return d.querySelector("svg")?
(d.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',d.querySelector("svg img")?c:b):function(b){b="<remove></remove>"+b;try{b=encodeURI(b)}catch(c){return}var e=new a.XMLHttpRequest;e.responseType="document";e.open("GET","data:text/html;charset=utf-8,"+b,!1);e.send(null);b=e.response.body;b.firstChild.remove();return b}}(s,s.document)}).info({angularVersion:"1.6.5"});d.module("ngSanitize").filter("linky",["$sanitize",function(g){var k=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,
p=/^mailto:/i,s=d.$$minErr("linky"),t=d.isDefined,y=d.isFunction,w=d.isObject,x=d.isString;return function(d,q,l){function r(a){a&&m.push(J(a))}function z(a,d){var c,b=A(a);m.push("<a ");for(c in b)m.push(c+'="'+b[c]+'" ');!t(q)||"target"in b||m.push('target="',q,'" ');m.push('href="',a.replace(/"/g,"&quot;"),'">');r(d);m.push("</a>")}if(null==d||""===d)return d;if(!x(d))throw s("notstring",d);for(var A=y(l)?l:w(l)?function(){return l}:function(){return{}},n=d,m=[],v,u;d=n.match(k);)v=d[0],d[2]||
d[4]||(v=(d[3]?"http://":"mailto:")+v),u=d.index,r(n.substr(0,u)),z(v,d[0].replace(p,"")),n=n.substring(u+d[0].length);r(n);return g(m.join(""))}}])})(window,window.angular);
//# 

/*
 AngularJS v1.6.5
 (c) 2010-2017 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(S,q){'use strict';function Ea(a,b,c){if(!a)throw Pa("areq",b||"?",c||"required");return a}function Fa(a,b){if(!a&&!b)return"";if(!a)return b;if(!b)return a;V(a)&&(a=a.join(" "));V(b)&&(b=b.join(" "));return a+" "+b}function Qa(a){var b={};a&&(a.to||a.from)&&(b.to=a.to,b.from=a.from);return b}function W(a,b,c){var d="";a=V(a)?a:a&&C(a)&&a.length?a.split(/\s+/):[];t(a,function(a,f){a&&0<a.length&&(d+=0<f?" ":"",d+=c?b+a:a+b)});return d}function Ga(a){if(a instanceof A)switch(a.length){case 0:return a;
case 1:if(1===a[0].nodeType)return a;break;default:return A(ua(a))}if(1===a.nodeType)return A(a)}function ua(a){if(!a[0])return a;for(var b=0;b<a.length;b++){var c=a[b];if(1===c.nodeType)return c}}function Ra(a,b,c){t(b,function(b){a.addClass(b,c)})}function Sa(a,b,c){t(b,function(b){a.removeClass(b,c)})}function X(a){return function(b,c){c.addClass&&(Ra(a,b,c.addClass),c.addClass=null);c.removeClass&&(Sa(a,b,c.removeClass),c.removeClass=null)}}function oa(a){a=a||{};if(!a.$$prepared){var b=a.domOperation||
O;a.domOperation=function(){a.$$domOperationFired=!0;b();b=O};a.$$prepared=!0}return a}function ha(a,b){Ha(a,b);Ia(a,b)}function Ha(a,b){b.from&&(a.css(b.from),b.from=null)}function Ia(a,b){b.to&&(a.css(b.to),b.to=null)}function T(a,b,c){var d=b.options||{};c=c.options||{};var e=(d.addClass||"")+" "+(c.addClass||""),f=(d.removeClass||"")+" "+(c.removeClass||"");a=Ta(a.attr("class"),e,f);c.preparationClasses&&(d.preparationClasses=ca(c.preparationClasses,d.preparationClasses),delete c.preparationClasses);
e=d.domOperation!==O?d.domOperation:null;va(d,c);e&&(d.domOperation=e);d.addClass=a.addClass?a.addClass:null;d.removeClass=a.removeClass?a.removeClass:null;b.addClass=d.addClass;b.removeClass=d.removeClass;return d}function Ta(a,b,c){function d(a){C(a)&&(a=a.split(" "));var b={};t(a,function(a){a.length&&(b[a]=!0)});return b}var e={};a=d(a);b=d(b);t(b,function(a,b){e[b]=1});c=d(c);t(c,function(a,b){e[b]=1===e[b]?null:-1});var f={addClass:"",removeClass:""};t(e,function(b,c){var d,e;1===b?(d="addClass",
e=!a[c]||a[c+"-remove"]):-1===b&&(d="removeClass",e=a[c]||a[c+"-add"]);e&&(f[d].length&&(f[d]+=" "),f[d]+=c)});return f}function J(a){return a instanceof A?a[0]:a}function Ua(a,b,c){var d="";b&&(d=W(b,"ng-",!0));c.addClass&&(d=ca(d,W(c.addClass,"-add")));c.removeClass&&(d=ca(d,W(c.removeClass,"-remove")));d.length&&(c.preparationClasses=d,a.addClass(d))}function pa(a,b){var c=b?"-"+b+"s":"";ka(a,[la,c]);return[la,c]}function wa(a,b){var c=b?"paused":"",d=Y+"PlayState";ka(a,[d,c]);return[d,c]}function ka(a,
b){a.style[b[0]]=b[1]}function ca(a,b){return a?b?a+" "+b:a:b}function Ja(a,b,c){var d=Object.create(null),e=a.getComputedStyle(b)||{};t(c,function(a,b){var c=e[a];if(c){var l=c.charAt(0);if("-"===l||"+"===l||0<=l)c=Va(c);0===c&&(c=null);d[b]=c}});return d}function Va(a){var b=0;a=a.split(/\s*,\s*/);t(a,function(a){"s"===a.charAt(a.length-1)&&(a=a.substring(0,a.length-1));a=parseFloat(a)||0;b=b?Math.max(a,b):a});return b}function xa(a){return 0===a||null!=a}function Ka(a,b){var c=Q,d=a+"s";b?c+="Duration":
d+=" linear all";return[c,d]}function La(){var a=Object.create(null);return{flush:function(){a=Object.create(null)},count:function(b){return(b=a[b])?b.total:0},get:function(b){return(b=a[b])&&b.value},put:function(b,c){a[b]?a[b].total++:a[b]={total:1,value:c}}}}function Ma(a,b,c){t(c,function(c){a[c]=ya(a[c])?a[c]:b.style.getPropertyValue(c)})}var Q,za,Y,Aa;void 0===S.ontransitionend&&void 0!==S.onwebkittransitionend?(Q="WebkitTransition",za="webkitTransitionEnd transitionend"):(Q="transition",za=
"transitionend");void 0===S.onanimationend&&void 0!==S.onwebkitanimationend?(Y="WebkitAnimation",Aa="webkitAnimationEnd animationend"):(Y="animation",Aa="animationend");var qa=Y+"Delay",Ba=Y+"Duration",la=Q+"Delay",Na=Q+"Duration",Pa=q.$$minErr("ng"),Wa={transitionDuration:Na,transitionDelay:la,transitionProperty:Q+"Property",animationDuration:Ba,animationDelay:qa,animationIterationCount:Y+"IterationCount"},Xa={transitionDuration:Na,transitionDelay:la,animationDuration:Ba,animationDelay:qa},Ca,va,
t,V,ya,Z,Da,ra,C,P,A,O;q.module("ngAnimate",[],function(){O=q.noop;Ca=q.copy;va=q.extend;A=q.element;t=q.forEach;V=q.isArray;C=q.isString;ra=q.isObject;P=q.isUndefined;ya=q.isDefined;Da=q.isFunction;Z=q.isElement}).info({angularVersion:"1.6.5"}).directive("ngAnimateSwap",["$animate","$rootScope",function(a,b){return{restrict:"A",transclude:"element",terminal:!0,priority:600,link:function(b,d,e,f,n){var G,l;b.$watchCollection(e.ngAnimateSwap||e["for"],function(e){G&&a.leave(G);l&&(l.$destroy(),l=null);
if(e||0===e)l=b.$new(),n(l,function(b){G=b;a.enter(b,null,d)})})}}}]).directive("ngAnimateChildren",["$interpolate",function(a){return{link:function(b,c,d){function e(a){c.data("$$ngAnimateChildren","on"===a||"true"===a)}var f=d.ngAnimateChildren;C(f)&&0===f.length?c.data("$$ngAnimateChildren",!0):(e(a(f)(b)),d.$observe("ngAnimateChildren",e))}}}]).factory("$$rAFScheduler",["$$rAF",function(a){function b(a){d=d.concat(a);c()}function c(){if(d.length){for(var b=d.shift(),n=0;n<b.length;n++)b[n]();
e||a(function(){e||c()})}}var d,e;d=b.queue=[];b.waitUntilQuiet=function(b){e&&e();e=a(function(){e=null;b();c()})};return b}]).provider("$$animateQueue",["$animateProvider",function(a){function b(a){if(!a)return null;a=a.split(" ");var b=Object.create(null);t(a,function(a){b[a]=!0});return b}function c(a,c){if(a&&c){var d=b(c);return a.split(" ").some(function(a){return d[a]})}}function d(a,b,c){return f[a].some(function(a){return a(b,c)})}function e(a,b){var c=0<(a.addClass||"").length,d=0<(a.removeClass||
"").length;return b?c&&d:c||d}var f=this.rules={skip:[],cancel:[],join:[]};f.join.push(function(a,b){return!a.structural&&e(a)});f.skip.push(function(a,b){return!a.structural&&!e(a)});f.skip.push(function(a,b){return"leave"===b.event&&a.structural});f.skip.push(function(a,b){return b.structural&&2===b.state&&!a.structural});f.cancel.push(function(a,b){return b.structural&&a.structural});f.cancel.push(function(a,b){return 2===b.state&&a.structural});f.cancel.push(function(a,b){if(b.structural)return!1;
var d=a.addClass,e=a.removeClass,f=b.addClass,sa=b.removeClass;return P(d)&&P(e)||P(f)&&P(sa)?!1:c(d,sa)||c(e,f)});this.$get=["$$rAF","$rootScope","$rootElement","$document","$$Map","$$animation","$$AnimateRunner","$templateRequest","$$jqLite","$$forceReflow","$$isDocumentHidden",function(b,c,f,s,y,sa,da,v,E,g,M){function x(){var a=!1;return function(b){a?b():c.$$postDigest(function(){a=!0;b()})}}function H(a,b,c){var h=[],d=k[c];d&&t(d,function(d){u.call(d.node,b)?h.push(d.callback):"leave"===c&&
u.call(d.node,a)&&h.push(d.callback)});return h}function I(a,b,c){var h=ua(b);return a.filter(function(a){return!(a.node===h&&(!c||a.callback===c))})}function K(a,k,w){function K(a,c,h,k){s(function(){var a=H(na,p,c);a.length?b(function(){t(a,function(a){a(f,h,k)});"close"!==h||p.parentNode||ba.off(p)}):"close"!==h||p.parentNode||ba.off(p)});a.progress(c,h,k)}function I(a){var b=f,c=g;c.preparationClasses&&(b.removeClass(c.preparationClasses),c.preparationClasses=null);c.activeClasses&&(b.removeClass(c.activeClasses),
c.activeClasses=null);Oa(f,g);ha(f,g);g.domOperation();l.complete(!a)}var g=Ca(w),f=Ga(a),p=J(f),na=p&&p.parentNode,g=oa(g),l=new da,s=x();V(g.addClass)&&(g.addClass=g.addClass.join(" "));g.addClass&&!C(g.addClass)&&(g.addClass=null);V(g.removeClass)&&(g.removeClass=g.removeClass.join(" "));g.removeClass&&!C(g.removeClass)&&(g.removeClass=null);g.from&&!ra(g.from)&&(g.from=null);g.to&&!ra(g.to)&&(g.to=null);if(!(h&&p&&Ya(p,k,w)&&D(p,g)))return I(),l;var v=0<=["enter","move","leave"].indexOf(k),u=
M(),y=u||ga.get(p);w=!y&&z.get(p)||{};var E=!!w.state;y||E&&1===w.state||(y=!L(p,na,k));if(y)return u&&K(l,k,"start"),I(),u&&K(l,k,"close"),l;v&&ta(p);u={structural:v,element:f,event:k,addClass:g.addClass,removeClass:g.removeClass,close:I,options:g,runner:l};if(E){if(d("skip",u,w)){if(2===w.state)return I(),l;T(f,w,u);return w.runner}if(d("cancel",u,w))if(2===w.state)w.runner.end();else if(w.structural)w.close();else return T(f,w,u),w.runner;else if(d("join",u,w))if(2===w.state)T(f,u,{});else return Ua(f,
v?k:null,g),k=u.event=w.event,g=T(f,w,u),w.runner}else T(f,u,{});(E=u.structural)||(E="animate"===u.event&&0<Object.keys(u.options.to||{}).length||e(u));if(!E)return I(),m(p),l;var q=(w.counter||0)+1;u.counter=q;F(p,1,u);c.$$postDigest(function(){f=Ga(a);var b=z.get(p),c=!b,b=b||{},h=0<(f.parent()||[]).length&&("animate"===b.event||b.structural||e(b));if(c||b.counter!==q||!h){c&&(Oa(f,g),ha(f,g));if(c||v&&b.event!==k)g.domOperation(),l.end();h||m(p)}else k=!b.structural&&e(b,!0)?"setClass":b.event,
F(p,2),b=sa(f,k,b.options),l.setHost(b),K(l,k,"start",{}),b.done(function(a){I(!a);(a=z.get(p))&&a.counter===q&&m(p);K(l,k,"close",{})})});return l}function ta(a){a=a.querySelectorAll("[data-ng-animate]");t(a,function(a){var b=parseInt(a.getAttribute("data-ng-animate"),10),c=z.get(a);if(c)switch(b){case 2:c.runner.end();case 1:z.delete(a)}})}function m(a){a.removeAttribute("data-ng-animate");z.delete(a)}function L(a,b,c){c=s[0].body;var h=J(f),k=a===c||"HTML"===a.nodeName,d=a===h,g=!1,e=ga.get(a),
p;for((a=A.data(a,"$ngAnimatePin"))&&(b=J(a));b;){d||(d=b===h);if(1!==b.nodeType)break;a=z.get(b)||{};if(!g){var H=ga.get(b);if(!0===H&&!1!==e){e=!0;break}else!1===H&&(e=!1);g=a.structural}if(P(p)||!0===p)a=A.data(b,"$$ngAnimateChildren"),ya(a)&&(p=a);if(g&&!1===p)break;k||(k=b===c);if(k&&d)break;if(!d&&(a=A.data(b,"$ngAnimatePin"))){b=J(a);continue}b=b.parentNode}return(!g||p)&&!0!==e&&d&&k}function F(a,b,c){c=c||{};c.state=b;a.setAttribute("data-ng-animate",b);c=(b=z.get(a))?va(b,c):c;z.set(a,c)}
var z=new y,ga=new y,h=null,p=c.$watch(function(){return 0===v.totalPendingRequests},function(a){a&&(p(),c.$$postDigest(function(){c.$$postDigest(function(){null===h&&(h=!0)})}))}),k=Object.create(null);y=a.customFilter();var na=a.classNameFilter();g=function(){return!0};var Ya=y||g,D=na?function(a,b){var c=[a.getAttribute("class"),b.addClass,b.removeClass].join(" ");return na.test(c)}:g,Oa=X(E),u=S.Node.prototype.contains||function(a){return this===a||!!(this.compareDocumentPosition(a)&16)},ba={on:function(a,
b,c){var h=ua(b);k[a]=k[a]||[];k[a].push({node:h,callback:c});A(b).on("$destroy",function(){z.get(h)||ba.off(a,b,c)})},off:function(a,b,c){if(1!==arguments.length||C(arguments[0])){var h=k[a];h&&(k[a]=1===arguments.length?null:I(h,b,c))}else for(h in b=arguments[0],k)k[h]=I(k[h],b)},pin:function(a,b){Ea(Z(a),"element","not an element");Ea(Z(b),"parentElement","not an element");a.data("$ngAnimatePin",b)},push:function(a,b,c,h){c=c||{};c.domOperation=h;return K(a,b,c)},enabled:function(a,b){var c=arguments.length;
if(0===c)b=!!h;else if(Z(a)){var k=J(a);1===c?b=!ga.get(k):ga.set(k,!b)}else b=h=!!a;return b}};return ba}]}]).provider("$$animation",["$animateProvider",function(a){var b=this.drivers=[];this.$get=["$$jqLite","$rootScope","$injector","$$AnimateRunner","$$Map","$$rAFScheduler",function(a,d,e,f,n,G){function l(a){function b(a){if(a.processed)return a;a.processed=!0;var d=a.domNode,e=d.parentNode;g.set(d,a);for(var f;e;){if(f=g.get(e)){f.processed||(f=b(f));break}e=e.parentNode}(f||c).children.push(a);
return a}var c={children:[]},d,g=new n;for(d=0;d<a.length;d++){var e=a[d];g.set(e.domNode,a[d]={domNode:e.domNode,fn:e.fn,children:[]})}for(d=0;d<a.length;d++)b(a[d]);return function(a){var b=[],c=[],d;for(d=0;d<a.children.length;d++)c.push(a.children[d]);a=c.length;var g=0,e=[];for(d=0;d<c.length;d++){var f=c[d];0>=a&&(a=g,g=0,b.push(e),e=[]);e.push(f.fn);f.children.forEach(function(a){g++;c.push(a)});a--}e.length&&b.push(e);return b}(c)}var s=[],y=X(a);return function(n,q,v){function E(a){a=a.hasAttribute("ng-animate-ref")?
[a]:a.querySelectorAll("[ng-animate-ref]");var b=[];t(a,function(a){var c=a.getAttribute("ng-animate-ref");c&&c.length&&b.push(a)});return b}function g(a){var b=[],c={};t(a,function(a,d){var k=J(a.element),g=0<=["enter","move"].indexOf(a.event),k=a.structural?E(k):[];if(k.length){var e=g?"to":"from";t(k,function(a){var b=a.getAttribute("ng-animate-ref");c[b]=c[b]||{};c[b][e]={animationID:d,element:A(a)}})}else b.push(a)});var d={},g={};t(c,function(c,e){var f=c.from,p=c.to;if(f&&p){var H=a[f.animationID],
z=a[p.animationID],m=f.animationID.toString();if(!g[m]){var l=g[m]={structural:!0,beforeStart:function(){H.beforeStart();z.beforeStart()},close:function(){H.close();z.close()},classes:M(H.classes,z.classes),from:H,to:z,anchors:[]};l.classes.length?b.push(l):(b.push(H),b.push(z))}g[m].anchors.push({out:f.element,"in":p.element})}else f=f?f.animationID:p.animationID,p=f.toString(),d[p]||(d[p]=!0,b.push(a[f]))});return b}function M(a,b){a=a.split(" ");b=b.split(" ");for(var c=[],d=0;d<a.length;d++){var g=
a[d];if("ng-"!==g.substring(0,3))for(var e=0;e<b.length;e++)if(g===b[e]){c.push(g);break}}return c.join(" ")}function x(a){for(var c=b.length-1;0<=c;c--){var d=e.get(b[c])(a);if(d)return d}}function H(a,b){function c(a){(a=a.data("$$animationRunner"))&&a.setHost(b)}a.from&&a.to?(c(a.from.element),c(a.to.element)):c(a.element)}function I(){var a=n.data("$$animationRunner");!a||"leave"===q&&v.$$domOperationFired||a.end()}function K(b){n.off("$destroy",I);n.removeData("$$animationRunner");y(n,v);ha(n,
v);v.domOperation();F&&a.removeClass(n,F);n.removeClass("ng-animate");m.complete(!b)}v=oa(v);var ta=0<=["enter","move","leave"].indexOf(q),m=new f({end:function(){K()},cancel:function(){K(!0)}});if(!b.length)return K(),m;n.data("$$animationRunner",m);var L=Fa(n.attr("class"),Fa(v.addClass,v.removeClass)),F=v.tempClasses;F&&(L+=" "+F,v.tempClasses=null);var z;ta&&(z="ng-"+q+"-prepare",a.addClass(n,z));s.push({element:n,classes:L,event:q,structural:ta,options:v,beforeStart:function(){n.addClass("ng-animate");
F&&a.addClass(n,F);z&&(a.removeClass(n,z),z=null)},close:K});n.on("$destroy",I);if(1<s.length)return m;d.$$postDigest(function(){var a=[];t(s,function(b){b.element.data("$$animationRunner")?a.push(b):b.close()});s.length=0;var b=g(a),c=[];t(b,function(a){c.push({domNode:J(a.from?a.from.element:a.element),fn:function(){a.beforeStart();var b,c=a.close;if((a.anchors?a.from.element||a.to.element:a.element).data("$$animationRunner")){var d=x(a);d&&(b=d.start)}b?(b=b(),b.done(function(a){c(!a)}),H(a,b)):
c()}})});G(l(c))});return m}}]}]).provider("$animateCss",["$animateProvider",function(a){var b=La(),c=La();this.$get=["$window","$$jqLite","$$AnimateRunner","$timeout","$$forceReflow","$sniffer","$$rAFScheduler","$$animateQueue",function(a,e,f,n,G,l,s,y){function q(a,b){var c=a.parentNode;return(c.$$ngAnimateParentKey||(c.$$ngAnimateParentKey=++M))+"-"+a.getAttribute("class")+"-"+b}function da(g,f,l,n){var m;0<b.count(l)&&(m=c.get(l),m||(f=W(f,"-stagger"),e.addClass(g,f),m=Ja(a,g,n),m.animationDuration=
Math.max(m.animationDuration,0),m.transitionDuration=Math.max(m.transitionDuration,0),e.removeClass(g,f),c.put(l,m)));return m||{}}function v(a){x.push(a);s.waitUntilQuiet(function(){b.flush();c.flush();for(var a=G(),d=0;d<x.length;d++)x[d](a);x.length=0})}function E(c,g,e){g=b.get(e);g||(g=Ja(a,c,Wa),"infinite"===g.animationIterationCount&&(g.animationIterationCount=1));b.put(e,g);c=g;e=c.animationDelay;g=c.transitionDelay;c.maxDelay=e&&g?Math.max(e,g):e||g;c.maxDuration=Math.max(c.animationDuration*
c.animationIterationCount,c.transitionDuration);return c}var g=X(e),M=0,x=[];return function(a,c){function d(){m()}function s(){m(!0)}function m(b){if(!(M||ba&&u)){M=!0;u=!1;h.$$skipPreparationClasses||e.removeClass(a,fa);e.removeClass(a,ca);wa(k,!1);pa(k,!1);t(x,function(a){k.style[a[0]]=""});g(a,h);ha(a,h);Object.keys(p).length&&t(p,function(a,b){a?k.style.setProperty(b,a):k.style.removeProperty(b)});if(h.onDone)h.onDone();ea&&ea.length&&a.off(ea.join(" "),z);var c=a.data("$$animateCss");c&&(n.cancel(c[0].timer),
a.removeData("$$animateCss"));A&&A.complete(!b)}}function L(a){r.blockTransition&&pa(k,a);r.blockKeyframeAnimation&&wa(k,!!a)}function F(){A=new f({end:d,cancel:s});v(O);m();return{$$willAnimate:!1,start:function(){return A},end:d}}function z(a){a.stopPropagation();var b=a.originalEvent||a;a=b.$manualTimeStamp||Date.now();b=parseFloat(b.elapsedTime.toFixed(3));Math.max(a-T,0)>=P&&b>=N&&(ba=!0,m())}function ga(){function b(){if(!M){L(!1);t(x,function(a){k.style[a[0]]=a[1]});g(a,h);e.addClass(a,ca);
if(r.recalculateTimingStyles){ma=k.getAttribute("class")+" "+fa;ja=q(k,ma);B=E(k,ma,ja);$=B.maxDelay;w=Math.max($,0);N=B.maxDuration;if(0===N){m();return}r.hasTransitions=0<B.transitionDuration;r.hasAnimations=0<B.animationDuration}r.applyAnimationDelay&&($="boolean"!==typeof h.delay&&xa(h.delay)?parseFloat(h.delay):$,w=Math.max($,0),B.animationDelay=$,aa=[qa,$+"s"],x.push(aa),k.style[aa[0]]=aa[1]);P=1E3*w;S=1E3*N;if(h.easing){var d,f=h.easing;r.hasTransitions&&(d=Q+"TimingFunction",x.push([d,f]),
k.style[d]=f);r.hasAnimations&&(d=Y+"TimingFunction",x.push([d,f]),k.style[d]=f)}B.transitionDuration&&ea.push(za);B.animationDuration&&ea.push(Aa);T=Date.now();var l=P+1.5*S;d=T+l;var f=a.data("$$animateCss")||[],F=!0;if(f.length){var s=f[0];(F=d>s.expectedEndTime)?n.cancel(s.timer):f.push(m)}F&&(l=n(c,l,!1),f[0]={timer:l,expectedEndTime:d},f.push(m),a.data("$$animateCss",f));if(ea.length)a.on(ea.join(" "),z);h.to&&(h.cleanupStyles&&Ma(p,k,Object.keys(h.to)),Ia(a,h))}}function c(){var b=a.data("$$animateCss");
if(b){for(var d=1;d<b.length;d++)b[d]();a.removeData("$$animateCss")}}if(!M)if(k.parentNode){var d=function(a){if(ba)u&&a&&(u=!1,m());else if(u=!a,B.animationDuration)if(a=wa(k,u),u)x.push(a);else{var b=x,c=b.indexOf(a);0<=a&&b.splice(c,1)}},f=0<Z&&(B.transitionDuration&&0===U.transitionDuration||B.animationDuration&&0===U.animationDuration)&&Math.max(U.animationDelay,U.transitionDelay);f?n(b,Math.floor(f*Z*1E3),!1):b();C.resume=function(){d(!0)};C.pause=function(){d(!1)}}else m()}var h=c||{};h.$$prepared||
(h=oa(Ca(h)));var p={},k=J(a);if(!k||!k.parentNode||!y.enabled())return F();var x=[],G=a.attr("class"),D=Qa(h),M,u,ba,A,C,w,P,N,S,T,ea=[];if(0===h.duration||!l.animations&&!l.transitions)return F();var ia=h.event&&V(h.event)?h.event.join(" "):h.event,X="",R="";ia&&h.structural?X=W(ia,"ng-",!0):ia&&(X=ia);h.addClass&&(R+=W(h.addClass,"-add"));h.removeClass&&(R.length&&(R+=" "),R+=W(h.removeClass,"-remove"));h.applyClassesEarly&&R.length&&g(a,h);var fa=[X,R].join(" ").trim(),ma=G+" "+fa,ca=W(fa,"-active"),
G=D.to&&0<Object.keys(D.to).length;if(!(0<(h.keyframeStyle||"").length||G||fa))return F();var ja,U;0<h.stagger?(D=parseFloat(h.stagger),U={transitionDelay:D,animationDelay:D,transitionDuration:0,animationDuration:0}):(ja=q(k,ma),U=da(k,fa,ja,Xa));h.$$skipPreparationClasses||e.addClass(a,fa);h.transitionStyle&&(D=[Q,h.transitionStyle],ka(k,D),x.push(D));0<=h.duration&&(D=0<k.style[Q].length,D=Ka(h.duration,D),ka(k,D),x.push(D));h.keyframeStyle&&(D=[Y,h.keyframeStyle],ka(k,D),x.push(D));var Z=U?0<=
h.staggerIndex?h.staggerIndex:b.count(ja):0;(ia=0===Z)&&!h.skipBlocking&&pa(k,9999);var B=E(k,ma,ja),$=B.maxDelay;w=Math.max($,0);N=B.maxDuration;var r={};r.hasTransitions=0<B.transitionDuration;r.hasAnimations=0<B.animationDuration;r.hasTransitionAll=r.hasTransitions&&"all"===B.transitionProperty;r.applyTransitionDuration=G&&(r.hasTransitions&&!r.hasTransitionAll||r.hasAnimations&&!r.hasTransitions);r.applyAnimationDuration=h.duration&&r.hasAnimations;r.applyTransitionDelay=xa(h.delay)&&(r.applyTransitionDuration||
r.hasTransitions);r.applyAnimationDelay=xa(h.delay)&&r.hasAnimations;r.recalculateTimingStyles=0<R.length;if(r.applyTransitionDuration||r.applyAnimationDuration)N=h.duration?parseFloat(h.duration):N,r.applyTransitionDuration&&(r.hasTransitions=!0,B.transitionDuration=N,D=0<k.style[Q+"Property"].length,x.push(Ka(N,D))),r.applyAnimationDuration&&(r.hasAnimations=!0,B.animationDuration=N,x.push([Ba,N+"s"]));if(0===N&&!r.recalculateTimingStyles)return F();if(null!=h.delay){var aa;"boolean"!==typeof h.delay&&
(aa=parseFloat(h.delay),w=Math.max(aa,0));r.applyTransitionDelay&&x.push([la,aa+"s"]);r.applyAnimationDelay&&x.push([qa,aa+"s"])}null==h.duration&&0<B.transitionDuration&&(r.recalculateTimingStyles=r.recalculateTimingStyles||ia);P=1E3*w;S=1E3*N;h.skipBlocking||(r.blockTransition=0<B.transitionDuration,r.blockKeyframeAnimation=0<B.animationDuration&&0<U.animationDelay&&0===U.animationDuration);h.from&&(h.cleanupStyles&&Ma(p,k,Object.keys(h.from)),Ha(a,h));r.blockTransition||r.blockKeyframeAnimation?
L(N):h.skipBlocking||pa(k,!1);return{$$willAnimate:!0,end:d,start:function(){if(!M)return C={end:d,cancel:s,resume:null,pause:null},A=new f(C),v(ga),A}}}}]}]).provider("$$animateCssDriver",["$$animationProvider",function(a){a.drivers.push("$$animateCssDriver");this.$get=["$animateCss","$rootScope","$$AnimateRunner","$rootElement","$sniffer","$$jqLite","$document",function(a,c,d,e,f,n,G){function l(a){return a.replace(/\bng-\S+\b/g,"")}function s(a,b){C(a)&&(a=a.split(" "));C(b)&&(b=b.split(" "));
return a.filter(function(a){return-1===b.indexOf(a)}).join(" ")}function y(c,f,e){function n(a){var b={},c=J(a).getBoundingClientRect();t(["width","height","top","left"],function(a){var d=c[a];switch(a){case "top":d+=v.scrollTop;break;case "left":d+=v.scrollLeft}b[a]=Math.floor(d)+"px"});return b}function G(){var c=l(e.attr("class")||""),d=s(c,m),c=s(m,c),d=a(y,{to:n(e),addClass:"ng-anchor-in "+d,removeClass:"ng-anchor-out "+c,delay:!0});return d.$$willAnimate?d:null}function q(){y.remove();f.removeClass("ng-animate-shim");
e.removeClass("ng-animate-shim")}var y=A(J(f).cloneNode(!0)),m=l(y.attr("class")||"");f.addClass("ng-animate-shim");e.addClass("ng-animate-shim");y.addClass("ng-anchor");E.append(y);var L;c=function(){var c=a(y,{addClass:"ng-anchor-out",delay:!0,from:n(f)});return c.$$willAnimate?c:null}();if(!c&&(L=G(),!L))return q();var F=c||L;return{start:function(){function a(){c&&c.end()}var b,c=F.start();c.done(function(){c=null;if(!L&&(L=G()))return c=L.start(),c.done(function(){c=null;q();b.complete()}),c;
q();b.complete()});return b=new d({end:a,cancel:a})}}}function q(a,b,c,f){var e=da(a,O),l=da(b,O),n=[];t(f,function(a){(a=y(c,a.out,a["in"]))&&n.push(a)});if(e||l||0!==n.length)return{start:function(){function a(){t(b,function(a){a.end()})}var b=[];e&&b.push(e.start());l&&b.push(l.start());t(n,function(a){b.push(a.start())});var c=new d({end:a,cancel:a});d.all(b,function(a){c.complete(a)});return c}}}function da(c){var d=c.element,e=c.options||{};c.structural&&(e.event=c.event,e.structural=!0,e.applyClassesEarly=
!0,"leave"===c.event&&(e.onDone=e.domOperation));e.preparationClasses&&(e.event=ca(e.event,e.preparationClasses));c=a(d,e);return c.$$willAnimate?c:null}if(!f.animations&&!f.transitions)return O;var v=G[0].body;c=J(e);var E=A(c.parentNode&&11===c.parentNode.nodeType||v.contains(c)?c:v);return function(a){return a.from&&a.to?q(a.from,a.to,a.classes,a.anchors):da(a)}}]}]).provider("$$animateJs",["$animateProvider",function(a){this.$get=["$injector","$$AnimateRunner","$$jqLite",function(b,c,d){function e(c){c=
V(c)?c:c.split(" ");for(var d=[],e={},f=0;f<c.length;f++){var y=c[f],q=a.$$registeredAnimations[y];q&&!e[y]&&(d.push(b.get(q)),e[y]=!0)}return d}var f=X(d);return function(a,b,d,s){function q(){s.domOperation();f(a,s)}function A(a,b,d,e,f){switch(d){case "animate":b=[b,e.from,e.to,f];break;case "setClass":b=[b,g,M,f];break;case "addClass":b=[b,g,f];break;case "removeClass":b=[b,M,f];break;default:b=[b,f]}b.push(e);if(a=a.apply(a,b))if(Da(a.start)&&(a=a.start()),a instanceof c)a.done(f);else if(Da(a))return a;
return O}function C(a,b,d,e,f){var g=[];t(e,function(e){var l=e[f];l&&g.push(function(){var e,f,h=!1,g=function(a){h||(h=!0,(f||O)(a),e.complete(!a))};e=new c({end:function(){g()},cancel:function(){g(!0)}});f=A(l,a,b,d,function(a){g(!1===a)});return e})});return g}function v(a,b,d,e,f){var g=C(a,b,d,e,f);if(0===g.length){var k,l;"beforeSetClass"===f?(k=C(a,"removeClass",d,e,"beforeRemoveClass"),l=C(a,"addClass",d,e,"beforeAddClass")):"setClass"===f&&(k=C(a,"removeClass",d,e,"removeClass"),l=C(a,"addClass",
d,e,"addClass"));k&&(g=g.concat(k));l&&(g=g.concat(l))}if(0!==g.length)return function(a){var b=[];g.length&&t(g,function(a){b.push(a())});b.length?c.all(b,a):a();return function(a){t(b,function(b){a?b.cancel():b.end()})}}}var E=!1;3===arguments.length&&ra(d)&&(s=d,d=null);s=oa(s);d||(d=a.attr("class")||"",s.addClass&&(d+=" "+s.addClass),s.removeClass&&(d+=" "+s.removeClass));var g=s.addClass,M=s.removeClass,x=e(d),H,I;if(x.length){var K,J;"leave"===b?(J="leave",K="afterLeave"):(J="before"+b.charAt(0).toUpperCase()+
b.substr(1),K=b);"enter"!==b&&"move"!==b&&(H=v(a,b,s,x,J));I=v(a,b,s,x,K)}if(H||I){var m;return{$$willAnimate:!0,end:function(){m?m.end():(E=!0,q(),ha(a,s),m=new c,m.complete(!0));return m},start:function(){function b(c){E=!0;q();ha(a,s);m.complete(c)}if(m)return m;m=new c;var d,e=[];H&&e.push(function(a){d=H(a)});e.length?e.push(function(a){q();a(!0)}):q();I&&e.push(function(a){d=I(a)});m.setHost({end:function(){E||((d||O)(void 0),b(void 0))},cancel:function(){E||((d||O)(!0),b(!0))}});c.chain(e,
b);return m}}}}}]}]).provider("$$animateJsDriver",["$$animationProvider",function(a){a.drivers.push("$$animateJsDriver");this.$get=["$$animateJs","$$AnimateRunner",function(a,c){function d(c){return a(c.element,c.event,c.classes,c.options)}return function(a){if(a.from&&a.to){var b=d(a.from),n=d(a.to);if(b||n)return{start:function(){function a(){return function(){t(d,function(a){a.end()})}}var d=[];b&&d.push(b.start());n&&d.push(n.start());c.all(d,function(a){e.complete(a)});var e=new c({end:a(),cancel:a()});
return e}}}else return d(a)}}]}])})(window,window.angular);
//# 

/*
 AngularJS v1.6.5
 (c) 2010-2017 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(n,c){'use strict';function l(b,a,g){var d=g.baseHref(),k=b[0];return function(b,e,f){var g,h;f=f||{};h=f.expires;g=c.isDefined(f.path)?f.path:d;c.isUndefined(e)&&(h="Thu, 01 Jan 1970 00:00:00 GMT",e="");c.isString(h)&&(h=new Date(h));e=encodeURIComponent(b)+"="+encodeURIComponent(e);e=e+(g?";path="+g:"")+(f.domain?";domain="+f.domain:"");e+=h?";expires="+h.toUTCString():"";e+=f.secure?";secure":"";f=e.length+1;4096<f&&a.warn("Cookie '"+b+"' possibly not set or overflowed because it was too large ("+
f+" > 4096 bytes)!");k.cookie=e}}c.module("ngCookies",["ng"]).info({angularVersion:"1.6.5"}).provider("$cookies",[function(){var b=this.defaults={};this.$get=["$$cookieReader","$$cookieWriter",function(a,g){return{get:function(d){return a()[d]},getObject:function(d){return(d=this.get(d))?c.fromJson(d):d},getAll:function(){return a()},put:function(d,a,m){g(d,a,m?c.extend({},b,m):b)},putObject:function(d,b,a){this.put(d,c.toJson(b),a)},remove:function(a,k){g(a,void 0,k?c.extend({},b,k):b)}}}]}]);c.module("ngCookies").factory("$cookieStore",
["$cookies",function(b){return{get:function(a){return b.getObject(a)},put:function(a,c){b.putObject(a,c)},remove:function(a){b.remove(a)}}}]);l.$inject=["$document","$log","$browser"];c.module("ngCookies").provider("$$cookieWriter",function(){this.$get=l})})(window,window.angular);
//# 

/*! ng-dialog - v1.2.0 (https://github.com/likeastore/ngDialog) */
!function(a,b){"undefined"!=typeof module&&module.exports?(b("undefined"==typeof angular?require("angular"):angular),module.exports="ngDialog"):"function"==typeof define&&define.amd?define(["angular"],b):b(a.angular)}(this,function(a){"use strict";var b=a.module("ngDialog",[]),c=a.element,d=a.isDefined,e=(document.body||document.documentElement).style,f=d(e.animation)||d(e.WebkitAnimation)||d(e.MozAnimation)||d(e.MsAnimation)||d(e.OAnimation),g="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",h="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",i="ngdialog-disabled-animation",j={html:!1,body:!1},k={},l=[],m=[],n=!1,o=!1,p=[],q="legacy",r="1.0.0+";return b.provider("ngDialog",function(){var b=this.defaults={className:"ngdialog-theme-default",appendClassName:"",disableAnimation:!1,plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,onOpenCallback:!1,overlay:!0,cache:!0,trapFocus:!0,preserveFocus:!0,ariaAuto:!0,ariaRole:null,ariaLabelledById:null,ariaLabelledBySelector:null,ariaDescribedById:null,ariaDescribedBySelector:null,bodyClassName:"ngdialog-open",width:null,height:null};this.setForceHtmlReload=function(a){j.html=a||!1},this.setForceBodyReload=function(a){j.body=a||!1},this.setDefaults=function(c){a.extend(b,c)},this.setOpenOnePerName=function(a){o=a||!1};var d,e=0,s=0,t={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function(u,v,w,x,y,z,A,B,C,D){var E=[],F={onDocumentKeydown:function(a){27===a.keyCode&&G.close("$escape")},activate:function(a){var b=a.data("$ngDialogOptions");b.trapFocus&&(a.on("keydown",F.onTrapFocusKeydown),E.body.on("keydown",F.onTrapFocusKeydown))},deactivate:function(a){a.off("keydown",F.onTrapFocusKeydown),E.body.off("keydown",F.onTrapFocusKeydown)},deactivateAll:function(b){a.forEach(b,function(b){var c=a.element(b);F.deactivate(c)})},setBodyPadding:function(a){var b=parseInt(E.body.css("padding-right")||0,10);E.body.css("padding-right",b+a+"px"),E.body.data("ng-dialog-original-padding",b),z.$broadcast("ngDialog.setPadding",a)},resetBodyPadding:function(){var a=E.body.data("ng-dialog-original-padding");a?E.body.css("padding-right",a+"px"):E.body.css("padding-right",""),z.$broadcast("ngDialog.setPadding",0)},performCloseDialog:function(a,b){var c=a.data("$ngDialogOptions"),e=a.attr("id"),h=k[e];if(F.deactivate(a),h){if("undefined"!=typeof B.Hammer){var i=h.hammerTime;i.off("tap",d),i.destroy&&i.destroy(),delete h.hammerTime}else a.unbind("click");1===s&&E.body.unbind("keydown",F.onDocumentKeydown),a.hasClass("ngdialog-closing")||(s-=1);var j=a.data("$ngDialogPreviousFocus");j&&j.focus&&j.focus(),z.$broadcast("ngDialog.closing",a,b),s=s<0?0:s,f&&!c.disableAnimation?(h.$destroy(),a.unbind(g).bind(g,function(){F.closeDialogElement(a,b)}).addClass("ngdialog-closing")):(h.$destroy(),F.closeDialogElement(a,b)),t[e]&&(t[e].resolve({id:e,value:b,$dialog:a,remainingDialogs:s}),delete t[e]),k[e]&&delete k[e],l.splice(l.indexOf(e),1),l.length||(E.body.unbind("keydown",F.onDocumentKeydown),n=!1),0==s&&(d=void 0)}},closeDialogElement:function(a,b){var c=a.data("$ngDialogOptions");a.remove(),m.splice(m.indexOf(c.bodyClassName),1),m.indexOf(c.bodyClassName)===-1&&(E.html.removeClass(c.bodyClassName),E.body.removeClass(c.bodyClassName)),0===s&&F.resetBodyPadding(),z.$broadcast("ngDialog.closed",a,b)},closeDialog:function(b,c){var d=b.data("$ngDialogPreCloseCallback");if(d&&a.isFunction(d)){var e=d.call(b,c);if(a.isObject(e))e.closePromise?e.closePromise.then(function(){F.performCloseDialog(b,c)},function(){return!1}):e.then(function(){F.performCloseDialog(b,c)},function(){return!1});else{if(e===!1)return!1;F.performCloseDialog(b,c)}}else F.performCloseDialog(b,c)},onTrapFocusKeydown:function(b){var c,d=a.element(b.currentTarget);if(d.hasClass("ngdialog"))c=d;else if(c=F.getActiveDialog(),null===c)return;var e=9===b.keyCode,f=b.shiftKey===!0;e&&F.handleTab(c,b,f)},handleTab:function(a,b,c){var d=F.getFocusableElements(a);if(0===d.length)return void(document.activeElement&&document.activeElement.blur&&document.activeElement.blur());var e=document.activeElement,f=Array.prototype.indexOf.call(d,e),g=f===-1,h=0===f,i=f===d.length-1,j=!1;c?(g||h)&&(d[d.length-1].focus(),j=!0):(g||i)&&(d[0].focus(),j=!0),j&&(b.preventDefault(),b.stopPropagation())},autoFocus:function(a){var b=a[0],d=b.querySelector("*[autofocus]");if(null===d||(d.focus(),document.activeElement!==d)){var e=F.getFocusableElements(a);if(e.length>0)return void e[0].focus();var f=F.filterVisibleElements(b.querySelectorAll("h1,h2,h3,h4,h5,h6,p,span"));if(f.length>0){var g=f[0];c(g).attr("tabindex","-1").css("outline","0"),g.focus()}}},getFocusableElements:function(a){var b=a[0],c=b.querySelectorAll(h),d=F.filterTabbableElements(c);return F.filterVisibleElements(d)},filterTabbableElements:function(a){for(var b=[],d=0;d<a.length;d++){var e=a[d];"-1"!==c(e).attr("tabindex")&&b.push(e)}return b},filterVisibleElements:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];(d.offsetWidth>0||d.offsetHeight>0)&&b.push(d)}return b},getActiveDialog:function(){var a=document.querySelectorAll(".ngdialog");return 0===a.length?null:c(a[a.length-1])},applyAriaAttributes:function(a,b){if(b.ariaAuto){if(!b.ariaRole){var c=F.getFocusableElements(a).length>0?"dialog":"alertdialog";b.ariaRole=c}b.ariaLabelledBySelector||(b.ariaLabelledBySelector="h1,h2,h3,h4,h5,h6"),b.ariaDescribedBySelector||(b.ariaDescribedBySelector="article,section,p")}b.ariaRole&&a.attr("role",b.ariaRole),F.applyAriaAttribute(a,"aria-labelledby",b.ariaLabelledById,b.ariaLabelledBySelector),F.applyAriaAttribute(a,"aria-describedby",b.ariaDescribedById,b.ariaDescribedBySelector)},applyAriaAttribute:function(a,b,d,e){if(d)return void a.attr(b,d);if(e){var f=a.attr("id"),g=a[0].querySelector(e);if(!g)return;var h=f+"-"+b;return c(g).attr("id",h),a.attr(b,h),h}},detectUIRouter:function(){return D.has("$transitions")?r:!!D.has("$state")&&q},getRouterLocationEventName:function(){return F.detectUIRouter()?"$stateChangeStart":"$locationChangeStart"}},G={__PRIVATE__:F,open:function(f){function g(b,c){var c=c||{};return c.headers=c.headers||{},a.extend(c.headers,{Accept:"text/html"}),z.$broadcast("ngDialog.templateLoading",b),y.get(b,c).then(function(a){return z.$broadcast("ngDialog.templateLoaded",b),a.data||""})}function h(b){return b?a.isString(b)&&q.plain?b:"boolean"!=typeof q.cache||q.cache?g(b,{cache:v}):g(b,{cache:!1}):"Empty template"}var j=null;if(f=f||{},!(o&&f.name&&(j=f.name.toLowerCase().replace(/\s/g,"-")+"-dialog",this.isOpen(j)))){var q=a.copy(b),r=++e;j=j||"ngdialog"+r,l.push(j),"undefined"!=typeof q.data&&("undefined"==typeof f.data&&(f.data={}),f.data=a.merge(a.copy(q.data),f.data)),a.extend(q,f);var u;t[j]=u=x.defer();var H;k[j]=H=a.isObject(q.scope)?q.scope.$new():z.$new();var I,J,K,L=a.extend({},q.resolve);return a.forEach(L,function(b,c){L[c]=a.isString(b)?D.get(b):D.invoke(b,null,null,c)}),x.all({template:h(q.template||q.templateUrl),locals:x.all(L)}).then(function(b){var e=b.template,f=b.locals;q.showClose&&(e+='<button aria-label="Dismiss" class="ngdialog-close"></button>');var g=q.overlay?"":" ngdialog-no-overlay";if(I=c('<div id="'+j+'" class="ngdialog'+g+'"></div>'),I.html(q.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content" role="document">'+e+"</div>":'<div class="ngdialog-content" role="document">'+e+"</div>"),I.data("$ngDialogOptions",q),H.ngDialogId=j,q.data&&a.isString(q.data)){var h=q.data.replace(/^\s*/,"")[0];H.ngDialogData="{"===h||"["===h?a.fromJson(q.data):new String(q.data),H.ngDialogData.ngDialogId=j}else q.data&&a.isObject(q.data)&&(H.ngDialogData=q.data,H.ngDialogData.ngDialogId=j);if(q.className&&I.addClass(q.className),q.appendClassName&&I.addClass(q.appendClassName),q.width&&(K=I[0].querySelector(".ngdialog-content"),a.isString(q.width)?K.style.width=q.width:K.style.width=q.width+"px"),q.height&&(K=I[0].querySelector(".ngdialog-content"),a.isString(q.height)?K.style.height=q.height:K.style.height=q.height+"px"),q.disableAnimation&&I.addClass(i),J=q.appendTo&&a.isString(q.appendTo)?a.element(document.querySelector(q.appendTo)):E.body,F.applyAriaAttributes(I,q),[{name:"$ngDialogPreCloseCallback",value:q.preCloseCallback},{name:"$ngDialogOnOpenCallback",value:q.onOpenCallback}].forEach(function(b){if(b.value){var c;a.isFunction(b.value)?c=b.value:a.isString(b.value)&&H&&(a.isFunction(H[b.value])?c=H[b.value]:H.$parent&&a.isFunction(H.$parent[b.value])?c=H.$parent[b.value]:z&&a.isFunction(z[b.value])&&(c=z[b.value])),c&&I.data(b.name,c)}}),H.closeThisDialog=function(a){F.closeDialog(I,a)},q.controller&&(a.isString(q.controller)||a.isArray(q.controller)||a.isFunction(q.controller))){var k;q.controllerAs&&a.isString(q.controllerAs)&&(k=q.controllerAs);var l=C(q.controller,a.extend(f,{$scope:H,$element:I}),!0,k);q.bindToController&&a.extend(l.instance,{ngDialogId:H.ngDialogId,ngDialogData:H.ngDialogData,closeThisDialog:H.closeThisDialog,confirm:H.confirm}),"function"==typeof l?I.data("$ngDialogControllerController",l()):I.data("$ngDialogControllerController",l)}if(A(function(){var b=document.querySelectorAll(".ngdialog");F.deactivateAll(b),w(I)(H);var c=B.innerWidth-E.body.prop("clientWidth");E.html.addClass(q.bodyClassName),E.body.addClass(q.bodyClassName),m.push(q.bodyClassName);var d=c-(B.innerWidth-E.body.prop("clientWidth"));d>0&&F.setBodyPadding(d),J.append(I),F.activate(I),q.trapFocus&&F.autoFocus(I),q.name?z.$broadcast("ngDialog.opened",{dialog:I,name:q.name}):z.$broadcast("ngDialog.opened",I);var e=I.data("$ngDialogOnOpenCallback");e&&a.isFunction(e)&&e.call(I)}),n||(E.body.bind("keydown",F.onDocumentKeydown),n=!0),q.closeByNavigation&&p.push(I),q.preserveFocus&&I.data("$ngDialogPreviousFocus",document.activeElement),d=function(a){var b=!!q.closeByDocument&&c(a.target).hasClass("ngdialog-overlay"),d=c(a.target).hasClass("ngdialog-close");(b||d)&&G.close(I.attr("id"),d?"$closeButton":"$document")},"undefined"!=typeof B.Hammer){var o=H.hammerTime=B.Hammer(I[0]);o.on("tap",d)}else I.bind("click",d);return s+=1,G}),{id:j,closePromise:u.promise,close:function(a){F.closeDialog(I,a)}}}},openConfirm:function(d){var e=x.defer(),f=a.copy(b);d=d||{},"undefined"!=typeof f.data&&("undefined"==typeof d.data&&(d.data={}),d.data=a.merge(a.copy(f.data),d.data)),a.extend(f,d),f.scope=a.isObject(f.scope)?f.scope.$new():z.$new(),f.scope.confirm=function(a){e.resolve(a);var b=c(document.getElementById(g.id));F.performCloseDialog(b,a)};var g=G.open(f);if(g)return g.closePromise.then(function(a){return a?e.reject(a.value):e.reject()}),e.promise},isOpen:function(a){var b=c(document.getElementById(a));return b.length>0},close:function(a,b){var d=c(document.getElementById(a));if(d.length)F.closeDialog(d,b);else if("$escape"===a){var e=l[l.length-1];d=c(document.getElementById(e)),d.data("$ngDialogOptions").closeByEscape&&F.closeDialog(d,"$escape")}else G.closeAll(b);return G},closeAll:function(a){for(var b=document.querySelectorAll(".ngdialog"),d=b.length-1;d>=0;d--){var e=b[d];F.closeDialog(c(e),a)}},getOpenDialogs:function(){return l},getDefaults:function(){return b}};a.forEach(["html","body"],function(a){if(E[a]=u.find(a),j[a]){var b=F.getRouterLocationEventName();z.$on(b,function(){E[a]=u.find(a)})}});var H=F.detectUIRouter();if(H===r){var I=D.get("$transitions");I.onStart({},function(a){for(;p.length>0;){var b=p.pop();if(F.closeDialog(b)===!1)return!1}})}else{var J=H===q?"$stateChangeStart":"$locationChangeStart";z.$on(J,function(a){for(;p.length>0;){var b=p.pop();F.closeDialog(b)===!1&&a.preventDefault()}})}return G}]}),b.directive("ngDialog",["ngDialog",function(b){return{restrict:"A",scope:{ngDialogScope:"="},link:function(c,d,e){d.on("click",function(d){d.preventDefault();var f=a.isDefined(c.ngDialogScope)?c.ngDialogScope:"noScope";a.isDefined(e.ngDialogClosePrevious)&&b.close(e.ngDialogClosePrevious);var g=b.getDefaults();b.open({template:e.ngDialog,className:e.ngDialogClass||g.className,appendClassName:e.ngDialogAppendClass,controller:e.ngDialogController,controllerAs:e.ngDialogControllerAs,bindToController:e.ngDialogBindToController,disableAnimation:e.ngDialogDisableAnimation,scope:f,data:e.ngDialogData,showClose:"false"!==e.ngDialogShowClose&&("true"===e.ngDialogShowClose||g.showClose),closeByDocument:"false"!==e.ngDialogCloseByDocument&&("true"===e.ngDialogCloseByDocument||g.closeByDocument),closeByEscape:"false"!==e.ngDialogCloseByEscape&&("true"===e.ngDialogCloseByEscape||g.closeByEscape),overlay:"false"!==e.ngDialogOverlay&&("true"===e.ngDialogOverlay||g.overlay),preCloseCallback:e.ngDialogPreCloseCallback||g.preCloseCallback,onOpenCallback:e.ngDialogOnOpenCallback||g.onOpenCallback,bodyClassName:e.ngDialogBodyClass||g.bodyClassName})})}}}]),b});
(function(e){var b;e.fn.emptyForce=function(){for(var j=0,k;(k=e(this)[j])!=null;j++){if(k.nodeType===1){e.cleanData(k.getElementsByTagName("*"))}if(e.jqplot.use_excanvas){k.outerHTML=""}else{while(k.firstChild){k.removeChild(k.firstChild)}}k=null}return e(this)};e.fn.removeChildForce=function(j){while(j.firstChild){this.removeChildForce(j.firstChild);j.removeChild(j.firstChild)}};e.fn.jqplot=function(){var j=[];var m=[];for(var n=0,k=arguments.length;n<k;n++){if(e.isArray(arguments[n])){j.push(arguments[n])}else{if(e.isPlainObject(arguments[n])){m.push(arguments[n])}}}return this.each(function(p){var u,t,s=e(this),o=j.length,l=m.length,r,q;if(p<o){r=j[p]}else{r=o?j[o-1]:null}if(p<l){q=m[p]}else{q=l?m[l-1]:null}u=s.attr("id");if(u===b){u="jqplot_target_"+e.jqplot.targetCounter++;s.attr("id",u)}t=e.jqplot(u,r,q);s.data("jqplot",t)})};e.jqplot=function(p,m,k){var l=null,j=null;if(arguments.length===3){l=m;j=k}else{if(arguments.length===2){if(e.isArray(m)){l=m}else{if(e.isPlainObject(m)){j=m
}}}}if(l===null&&j!==null&&j.data){l=j.data}var o=new h();e("#"+p).removeClass("jqplot-error");if(e.jqplot.config.catchErrors){try{o.init(p,l,j);o.draw();o.themeEngine.init.call(o);return o}catch(n){var q=e.jqplot.config.errorMessage||n.message;e("#"+p).append('<div class="jqplot-error-message">'+q+"</div>");e("#"+p).addClass("jqplot-error");document.getElementById(p).style.background=e.jqplot.config.errorBackground;document.getElementById(p).style.border=e.jqplot.config.errorBorder;document.getElementById(p).style.fontFamily=e.jqplot.config.errorFontFamily;document.getElementById(p).style.fontSize=e.jqplot.config.errorFontSize;document.getElementById(p).style.fontStyle=e.jqplot.config.errorFontStyle;document.getElementById(p).style.fontWeight=e.jqplot.config.errorFontWeight}}else{o.init(p,l,j);o.draw();o.themeEngine.init.call(o);return o}};e.jqplot.version="@VERSION";e.jqplot.revision="@REVISION";e.jqplot.targetCounter=1;e.jqplot.CanvasManager=function(){if(typeof e.jqplot.CanvasManager.canvases=="undefined"){e.jqplot.CanvasManager.canvases=[];
e.jqplot.CanvasManager.free=[]}var j=[];this.getCanvas=function(){var n;var m=true;if(!e.jqplot.use_excanvas){for(var o=0,k=e.jqplot.CanvasManager.canvases.length;o<k;o++){if(e.jqplot.CanvasManager.free[o]===true){m=false;n=e.jqplot.CanvasManager.canvases[o];e.jqplot.CanvasManager.free[o]=false;j.push(o);break}}}if(m){n=document.createElement("canvas");j.push(e.jqplot.CanvasManager.canvases.length);e.jqplot.CanvasManager.canvases.push(n);e.jqplot.CanvasManager.free.push(false)}return n};this.initCanvas=function(m){if(e.jqplot.use_excanvas){return window.G_vmlCanvasManager.initElement(m)}var l=m.getContext("2d");var n=1;if(window.devicePixelRatio>1&&(l.webkitBackingStorePixelRatio===b||l.webkitBackingStorePixelRatio<2)){n=window.devicePixelRatio}var k=m.width;var o=m.height;m.width=n*m.width;m.height=n*m.height;m.style.width=k+"px";m.style.height=o+"px";l.save();l.scale(n,n);return m};this.freeAllCanvases=function(){for(var m=0,k=j.length;m<k;m++){this.freeCanvas(j[m])}j=[]};this.freeCanvas=function(k){if(e.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==b){window.G_vmlCanvasManager.uninitElement(e.jqplot.CanvasManager.canvases[k]);
e.jqplot.CanvasManager.canvases[k]=null}else{var l=e.jqplot.CanvasManager.canvases[k];l.getContext("2d").clearRect(0,0,l.width,l.height);e(l).unbind().removeAttr("class").removeAttr("style");e(l).css({left:"",top:"",position:""});l.width=0;l.height=0;e.jqplot.CanvasManager.free[k]=true}}};e.jqplot.log=function(){if(window.console){window.console.log.apply(window.console,arguments)}};e.jqplot.config={addDomReference:false,enablePlugins:false,defaultHeight:300,defaultWidth:400,UTCAdjust:false,timezoneOffset:new Date(new Date().getTimezoneOffset()*60000),errorMessage:"",errorBackground:"",errorBorder:"",errorFontFamily:"",errorFontSize:"",errorFontStyle:"",errorFontWeight:"",catchErrors:false,defaultTickFormatString:"%.1f",defaultColors:["#4bb2c5","#EAA228","#c5b47f","#579575","#839557","#958c12","#953579","#4b5de4","#d8b83f","#ff5800","#0085cc","#c747a3","#cddf54","#FBD178","#26B4E3","#bd70c7"],defaultNegativeColors:["#498991","#C08840","#9F9274","#546D61","#646C4A","#6F6621","#6E3F5F","#4F64B0","#A89050","#C45923","#187399","#945381","#959E5C","#C7AF7B","#478396","#907294"],dashLength:4,gapLength:4,dotGapLength:2.5,srcLocation:"jqplot/src/",pluginLocation:"jqplot/src/plugins/"};
e.jqplot.arrayMax=function(j){return Math.max.apply(Math,j)};e.jqplot.arrayMin=function(j){return Math.min.apply(Math,j)};e.jqplot.enablePlugins=e.jqplot.config.enablePlugins;e.jqplot.support_canvas=function(){if(typeof e.jqplot.support_canvas.result=="undefined"){e.jqplot.support_canvas.result=!!document.createElement("canvas").getContext}return e.jqplot.support_canvas.result};e.jqplot.support_canvas_text=function(){if(typeof e.jqplot.support_canvas_text.result=="undefined"){if(window.G_vmlCanvasManager!==b&&window.G_vmlCanvasManager._version>887){e.jqplot.support_canvas_text.result=true}else{e.jqplot.support_canvas_text.result=!!(document.createElement("canvas").getContext&&typeof document.createElement("canvas").getContext("2d").fillText=="function")}}return e.jqplot.support_canvas_text.result};e.jqplot.use_excanvas=((!e.support.boxModel||!e.support.objectAll||!$support.leadingWhitespace)&&!e.jqplot.support_canvas())?true:false;e.jqplot.preInitHooks=[];e.jqplot.postInitHooks=[];e.jqplot.preParseOptionsHooks=[];
e.jqplot.postParseOptionsHooks=[];e.jqplot.preDrawHooks=[];e.jqplot.postDrawHooks=[];e.jqplot.preDrawSeriesHooks=[];e.jqplot.postDrawSeriesHooks=[];e.jqplot.preDrawLegendHooks=[];e.jqplot.addLegendRowHooks=[];e.jqplot.preSeriesInitHooks=[];e.jqplot.postSeriesInitHooks=[];e.jqplot.preParseSeriesOptionsHooks=[];e.jqplot.postParseSeriesOptionsHooks=[];e.jqplot.eventListenerHooks=[];e.jqplot.preDrawSeriesShadowHooks=[];e.jqplot.postDrawSeriesShadowHooks=[];e.jqplot.ElemContainer=function(){this._elem;this._plotWidth;this._plotHeight;this._plotDimensions={height:null,width:null}};e.jqplot.ElemContainer.prototype.createElement=function(m,o,k,l,p){this._offsets=o;var j=k||"jqplot";var n=document.createElement(m);this._elem=e(n);this._elem.addClass(j);this._elem.css(l);this._elem.attr(p);n=null;return this._elem};e.jqplot.ElemContainer.prototype.getWidth=function(){if(this._elem){return this._elem.outerWidth(true)}else{return null}};e.jqplot.ElemContainer.prototype.getHeight=function(){if(this._elem){return this._elem.outerHeight(true)
}else{return null}};e.jqplot.ElemContainer.prototype.getPosition=function(){if(this._elem){return this._elem.position()}else{return{top:null,left:null,bottom:null,right:null}}};e.jqplot.ElemContainer.prototype.getTop=function(){return this.getPosition().top};e.jqplot.ElemContainer.prototype.getLeft=function(){return this.getPosition().left};e.jqplot.ElemContainer.prototype.getBottom=function(){return this._elem.css("bottom")};e.jqplot.ElemContainer.prototype.getRight=function(){return this._elem.css("right")};function g(j){e.jqplot.ElemContainer.call(this);this.name=j;this._series=[];this.show=false;this.tickRenderer=e.jqplot.AxisTickRenderer;this.tickOptions={};this.labelRenderer=e.jqplot.AxisLabelRenderer;this.labelOptions={};this.label=null;this.showLabel=true;this.min=null;this.max=null;this.autoscale=false;this.pad=1.2;this.padMax=null;this.padMin=null;this.ticks=[];this.numberTicks;this.tickInterval;this.renderer=e.jqplot.LinearAxisRenderer;this.rendererOptions={};this.showTicks=true;
this.showTickMarks=true;this.showMinorTicks=true;this.drawMajorGridlines=true;this.drawMinorGridlines=false;this.drawMajorTickMarks=true;this.drawMinorTickMarks=true;this.useSeriesColor=false;this.borderWidth=null;this.borderColor=null;this.scaleToHiddenSeries=false;this._dataBounds={min:null,max:null};this._intervalStats=[];this._offsets={min:null,max:null};this._ticks=[];this._label=null;this.syncTicks=null;this.tickSpacing=75;this._min=null;this._max=null;this._tickInterval=null;this._numberTicks=null;this.__ticks=null;this._options={}}g.prototype=new e.jqplot.ElemContainer();g.prototype.constructor=g;g.prototype.init=function(){if(e.isFunction(this.renderer)){this.renderer=new this.renderer()}this.tickOptions.axis=this.name;if(this.tickOptions.showMark==null){this.tickOptions.showMark=this.showTicks}if(this.tickOptions.showMark==null){this.tickOptions.showMark=this.showTickMarks}if(this.tickOptions.showLabel==null){this.tickOptions.showLabel=this.showTicks}if(this.label==null||this.label==""){this.showLabel=false
}else{this.labelOptions.label=this.label}if(this.showLabel==false){this.labelOptions.show=false}if(this.pad==0){this.pad=1}if(this.padMax==0){this.padMax=1}if(this.padMin==0){this.padMin=1}if(this.padMax==null){this.padMax=(this.pad-1)/2+1}if(this.padMin==null){this.padMin=(this.pad-1)/2+1}this.pad=this.padMax+this.padMin-1;if(this.min!=null||this.max!=null){this.autoscale=false}if(this.syncTicks==null&&this.name.indexOf("y")>-1){this.syncTicks=true}else{if(this.syncTicks==null){this.syncTicks=false}}this.renderer.init.call(this,this.rendererOptions)};g.prototype.draw=function(j,k){if(this.__ticks){this.__ticks=null}return this.renderer.draw.call(this,j,k)};g.prototype.set=function(){this.renderer.set.call(this)};g.prototype.pack=function(k,j){if(this.show){this.renderer.pack.call(this,k,j)}if(this._min==null){this._min=this.min;this._max=this.max;this._tickInterval=this.tickInterval;this._numberTicks=this.numberTicks;this.__ticks=this._ticks}};g.prototype.reset=function(){this.renderer.reset.call(this)
};g.prototype.resetScale=function(j){e.extend(true,this,{min:null,max:null,numberTicks:null,tickInterval:null,_ticks:[],ticks:[]},j);this.resetDataBounds()};g.prototype.resetDataBounds=function(){var t=this._dataBounds;t.min=null;t.max=null;var m,u,q;var n=(this.show)?true:false;for(var p=0;p<this._series.length;p++){u=this._series[p];if(u.show||this.scaleToHiddenSeries){q=u._plotData;if(u._type==="line"&&u.renderer.bands.show&&this.name.charAt(0)!=="x"){q=[[0,u.renderer.bands._min],[1,u.renderer.bands._max]]}var k=1,r=1;if(u._type!=null&&u._type=="ohlc"){k=3;r=2}for(var o=0,m=q.length;o<m;o++){if(this.name=="xaxis"||this.name=="x2axis"){if((q[o][0]!=null&&q[o][0]<t.min)||t.min==null){t.min=q[o][0]}if((q[o][0]!=null&&q[o][0]>t.max)||t.max==null){t.max=q[o][0]}}else{if((q[o][k]!=null&&q[o][k]<t.min)||t.min==null){t.min=q[o][k]}if((q[o][r]!=null&&q[o][r]>t.max)||t.max==null){t.max=q[o][r]}}}if(n&&u.renderer.constructor!==e.jqplot.BarRenderer){n=false}else{if(n&&this._options.hasOwnProperty("forceTickAt0")&&this._options.forceTickAt0==false){n=false
}else{if(n&&u.renderer.constructor===e.jqplot.BarRenderer){if(u.barDirection=="vertical"&&this.name!="xaxis"&&this.name!="x2axis"){if(this._options.pad!=null||this._options.padMin!=null){n=false}}else{if(u.barDirection=="horizontal"&&(this.name=="xaxis"||this.name=="x2axis")){if(this._options.pad!=null||this._options.padMin!=null){n=false}}}}}}}}if(n&&this.renderer.constructor===e.jqplot.LinearAxisRenderer&&t.min>=0){this.padMin=1;this.forceTickAt0=true}};function a(j){e.jqplot.ElemContainer.call(this);this.show=false;this.location="ne";this.labels=[];this.showLabels=true;this.showSwatches=true;this.placement="insideGrid";this.xoffset=0;this.yoffset=0;this.border;this.background;this.textColor;this.fontFamily;this.fontSize;this.rowSpacing="0.5em";this.renderer=e.jqplot.TableLegendRenderer;this.rendererOptions={};this.preDraw=false;this.marginTop=null;this.marginRight=null;this.marginBottom=null;this.marginLeft=null;this.escapeHtml=false;this._series=[];e.extend(true,this,j)}a.prototype=new e.jqplot.ElemContainer();
a.prototype.constructor=a;a.prototype.setOptions=function(j){e.extend(true,this,j);if(this.placement=="inside"){this.placement="insideGrid"}if(this.xoffset>0){if(this.placement=="insideGrid"){switch(this.location){case"nw":case"w":case"sw":if(this.marginLeft==null){this.marginLeft=this.xoffset+"px"}this.marginRight="0px";break;case"ne":case"e":case"se":default:if(this.marginRight==null){this.marginRight=this.xoffset+"px"}this.marginLeft="0px";break}}else{if(this.placement=="outside"){switch(this.location){case"nw":case"w":case"sw":if(this.marginRight==null){this.marginRight=this.xoffset+"px"}this.marginLeft="0px";break;case"ne":case"e":case"se":default:if(this.marginLeft==null){this.marginLeft=this.xoffset+"px"}this.marginRight="0px";break}}}this.xoffset=0}if(this.yoffset>0){if(this.placement=="outside"){switch(this.location){case"sw":case"s":case"se":if(this.marginTop==null){this.marginTop=this.yoffset+"px"}this.marginBottom="0px";break;case"ne":case"n":case"nw":default:if(this.marginBottom==null){this.marginBottom=this.yoffset+"px"
}this.marginTop="0px";break}}else{if(this.placement=="insideGrid"){switch(this.location){case"sw":case"s":case"se":if(this.marginBottom==null){this.marginBottom=this.yoffset+"px"}this.marginTop="0px";break;case"ne":case"n":case"nw":default:if(this.marginTop==null){this.marginTop=this.yoffset+"px"}this.marginBottom="0px";break}}}this.yoffset=0}};a.prototype.init=function(){if(e.isFunction(this.renderer)){this.renderer=new this.renderer()}this.renderer.init.call(this,this.rendererOptions)};a.prototype.draw=function(k,l){for(var j=0;j<e.jqplot.preDrawLegendHooks.length;j++){e.jqplot.preDrawLegendHooks[j].call(this,k)}return this.renderer.draw.call(this,k,l)};a.prototype.pack=function(j){this.renderer.pack.call(this,j)};function f(j){e.jqplot.ElemContainer.call(this);this.text=j;this.show=true;this.fontFamily;this.fontSize;this.textAlign;this.textColor;this.renderer=e.jqplot.DivTitleRenderer;this.rendererOptions={};this.escapeHtml=false}f.prototype=new e.jqplot.ElemContainer();f.prototype.constructor=f;
f.prototype.init=function(){if(e.isFunction(this.renderer)){this.renderer=new this.renderer()}this.renderer.init.call(this,this.rendererOptions)};f.prototype.draw=function(j){return this.renderer.draw.call(this,j)};f.prototype.pack=function(){this.renderer.pack.call(this)};function i(j){j=j||{};e.jqplot.ElemContainer.call(this);this.show=true;this.xaxis="xaxis";this._xaxis;this.yaxis="yaxis";this._yaxis;this.gridBorderWidth=2;this.renderer=e.jqplot.LineRenderer;this.rendererOptions={};this.data=[];this.gridData=[];this.label="";this.showLabel=true;this.color;this.negativeColor;this.lineWidth=2.5;this.lineJoin="round";this.lineCap="round";this.linePattern="solid";this.shadow=true;this.shadowAngle=45;this.shadowOffset=1.25;this.shadowDepth=3;this.shadowAlpha="0.1";this.breakOnNull=false;this.markerRenderer=e.jqplot.MarkerRenderer;this.markerOptions={};this.showLine=true;this.showMarker=true;this.index;this.fill=false;this.fillColor;this.fillAlpha;this.fillAndStroke=false;this.disableStack=false;
this._stack=false;this.neighborThreshold=4;this.fillToZero=false;this.fillToValue=0;this.fillAxis="y";this.useNegativeColors=true;this._stackData=[];this._plotData=[];this._plotValues={x:[],y:[]};this._intervals={x:{},y:{}};this._prevPlotData=[];this._prevGridData=[];this._stackAxis="y";this._primaryAxis="_xaxis";this.canvas=new e.jqplot.GenericCanvas();this.shadowCanvas=new e.jqplot.GenericCanvas();this.plugins={};this._sumy=0;this._sumx=0;this._type=""}i.prototype=new e.jqplot.ElemContainer();i.prototype.constructor=i;i.prototype.init=function(n,r,p){this.index=n;this.gridBorderWidth=r;var q=this.data;var m=[],o,j;for(o=0,j=q.length;o<j;o++){if(!this.breakOnNull){if(q[o]==null||q[o][0]==null||q[o][1]==null){continue}else{m.push(q[o])}}else{m.push(q[o])}}this.data=m;if(!this.color){this.color=p.colorGenerator.get(this.index)}if(!this.negativeColor){this.negativeColor=p.negativeColorGenerator.get(this.index)}if(!this.fillColor){this.fillColor=this.color}if(this.fillAlpha){var k=e.jqplot.normalize2rgb(this.fillColor);
var k=e.jqplot.getColorComponents(k);this.fillColor="rgba("+k[0]+","+k[1]+","+k[2]+","+this.fillAlpha+")"}if(e.isFunction(this.renderer)){this.renderer=new this.renderer()}this.renderer.init.call(this,this.rendererOptions,p);this.markerRenderer=new this.markerRenderer();if(!this.markerOptions.color){this.markerOptions.color=this.color}if(this.markerOptions.show==null){this.markerOptions.show=this.showMarker}this.showMarker=this.markerOptions.show;this.markerRenderer.init(this.markerOptions)};i.prototype.draw=function(q,n,p){var l=(n==b)?{}:n;q=(q==b)?this.canvas._ctx:q;var k,o,m;for(k=0;k<e.jqplot.preDrawSeriesHooks.length;k++){e.jqplot.preDrawSeriesHooks[k].call(this,q,l)}if(this.show){this.renderer.setGridData.call(this,p);if(!l.preventJqPlotSeriesDrawTrigger){e(q.canvas).trigger("jqplotSeriesDraw",[this.data,this.gridData])}o=[];if(l.data){o=l.data}else{if(!this._stack){o=this.data}else{o=this._plotData}}m=l.gridData||this.renderer.makeGridData.call(this,o,p);if(this._type==="line"&&this.renderer.smooth&&this.renderer._smoothedData.length){m=this.renderer._smoothedData
}this.renderer.draw.call(this,q,m,l,p)}for(k=0;k<e.jqplot.postDrawSeriesHooks.length;k++){e.jqplot.postDrawSeriesHooks[k].call(this,q,l,p)}q=n=p=k=o=m=null};i.prototype.drawShadow=function(q,n,p){var l=(n==b)?{}:n;q=(q==b)?this.shadowCanvas._ctx:q;var k,o,m;for(k=0;k<e.jqplot.preDrawSeriesShadowHooks.length;k++){e.jqplot.preDrawSeriesShadowHooks[k].call(this,q,l)}if(this.shadow){this.renderer.setGridData.call(this,p);o=[];if(l.data){o=l.data}else{if(!this._stack){o=this.data}else{o=this._plotData}}m=l.gridData||this.renderer.makeGridData.call(this,o,p);this.renderer.drawShadow.call(this,q,m,l,p)}for(k=0;k<e.jqplot.postDrawSeriesShadowHooks.length;k++){e.jqplot.postDrawSeriesShadowHooks[k].call(this,q,l)}q=n=p=k=o=m=null};i.prototype.toggleDisplay=function(k,m){var j,l;if(k.data.series){j=k.data.series}else{j=this}if(k.data.speed){l=k.data.speed}if(l){if(j.canvas._elem.is(":hidden")||!j.show){j.show=true;j.canvas._elem.removeClass("jqplot-series-hidden");if(j.shadowCanvas._elem){j.shadowCanvas._elem.fadeIn(l)
}j.canvas._elem.fadeIn(l,m);j.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+j.index).fadeIn(l)}else{j.show=false;j.canvas._elem.addClass("jqplot-series-hidden");if(j.shadowCanvas._elem){j.shadowCanvas._elem.fadeOut(l)}j.canvas._elem.fadeOut(l,m);j.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+j.index).fadeOut(l)}}else{if(j.canvas._elem.is(":hidden")||!j.show){j.show=true;j.canvas._elem.removeClass("jqplot-series-hidden");if(j.shadowCanvas._elem){j.shadowCanvas._elem.show()}j.canvas._elem.show(0,m);j.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+j.index).show()}else{j.show=false;j.canvas._elem.addClass("jqplot-series-hidden");if(j.shadowCanvas._elem){j.shadowCanvas._elem.hide()}j.canvas._elem.hide(0,m);j.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+j.index).hide()}}};function d(){e.jqplot.ElemContainer.call(this);this.drawGridlines=true;this.gridLineColor="#cccccc";this.gridLineWidth=1;this.background="#fffdf6";this.borderColor="#999999";this.borderWidth=2;
this.drawBorder=true;this.shadow=true;this.shadowAngle=45;this.shadowOffset=1.5;this.shadowWidth=3;this.shadowDepth=3;this.shadowColor=null;this.shadowAlpha="0.07";this._left;this._top;this._right;this._bottom;this._width;this._height;this._axes=[];this.renderer=e.jqplot.CanvasGridRenderer;this.rendererOptions={};this._offsets={top:null,bottom:null,left:null,right:null}}d.prototype=new e.jqplot.ElemContainer();d.prototype.constructor=d;d.prototype.init=function(){if(e.isFunction(this.renderer)){this.renderer=new this.renderer()}this.renderer.init.call(this,this.rendererOptions)};d.prototype.createElement=function(j,k){this._offsets=j;return this.renderer.createElement.call(this,k)};d.prototype.draw=function(){this.renderer.draw.call(this)};e.jqplot.GenericCanvas=function(){e.jqplot.ElemContainer.call(this);this._ctx};e.jqplot.GenericCanvas.prototype=new e.jqplot.ElemContainer();e.jqplot.GenericCanvas.prototype.constructor=e.jqplot.GenericCanvas;e.jqplot.GenericCanvas.prototype.createElement=function(n,l,k,o){this._offsets=n;
var j="jqplot";if(l!=b){j=l}var m;m=o.canvasManager.getCanvas();if(k!=null){this._plotDimensions=k}m.width=this._plotDimensions.width-this._offsets.left-this._offsets.right;m.height=this._plotDimensions.height-this._offsets.top-this._offsets.bottom;this._elem=e(m);this._elem.css({position:"absolute",left:this._offsets.left,top:this._offsets.top});this._elem.addClass(j);m=o.canvasManager.initCanvas(m);m=null;return this._elem};e.jqplot.GenericCanvas.prototype.setContext=function(){this._ctx=this._elem.get(0).getContext("2d");return this._ctx};e.jqplot.GenericCanvas.prototype.resetCanvas=function(){if(this._elem){if(e.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==b){window.G_vmlCanvasManager.uninitElement(this._elem.get(0))}this._elem.emptyForce()}this._ctx=null};e.jqplot.HooksManager=function(){this.hooks=[];this.args=[]};e.jqplot.HooksManager.prototype.addOnce=function(n,k){k=k||[];var o=false;for(var m=0,j=this.hooks.length;m<j;m++){if(this.hooks[m]==n){o=true}}if(!o){this.hooks.push(n);
this.args.push(k)}};e.jqplot.HooksManager.prototype.add=function(k,j){j=j||[];this.hooks.push(k);this.args.push(j)};e.jqplot.EventListenerManager=function(){this.hooks=[]};e.jqplot.EventListenerManager.prototype.addOnce=function(o,n){var p=false,m,k;for(var k=0,j=this.hooks.length;k<j;k++){m=this.hooks[k];if(m[0]==o&&m[1]==n){p=true}}if(!p){this.hooks.push([o,n])}};e.jqplot.EventListenerManager.prototype.add=function(k,j){this.hooks.push([k,j])};var c=["yMidAxis","xaxis","yaxis","x2axis","y2axis","y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis"];function h(){this.animate=false;this.animateReplot=false;this.axes={xaxis:new g("xaxis"),yaxis:new g("yaxis"),x2axis:new g("x2axis"),y2axis:new g("y2axis"),y3axis:new g("y3axis"),y4axis:new g("y4axis"),y5axis:new g("y5axis"),y6axis:new g("y6axis"),y7axis:new g("y7axis"),y8axis:new g("y8axis"),y9axis:new g("y9axis"),yMidAxis:new g("yMidAxis")};this.baseCanvas=new e.jqplot.GenericCanvas();this.captureRightClick=false;this.data=[];this.dataRenderer;
this.dataRendererOptions;this.defaults={axesDefaults:{},axes:{xaxis:{},yaxis:{},x2axis:{},y2axis:{},y3axis:{},y4axis:{},y5axis:{},y6axis:{},y7axis:{},y8axis:{},y9axis:{},yMidAxis:{}},seriesDefaults:{},series:[]};this.defaultAxisStart=1;this.drawIfHidden=false;this.eventCanvas=new e.jqplot.GenericCanvas();this.fillBetween={series1:null,series2:null,color:null,baseSeries:0,fill:true};this.fontFamily;this.fontSize;this.grid=new d();this.legend=new a();this.noDataIndicator={show:false,indicator:"Loading Data...",axes:{xaxis:{min:0,max:10,tickInterval:2,show:true},yaxis:{min:0,max:12,tickInterval:3,show:true}}};this.negativeSeriesColors=e.jqplot.config.defaultNegativeColors;this.options={};this.previousSeriesStack=[];this.plugins={};this.series=[];this.seriesStack=[];this.seriesColors=e.jqplot.config.defaultColors;this.sortData=true;this.stackSeries=false;this.syncXTicks=true;this.syncYTicks=true;this.target=null;this.targetId=null;this.textColor;this.title=new f();this._drawCount=0;this._sumy=0;
this._sumx=0;this._stackData=[];this._plotData=[];this._width=null;this._height=null;this._plotDimensions={height:null,width:null};this._gridPadding={top:null,right:null,bottom:null,left:null};this._defaultGridPadding={top:10,right:10,bottom:23,left:10};this._addDomReference=e.jqplot.config.addDomReference;this.preInitHooks=new e.jqplot.HooksManager();this.postInitHooks=new e.jqplot.HooksManager();this.preParseOptionsHooks=new e.jqplot.HooksManager();this.postParseOptionsHooks=new e.jqplot.HooksManager();this.preDrawHooks=new e.jqplot.HooksManager();this.postDrawHooks=new e.jqplot.HooksManager();this.preDrawSeriesHooks=new e.jqplot.HooksManager();this.postDrawSeriesHooks=new e.jqplot.HooksManager();this.preDrawLegendHooks=new e.jqplot.HooksManager();this.addLegendRowHooks=new e.jqplot.HooksManager();this.preSeriesInitHooks=new e.jqplot.HooksManager();this.postSeriesInitHooks=new e.jqplot.HooksManager();this.preParseSeriesOptionsHooks=new e.jqplot.HooksManager();this.postParseSeriesOptionsHooks=new e.jqplot.HooksManager();
this.eventListenerHooks=new e.jqplot.EventListenerManager();this.preDrawSeriesShadowHooks=new e.jqplot.HooksManager();this.postDrawSeriesShadowHooks=new e.jqplot.HooksManager();this.colorGenerator=new e.jqplot.ColorGenerator();this.negativeColorGenerator=new e.jqplot.ColorGenerator();this.canvasManager=new e.jqplot.CanvasManager();this.themeEngine=new e.jqplot.ThemeEngine();var l=0;this.init=function(x,t,z){z=z||{};for(var u=0;u<e.jqplot.preInitHooks.length;u++){e.jqplot.preInitHooks[u].call(this,x,t,z)}for(var u=0;u<this.preInitHooks.hooks.length;u++){this.preInitHooks.hooks[u].call(this,x,t,z)}this.targetId="#"+x;this.target=e("#"+x);if(this._addDomReference){this.target.data("jqplot",this)}this.target.removeClass("jqplot-error");if(!this.target.get(0)){throw new Error("No plot target specified")}if(this.target.css("position")=="static"){this.target.css("position","relative")}if(!this.target.hasClass("jqplot-target")){this.target.addClass("jqplot-target")}if(!this.target.height()){var v;
if(z&&z.height){v=parseInt(z.height,10)}else{if(this.target.attr("data-height")){v=parseInt(this.target.attr("data-height"),10)}else{v=parseInt(e.jqplot.config.defaultHeight,10)}}this._height=v;this.target.css("height",v+"px")}else{this._height=v=this.target.height()}if(!this.target.width()){var y;if(z&&z.width){y=parseInt(z.width,10)}else{if(this.target.attr("data-width")){y=parseInt(this.target.attr("data-width"),10)}else{y=parseInt(e.jqplot.config.defaultWidth,10)}}this._width=y;this.target.css("width",y+"px")}else{this._width=y=this.target.width()}for(var u=0,r=c.length;u<r;u++){this.axes[c[u]]=new g(c[u])}this._plotDimensions.height=this._height;this._plotDimensions.width=this._width;this.grid._plotDimensions=this._plotDimensions;this.title._plotDimensions=this._plotDimensions;this.baseCanvas._plotDimensions=this._plotDimensions;this.eventCanvas._plotDimensions=this._plotDimensions;this.legend._plotDimensions=this._plotDimensions;if(this._height<=0||this._width<=0||!this._height||!this._width){throw new Error("Canvas dimension not set")
}if(z.dataRenderer&&e.isFunction(z.dataRenderer)){if(z.dataRendererOptions){this.dataRendererOptions=z.dataRendererOptions}this.dataRenderer=z.dataRenderer;t=this.dataRenderer(t,this,this.dataRendererOptions)}if(z.noDataIndicator&&e.isPlainObject(z.noDataIndicator)){e.extend(true,this.noDataIndicator,z.noDataIndicator)}if(t==null||e.isArray(t)==false||t.length==0||e.isArray(t[0])==false||t[0].length==0){if(this.noDataIndicator.show==false){throw new Error("No data specified")}else{for(var n in this.noDataIndicator.axes){for(var p in this.noDataIndicator.axes[n]){this.axes[n][p]=this.noDataIndicator.axes[n][p]}}this.postDrawHooks.add(function(){var E=this.eventCanvas.getHeight();var B=this.eventCanvas.getWidth();var A=e('<div class="jqplot-noData-container" style="position:absolute;"></div>');this.target.append(A);A.height(E);A.width(B);A.css("top",this.eventCanvas._offsets.top);A.css("left",this.eventCanvas._offsets.left);var D=e('<div class="jqplot-noData-contents" style="text-align:center; position:relative; margin-left:auto; margin-right:auto;"></div>');
A.append(D);D.html(this.noDataIndicator.indicator);var C=D.height();var w=D.width();D.height(C);D.width(w);D.css("top",(E-C)/2+"px")})}}this.data=e.extend(true,[],t);this.parseOptions(z);if(this.textColor){this.target.css("color",this.textColor)}if(this.fontFamily){this.target.css("font-family",this.fontFamily)}if(this.fontSize){this.target.css("font-size",this.fontSize)}this.title.init();this.legend.init();this._sumy=0;this._sumx=0;this.computePlotData();for(var u=0;u<this.series.length;u++){this.seriesStack.push(u);this.previousSeriesStack.push(u);this.series[u].shadowCanvas._plotDimensions=this._plotDimensions;this.series[u].canvas._plotDimensions=this._plotDimensions;for(var s=0;s<e.jqplot.preSeriesInitHooks.length;s++){e.jqplot.preSeriesInitHooks[s].call(this.series[u],x,this.data,this.options.seriesDefaults,this.options.series[u],this)}for(var s=0;s<this.preSeriesInitHooks.hooks.length;s++){this.preSeriesInitHooks.hooks[s].call(this.series[u],x,this.data,this.options.seriesDefaults,this.options.series[u],this)
}this.series[u]._plotDimensions=this._plotDimensions;this.series[u].init(u,this.grid.borderWidth,this);for(var s=0;s<e.jqplot.postSeriesInitHooks.length;s++){e.jqplot.postSeriesInitHooks[s].call(this.series[u],x,this.data,this.options.seriesDefaults,this.options.series[u],this)}for(var s=0;s<this.postSeriesInitHooks.hooks.length;s++){this.postSeriesInitHooks.hooks[s].call(this.series[u],x,this.data,this.options.seriesDefaults,this.options.series[u],this)}this._sumy+=this.series[u]._sumy;this._sumx+=this.series[u]._sumx}var o,q;for(var u=0,r=c.length;u<r;u++){o=c[u];q=this.axes[o];q._plotDimensions=this._plotDimensions;q.init();if(this.axes[o].borderColor==null){if(o.charAt(0)!=="x"&&q.useSeriesColor===true&&q.show){q.borderColor=q._series[0].color}else{q.borderColor=this.grid.borderColor}}}if(this.sortData){j(this.series)}this.grid.init();this.grid._axes=this.axes;this.legend._series=this.series;for(var u=0;u<e.jqplot.postInitHooks.length;u++){e.jqplot.postInitHooks[u].call(this,x,this.data,z)
}for(var u=0;u<this.postInitHooks.hooks.length;u++){this.postInitHooks.hooks[u].call(this,x,this.data,z)}};this.resetAxesScale=function(s,o){var q=o||{};var r=s||this.axes;if(r===true){r=this.axes}if(e.isArray(r)){for(var p=0;p<r.length;p++){this.axes[r[p]].resetScale(q[r[p]])}}else{if(typeof(r)==="object"){for(var n in r){this.axes[n].resetScale(q[n])}}}};this.reInitialize=function(w,n){var A=e.extend(true,{},this.options,n);var y=this.targetId.substr(1);var u=(w==null)?this.data:w;for(var x=0;x<e.jqplot.preInitHooks.length;x++){e.jqplot.preInitHooks[x].call(this,y,u,A)}for(var x=0;x<this.preInitHooks.hooks.length;x++){this.preInitHooks.hooks[x].call(this,y,u,A)}this._height=this.target.height();this._width=this.target.width();if(this._height<=0||this._width<=0||!this._height||!this._width){throw new Error("Target dimension not set")}this._plotDimensions.height=this._height;this._plotDimensions.width=this._width;this.grid._plotDimensions=this._plotDimensions;this.title._plotDimensions=this._plotDimensions;
this.baseCanvas._plotDimensions=this._plotDimensions;this.eventCanvas._plotDimensions=this._plotDimensions;this.legend._plotDimensions=this._plotDimensions;var o,z,v,q;for(var x=0,s=c.length;x<s;x++){o=c[x];q=this.axes[o];z=q._ticks;for(var v=0,r=z.length;v<r;v++){var p=z[v]._elem;if(p){if(e.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==b){window.G_vmlCanvasManager.uninitElement(p.get(0))}p.emptyForce();p=null;z._elem=null}}z=null;delete q.ticks;delete q._ticks;this.axes[o]=new g(o);this.axes[o]._plotWidth=this._width;this.axes[o]._plotHeight=this._height}if(w){if(A.dataRenderer&&e.isFunction(A.dataRenderer)){if(A.dataRendererOptions){this.dataRendererOptions=A.dataRendererOptions}this.dataRenderer=A.dataRenderer;w=this.dataRenderer(w,this,this.dataRendererOptions)}this.data=e.extend(true,[],w)}if(n){this.parseOptions(A)}this.title._plotWidth=this._width;if(this.textColor){this.target.css("color",this.textColor)}if(this.fontFamily){this.target.css("font-family",this.fontFamily)
}if(this.fontSize){this.target.css("font-size",this.fontSize)}this.title.init();this.legend.init();this._sumy=0;this._sumx=0;this.seriesStack=[];this.previousSeriesStack=[];this.computePlotData();for(var x=0,s=this.series.length;x<s;x++){this.seriesStack.push(x);this.previousSeriesStack.push(x);this.series[x].shadowCanvas._plotDimensions=this._plotDimensions;this.series[x].canvas._plotDimensions=this._plotDimensions;for(var v=0;v<e.jqplot.preSeriesInitHooks.length;v++){e.jqplot.preSeriesInitHooks[v].call(this.series[x],y,this.data,this.options.seriesDefaults,this.options.series[x],this)}for(var v=0;v<this.preSeriesInitHooks.hooks.length;v++){this.preSeriesInitHooks.hooks[v].call(this.series[x],y,this.data,this.options.seriesDefaults,this.options.series[x],this)}this.series[x]._plotDimensions=this._plotDimensions;this.series[x].init(x,this.grid.borderWidth,this);for(var v=0;v<e.jqplot.postSeriesInitHooks.length;v++){e.jqplot.postSeriesInitHooks[v].call(this.series[x],y,this.data,this.options.seriesDefaults,this.options.series[x],this)
}for(var v=0;v<this.postSeriesInitHooks.hooks.length;v++){this.postSeriesInitHooks.hooks[v].call(this.series[x],y,this.data,this.options.seriesDefaults,this.options.series[x],this)}this._sumy+=this.series[x]._sumy;this._sumx+=this.series[x]._sumx}for(var x=0,s=c.length;x<s;x++){o=c[x];q=this.axes[o];q._plotDimensions=this._plotDimensions;q.init();if(q.borderColor==null){if(o.charAt(0)!=="x"&&q.useSeriesColor===true&&q.show){q.borderColor=q._series[0].color}else{q.borderColor=this.grid.borderColor}}}if(this.sortData){j(this.series)}this.grid.init();this.grid._axes=this.axes;this.legend._series=this.series;for(var x=0,s=e.jqplot.postInitHooks.length;x<s;x++){e.jqplot.postInitHooks[x].call(this,y,this.data,A)}for(var x=0,s=this.postInitHooks.hooks.length;x<s;x++){this.postInitHooks.hooks[x].call(this,y,this.data,A)}};this.quickInit=function(){this._height=this.target.height();this._width=this.target.width();if(this._height<=0||this._width<=0||!this._height||!this._width){throw new Error("Target dimension not set")
}this._plotDimensions.height=this._height;this._plotDimensions.width=this._width;this.grid._plotDimensions=this._plotDimensions;this.title._plotDimensions=this._plotDimensions;this.baseCanvas._plotDimensions=this._plotDimensions;this.eventCanvas._plotDimensions=this._plotDimensions;this.legend._plotDimensions=this._plotDimensions;for(var u in this.axes){this.axes[u]._plotWidth=this._width;this.axes[u]._plotHeight=this._height}this.title._plotWidth=this._width;if(this.textColor){this.target.css("color",this.textColor)}if(this.fontFamily){this.target.css("font-family",this.fontFamily)}if(this.fontSize){this.target.css("font-size",this.fontSize)}this._sumy=0;this._sumx=0;this.computePlotData();for(var r=0;r<this.series.length;r++){if(this.series[r]._type==="line"&&this.series[r].renderer.bands.show){this.series[r].renderer.initBands.call(this.series[r],this.series[r].renderer.options,this)}this.series[r]._plotDimensions=this._plotDimensions;this.series[r].canvas._plotDimensions=this._plotDimensions;
this._sumy+=this.series[r]._sumy;this._sumx+=this.series[r]._sumx}var p;for(var o=0;o<12;o++){p=c[o];var q=this.axes[p]._ticks;for(var r=0;r<q.length;r++){var s=q[r]._elem;if(s){if(e.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==b){window.G_vmlCanvasManager.uninitElement(s.get(0))}s.emptyForce();s=null;q._elem=null}}q=null;this.axes[p]._plotDimensions=this._plotDimensions;this.axes[p]._ticks=[]}if(this.sortData){j(this.series)}this.grid._axes=this.axes;this.legend._series=this.series};function j(s){var w,x,y,o,v;for(var t=0;t<s.length;t++){var p;var u=[s[t].data,s[t]._stackData,s[t]._plotData,s[t]._prevPlotData];for(var q=0;q<4;q++){p=true;w=u[q];if(s[t]._stackAxis=="x"){for(var r=0;r<w.length;r++){if(typeof(w[r][1])!="number"){p=false;break}}if(p){w.sort(function(z,n){return z[1]-n[1]})}}else{for(var r=0;r<w.length;r++){if(typeof(w[r][0])!="number"){p=false;break}}if(p){w.sort(function(z,n){return z[0]-n[0]})}}}}}this.computePlotData=function(){this._plotData=[];this._stackData=[];
var u,v,q;for(v=0,q=this.series.length;v<q;v++){u=this.series[v];this._plotData.push([]);this._stackData.push([]);var o=u.data;this._plotData[v]=e.extend(true,[],o);this._stackData[v]=e.extend(true,[],o);u._plotData=this._plotData[v];u._stackData=this._stackData[v];var y={x:[],y:[]};if(this.stackSeries&&!u.disableStack){u._stack=true;var w=(u._stackAxis==="x")?0:1;for(var r=0,n=o.length;r<n;r++){var x=o[r][w];if(x==null){x=0}this._plotData[v][r][w]=x;this._stackData[v][r][w]=x;if(v>0){for(var s=v;s--;){var p=this._plotData[s][r][w];if(x*p>=0){this._plotData[v][r][w]+=p;this._stackData[v][r][w]+=p;break}}}}}else{for(var t=0;t<u.data.length;t++){y.x.push(u.data[t][0]);y.y.push(u.data[t][1])}this._stackData.push(u.data);this.series[v]._stackData=u.data;this._plotData.push(u.data);u._plotData=u.data;u._plotValues=y}if(v>0){u._prevPlotData=this.series[v-1]._plotData}u._sumy=0;u._sumx=0;for(t=u.data.length-1;t>-1;t--){u._sumy+=u.data[t][1];u._sumx+=u.data[t][0]}}};this.populatePlotData=function(v,w){this._plotData=[];
this._stackData=[];v._stackData=[];v._plotData=[];var z={x:[],y:[]};if(this.stackSeries&&!v.disableStack){v._stack=true;var y=(v._stackAxis==="x")?0:1;var A=e.extend(true,[],v.data);var B=e.extend(true,[],v.data);var p,o,q,x,n;for(var t=0;t<w;t++){var r=this.series[t].data;for(var s=0;s<r.length;s++){q=r[s];p=(q[0]!=null)?q[0]:0;o=(q[1]!=null)?q[1]:0;A[s][0]+=p;A[s][1]+=o;x=(y)?o:p;if(v.data[s][y]*x>=0){B[s][y]+=x}}}for(var u=0;u<B.length;u++){z.x.push(B[u][0]);z.y.push(B[u][1])}this._plotData.push(B);this._stackData.push(A);v._stackData=A;v._plotData=B;v._plotValues=z}else{for(var u=0;u<v.data.length;u++){z.x.push(v.data[u][0]);z.y.push(v.data[u][1])}this._stackData.push(v.data);this.series[w]._stackData=v.data;this._plotData.push(v.data);v._plotData=v.data;v._plotValues=z}if(w>0){v._prevPlotData=this.series[w-1]._plotData}v._sumy=0;v._sumx=0;for(u=v.data.length-1;u>-1;u--){v._sumy+=v.data[u][1];v._sumx+=v.data[u][0]}};this.getNextSeriesColor=(function(o){var n=0;var p=o.seriesColors;return function(){if(n<p.length){return p[n++]
}else{n=0;return p[n++]}}})(this);this.parseOptions=function(A){for(var v=0;v<this.preParseOptionsHooks.hooks.length;v++){this.preParseOptionsHooks.hooks[v].call(this,A)}for(var v=0;v<e.jqplot.preParseOptionsHooks.length;v++){e.jqplot.preParseOptionsHooks[v].call(this,A)}this.options=e.extend(true,{},this.defaults,A);var p=this.options;this.animate=p.animate;this.animateReplot=p.animateReplot;this.stackSeries=p.stackSeries;if(e.isPlainObject(p.fillBetween)){var z=["series1","series2","color","baseSeries","fill"],w;for(var v=0,t=z.length;v<t;v++){w=z[v];if(p.fillBetween[w]!=null){this.fillBetween[w]=p.fillBetween[w]}}}if(p.seriesColors){this.seriesColors=p.seriesColors}if(p.negativeSeriesColors){this.negativeSeriesColors=p.negativeSeriesColors}if(p.captureRightClick){this.captureRightClick=p.captureRightClick}this.defaultAxisStart=(A&&A.defaultAxisStart!=null)?A.defaultAxisStart:this.defaultAxisStart;this.colorGenerator.setColors(this.seriesColors);this.negativeColorGenerator.setColors(this.negativeSeriesColors);
e.extend(true,this._gridPadding,p.gridPadding);this.sortData=(p.sortData!=null)?p.sortData:this.sortData;for(var v=0;v<12;v++){var q=c[v];var s=this.axes[q];s._options=e.extend(true,{},p.axesDefaults,p.axes[q]);e.extend(true,s,p.axesDefaults,p.axes[q]);s._plotWidth=this._width;s._plotHeight=this._height}var y=function(E,C,F){var B=[];var D,n;C=C||"vertical";if(!e.isArray(E[0])){for(D=0,n=E.length;D<n;D++){if(C=="vertical"){B.push([F+D,E[D]])}else{B.push([E[D],F+D])}}}else{e.extend(true,B,E)}return B};var x=0;this.series=[];for(var v=0;v<this.data.length;v++){var o=e.extend(true,{index:v},{seriesColors:this.seriesColors,negativeSeriesColors:this.negativeSeriesColors},this.options.seriesDefaults,this.options.series[v],{rendererOptions:{animation:{show:this.animate}}});var z=new i(o);for(var u=0;u<e.jqplot.preParseSeriesOptionsHooks.length;u++){e.jqplot.preParseSeriesOptionsHooks[u].call(z,this.options.seriesDefaults,this.options.series[v])}for(var u=0;u<this.preParseSeriesOptionsHooks.hooks.length;
u++){this.preParseSeriesOptionsHooks.hooks[u].call(z,this.options.seriesDefaults,this.options.series[v])}e.extend(true,z,o);var r="vertical";if(z.renderer===e.jqplot.BarRenderer&&z.rendererOptions&&z.rendererOptions.barDirection=="horizontal"){r="horizontal";z._stackAxis="x";z._primaryAxis="_yaxis"}z.data=y(this.data[v],r,this.defaultAxisStart);switch(z.xaxis){case"xaxis":z._xaxis=this.axes.xaxis;break;case"x2axis":z._xaxis=this.axes.x2axis;break;default:break}z._yaxis=this.axes[z.yaxis];z._xaxis._series.push(z);z._yaxis._series.push(z);if(z.show){z._xaxis.show=true;z._yaxis.show=true}else{if(z._xaxis.scaleToHiddenSeries){z._xaxis.show=true}if(z._yaxis.scaleToHiddenSeries){z._yaxis.show=true}}if(!z.label){z.label="Series "+(v+1).toString()}this.series.push(z);for(var u=0;u<e.jqplot.postParseSeriesOptionsHooks.length;u++){e.jqplot.postParseSeriesOptionsHooks[u].call(this.series[v],this.options.seriesDefaults,this.options.series[v])}for(var u=0;u<this.postParseSeriesOptionsHooks.hooks.length;
u++){this.postParseSeriesOptionsHooks.hooks[u].call(this.series[v],this.options.seriesDefaults,this.options.series[v])}}e.extend(true,this.grid,this.options.grid);for(var v=0,t=c.length;v<t;v++){var q=c[v];var s=this.axes[q];if(s.borderWidth==null){s.borderWidth=this.grid.borderWidth}}if(typeof this.options.title=="string"){this.title.text=this.options.title}else{if(typeof this.options.title=="object"){e.extend(true,this.title,this.options.title)}}this.title._plotWidth=this._width;this.legend.setOptions(this.options.legend);for(var v=0;v<e.jqplot.postParseOptionsHooks.length;v++){e.jqplot.postParseOptionsHooks[v].call(this,A)}for(var v=0;v<this.postParseOptionsHooks.hooks.length;v++){this.postParseOptionsHooks.hooks[v].call(this,A)}};this.destroy=function(){this.canvasManager.freeAllCanvases();if(this.eventCanvas&&this.eventCanvas._elem){this.eventCanvas._elem.unbind()}this.target.empty();this.target[0].innerHTML=""};this.replot=function(o){var p=o||{};var r=p.data||null;var n=(p.clear===false)?false:true;
var q=p.resetAxes||false;delete p.data;delete p.clear;delete p.resetAxes;this.target.trigger("jqplotPreReplot");if(n){this.destroy()}if(r||!e.isEmptyObject(p)){this.reInitialize(r,p)}else{this.quickInit()}if(q){this.resetAxesScale(q,p.axes)}this.draw();this.target.trigger("jqplotPostReplot")};this.redraw=function(n){n=(n!=null)?n:true;this.target.trigger("jqplotPreRedraw");if(n){this.canvasManager.freeAllCanvases();this.eventCanvas._elem.unbind();this.target.empty()}for(var p in this.axes){this.axes[p]._ticks=[]}this.computePlotData();this._sumy=0;this._sumx=0;for(var o=0,q=this.series.length;o<q;o++){this._sumy+=this.series[o]._sumy;this._sumx+=this.series[o]._sumx}this.draw();this.target.trigger("jqplotPostRedraw")};this.draw=function(){if(this.drawIfHidden||this.target.is(":visible")){this.target.trigger("jqplotPreDraw");var I,G,F,r;for(I=0,F=e.jqplot.preDrawHooks.length;I<F;I++){e.jqplot.preDrawHooks[I].call(this)}for(I=0,F=this.preDrawHooks.hooks.length;I<F;I++){this.preDrawHooks.hooks[I].apply(this,this.preDrawSeriesHooks.args[I])
}this.target.append(this.baseCanvas.createElement({left:0,right:0,top:0,bottom:0},"jqplot-base-canvas",null,this));this.baseCanvas.setContext();this.target.append(this.title.draw());this.title.pack({top:0,left:0});var M=this.legend.draw({},this);var o={top:0,left:0,bottom:0,right:0};if(this.legend.placement=="outsideGrid"){this.target.append(M);switch(this.legend.location){case"n":o.top+=this.legend.getHeight();break;case"s":o.bottom+=this.legend.getHeight();break;case"ne":case"e":case"se":o.right+=this.legend.getWidth();break;case"nw":case"w":case"sw":o.left+=this.legend.getWidth();break;default:o.right+=this.legend.getWidth();break}M=M.detach()}var u=this.axes;var N;for(I=0;I<12;I++){N=c[I];this.target.append(u[N].draw(this.baseCanvas._ctx,this));u[N].set()}if(u.yaxis.show){o.left+=u.yaxis.getWidth()}var H=["y2axis","y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis"];var A=[0,0,0,0,0,0,0,0];var D=0;var C;for(C=0;C<8;C++){if(u[H[C]].show){D+=u[H[C]].getWidth();A[C]=D}}o.right+=D;
if(u.x2axis.show){o.top+=u.x2axis.getHeight()}if(this.title.show){o.top+=this.title.getHeight()}if(u.xaxis.show){o.bottom+=u.xaxis.getHeight()}if(this.options.gridDimensions&&e.isPlainObject(this.options.gridDimensions)){var v=parseInt(this.options.gridDimensions.width,10)||0;var J=parseInt(this.options.gridDimensions.height,10)||0;var q=(this._width-o.left-o.right-v)/2;var L=(this._height-o.top-o.bottom-J)/2;if(L>=0&&q>=0){o.top+=L;o.bottom+=L;o.left+=q;o.right+=q}}var p=["top","bottom","left","right"];for(var C in p){if(this._gridPadding[p[C]]==null&&o[p[C]]>0){this._gridPadding[p[C]]=o[p[C]]}else{if(this._gridPadding[p[C]]==null){this._gridPadding[p[C]]=this._defaultGridPadding[p[C]]}}}var B=this._gridPadding;if(this.legend.placement==="outsideGrid"){B={top:this.title.getHeight(),left:0,right:0,bottom:0};if(this.legend.location==="s"){B.left=this._gridPadding.left;B.right=this._gridPadding.right}}u.xaxis.pack({position:"absolute",bottom:this._gridPadding.bottom-u.xaxis.getHeight(),left:0,width:this._width},{min:this._gridPadding.left,max:this._width-this._gridPadding.right});
u.yaxis.pack({position:"absolute",top:0,left:this._gridPadding.left-u.yaxis.getWidth(),height:this._height},{min:this._height-this._gridPadding.bottom,max:this._gridPadding.top});u.x2axis.pack({position:"absolute",top:this._gridPadding.top-u.x2axis.getHeight(),left:0,width:this._width},{min:this._gridPadding.left,max:this._width-this._gridPadding.right});for(I=8;I>0;I--){u[H[I-1]].pack({position:"absolute",top:0,right:this._gridPadding.right-A[I-1]},{min:this._height-this._gridPadding.bottom,max:this._gridPadding.top})}var w=(this._width-this._gridPadding.left-this._gridPadding.right)/2+this._gridPadding.left-u.yMidAxis.getWidth()/2;u.yMidAxis.pack({position:"absolute",top:0,left:w,zIndex:9,textAlign:"center"},{min:this._height-this._gridPadding.bottom,max:this._gridPadding.top});this.target.append(this.grid.createElement(this._gridPadding,this));this.grid.draw();var t=this.series;var K=t.length;for(I=0,F=K;I<F;I++){G=this.seriesStack[I];this.target.append(t[G].shadowCanvas.createElement(this._gridPadding,"jqplot-series-shadowCanvas",null,this));
t[G].shadowCanvas.setContext();t[G].shadowCanvas._elem.data("seriesIndex",G)}for(I=0,F=K;I<F;I++){G=this.seriesStack[I];this.target.append(t[G].canvas.createElement(this._gridPadding,"jqplot-series-canvas",null,this));t[G].canvas.setContext();t[G].canvas._elem.data("seriesIndex",G)}this.target.append(this.eventCanvas.createElement(this._gridPadding,"jqplot-event-canvas",null,this));this.eventCanvas.setContext();this.eventCanvas._ctx.fillStyle="rgba(0,0,0,0)";this.eventCanvas._ctx.fillRect(0,0,this.eventCanvas._ctx.canvas.width,this.eventCanvas._ctx.canvas.height);this.bindCustomEvents();if(this.legend.preDraw){this.eventCanvas._elem.before(M);this.legend.pack(B);if(this.legend._elem){this.drawSeries({legendInfo:{location:this.legend.location,placement:this.legend.placement,width:this.legend.getWidth(),height:this.legend.getHeight(),xoffset:this.legend.xoffset,yoffset:this.legend.yoffset}})}else{this.drawSeries()}}else{this.drawSeries();if(K){e(t[K-1].canvas._elem).after(M)}this.legend.pack(B)
}for(var I=0,F=e.jqplot.eventListenerHooks.length;I<F;I++){this.eventCanvas._elem.bind(e.jqplot.eventListenerHooks[I][0],{plot:this},e.jqplot.eventListenerHooks[I][1])}for(var I=0,F=this.eventListenerHooks.hooks.length;I<F;I++){this.eventCanvas._elem.bind(this.eventListenerHooks.hooks[I][0],{plot:this},this.eventListenerHooks.hooks[I][1])}var z=this.fillBetween;if(z.fill&&z.series1!==z.series2&&z.series1<K&&z.series2<K&&t[z.series1]._type==="line"&&t[z.series2]._type==="line"){this.doFillBetweenLines()}for(var I=0,F=e.jqplot.postDrawHooks.length;I<F;I++){e.jqplot.postDrawHooks[I].call(this)}for(var I=0,F=this.postDrawHooks.hooks.length;I<F;I++){this.postDrawHooks.hooks[I].apply(this,this.postDrawHooks.args[I])}if(this.target.is(":visible")){this._drawCount+=1}var x,y,E,s;for(I=0,F=K;I<F;I++){x=t[I];y=x.renderer;E=".jqplot-point-label.jqplot-series-"+I;if(y.animation&&y.animation._supported&&y.animation.show&&(this._drawCount<2||this.animateReplot)){s=this.target.find(E);s.stop(true,true).hide();
x.canvas._elem.stop(true,true).hide();x.shadowCanvas._elem.stop(true,true).hide();x.canvas._elem.jqplotEffect("blind",{mode:"show",direction:y.animation.direction},y.animation.speed);x.shadowCanvas._elem.jqplotEffect("blind",{mode:"show",direction:y.animation.direction},y.animation.speed);s.fadeIn(y.animation.speed*0.8)}}s=null;this.target.trigger("jqplotPostDraw",[this])}};h.prototype.doFillBetweenLines=function(){var p=this.fillBetween;var y=p.series1;var w=p.series2;var x=(y<w)?y:w;var v=(w>y)?w:y;var t=this.series[x];var s=this.series[v];if(s.renderer.smooth){var r=s.renderer._smoothedData.slice(0).reverse()}else{var r=s.gridData.slice(0).reverse()}if(t.renderer.smooth){var u=t.renderer._smoothedData.concat(r)}else{var u=t.gridData.concat(r)}var q=(p.color!==null)?p.color:this.series[y].fillColor;var z=(p.baseSeries!==null)?p.baseSeries:x;var o=this.series[z].renderer.shapeRenderer;var n={fillStyle:q,fill:true,closePath:true};o.draw(t.shadowCanvas._ctx,u,n)};this.bindCustomEvents=function(){this.eventCanvas._elem.bind("click",{plot:this},this.onClick);
this.eventCanvas._elem.bind("dblclick",{plot:this},this.onDblClick);this.eventCanvas._elem.bind("mousedown",{plot:this},this.onMouseDown);this.eventCanvas._elem.bind("mousemove",{plot:this},this.onMouseMove);this.eventCanvas._elem.bind("mouseenter",{plot:this},this.onMouseEnter);this.eventCanvas._elem.bind("mouseleave",{plot:this},this.onMouseLeave);if(this.captureRightClick){this.eventCanvas._elem.bind("mouseup",{plot:this},this.onRightClick);this.eventCanvas._elem.get(0).oncontextmenu=function(){return false}}else{this.eventCanvas._elem.bind("mouseup",{plot:this},this.onMouseUp)}};function k(w){var v=w.data.plot;var r=v.eventCanvas._elem.offset();var u={x:w.pageX-r.left,y:w.pageY-r.top};var s={xaxis:null,yaxis:null,x2axis:null,y2axis:null,y3axis:null,y4axis:null,y5axis:null,y6axis:null,y7axis:null,y8axis:null,y9axis:null,yMidAxis:null};var t=["xaxis","yaxis","x2axis","y2axis","y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis","yMidAxis"];var o=v.axes;var p,q;for(p=11;p>0;p--){q=t[p-1];
if(o[q].show){s[q]=o[q].series_p2u(u[q.charAt(0)])}}return{offsets:r,gridPos:u,dataPos:s}}function m(n,o){var z=o.series;var ae,ac,ab,W,X,R,Q,E,C,H,I,S;var aa,af,Y,A,P,U,ad;var q,V;for(ab=o.seriesStack.length-1;ab>=0;ab--){ae=o.seriesStack[ab];W=z[ae];ad=W._highlightThreshold;switch(W.renderer.constructor){case e.jqplot.BarRenderer:R=n.x;Q=n.y;for(ac=0;ac<W._barPoints.length;ac++){P=W._barPoints[ac];Y=W.gridData[ac];if(R>P[0][0]&&R<P[2][0]&&Q>P[2][1]&&Q<P[0][1]){return{seriesIndex:W.index,pointIndex:ac,gridData:Y,data:W.data[ac],points:W._barPoints[ac]}}}break;case e.jqplot.PyramidRenderer:R=n.x;Q=n.y;for(ac=0;ac<W._barPoints.length;ac++){P=W._barPoints[ac];Y=W.gridData[ac];if(R>P[0][0]+ad[0][0]&&R<P[2][0]+ad[2][0]&&Q>P[2][1]&&Q<P[0][1]){return{seriesIndex:W.index,pointIndex:ac,gridData:Y,data:W.data[ac],points:W._barPoints[ac]}}}break;case e.jqplot.DonutRenderer:H=W.startAngle/180*Math.PI;R=n.x-W._center[0];Q=n.y-W._center[1];X=Math.sqrt(Math.pow(R,2)+Math.pow(Q,2));if(R>0&&-Q>=0){E=2*Math.PI-Math.atan(-Q/R)
}else{if(R>0&&-Q<0){E=-Math.atan(-Q/R)}else{if(R<0){E=Math.PI-Math.atan(-Q/R)}else{if(R==0&&-Q>0){E=3*Math.PI/2}else{if(R==0&&-Q<0){E=Math.PI/2}else{if(R==0&&Q==0){E=0}}}}}}if(H){E-=H;if(E<0){E+=2*Math.PI}else{if(E>2*Math.PI){E-=2*Math.PI}}}C=W.sliceMargin/180*Math.PI;if(X<W._radius&&X>W._innerRadius){for(ac=0;ac<W.gridData.length;ac++){I=(ac>0)?W.gridData[ac-1][1]+C:C;S=W.gridData[ac][1];if(E>I&&E<S){return{seriesIndex:W.index,pointIndex:ac,gridData:[n.x,n.y],data:W.data[ac]}}}}break;case e.jqplot.PieRenderer:H=W.startAngle/180*Math.PI;R=n.x-W._center[0];Q=n.y-W._center[1];X=Math.sqrt(Math.pow(R,2)+Math.pow(Q,2));if(R>0&&-Q>=0){E=2*Math.PI-Math.atan(-Q/R)}else{if(R>0&&-Q<0){E=-Math.atan(-Q/R)}else{if(R<0){E=Math.PI-Math.atan(-Q/R)}else{if(R==0&&-Q>0){E=3*Math.PI/2}else{if(R==0&&-Q<0){E=Math.PI/2}else{if(R==0&&Q==0){E=0}}}}}}if(H){E-=H;if(E<0){E+=2*Math.PI}else{if(E>2*Math.PI){E-=2*Math.PI}}}C=W.sliceMargin/180*Math.PI;if(X<W._radius){for(ac=0;ac<W.gridData.length;ac++){I=(ac>0)?W.gridData[ac-1][1]+C:C;
S=W.gridData[ac][1];if(E>I&&E<S){return{seriesIndex:W.index,pointIndex:ac,gridData:[n.x,n.y],data:W.data[ac]}}}}break;case e.jqplot.BubbleRenderer:R=n.x;Q=n.y;var N=null;if(W.show){for(var ac=0;ac<W.gridData.length;ac++){Y=W.gridData[ac];af=Math.sqrt((R-Y[0])*(R-Y[0])+(Q-Y[1])*(Q-Y[1]));if(af<=Y[2]&&(af<=aa||aa==null)){aa=af;N={seriesIndex:ae,pointIndex:ac,gridData:Y,data:W.data[ac]}}}if(N!=null){return N}}break;case e.jqplot.FunnelRenderer:R=n.x;Q=n.y;var T=W._vertices,w=T[0],u=T[T.length-1],B,M,G;function Z(s,v,t){var r=(v[1]-t[1])/(v[0]-t[0]);var p=v[1]-r*v[0];var x=s+v[1];return[(x-p)/r,x]}B=Z(Q,w[0],u[3]);M=Z(Q,w[1],u[2]);for(ac=0;ac<T.length;ac++){G=T[ac];if(Q>=G[0][1]&&Q<=G[3][1]&&R>=B[0]&&R<=M[0]){return{seriesIndex:W.index,pointIndex:ac,gridData:null,data:W.data[ac]}}}break;case e.jqplot.LineRenderer:R=n.x;Q=n.y;X=W.renderer;if(W.show){if((W.fill||(W.renderer.bands.show&&W.renderer.bands.fill))&&(!o.plugins.highlighter||!o.plugins.highlighter.show)){var F=false;if(R>W._boundingBox[0][0]&&R<W._boundingBox[1][0]&&Q>W._boundingBox[1][1]&&Q<W._boundingBox[0][1]){var L=W._areaPoints.length;
var O;var ac=L-1;for(var O=0;O<L;O++){var K=[W._areaPoints[O][0],W._areaPoints[O][1]];var J=[W._areaPoints[ac][0],W._areaPoints[ac][1]];if(K[1]<Q&&J[1]>=Q||J[1]<Q&&K[1]>=Q){if(K[0]+(Q-K[1])/(J[1]-K[1])*(J[0]-K[0])<R){F=!F}}ac=O}}if(F){return{seriesIndex:ae,pointIndex:null,gridData:W.gridData,data:W.data,points:W._areaPoints}}break}else{V=W.markerRenderer.size/2+W.neighborThreshold;q=(V>0)?V:0;for(var ac=0;ac<W.gridData.length;ac++){Y=W.gridData[ac];if(X.constructor==e.jqplot.OHLCRenderer){if(X.candleStick){var D=W._yaxis.series_u2p;if(R>=Y[0]-X._bodyWidth/2&&R<=Y[0]+X._bodyWidth/2&&Q>=D(W.data[ac][2])&&Q<=D(W.data[ac][3])){return{seriesIndex:ae,pointIndex:ac,gridData:Y,data:W.data[ac]}}}else{if(!X.hlc){var D=W._yaxis.series_u2p;if(R>=Y[0]-X._tickLength&&R<=Y[0]+X._tickLength&&Q>=D(W.data[ac][2])&&Q<=D(W.data[ac][3])){return{seriesIndex:ae,pointIndex:ac,gridData:Y,data:W.data[ac]}}}else{var D=W._yaxis.series_u2p;if(R>=Y[0]-X._tickLength&&R<=Y[0]+X._tickLength&&Q>=D(W.data[ac][1])&&Q<=D(W.data[ac][2])){return{seriesIndex:ae,pointIndex:ac,gridData:Y,data:W.data[ac]}
}}}}else{if(Y[0]!=null&&Y[1]!=null){af=Math.sqrt((R-Y[0])*(R-Y[0])+(Q-Y[1])*(Q-Y[1]));if(af<=q&&(af<=aa||aa==null)){aa=af;return{seriesIndex:ae,pointIndex:ac,gridData:Y,data:W.data[ac]}}}}}}}break;default:R=n.x;Q=n.y;X=W.renderer;if(W.show){V=W.markerRenderer.size/2+W.neighborThreshold;q=(V>0)?V:0;for(var ac=0;ac<W.gridData.length;ac++){Y=W.gridData[ac];if(X.constructor==e.jqplot.OHLCRenderer){if(X.candleStick){var D=W._yaxis.series_u2p;if(R>=Y[0]-X._bodyWidth/2&&R<=Y[0]+X._bodyWidth/2&&Q>=D(W.data[ac][2])&&Q<=D(W.data[ac][3])){return{seriesIndex:ae,pointIndex:ac,gridData:Y,data:W.data[ac]}}}else{if(!X.hlc){var D=W._yaxis.series_u2p;if(R>=Y[0]-X._tickLength&&R<=Y[0]+X._tickLength&&Q>=D(W.data[ac][2])&&Q<=D(W.data[ac][3])){return{seriesIndex:ae,pointIndex:ac,gridData:Y,data:W.data[ac]}}}else{var D=W._yaxis.series_u2p;if(R>=Y[0]-X._tickLength&&R<=Y[0]+X._tickLength&&Q>=D(W.data[ac][1])&&Q<=D(W.data[ac][2])){return{seriesIndex:ae,pointIndex:ac,gridData:Y,data:W.data[ac]}}}}}else{af=Math.sqrt((R-Y[0])*(R-Y[0])+(Q-Y[1])*(Q-Y[1]));
if(af<=q&&(af<=aa||aa==null)){aa=af;return{seriesIndex:ae,pointIndex:ac,gridData:Y,data:W.data[ac]}}}}}break}}return null}this.onClick=function(q){var o=k(q);var s=q.data.plot;var r=m(o.gridPos,s);var n=e.Event("jqplotClick");n.pageX=q.pageX;n.pageY=q.pageY;e(this).trigger(n,[o.gridPos,o.dataPos,r,s])};this.onDblClick=function(q){var o=k(q);var s=q.data.plot;var r=m(o.gridPos,s);var n=e.Event("jqplotDblClick");n.pageX=q.pageX;n.pageY=q.pageY;e(this).trigger(n,[o.gridPos,o.dataPos,r,s])};this.onMouseDown=function(q){var o=k(q);var s=q.data.plot;var r=m(o.gridPos,s);var n=e.Event("jqplotMouseDown");n.pageX=q.pageX;n.pageY=q.pageY;e(this).trigger(n,[o.gridPos,o.dataPos,r,s])};this.onMouseUp=function(p){var o=k(p);var n=e.Event("jqplotMouseUp");n.pageX=p.pageX;n.pageY=p.pageY;e(this).trigger(n,[o.gridPos,o.dataPos,null,p.data.plot])};this.onRightClick=function(q){var o=k(q);var s=q.data.plot;var r=m(o.gridPos,s);if(s.captureRightClick){if(q.which==3){var n=e.Event("jqplotRightClick");n.pageX=q.pageX;
n.pageY=q.pageY;e(this).trigger(n,[o.gridPos,o.dataPos,r,s])}else{var n=e.Event("jqplotMouseUp");n.pageX=q.pageX;n.pageY=q.pageY;e(this).trigger(n,[o.gridPos,o.dataPos,r,s])}}};this.onMouseMove=function(q){var o=k(q);var s=q.data.plot;var r=m(o.gridPos,s);var n=e.Event("jqplotMouseMove");n.pageX=q.pageX;n.pageY=q.pageY;e(this).trigger(n,[o.gridPos,o.dataPos,r,s])};this.onMouseEnter=function(q){var o=k(q);var r=q.data.plot;var n=e.Event("jqplotMouseEnter");n.pageX=q.pageX;n.pageY=q.pageY;n.relatedTarget=q.relatedTarget;e(this).trigger(n,[o.gridPos,o.dataPos,null,r])};this.onMouseLeave=function(q){var o=k(q);var r=q.data.plot;var n=e.Event("jqplotMouseLeave");n.pageX=q.pageX;n.pageY=q.pageY;n.relatedTarget=q.relatedTarget;e(this).trigger(n,[o.gridPos,o.dataPos,null,r])};this.drawSeries=function(p,n){var r,q,o;n=(typeof(p)==="number"&&n==null)?p:n;p=(typeof(p)==="object")?p:{};if(n!=b){q=this.series[n];o=q.shadowCanvas._ctx;o.clearRect(0,0,o.canvas.width,o.canvas.height);q.drawShadow(o,p,this);
o=q.canvas._ctx;o.clearRect(0,0,o.canvas.width,o.canvas.height);q.draw(o,p,this);if(q.renderer.constructor==e.jqplot.BezierCurveRenderer){if(n<this.series.length-1){this.drawSeries(n+1)}}}else{for(r=0;r<this.series.length;r++){q=this.series[r];o=q.shadowCanvas._ctx;o.clearRect(0,0,o.canvas.width,o.canvas.height);q.drawShadow(o,p,this);o=q.canvas._ctx;o.clearRect(0,0,o.canvas.width,o.canvas.height);q.draw(o,p,this)}}p=n=r=q=o=null};this.moveSeriesToFront=function(o){o=parseInt(o,10);var r=e.inArray(o,this.seriesStack);if(r==-1){return}if(r==this.seriesStack.length-1){this.previousSeriesStack=this.seriesStack.slice(0);return}var n=this.seriesStack[this.seriesStack.length-1];var q=this.series[o].canvas._elem.detach();var p=this.series[o].shadowCanvas._elem.detach();this.series[n].shadowCanvas._elem.after(p);this.series[n].canvas._elem.after(q);this.previousSeriesStack=this.seriesStack.slice(0);this.seriesStack.splice(r,1);this.seriesStack.push(o)};this.moveSeriesToBack=function(o){o=parseInt(o,10);
var r=e.inArray(o,this.seriesStack);if(r==0||r==-1){return}var n=this.seriesStack[0];var q=this.series[o].canvas._elem.detach();var p=this.series[o].shadowCanvas._elem.detach();this.series[n].shadowCanvas._elem.before(p);this.series[n].canvas._elem.before(q);this.previousSeriesStack=this.seriesStack.slice(0);this.seriesStack.splice(r,1);this.seriesStack.unshift(o)};this.restorePreviousSeriesOrder=function(){var t,s,r,q,p,n,o;if(this.seriesStack==this.previousSeriesStack){return}for(t=1;t<this.previousSeriesStack.length;t++){n=this.previousSeriesStack[t];o=this.previousSeriesStack[t-1];r=this.series[n].canvas._elem.detach();q=this.series[n].shadowCanvas._elem.detach();this.series[o].shadowCanvas._elem.after(q);this.series[o].canvas._elem.after(r)}p=this.seriesStack.slice(0);this.seriesStack=this.previousSeriesStack.slice(0);this.previousSeriesStack=p};this.restoreOriginalSeriesOrder=function(){var r,q,n=[],p,o;for(r=0;r<this.series.length;r++){n.push(r)}if(this.seriesStack==n){return}this.previousSeriesStack=this.seriesStack.slice(0);
this.seriesStack=n;for(r=1;r<this.seriesStack.length;r++){p=this.series[r].canvas._elem.detach();o=this.series[r].shadowCanvas._elem.detach();this.series[r-1].shadowCanvas._elem.after(o);this.series[r-1].canvas._elem.after(p)}};this.activateTheme=function(n){this.themeEngine.activate(this,n)}}e.jqplot.computeHighlightColors=function(l){var n;if(e.isArray(l)){n=[];for(var p=0;p<l.length;p++){var o=e.jqplot.getColorComponents(l[p]);var k=[o[0],o[1],o[2]];var q=k[0]+k[1]+k[2];for(var m=0;m<3;m++){k[m]=(q>660)?k[m]*0.85:0.73*k[m]+90;k[m]=parseInt(k[m],10);(k[m]>255)?255:k[m]}k[3]=0.3+0.35*o[3];n.push("rgba("+k[0]+","+k[1]+","+k[2]+","+k[3]+")")}}else{var o=e.jqplot.getColorComponents(l);var k=[o[0],o[1],o[2]];var q=k[0]+k[1]+k[2];for(var m=0;m<3;m++){k[m]=(q>660)?k[m]*0.85:0.73*k[m]+90;k[m]=parseInt(k[m],10);(k[m]>255)?255:k[m]}k[3]=0.3+0.35*o[3];n="rgba("+k[0]+","+k[1]+","+k[2]+","+k[3]+")"}return n};e.jqplot.ColorGenerator=function(k){k=k||e.jqplot.config.defaultColors;var j=0;this.next=function(){if(j<k.length){return k[j++]
}else{j=0;return k[j++]}};this.previous=function(){if(j>0){return k[j--]}else{j=k.length-1;return k[j]}};this.get=function(m){var l=m-k.length*Math.floor(m/k.length);return k[l]};this.setColors=function(l){k=l};this.reset=function(){j=0};this.getIndex=function(){return j};this.setIndex=function(l){j=l}};e.jqplot.hex2rgb=function(l,j){l=l.replace("#","");if(l.length==3){l=l.charAt(0)+l.charAt(0)+l.charAt(1)+l.charAt(1)+l.charAt(2)+l.charAt(2)}var k;k="rgba("+parseInt(l.slice(0,2),16)+", "+parseInt(l.slice(2,4),16)+", "+parseInt(l.slice(4,6),16);if(j){k+=", "+j}k+=")";return k};e.jqplot.rgb2hex=function(p){var l=/rgba?\( *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *(?:, *[0-9.]*)?\)/;var j=p.match(l);var o="#";for(var n=1;n<4;n++){var k;if(j[n].search(/%/)!=-1){k=parseInt(255*j[n]/100,10).toString(16);if(k.length==1){k="0"+k}}else{k=parseInt(j[n],10).toString(16);if(k.length==1){k="0"+k}}o+=k}return o};e.jqplot.normalize2rgb=function(k,j){if(k.search(/^ *rgba?\(/)!=-1){return k
}else{if(k.search(/^ *#?[0-9a-fA-F]?[0-9a-fA-F]/)!=-1){return e.jqplot.hex2rgb(k,j)}else{throw new Error("Invalid color spec")}}};e.jqplot.getColorComponents=function(p){p=e.jqplot.colorKeywordMap[p]||p;var n=e.jqplot.normalize2rgb(p);var l=/rgba?\( *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *,? *([0-9.]* *)?\)/;var j=n.match(l);var k=[];for(var o=1;o<4;o++){if(j[o].search(/%/)!=-1){k[o-1]=parseInt(255*j[o]/100,10)}else{k[o-1]=parseInt(j[o],10)}}k[3]=parseFloat(j[4])?parseFloat(j[4]):1;return k};e.jqplot.colorKeywordMap={aliceblue:"rgb(240, 248, 255)",antiquewhite:"rgb(250, 235, 215)",aqua:"rgb( 0, 255, 255)",aquamarine:"rgb(127, 255, 212)",azure:"rgb(240, 255, 255)",beige:"rgb(245, 245, 220)",bisque:"rgb(255, 228, 196)",black:"rgb( 0, 0, 0)",blanchedalmond:"rgb(255, 235, 205)",blue:"rgb( 0, 0, 255)",blueviolet:"rgb(138, 43, 226)",brown:"rgb(165, 42, 42)",burlywood:"rgb(222, 184, 135)",cadetblue:"rgb( 95, 158, 160)",chartreuse:"rgb(127, 255, 0)",chocolate:"rgb(210, 105, 30)",coral:"rgb(255, 127, 80)",cornflowerblue:"rgb(100, 149, 237)",cornsilk:"rgb(255, 248, 220)",crimson:"rgb(220, 20, 60)",cyan:"rgb( 0, 255, 255)",darkblue:"rgb( 0, 0, 139)",darkcyan:"rgb( 0, 139, 139)",darkgoldenrod:"rgb(184, 134, 11)",darkgray:"rgb(169, 169, 169)",darkgreen:"rgb( 0, 100, 0)",darkgrey:"rgb(169, 169, 169)",darkkhaki:"rgb(189, 183, 107)",darkmagenta:"rgb(139, 0, 139)",darkolivegreen:"rgb( 85, 107, 47)",darkorange:"rgb(255, 140, 0)",darkorchid:"rgb(153, 50, 204)",darkred:"rgb(139, 0, 0)",darksalmon:"rgb(233, 150, 122)",darkseagreen:"rgb(143, 188, 143)",darkslateblue:"rgb( 72, 61, 139)",darkslategray:"rgb( 47, 79, 79)",darkslategrey:"rgb( 47, 79, 79)",darkturquoise:"rgb( 0, 206, 209)",darkviolet:"rgb(148, 0, 211)",deeppink:"rgb(255, 20, 147)",deepskyblue:"rgb( 0, 191, 255)",dimgray:"rgb(105, 105, 105)",dimgrey:"rgb(105, 105, 105)",dodgerblue:"rgb( 30, 144, 255)",firebrick:"rgb(178, 34, 34)",floralwhite:"rgb(255, 250, 240)",forestgreen:"rgb( 34, 139, 34)",fuchsia:"rgb(255, 0, 255)",gainsboro:"rgb(220, 220, 220)",ghostwhite:"rgb(248, 248, 255)",gold:"rgb(255, 215, 0)",goldenrod:"rgb(218, 165, 32)",gray:"rgb(128, 128, 128)",grey:"rgb(128, 128, 128)",green:"rgb( 0, 128, 0)",greenyellow:"rgb(173, 255, 47)",honeydew:"rgb(240, 255, 240)",hotpink:"rgb(255, 105, 180)",indianred:"rgb(205, 92, 92)",indigo:"rgb( 75, 0, 130)",ivory:"rgb(255, 255, 240)",khaki:"rgb(240, 230, 140)",lavender:"rgb(230, 230, 250)",lavenderblush:"rgb(255, 240, 245)",lawngreen:"rgb(124, 252, 0)",lemonchiffon:"rgb(255, 250, 205)",lightblue:"rgb(173, 216, 230)",lightcoral:"rgb(240, 128, 128)",lightcyan:"rgb(224, 255, 255)",lightgoldenrodyellow:"rgb(250, 250, 210)",lightgray:"rgb(211, 211, 211)",lightgreen:"rgb(144, 238, 144)",lightgrey:"rgb(211, 211, 211)",lightpink:"rgb(255, 182, 193)",lightsalmon:"rgb(255, 160, 122)",lightseagreen:"rgb( 32, 178, 170)",lightskyblue:"rgb(135, 206, 250)",lightslategray:"rgb(119, 136, 153)",lightslategrey:"rgb(119, 136, 153)",lightsteelblue:"rgb(176, 196, 222)",lightyellow:"rgb(255, 255, 224)",lime:"rgb( 0, 255, 0)",limegreen:"rgb( 50, 205, 50)",linen:"rgb(250, 240, 230)",magenta:"rgb(255, 0, 255)",maroon:"rgb(128, 0, 0)",mediumaquamarine:"rgb(102, 205, 170)",mediumblue:"rgb( 0, 0, 205)",mediumorchid:"rgb(186, 85, 211)",mediumpurple:"rgb(147, 112, 219)",mediumseagreen:"rgb( 60, 179, 113)",mediumslateblue:"rgb(123, 104, 238)",mediumspringgreen:"rgb( 0, 250, 154)",mediumturquoise:"rgb( 72, 209, 204)",mediumvioletred:"rgb(199, 21, 133)",midnightblue:"rgb( 25, 25, 112)",mintcream:"rgb(245, 255, 250)",mistyrose:"rgb(255, 228, 225)",moccasin:"rgb(255, 228, 181)",navajowhite:"rgb(255, 222, 173)",navy:"rgb( 0, 0, 128)",oldlace:"rgb(253, 245, 230)",olive:"rgb(128, 128, 0)",olivedrab:"rgb(107, 142, 35)",orange:"rgb(255, 165, 0)",orangered:"rgb(255, 69, 0)",orchid:"rgb(218, 112, 214)",palegoldenrod:"rgb(238, 232, 170)",palegreen:"rgb(152, 251, 152)",paleturquoise:"rgb(175, 238, 238)",palevioletred:"rgb(219, 112, 147)",papayawhip:"rgb(255, 239, 213)",peachpuff:"rgb(255, 218, 185)",peru:"rgb(205, 133, 63)",pink:"rgb(255, 192, 203)",plum:"rgb(221, 160, 221)",powderblue:"rgb(176, 224, 230)",purple:"rgb(128, 0, 128)",red:"rgb(255, 0, 0)",rosybrown:"rgb(188, 143, 143)",royalblue:"rgb( 65, 105, 225)",saddlebrown:"rgb(139, 69, 19)",salmon:"rgb(250, 128, 114)",sandybrown:"rgb(244, 164, 96)",seagreen:"rgb( 46, 139, 87)",seashell:"rgb(255, 245, 238)",sienna:"rgb(160, 82, 45)",silver:"rgb(192, 192, 192)",skyblue:"rgb(135, 206, 235)",slateblue:"rgb(106, 90, 205)",slategray:"rgb(112, 128, 144)",slategrey:"rgb(112, 128, 144)",snow:"rgb(255, 250, 250)",springgreen:"rgb( 0, 255, 127)",steelblue:"rgb( 70, 130, 180)",tan:"rgb(210, 180, 140)",teal:"rgb( 0, 128, 128)",thistle:"rgb(216, 191, 216)",tomato:"rgb(255, 99, 71)",turquoise:"rgb( 64, 224, 208)",violet:"rgb(238, 130, 238)",wheat:"rgb(245, 222, 179)",white:"rgb(255, 255, 255)",whitesmoke:"rgb(245, 245, 245)",yellow:"rgb(255, 255, 0)",yellowgreen:"rgb(154, 205, 50)"}
})(jQuery);(function(a){a.jqplot.LinearAxisRenderer=function(){};a.jqplot.LinearAxisRenderer.prototype.init=function(b){this.breakPoints=null;this.breakTickLabel="&asymp;";this.drawBaseline=true;this.baselineWidth=null;this.baselineColor=null;this.forceTickAt0=false;this.forceTickAt100=false;this.tickInset=0;this.minorTicks=0;this.alignTicks=false;this._autoFormatString="";this._overrideFormatString=false;this._scalefact=1;a.extend(true,this,b);if(this.breakPoints){if(!a.isArray(this.breakPoints)){this.breakPoints=null}else{if(this.breakPoints.length<2||this.breakPoints[1]<=this.breakPoints[0]){this.breakPoints=null}}}if(this.numberTicks!=null&&this.numberTicks<2){this.numberTicks=2}this.resetDataBounds()};a.jqplot.LinearAxisRenderer.prototype.draw=function(b,j){if(this.show){this.renderer.createTicks.call(this,j);var h=0;var c;if(this._elem){this._elem.emptyForce();this._elem=null}this._elem=a(document.createElement("div"));this._elem.addClass("jqplot-axis jqplot-"+this.name);this._elem.css("position","absolute");
if(this.name=="xaxis"||this.name=="x2axis"){this._elem.width(this._plotDimensions.width)}else{this._elem.height(this._plotDimensions.height)}this.labelOptions.axis=this.name;this._label=new this.labelRenderer(this.labelOptions);if(this._label.show){var g=this._label.draw(b,j);g.appendTo(this._elem);g=null}var f=this._ticks;var e;for(var d=0;d<f.length;d++){e=f[d];if(e.show&&e.showLabel&&(!e.isMinorTick||this.showMinorTicks)){this._elem.append(e.draw(b,j))}}e=null;f=null}return this._elem};a.jqplot.LinearAxisRenderer.prototype.reset=function(){this.min=this._options.min;this.max=this._options.max;this.tickInterval=this._options.tickInterval;this.numberTicks=this._options.numberTicks;this._autoFormatString="";if(this._overrideFormatString&&this.tickOptions&&this.tickOptions.formatString){this.tickOptions.formatString=""}};a.jqplot.LinearAxisRenderer.prototype.set=function(){var k=0;var d;var c=0;var j=0;var b=(this._label==null)?false:this._label.show;if(this.show){var g=this._ticks;var f;
for(var e=0;e<g.length;e++){f=g[e];if(!f._breakTick&&f.show&&f.showLabel&&(!f.isMinorTick||this.showMinorTicks)){if(this.name=="xaxis"||this.name=="x2axis"){d=f._elem.outerHeight(true)}else{d=f._elem.outerWidth(true)}if(d>k){k=d}}}f=null;g=null;if(b){c=this._label._elem.outerWidth(true);j=this._label._elem.outerHeight(true)}if(this.name=="xaxis"){k=k+j;this._elem.css({height:k+"px",left:"0px",bottom:"0px"})}else{if(this.name=="x2axis"){k=k+j;this._elem.css({height:k+"px",left:"0px",top:"0px"})}else{if(this.name=="yaxis"){k=k+c;this._elem.css({width:k+"px",left:"0px",top:"0px"});if(b&&this._label.constructor==a.jqplot.AxisLabelRenderer){this._label._elem.css("width",c+"px")}}else{k=k+c;this._elem.css({width:k+"px",right:"0px",top:"0px"});if(b&&this._label.constructor==a.jqplot.AxisLabelRenderer){this._label._elem.css("width",c+"px")}}}}}};a.jqplot.LinearAxisRenderer.prototype.createTicks=function(d){var S=this._ticks;var J=this.ticks;var y=this.name;var A=this._dataBounds;var b=(this.name.charAt(0)==="x")?this._plotDimensions.width:this._plotDimensions.height;
var h;var af,H;var l,k;var ad,Z;var G=this.min;var ae=this.max;var V=this.numberTicks;var aj=this.tickInterval;var g=30;this._scalefact=(Math.max(b,g+1)-g)/300;if(J.length){for(Z=0;Z<J.length;Z++){var N=J[Z];var T=new this.tickRenderer(this.tickOptions);if(a.isArray(N)){T.value=N[0];if(this.breakPoints){if(N[0]==this.breakPoints[0]){T.label=this.breakTickLabel;T._breakTick=true;T.showGridline=false;T.showMark=false}else{if(N[0]>this.breakPoints[0]&&N[0]<=this.breakPoints[1]){T.show=false;T.showGridline=false;T.label=N[1]}else{T.label=N[1]}}}else{T.label=N[1]}T.setTick(N[0],this.name);this._ticks.push(T)}else{if(a.isPlainObject(N)){a.extend(true,T,N);T.axis=this.name;this._ticks.push(T)}else{T.value=N;if(this.breakPoints){if(N==this.breakPoints[0]){T.label=this.breakTickLabel;T._breakTick=true;T.showGridline=false;T.showMark=false}else{if(N>this.breakPoints[0]&&N<=this.breakPoints[1]){T.show=false;T.showGridline=false}}}T.setTick(N,this.name);this._ticks.push(T)}}}this.numberTicks=J.length;
this.min=this._ticks[0].value;this.max=this._ticks[this.numberTicks-1].value;this.tickInterval=(this.max-this.min)/(this.numberTicks-1)}else{if(y=="xaxis"||y=="x2axis"){b=this._plotDimensions.width}else{b=this._plotDimensions.height}var w=this.numberTicks;if(this.alignTicks){if(this.name==="x2axis"&&d.axes.xaxis.show){w=d.axes.xaxis.numberTicks}else{if(this.name.charAt(0)==="y"&&this.name!=="yaxis"&&this.name!=="yMidAxis"&&d.axes.yaxis.show){w=d.axes.yaxis.numberTicks}}}af=((this.min!=null)?this.min:A.min);H=((this.max!=null)?this.max:A.max);var u=H-af;var R,x;var q;if(this.tickOptions==null||!this.tickOptions.formatString){this._overrideFormatString=true}if(this.min==null||this.max==null&&this.tickInterval==null&&!this.autoscale){if(this.forceTickAt0){if(af>0){af=0}if(H<0){H=0}}if(this.forceTickAt100){if(af>100){af=100}if(H<100){H=100}}var D=false,aa=false;if(this.min!=null){D=true}else{if(this.max!=null){aa=true}}var O=a.jqplot.LinearTickGenerator(af,H,this._scalefact,w,D,aa);var v=(this.min!=null)?af:af+u*(this.padMin-1);
var P=(this.max!=null)?H:H-u*(this.padMax-1);if(af<v||H>P){v=(this.min!=null)?af:af-u*(this.padMin-1);P=(this.max!=null)?H:H+u*(this.padMax-1);O=a.jqplot.LinearTickGenerator(v,P,this._scalefact,w,D,aa)}this.min=O[0];this.max=O[1];this.numberTicks=O[2];this._autoFormatString=O[3];this.tickInterval=O[4]}else{if(af==H){var c=0.05;if(af>0){c=Math.max(Math.log(af)/Math.LN10,0.05)}af-=c;H+=c}if(this.autoscale&&this.min==null&&this.max==null){var e,f,p;var B=false;var M=false;var z={min:null,max:null,average:null,stddev:null};for(var Z=0;Z<this._series.length;Z++){var U=this._series[Z];var C=(U.fillAxis=="x")?U._xaxis.name:U._yaxis.name;if(this.name==C){var Q=U._plotValues[U.fillAxis];var F=Q[0];var ab=Q[0];for(var Y=1;Y<Q.length;Y++){if(Q[Y]<F){F=Q[Y]}else{if(Q[Y]>ab){ab=Q[Y]}}}var r=(ab-F)/ab;if(U.renderer.constructor==a.jqplot.BarRenderer){if(F>=0&&(U.fillToZero||r>0.1)){B=true}else{B=false;if(U.fill&&U.fillToZero&&F<0&&ab>0){M=true}else{M=false}}}else{if(U.fill){if(F>=0&&(U.fillToZero||r>0.1)){B=true
}else{if(F<0&&ab>0&&U.fillToZero){B=false;M=true}else{B=false;M=false}}}else{if(F<0){B=false}}}}}if(B){this.numberTicks=2+Math.ceil((b-(this.tickSpacing-1))/this.tickSpacing);this.min=0;G=0;f=H/(this.numberTicks-1);q=Math.pow(10,Math.abs(Math.floor(Math.log(f)/Math.LN10)));if(f/q==parseInt(f/q,10)){f+=q}this.tickInterval=Math.ceil(f/q)*q;this.max=this.tickInterval*(this.numberTicks-1)}else{if(M){this.numberTicks=2+Math.ceil((b-(this.tickSpacing-1))/this.tickSpacing);var I=Math.ceil(Math.abs(af)/u*(this.numberTicks-1));var ai=this.numberTicks-1-I;f=Math.max(Math.abs(af/I),Math.abs(H/ai));q=Math.pow(10,Math.abs(Math.floor(Math.log(f)/Math.LN10)));this.tickInterval=Math.ceil(f/q)*q;this.max=this.tickInterval*ai;this.min=-this.tickInterval*I}else{if(this.numberTicks==null){if(this.tickInterval){this.numberTicks=3+Math.ceil(u/this.tickInterval)}else{this.numberTicks=2+Math.ceil((b-(this.tickSpacing-1))/this.tickSpacing)}}if(this.tickInterval==null){f=u/(this.numberTicks-1);if(f<1){q=Math.pow(10,Math.abs(Math.floor(Math.log(f)/Math.LN10)))
}else{q=1}this.tickInterval=Math.ceil(f*q*this.pad)/q}else{q=1/this.tickInterval}e=this.tickInterval*(this.numberTicks-1);p=(e-u)/2;if(this.min==null){this.min=Math.floor(q*(af-p))/q}if(this.max==null){this.max=this.min+e}}}var E=a.jqplot.getSignificantFigures(this.tickInterval);var L;if(E.digitsLeft>=E.significantDigits){L="%d"}else{var q=Math.max(0,5-E.digitsLeft);q=Math.min(q,E.digitsRight);L="%."+q+"f"}this._autoFormatString=L}else{R=(this.min!=null)?this.min:af-u*(this.padMin-1);x=(this.max!=null)?this.max:H+u*(this.padMax-1);u=x-R;if(this.numberTicks==null){if(this.tickInterval!=null){this.numberTicks=Math.ceil((x-R)/this.tickInterval)+1}else{if(b>100){this.numberTicks=parseInt(3+(b-100)/75,10)}else{this.numberTicks=2}}}if(this.tickInterval==null){this.tickInterval=u/(this.numberTicks-1)}if(this.max==null){x=R+this.tickInterval*(this.numberTicks-1)}if(this.min==null){R=x-this.tickInterval*(this.numberTicks-1)}var E=a.jqplot.getSignificantFigures(this.tickInterval);var L;if(E.digitsLeft>=E.significantDigits){L="%d"
}else{var q=Math.max(0,5-E.digitsLeft);q=Math.min(q,E.digitsRight);L="%."+q+"f"}this._autoFormatString=L;this.min=R;this.max=x}if(this.renderer.constructor==a.jqplot.LinearAxisRenderer&&this._autoFormatString==""){u=this.max-this.min;var ag=new this.tickRenderer(this.tickOptions);var K=ag.formatString||a.jqplot.config.defaultTickFormatString;var K=K.match(a.jqplot.sprintf.regex)[0];var ac=0;if(K){if(K.search(/[fFeEgGpP]/)>-1){var X=K.match(/\%\.(\d{0,})?[eEfFgGpP]/);if(X){ac=parseInt(X[1],10)}else{ac=6}}else{if(K.search(/[di]/)>-1){ac=0}}var o=Math.pow(10,-ac);if(this.tickInterval<o){if(V==null&&aj==null){this.tickInterval=o;if(ae==null&&G==null){this.min=Math.floor(this._dataBounds.min/o)*o;if(this.min==this._dataBounds.min){this.min=this._dataBounds.min-this.tickInterval}this.max=Math.ceil(this._dataBounds.max/o)*o;if(this.max==this._dataBounds.max){this.max=this._dataBounds.max+this.tickInterval}var W=(this.max-this.min)/this.tickInterval;W=W.toFixed(11);W=Math.ceil(W);this.numberTicks=W+1
}else{if(ae==null){var W=(this._dataBounds.max-this.min)/this.tickInterval;W=W.toFixed(11);this.numberTicks=Math.ceil(W)+2;this.max=this.min+this.tickInterval*(this.numberTicks-1)}else{if(G==null){var W=(this.max-this._dataBounds.min)/this.tickInterval;W=W.toFixed(11);this.numberTicks=Math.ceil(W)+2;this.min=this.max-this.tickInterval*(this.numberTicks-1)}else{this.numberTicks=Math.ceil((ae-G)/this.tickInterval)+1;this.min=Math.floor(G*Math.pow(10,ac))/Math.pow(10,ac);this.max=Math.ceil(ae*Math.pow(10,ac))/Math.pow(10,ac);this.numberTicks=Math.ceil((this.max-this.min)/this.tickInterval)+1}}}}}}}}if(this._overrideFormatString&&this._autoFormatString!=""){this.tickOptions=this.tickOptions||{};this.tickOptions.formatString=this._autoFormatString}var T,ah;for(var Z=0;Z<this.numberTicks;Z++){ad=this.min+Z*this.tickInterval;T=new this.tickRenderer(this.tickOptions);T.setTick(ad,this.name);this._ticks.push(T);if(Z<this.numberTicks-1){for(var Y=0;Y<this.minorTicks;Y++){ad+=this.tickInterval/(this.minorTicks+1);
ah=a.extend(true,{},this.tickOptions,{name:this.name,value:ad,label:"",isMinorTick:true});T=new this.tickRenderer(ah);this._ticks.push(T)}}T=null}}if(this.tickInset){this.min=this.min-this.tickInset*this.tickInterval;this.max=this.max+this.tickInset*this.tickInterval}S=null};a.jqplot.LinearAxisRenderer.prototype.resetTickValues=function(d){if(a.isArray(d)&&d.length==this._ticks.length){var c;for(var b=0;b<d.length;b++){c=this._ticks[b];c.value=d[b];c.label=c.formatter(c.formatString,d[b]);c.label=c.prefix+c.label;c._elem.html(c.label)}c=null;this.min=a.jqplot.arrayMin(d);this.max=a.jqplot.arrayMax(d);this.pack()}};a.jqplot.LinearAxisRenderer.prototype.pack=function(d,c){d=d||{};c=c||this._offsets;var v=this._ticks;var q=this.max;var o=this.min;var k=c.max;var g=c.min;var m=(this._label==null)?false:this._label.show;for(var n in d){this._elem.css(n,d[n])}this._offsets=c;var e=k-g;var f=q-o;if(this.breakPoints){f=f-this.breakPoints[1]+this.breakPoints[0];this.p2u=function(h){return(h-g)*f/e+o
};this.u2p=function(h){if(h>this.breakPoints[0]&&h<this.breakPoints[1]){h=this.breakPoints[0]}if(h<=this.breakPoints[0]){return(h-o)*e/f+g}else{return(h-this.breakPoints[1]+this.breakPoints[0]-o)*e/f+g}};if(this.name.charAt(0)=="x"){this.series_u2p=function(h){if(h>this.breakPoints[0]&&h<this.breakPoints[1]){h=this.breakPoints[0]}if(h<=this.breakPoints[0]){return(h-o)*e/f}else{return(h-this.breakPoints[1]+this.breakPoints[0]-o)*e/f}};this.series_p2u=function(h){return h*f/e+o}}else{this.series_u2p=function(h){if(h>this.breakPoints[0]&&h<this.breakPoints[1]){h=this.breakPoints[0]}if(h>=this.breakPoints[1]){return(h-q)*e/f}else{return(h+this.breakPoints[1]-this.breakPoints[0]-q)*e/f}};this.series_p2u=function(h){return h*f/e+q}}}else{this.p2u=function(h){return(h-g)*f/e+o};this.u2p=function(h){return(h-o)*e/f+g};if(this.name=="xaxis"||this.name=="x2axis"){this.series_u2p=function(h){return(h-o)*e/f};this.series_p2u=function(h){return h*f/e+o}}else{this.series_u2p=function(h){return(h-q)*e/f
};this.series_p2u=function(h){return h*f/e+q}}}if(this.show){if(this.name=="xaxis"||this.name=="x2axis"){for(var r=0;r<v.length;r++){var l=v[r];if(l.show&&l.showLabel){var b;if(l.constructor==a.jqplot.CanvasAxisTickRenderer&&l.angle){var u=(this.name=="xaxis")?1:-1;switch(l.labelPosition){case"auto":if(u*l.angle<0){b=-l.getWidth()+l._textRenderer.height*Math.sin(-l._textRenderer.angle)/2}else{b=-l._textRenderer.height*Math.sin(l._textRenderer.angle)/2}break;case"end":b=-l.getWidth()+l._textRenderer.height*Math.sin(-l._textRenderer.angle)/2;break;case"start":b=-l._textRenderer.height*Math.sin(l._textRenderer.angle)/2;break;case"middle":b=-l.getWidth()/2+l._textRenderer.height*Math.sin(-l._textRenderer.angle)/2;break;default:b=-l.getWidth()/2+l._textRenderer.height*Math.sin(-l._textRenderer.angle)/2;break}}else{b=-l.getWidth()/2}var x=this.u2p(l.value)+b+"px";l._elem.css("left",x);l.pack()}}if(m){var j=this._label._elem.outerWidth(true);this._label._elem.css("left",g+e/2-j/2+"px");if(this.name=="xaxis"){this._label._elem.css("bottom","0px")
}else{this._label._elem.css("top","0px")}this._label.pack()}}else{for(var r=0;r<v.length;r++){var l=v[r];if(l.show&&l.showLabel){var b;if(l.constructor==a.jqplot.CanvasAxisTickRenderer&&l.angle){var u=(this.name=="yaxis")?1:-1;switch(l.labelPosition){case"auto":case"end":if(u*l.angle<0){b=-l._textRenderer.height*Math.cos(-l._textRenderer.angle)/2}else{b=-l.getHeight()+l._textRenderer.height*Math.cos(l._textRenderer.angle)/2}break;case"start":if(l.angle>0){b=-l._textRenderer.height*Math.cos(-l._textRenderer.angle)/2}else{b=-l.getHeight()+l._textRenderer.height*Math.cos(l._textRenderer.angle)/2}break;case"middle":b=-l.getHeight()/2;break;default:b=-l.getHeight()/2;break}}else{b=-l.getHeight()/2}var x=this.u2p(l.value)+b+"px";l._elem.css("top",x);l.pack()}}if(m){var s=this._label._elem.outerHeight(true);this._label._elem.css("top",k-e/2-s/2+"px");if(this.name=="yaxis"){this._label._elem.css("left","0px")}else{this._label._elem.css("right","0px")}this._label.pack()}}}v=null}})(jQuery);(function(a){a.jqplot.AxisTickRenderer=function(b){a.jqplot.ElemContainer.call(this);
this.mark="outside";this.axis;this.showMark=true;this.showGridline=true;this.isMinorTick=false;this.size=4;this.markSize=6;this.show=true;this.showLabel=true;this.label=null;this.value=null;this._styles={};this.formatter=a.jqplot.DefaultTickFormatter;this.prefix="";this.suffix="";this.formatString="";this.fontFamily;this.fontSize;this.textColor;this.escapeHTML=false;this._elem;this._breakTick=false;a.extend(true,this,b)};a.jqplot.AxisTickRenderer.prototype.init=function(b){a.extend(true,this,b)};a.jqplot.AxisTickRenderer.prototype=new a.jqplot.ElemContainer();a.jqplot.AxisTickRenderer.prototype.constructor=a.jqplot.AxisTickRenderer;a.jqplot.AxisTickRenderer.prototype.setTick=function(b,d,c){this.value=b;this.axis=d;if(c){this.isMinorTick=true}return this};a.jqplot.AxisTickRenderer.prototype.draw=function(){if(this.label===null){this.label=this.prefix+this.formatter(this.formatString,this.value)+this.suffix}var c={position:"absolute"};if(Number(this.label)){c.whitSpace="nowrap"}if(this._elem){this._elem.emptyForce();
this._elem=null}this._elem=a(document.createElement("div"));this._elem.addClass("jqplot-"+this.axis+"-tick");if(!this.escapeHTML){this._elem.html(this.label)}else{this._elem.text(this.label)}this._elem.css(c);for(var b in this._styles){this._elem.css(b,this._styles[b])}if(this.fontFamily){this._elem.css("font-family",this.fontFamily)}if(this.fontSize){this._elem.css("font-size",this.fontSize)}if(this.textColor){this._elem.css("color",this.textColor)}if(this._breakTick){this._elem.addClass("jqplot-breakTick")}return this._elem};a.jqplot.DefaultTickFormatter=function(b,c){if(typeof c=="number"){if(!b){b=a.jqplot.config.defaultTickFormatString}return a.jqplot.sprintf(b,c)}else{return String(c)}};a.jqplot.PercentTickFormatter=function(b,c){if(typeof c=="number"){c=100*c;if(!b){b=a.jqplot.config.defaultTickFormatString}return a.jqplot.sprintf(b,c)}else{return String(c)}};a.jqplot.AxisTickRenderer.prototype.pack=function(){}})(jQuery);(function(a){a.jqplot.AxisLabelRenderer=function(b){a.jqplot.ElemContainer.call(this);
this.axis;this.show=true;this.label="";this.fontFamily=null;this.fontSize=null;this.textColor=null;this._elem;this.escapeHTML=false;a.extend(true,this,b)};a.jqplot.AxisLabelRenderer.prototype=new a.jqplot.ElemContainer();a.jqplot.AxisLabelRenderer.prototype.constructor=a.jqplot.AxisLabelRenderer;a.jqplot.AxisLabelRenderer.prototype.init=function(b){a.extend(true,this,b)};a.jqplot.AxisLabelRenderer.prototype.draw=function(b,c){if(this._elem){this._elem.emptyForce();this._elem=null}this._elem=a('<div style="position:absolute;" class="jqplot-'+this.axis+'-label"></div>');if(Number(this.label)){this._elem.css("white-space","nowrap")}if(!this.escapeHTML){this._elem.html(this.label)}else{this._elem.text(this.label)}if(this.fontFamily){this._elem.css("font-family",this.fontFamily)}if(this.fontSize){this._elem.css("font-size",this.fontSize)}if(this.textColor){this._elem.css("color",this.textColor)}return this._elem};a.jqplot.AxisLabelRenderer.prototype.pack=function(){}})(jQuery);(function(a){a.jqplot.TableLegendRenderer=function(){};
a.jqplot.TableLegendRenderer.prototype.init=function(b){a.extend(true,this,b)};a.jqplot.TableLegendRenderer.prototype.addrow=function(k,e,b,i){var f=(b)?this.rowSpacing+"px":"0px";var j;var d;var c;var h;var g;c=document.createElement("tr");j=a(c);j.addClass("jqplot-table-legend");c=null;if(i){j.prependTo(this._elem)}else{j.appendTo(this._elem)}if(this.showSwatches){d=a(document.createElement("td"));d.addClass("jqplot-table-legend jqplot-table-legend-swatch");d.css({textAlign:"center",paddingTop:f});h=a(document.createElement("div"));h.addClass("jqplot-table-legend-swatch-outline");g=a(document.createElement("div"));g.addClass("jqplot-table-legend-swatch");g.css({backgroundColor:e,borderColor:e});j.append(d.append(h.append(g)))}if(this.showLabels){d=a(document.createElement("td"));d.addClass("jqplot-table-legend jqplot-table-legend-label");d.css("paddingTop",f);j.append(d);if(this.escapeHtml){d.text(k)}else{d.html(k)}}d=null;h=null;g=null;j=null;c=null};a.jqplot.TableLegendRenderer.prototype.draw=function(){if(this._elem){this._elem.emptyForce();
this._elem=null}if(this.show){var g=this._series;var c=document.createElement("table");this._elem=a(c);this._elem.addClass("jqplot-table-legend");var n={position:"absolute"};if(this.background){n.background=this.background}if(this.border){n.border=this.border}if(this.fontSize){n.fontSize=this.fontSize}if(this.fontFamily){n.fontFamily=this.fontFamily}if(this.textColor){n.textColor=this.textColor}if(this.marginTop!=null){n.marginTop=this.marginTop}if(this.marginBottom!=null){n.marginBottom=this.marginBottom}if(this.marginLeft!=null){n.marginLeft=this.marginLeft}if(this.marginRight!=null){n.marginRight=this.marginRight}var b=false,k=false,m;for(var h=0;h<g.length;h++){m=g[h];if(m._stack||m.renderer.constructor==a.jqplot.BezierCurveRenderer){k=true}if(m.show&&m.showLabel){var f=this.labels[h]||m.label.toString();if(f){var d=m.color;if(k&&h<g.length-1){b=true}else{if(k&&h==g.length-1){b=false}}this.renderer.addrow.call(this,f,d,b,k);b=true}for(var e=0;e<a.jqplot.addLegendRowHooks.length;e++){var l=a.jqplot.addLegendRowHooks[e].call(this,m);
if(l){this.renderer.addrow.call(this,l.label,l.color,b);b=true}}f=null}}}return this._elem};a.jqplot.TableLegendRenderer.prototype.pack=function(e){if(this.show){if(this.placement=="insideGrid"){switch(this.location){case"nw":var d=e.left;var c=e.top;this._elem.css("left",d);this._elem.css("top",c);break;case"n":var d=(e.left+(this._plotDimensions.width-e.right))/2-this.getWidth()/2;var c=e.top;this._elem.css("left",d);this._elem.css("top",c);break;case"ne":var d=e.right;var c=e.top;this._elem.css({right:d,top:c});break;case"e":var d=e.right;var c=(e.top+(this._plotDimensions.height-e.bottom))/2-this.getHeight()/2;this._elem.css({right:d,top:c});break;case"se":var d=e.right;var c=e.bottom;this._elem.css({right:d,bottom:c});break;case"s":var d=(e.left+(this._plotDimensions.width-e.right))/2-this.getWidth()/2;var c=e.bottom;this._elem.css({left:d,bottom:c});break;case"sw":var d=e.left;var c=e.bottom;this._elem.css({left:d,bottom:c});break;case"w":var d=e.left;var c=(e.top+(this._plotDimensions.height-e.bottom))/2-this.getHeight()/2;
this._elem.css({left:d,top:c});break;default:var d=e.right;var c=e.bottom;this._elem.css({right:d,bottom:c});break}}else{if(this.placement=="outside"){switch(this.location){case"nw":var d=this._plotDimensions.width-e.left;var c=e.top;this._elem.css("right",d);this._elem.css("top",c);break;case"n":var d=(e.left+(this._plotDimensions.width-e.right))/2-this.getWidth()/2;var c=this._plotDimensions.height-e.top;this._elem.css("left",d);this._elem.css("bottom",c);break;case"ne":var d=this._plotDimensions.width-e.right;var c=e.top;this._elem.css({left:d,top:c});break;case"e":var d=this._plotDimensions.width-e.right;var c=(e.top+(this._plotDimensions.height-e.bottom))/2-this.getHeight()/2;this._elem.css({left:d,top:c});break;case"se":var d=this._plotDimensions.width-e.right;var c=e.bottom;this._elem.css({left:d,bottom:c});break;case"s":var d=(e.left+(this._plotDimensions.width-e.right))/2-this.getWidth()/2;var c=this._plotDimensions.height-e.bottom;this._elem.css({left:d,top:c});break;case"sw":var d=this._plotDimensions.width-e.left;
var c=e.bottom;this._elem.css({right:d,bottom:c});break;case"w":var d=this._plotDimensions.width-e.left;var c=(e.top+(this._plotDimensions.height-e.bottom))/2-this.getHeight()/2;this._elem.css({right:d,top:c});break;default:var d=e.right;var c=e.bottom;this._elem.css({right:d,bottom:c});break}}else{switch(this.location){case"nw":this._elem.css({left:0,top:e.top});break;case"n":var d=(e.left+(this._plotDimensions.width-e.right))/2-this.getWidth()/2;this._elem.css({left:d,top:e.top});break;case"ne":this._elem.css({right:0,top:e.top});break;case"e":var c=(e.top+(this._plotDimensions.height-e.bottom))/2-this.getHeight()/2;this._elem.css({right:e.right,top:c});break;case"se":this._elem.css({right:e.right,bottom:e.bottom});break;case"s":var d=(e.left+(this._plotDimensions.width-e.right))/2-this.getWidth()/2;this._elem.css({left:d,bottom:e.bottom});break;case"sw":this._elem.css({left:e.left,bottom:e.bottom});break;case"w":var c=(e.top+(this._plotDimensions.height-e.bottom))/2-this.getHeight()/2;
this._elem.css({left:e.left,top:c});break;default:this._elem.css({right:e.right,bottom:e.bottom});break}}}}}})(jQuery);(function(h){h.jqplot.LineRenderer=function(){this.shapeRenderer=new h.jqplot.ShapeRenderer();this.shadowRenderer=new h.jqplot.ShadowRenderer()};h.jqplot.LineRenderer.prototype.init=function(q,v){q=q||{};this._type="line";this.renderer.animation={show:false,direction:"left",speed:2500,_supported:true};this.renderer.smooth=false;this.renderer.tension=null;this.renderer.constrainSmoothing=true;this.renderer._smoothedData=[];this.renderer._smoothedPlotData=[];this.renderer._hiBandGridData=[];this.renderer._lowBandGridData=[];this.renderer._hiBandSmoothedData=[];this.renderer._lowBandSmoothedData=[];this.renderer.bandData=[];this.renderer.bands={show:false,hiData:[],lowData:[],color:this.color,showLines:false,fill:true,fillColor:null,_min:null,_max:null,interval:"3%"};var t={highlightMouseOver:q.highlightMouseOver,highlightMouseDown:q.highlightMouseDown,highlightColor:q.highlightColor};
delete (q.highlightMouseOver);delete (q.highlightMouseDown);delete (q.highlightColor);h.extend(true,this.renderer,q);this.renderer.options=q;if(this.renderer.bandData.length>1&&(!q.bands||q.bands.show==null)){this.renderer.bands.show=true}else{if(q.bands&&q.bands.show==null&&q.bands.interval!=null){this.renderer.bands.show=true}}if(this.fill){this.renderer.bands.show=false}if(this.renderer.bands.show){this.renderer.initBands.call(this,this.renderer.options,v)}if(this._stack){this.renderer.smooth=false}var u={lineJoin:this.lineJoin,lineCap:this.lineCap,fill:this.fill,isarc:false,strokeStyle:this.color,fillStyle:this.fillColor,lineWidth:this.lineWidth,linePattern:this.linePattern,closePath:this.fill};this.renderer.shapeRenderer.init(u);var r=q.shadowOffset;if(r==null){if(this.lineWidth>2.5){r=1.25*(1+(Math.atan((this.lineWidth/2.5))/0.785398163-1)*0.6)}else{r=1.25*Math.atan((this.lineWidth/2.5))/0.785398163}}var p={lineJoin:this.lineJoin,lineCap:this.lineCap,fill:this.fill,isarc:false,angle:this.shadowAngle,offset:r,alpha:this.shadowAlpha,depth:this.shadowDepth,lineWidth:this.lineWidth,linePattern:this.linePattern,closePath:this.fill};
this.renderer.shadowRenderer.init(p);this._areaPoints=[];this._boundingBox=[[],[]];if(!this.isTrendline&&this.fill||this.renderer.bands.show){this.highlightMouseOver=true;this.highlightMouseDown=false;this.highlightColor=null;if(t.highlightMouseDown&&t.highlightMouseOver==null){t.highlightMouseOver=false}h.extend(true,this,{highlightMouseOver:t.highlightMouseOver,highlightMouseDown:t.highlightMouseDown,highlightColor:t.highlightColor});if(!this.highlightColor){var s=(this.renderer.bands.show)?this.renderer.bands.fillColor:this.fillColor;this.highlightColor=h.jqplot.computeHighlightColors(s)}if(this.highlighter){this.highlighter.show=false}}if(!this.isTrendline&&v){v.plugins.lineRenderer={};v.postInitHooks.addOnce(j);v.postDrawHooks.addOnce(l);v.eventListenerHooks.addOnce("jqplotMouseMove",b);v.eventListenerHooks.addOnce("jqplotMouseDown",a);v.eventListenerHooks.addOnce("jqplotMouseUp",n);v.eventListenerHooks.addOnce("jqplotClick",i);v.eventListenerHooks.addOnce("jqplotRightClick",o)}};h.jqplot.LineRenderer.prototype.initBands=function(t,D){var u=t.bandData||[];
var w=this.renderer.bands;w.hiData=[];w.lowData=[];var J=this.data;w._max=null;w._min=null;if(u.length==2){if(h.isArray(u[0][0])){var x;var q=0,A=0;for(var E=0,B=u[0].length;E<B;E++){x=u[0][E];if((x[1]!=null&&x[1]>w._max)||w._max==null){w._max=x[1]}if((x[1]!=null&&x[1]<w._min)||w._min==null){w._min=x[1]}}for(var E=0,B=u[1].length;E<B;E++){x=u[1][E];if((x[1]!=null&&x[1]>w._max)||w._max==null){w._max=x[1];A=1}if((x[1]!=null&&x[1]<w._min)||w._min==null){w._min=x[1];q=1}}if(A===q){w.show=false}w.hiData=u[A];w.lowData=u[q]}else{if(u[0].length===J.length&&u[1].length===J.length){var s=(u[0][0]>u[1][0])?0:1;var K=(s)?0:1;for(var E=0,B=J.length;E<B;E++){w.hiData.push([J[E][0],u[s][E]]);w.lowData.push([J[E][0],u[K][E]])}}else{w.show=false}}}else{if(u.length>2&&!h.isArray(u[0][0])){var s=(u[0][0]>u[0][1])?0:1;var K=(s)?0:1;for(var E=0,B=u.length;E<B;E++){w.hiData.push([J[E][0],u[E][s]]);w.lowData.push([J[E][0],u[E][K]])}}else{var z=w.interval;var I=null;var H=null;var r=null;var C=null;if(h.isArray(z)){I=z[0];
H=z[1]}else{I=z}if(isNaN(I)){if(I.charAt(I.length-1)==="%"){r="multiply";I=parseFloat(I)/100+1}}else{I=parseFloat(I);r="add"}if(H!==null&&isNaN(H)){if(H.charAt(H.length-1)==="%"){C="multiply";H=parseFloat(H)/100+1}}else{if(H!==null){H=parseFloat(H);C="add"}}if(I!==null){if(H===null){H=-I;C=r;if(C==="multiply"){H+=2}}if(I<H){var F=I;I=H;H=F;F=r;r=C;C=F}for(var E=0,B=J.length;E<B;E++){switch(r){case"add":w.hiData.push([J[E][0],J[E][1]+I]);break;case"multiply":w.hiData.push([J[E][0],J[E][1]*I]);break}switch(C){case"add":w.lowData.push([J[E][0],J[E][1]+H]);break;case"multiply":w.lowData.push([J[E][0],J[E][1]*H]);break}}}else{w.show=false}}}var v=w.hiData;var y=w.lowData;for(var E=0,B=v.length;E<B;E++){if((v[E][1]!=null&&v[E][1]>w._max)||w._max==null){w._max=v[E][1]}}for(var E=0,B=y.length;E<B;E++){if((y[E][1]!=null&&y[E][1]<w._min)||w._min==null){w._min=y[E][1]}}if(w.fillColor===null){var G=h.jqplot.getColorComponents(w.color);G[3]=G[3]*0.5;w.fillColor="rgba("+G[0]+", "+G[1]+", "+G[2]+", "+G[3]+")"
}};function f(q,p){return(3.4182054+p)*Math.pow(q,-0.3534992)}function g(r,q){var p=Math.sqrt(Math.pow((q[0]-r[0]),2)+Math.pow((q[1]-r[1]),2));return 5.7648*Math.log(p)+7.4456}function c(p){var q=(Math.exp(2*p)-1)/(Math.exp(2*p)+1);return q}function e(U){var E=this.renderer.smooth;var O=this.canvas.getWidth();var v=this._xaxis.series_p2u;var R=this._yaxis.series_p2u;var Q=null;var u=null;var K=U.length/O;var r=[];var J=[];if(!isNaN(parseFloat(E))){Q=parseFloat(E)}else{Q=f(K,0.5)}var H=[];var s=[];for(var P=0,L=U.length;P<L;P++){H.push(U[P][1]);s.push(U[P][0])}function G(A,B){if(A-B==0){return Math.pow(10,10)}else{return A-B}}var I,z,y,x;var p=U.length-1;for(var t=1,M=U.length;t<M;t++){var q=[];var F=[];for(var N=0;N<2;N++){var P=t-1+N;if(P==0||P==p){q[N]=Math.pow(10,10)}else{if(H[P+1]-H[P]==0||H[P]-H[P-1]==0){q[N]=0}else{if(((s[P+1]-s[P])/(H[P+1]-H[P])+(s[P]-s[P-1])/(H[P]-H[P-1]))==0){q[N]=0}else{if((H[P+1]-H[P])*(H[P]-H[P-1])<0){q[N]=0}else{q[N]=2/(G(s[P+1],s[P])/(H[P+1]-H[P])+G(s[P],s[P-1])/(H[P]-H[P-1]))
}}}}}if(t==1){q[0]=3/2*(H[1]-H[0])/G(s[1],s[0])-q[1]/2}else{if(t==p){q[1]=3/2*(H[p]-H[p-1])/G(s[p],s[p-1])-q[0]/2}}F[0]=-2*(q[1]+2*q[0])/G(s[t],s[t-1])+6*(H[t]-H[t-1])/Math.pow(G(s[t],s[t-1]),2);F[1]=2*(2*q[1]+q[0])/G(s[t],s[t-1])-6*(H[t]-H[t-1])/Math.pow(G(s[t],s[t-1]),2);x=1/6*(F[1]-F[0])/G(s[t],s[t-1]);y=1/2*(s[t]*F[0]-s[t-1]*F[1])/G(s[t],s[t-1]);z=(H[t]-H[t-1]-y*(Math.pow(s[t],2)-Math.pow(s[t-1],2))-x*(Math.pow(s[t],3)-Math.pow(s[t-1],3)))/G(s[t],s[t-1]);I=H[t-1]-z*s[t-1]-y*Math.pow(s[t-1],2)-x*Math.pow(s[t-1],3);var T=(s[t]-s[t-1])/Q;var S,w;for(var N=0,L=Q;N<L;N++){S=[];w=s[t-1]+N*T;S.push(w);S.push(I+z*w+y*Math.pow(w,2)+x*Math.pow(w,3));r.push(S);J.push([v(S[0]),R(S[1])])}}r.push(U[P]);J.push([v(U[P][0]),R(U[P][1])]);return[r,J]}function k(A){var z=this.renderer.smooth;var ae=this.renderer.tension;var q=this.canvas.getWidth();var R=this._xaxis.series_p2u;var B=this._yaxis.series_p2u;var S=null;var T=null;var ad=null;var Y=null;var W=null;var D=null;var ab=null;var x=null;var U,V,N,M,K,I;
var v,r,F,E;var L,J,X;var G=[];var u=[];var w=A.length/q;var ac,H,P,Q,O;var C=[];var y=[];if(!isNaN(parseFloat(z))){S=parseFloat(z)}else{S=f(w,0.5)}if(!isNaN(parseFloat(ae))){ae=parseFloat(ae)}for(var aa=0,Z=A.length-1;aa<Z;aa++){if(ae===null){D=Math.abs((A[aa+1][1]-A[aa][1])/(A[aa+1][0]-A[aa][0]));ac=0.3;H=0.6;P=(H-ac)/2;Q=2.5;O=-1.4;x=D/Q+O;Y=P*c(x)-P*c(O)+ac;if(aa>0){ab=Math.abs((A[aa][1]-A[aa-1][1])/(A[aa][0]-A[aa-1][0]))}x=ab/Q+O;W=P*c(x)-P*c(O)+ac;ad=(Y+W)/2}else{ad=ae}for(U=0;U<S;U++){V=U/S;N=(1+2*V)*Math.pow((1-V),2);M=V*Math.pow((1-V),2);K=Math.pow(V,2)*(3-2*V);I=Math.pow(V,2)*(V-1);if(A[aa-1]){v=ad*(A[aa+1][0]-A[aa-1][0]);r=ad*(A[aa+1][1]-A[aa-1][1])}else{v=ad*(A[aa+1][0]-A[aa][0]);r=ad*(A[aa+1][1]-A[aa][1])}if(A[aa+2]){F=ad*(A[aa+2][0]-A[aa][0]);E=ad*(A[aa+2][1]-A[aa][1])}else{F=ad*(A[aa+1][0]-A[aa][0]);E=ad*(A[aa+1][1]-A[aa][1])}L=N*A[aa][0]+K*A[aa+1][0]+M*v+I*F;J=N*A[aa][1]+K*A[aa+1][1]+M*r+I*E;X=[L,J];C.push(X);y.push([R(L),B(J)])}}C.push(A[Z]);y.push([R(A[Z][0]),B(A[Z][1])]);
return[C,y]}h.jqplot.LineRenderer.prototype.setGridData=function(x){var t=this._xaxis.series_u2p;var p=this._yaxis.series_u2p;var u=this._plotData;var y=this._prevPlotData;this.gridData=[];this._prevGridData=[];this.renderer._smoothedData=[];this.renderer._smoothedPlotData=[];this.renderer._hiBandGridData=[];this.renderer._lowBandGridData=[];this.renderer._hiBandSmoothedData=[];this.renderer._lowBandSmoothedData=[];var s=this.renderer.bands;var q=false;for(var v=0,r=u.length;v<r;v++){if(u[v][0]!=null&&u[v][1]!=null){this.gridData.push([t.call(this._xaxis,u[v][0]),p.call(this._yaxis,u[v][1])])}else{if(u[v][0]==null){q=true;this.gridData.push([null,p.call(this._yaxis,u[v][1])])}else{if(u[v][1]==null){q=true;this.gridData.push([t.call(this._xaxis,u[v][0]),null])}}}if(y[v]!=null&&y[v][0]!=null&&y[v][1]!=null){this._prevGridData.push([t.call(this._xaxis,y[v][0]),p.call(this._yaxis,y[v][1])])}else{if(y[v]!=null&&y[v][0]==null){this._prevGridData.push([null,p.call(this._yaxis,y[v][1])])}else{if(y[v]!=null&&y[v][0]!=null&&y[v][1]==null){this._prevGridData.push([t.call(this._xaxis,y[v][0]),null])
}}}}if(q){this.renderer.smooth=false;if(this._type==="line"){s.show=false}}if(this._type==="line"&&s.show){for(var v=0,r=s.hiData.length;v<r;v++){this.renderer._hiBandGridData.push([t.call(this._xaxis,s.hiData[v][0]),p.call(this._yaxis,s.hiData[v][1])])}for(var v=0,r=s.lowData.length;v<r;v++){this.renderer._lowBandGridData.push([t.call(this._xaxis,s.lowData[v][0]),p.call(this._yaxis,s.lowData[v][1])])}}if(this._type==="line"&&this.renderer.smooth&&this.gridData.length>2){var w;if(this.renderer.constrainSmoothing){w=e.call(this,this.gridData);this.renderer._smoothedData=w[0];this.renderer._smoothedPlotData=w[1];if(s.show){w=e.call(this,this.renderer._hiBandGridData);this.renderer._hiBandSmoothedData=w[0];w=e.call(this,this.renderer._lowBandGridData);this.renderer._lowBandSmoothedData=w[0]}w=null}else{w=k.call(this,this.gridData);this.renderer._smoothedData=w[0];this.renderer._smoothedPlotData=w[1];if(s.show){w=k.call(this,this.renderer._hiBandGridData);this.renderer._hiBandSmoothedData=w[0];
w=k.call(this,this.renderer._lowBandGridData);this.renderer._lowBandSmoothedData=w[0]}w=null}}};h.jqplot.LineRenderer.prototype.makeGridData=function(w,y){var u=this._xaxis.series_u2p;var p=this._yaxis.series_u2p;var z=[];var r=[];this.renderer._smoothedData=[];this.renderer._smoothedPlotData=[];this.renderer._hiBandGridData=[];this.renderer._lowBandGridData=[];this.renderer._hiBandSmoothedData=[];this.renderer._lowBandSmoothedData=[];var t=this.renderer.bands;var q=false;for(var v=0;v<w.length;v++){if(w[v][0]!=null&&w[v][1]!=null){z.push([u.call(this._xaxis,w[v][0]),p.call(this._yaxis,w[v][1])])}else{if(w[v][0]==null){q=true;z.push([null,p.call(this._yaxis,w[v][1])])}else{if(w[v][1]==null){q=true;z.push([u.call(this._xaxis,w[v][0]),null])}}}}if(q){this.renderer.smooth=false;if(this._type==="line"){t.show=false}}if(this._type==="line"&&t.show){for(var v=0,s=t.hiData.length;v<s;v++){this.renderer._hiBandGridData.push([u.call(this._xaxis,t.hiData[v][0]),p.call(this._yaxis,t.hiData[v][1])])
}for(var v=0,s=t.lowData.length;v<s;v++){this.renderer._lowBandGridData.push([u.call(this._xaxis,t.lowData[v][0]),p.call(this._yaxis,t.lowData[v][1])])}}if(this._type==="line"&&this.renderer.smooth&&z.length>2){var x;if(this.renderer.constrainSmoothing){x=e.call(this,z);this.renderer._smoothedData=x[0];this.renderer._smoothedPlotData=x[1];if(t.show){x=e.call(this,this.renderer._hiBandGridData);this.renderer._hiBandSmoothedData=x[0];x=e.call(this,this.renderer._lowBandGridData);this.renderer._lowBandSmoothedData=x[0]}x=null}else{x=k.call(this,z);this.renderer._smoothedData=x[0];this.renderer._smoothedPlotData=x[1];if(t.show){x=k.call(this,this.renderer._hiBandGridData);this.renderer._hiBandSmoothedData=x[0];x=k.call(this,this.renderer._lowBandGridData);this.renderer._lowBandSmoothedData=x[0]}x=null}}return z};h.jqplot.LineRenderer.prototype.draw=function(F,Q,r,J){var K;var z=h.extend(true,{},r);var t=(z.shadow!=undefined)?z.shadow:this.shadow;var R=(z.showLine!=undefined)?z.showLine:this.showLine;
var I=(z.fill!=undefined)?z.fill:this.fill;var q=(z.fillAndStroke!=undefined)?z.fillAndStroke:this.fillAndStroke;var A,G,D,M;F.save();if(Q.length){if(R){if(I){if(this.fillToZero){var N=this.negativeColor;if(!this.useNegativeColors){N=z.fillStyle}var x=false;var y=z.fillStyle;if(q){var P=Q.slice(0)}if(this.index==0||!this._stack){var E=[];var T=(this.renderer.smooth)?this.renderer._smoothedPlotData:this._plotData;this._areaPoints=[];var O=this._yaxis.series_u2p(this.fillToValue);var s=this._xaxis.series_u2p(this.fillToValue);z.closePath=true;if(this.fillAxis=="y"){E.push([Q[0][0],O]);this._areaPoints.push([Q[0][0],O]);for(var K=0;K<Q.length-1;K++){E.push(Q[K]);this._areaPoints.push(Q[K]);if(T[K][1]*T[K+1][1]<=0){if(T[K][1]<0){x=true;z.fillStyle=N}else{x=false;z.fillStyle=y}var w=Q[K][0]+(Q[K+1][0]-Q[K][0])*(O-Q[K][1])/(Q[K+1][1]-Q[K][1]);E.push([w,O]);this._areaPoints.push([w,O]);if(t){this.renderer.shadowRenderer.draw(F,E,z)}this.renderer.shapeRenderer.draw(F,E,z);E=[[w,O]]}}if(T[Q.length-1][1]<0){x=true;
z.fillStyle=N}else{x=false;z.fillStyle=y}E.push(Q[Q.length-1]);this._areaPoints.push(Q[Q.length-1]);E.push([Q[Q.length-1][0],O]);this._areaPoints.push([Q[Q.length-1][0],O])}if(t){this.renderer.shadowRenderer.draw(F,E,z)}this.renderer.shapeRenderer.draw(F,E,z)}else{var C=this._prevGridData;for(var K=C.length;K>0;K--){Q.push(C[K-1])}if(t){this.renderer.shadowRenderer.draw(F,Q,z)}this._areaPoints=Q;this.renderer.shapeRenderer.draw(F,Q,z)}}else{if(q){var P=Q.slice(0)}if(this.index==0||!this._stack){var u=F.canvas.height;Q.unshift([Q[0][0],u]);var L=Q.length;Q.push([Q[L-1][0],u])}else{var C=this._prevGridData;for(var K=C.length;K>0;K--){Q.push(C[K-1])}}this._areaPoints=Q;if(t){this.renderer.shadowRenderer.draw(F,Q,z)}this.renderer.shapeRenderer.draw(F,Q,z)}if(q){var H=h.extend(true,{},z,{fill:false,closePath:false});this.renderer.shapeRenderer.draw(F,P,H);if(this.markerRenderer.show){if(this.renderer.smooth){P=this.gridData}for(K=0;K<P.length;K++){this.markerRenderer.draw(P[K][0],P[K][1],F,z.markerOptions)
}}}}else{if(this.renderer.bands.show){var v;var S=h.extend(true,{},z);if(this.renderer.bands.showLines){v=(this.renderer.smooth)?this.renderer._hiBandSmoothedData:this.renderer._hiBandGridData;this.renderer.shapeRenderer.draw(F,v,z);v=(this.renderer.smooth)?this.renderer._lowBandSmoothedData:this.renderer._lowBandGridData;this.renderer.shapeRenderer.draw(F,v,S)}if(this.renderer.bands.fill){if(this.renderer.smooth){v=this.renderer._hiBandSmoothedData.concat(this.renderer._lowBandSmoothedData.reverse())}else{v=this.renderer._hiBandGridData.concat(this.renderer._lowBandGridData.reverse())}this._areaPoints=v;S.closePath=true;S.fill=true;S.fillStyle=this.renderer.bands.fillColor;this.renderer.shapeRenderer.draw(F,v,S)}}if(t){this.renderer.shadowRenderer.draw(F,Q,z)}this.renderer.shapeRenderer.draw(F,Q,z)}}var A=D=G=M=null;for(K=0;K<this._areaPoints.length;K++){var B=this._areaPoints[K];if(A>B[0]||A==null){A=B[0]}if(M<B[1]||M==null){M=B[1]}if(D<B[0]||D==null){D=B[0]}if(G>B[1]||G==null){G=B[1]
}}if(this.type==="line"&&this.renderer.bands.show){M=this._yaxis.series_u2p(this.renderer.bands._min);G=this._yaxis.series_u2p(this.renderer.bands._max)}this._boundingBox=[[A,M],[D,G]];if(this.markerRenderer.show&&!I){if(this.renderer.smooth){Q=this.gridData}for(K=0;K<Q.length;K++){if(Q[K][0]!=null&&Q[K][1]!=null){this.markerRenderer.draw(Q[K][0],Q[K][1],F,z.markerOptions)}}}}F.restore()};h.jqplot.LineRenderer.prototype.drawShadow=function(p,r,q){};function j(s,r,p){for(var q=0;q<this.series.length;q++){if(this.series[q].renderer.constructor==h.jqplot.LineRenderer){if(this.series[q].highlightMouseOver){this.series[q].highlightMouseDown=false}}}}function l(){if(this.plugins.lineRenderer&&this.plugins.lineRenderer.highlightCanvas){this.plugins.lineRenderer.highlightCanvas.resetCanvas();this.plugins.lineRenderer.highlightCanvas=null}this.plugins.lineRenderer.highlightedSeriesIndex=null;this.plugins.lineRenderer.highlightCanvas=new h.jqplot.GenericCanvas();this.eventCanvas._elem.before(this.plugins.lineRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-lineRenderer-highlight-canvas",this._plotDimensions,this));
this.plugins.lineRenderer.highlightCanvas.setContext();this.eventCanvas._elem.bind("mouseleave",{plot:this},function(p){m(p.data.plot)})}function d(w,v,t,r){var q=w.series[v];var p=w.plugins.lineRenderer.highlightCanvas;p._ctx.clearRect(0,0,p._ctx.canvas.width,p._ctx.canvas.height);q._highlightedPoint=t;w.plugins.lineRenderer.highlightedSeriesIndex=v;var u={fillStyle:q.highlightColor};if(q.type==="line"&&q.renderer.bands.show){u.fill=true;u.closePath=true}q.renderer.shapeRenderer.draw(p._ctx,r,u);p=null}function m(r){var p=r.plugins.lineRenderer.highlightCanvas;p._ctx.clearRect(0,0,p._ctx.canvas.width,p._ctx.canvas.height);for(var q=0;q<r.series.length;q++){r.series[q]._highlightedPoint=null}r.plugins.lineRenderer.highlightedSeriesIndex=null;r.target.trigger("jqplotDataUnhighlight");p=null}function b(t,s,w,v,u){if(v){var r=[v.seriesIndex,v.pointIndex,v.data];var q=jQuery.Event("jqplotDataMouseOver");q.pageX=t.pageX;q.pageY=t.pageY;u.target.trigger(q,r);if(u.series[r[0]].highlightMouseOver&&!(r[0]==u.plugins.lineRenderer.highlightedSeriesIndex)){var p=jQuery.Event("jqplotDataHighlight");
p.which=t.which;p.pageX=t.pageX;p.pageY=t.pageY;u.target.trigger(p,r);d(u,v.seriesIndex,v.pointIndex,v.points)}}else{if(v==null){m(u)}}}function a(s,r,v,u,t){if(u){var q=[u.seriesIndex,u.pointIndex,u.data];if(t.series[q[0]].highlightMouseDown&&!(q[0]==t.plugins.lineRenderer.highlightedSeriesIndex)){var p=jQuery.Event("jqplotDataHighlight");p.which=s.which;p.pageX=s.pageX;p.pageY=s.pageY;t.target.trigger(p,q);d(t,u.seriesIndex,u.pointIndex,u.points)}}else{if(u==null){m(t)}}}function n(r,q,u,t,s){var p=s.plugins.lineRenderer.highlightedSeriesIndex;if(p!=null&&s.series[p].highlightMouseDown){m(s)}}function i(s,r,v,u,t){if(u){var q=[u.seriesIndex,u.pointIndex,u.data];var p=jQuery.Event("jqplotDataClick");p.which=s.which;p.pageX=s.pageX;p.pageY=s.pageY;t.target.trigger(p,q)}}function o(t,s,w,v,u){if(v){var r=[v.seriesIndex,v.pointIndex,v.data];var p=u.plugins.lineRenderer.highlightedSeriesIndex;if(p!=null&&u.series[p].highlightMouseDown){m(u)}var q=jQuery.Event("jqplotDataRightClick");q.which=t.which;
q.pageX=t.pageX;q.pageY=t.pageY;u.target.trigger(q,r)}}})(jQuery);(function(b){var a=0.1;b.jqplot.LinePattern=function(r,m){var l={dotted:[a,b.jqplot.config.dotGapLength],dashed:[b.jqplot.config.dashLength,b.jqplot.config.gapLength],solid:null};if(typeof m==="string"){if(m[0]==="."||m[0]==="-"){var t=m;m=[];for(var k=0,g=t.length;k<g;k++){if(t[k]==="."){m.push(a)}else{if(t[k]==="-"){m.push(b.jqplot.config.dashLength)}else{continue}}m.push(b.jqplot.config.gapLength)}}else{m=l[m]}}if(!(m&&m.length)){return r}var f=0;var n=m[0];var p=0;var o=0;var j=0;var c=0;var q=function(i,s){r.moveTo(i,s);p=i;o=s;j=i;c=s};var e=function(i,A){var w=r.lineWidth;var u=i-p;var s=A-o;var v=Math.sqrt(u*u+s*s);if((v>0)&&(w>0)){u/=v;s/=v;while(true){var z=w*n;if(z<v){p+=z*u;o+=z*s;if((f&1)==0){r.lineTo(p,o)}else{r.moveTo(p,o)}v-=z;f++;if(f>=m.length){f=0}n=m[f]}else{p=i;o=A;if((f&1)==0){r.lineTo(p,o)}else{r.moveTo(p,o)}n-=v/w;break}}}};var d=function(){r.beginPath()};var h=function(){e(j,c)};return{moveTo:q,lineTo:e,beginPath:d,closePath:h}
}})(jQuery);(function(a){a.jqplot.MarkerRenderer=function(b){this.show=true;this.style="filledCircle";this.lineWidth=2;this.size=9;this.color="#666666";this.shadow=true;this.shadowAngle=45;this.shadowOffset=1;this.shadowDepth=3;this.shadowAlpha="0.07";this.shadowRenderer=new a.jqplot.ShadowRenderer();this.shapeRenderer=new a.jqplot.ShapeRenderer();a.extend(true,this,b)};a.jqplot.MarkerRenderer.prototype.init=function(b){a.extend(true,this,b);var d={angle:this.shadowAngle,offset:this.shadowOffset,alpha:this.shadowAlpha,lineWidth:this.lineWidth,depth:this.shadowDepth,closePath:true};if(this.style.indexOf("filled")!=-1){d.fill=true}if(this.style.indexOf("ircle")!=-1){d.isarc=true;d.closePath=false}this.shadowRenderer.init(d);var c={fill:false,isarc:false,strokeStyle:this.color,fillStyle:this.color,lineWidth:this.lineWidth,closePath:true};if(this.style.indexOf("filled")!=-1){c.fill=true}if(this.style.indexOf("ircle")!=-1){c.isarc=true;c.closePath=false}this.shapeRenderer.init(c)};a.jqplot.MarkerRenderer.prototype.drawDiamond=function(d,c,g,f,i){var b=1.2;
var j=this.size/2/b;var h=this.size/2*b;var e=[[d-j,c],[d,c+h],[d+j,c],[d,c-h]];if(this.shadow){this.shadowRenderer.draw(g,e)}this.shapeRenderer.draw(g,e,i)};a.jqplot.MarkerRenderer.prototype.drawPlus=function(e,d,h,g,k){var c=1;var l=this.size/2*c;var i=this.size/2*c;var j=[[e,d-i],[e,d+i]];var f=[[e+l,d],[e-l,d]];var b=a.extend(true,{},this.options,{closePath:false});if(this.shadow){this.shadowRenderer.draw(h,j,{closePath:false});this.shadowRenderer.draw(h,f,{closePath:false})}this.shapeRenderer.draw(h,j,b);this.shapeRenderer.draw(h,f,b)};a.jqplot.MarkerRenderer.prototype.drawX=function(e,d,h,g,k){var c=1;var l=this.size/2*c;var i=this.size/2*c;var b=a.extend(true,{},this.options,{closePath:false});var j=[[e-l,d-i],[e+l,d+i]];var f=[[e-l,d+i],[e+l,d-i]];if(this.shadow){this.shadowRenderer.draw(h,j,{closePath:false});this.shadowRenderer.draw(h,f,{closePath:false})}this.shapeRenderer.draw(h,j,b);this.shapeRenderer.draw(h,f,b)};a.jqplot.MarkerRenderer.prototype.drawDash=function(d,c,g,f,i){var b=1;
var j=this.size/2*b;var h=this.size/2*b;var e=[[d-j,c],[d+j,c]];if(this.shadow){this.shadowRenderer.draw(g,e)}this.shapeRenderer.draw(g,e,i)};a.jqplot.MarkerRenderer.prototype.drawLine=function(g,f,b,e,c){var d=[g,f];if(this.shadow){this.shadowRenderer.draw(b,d)}this.shapeRenderer.draw(b,d,c)};a.jqplot.MarkerRenderer.prototype.drawSquare=function(d,c,g,f,i){var b=1;var j=this.size/2/b;var h=this.size/2*b;var e=[[d-j,c-h],[d-j,c+h],[d+j,c+h],[d+j,c-h]];if(this.shadow){this.shadowRenderer.draw(g,e)}this.shapeRenderer.draw(g,e,i)};a.jqplot.MarkerRenderer.prototype.drawCircle=function(c,i,e,h,f){var b=this.size/2;var d=2*Math.PI;var g=[c,i,b,0,d,true];if(this.shadow){this.shadowRenderer.draw(e,g)}this.shapeRenderer.draw(e,g,f)};a.jqplot.MarkerRenderer.prototype.draw=function(b,e,c,d){d=d||{};if(d.show==null||d.show!=false){if(d.color&&!d.fillStyle){d.fillStyle=d.color}if(d.color&&!d.strokeStyle){d.strokeStyle=d.color}switch(this.style){case"diamond":this.drawDiamond(b,e,c,false,d);break;case"filledDiamond":this.drawDiamond(b,e,c,true,d);
break;case"circle":this.drawCircle(b,e,c,false,d);break;case"filledCircle":this.drawCircle(b,e,c,true,d);break;case"square":this.drawSquare(b,e,c,false,d);break;case"filledSquare":this.drawSquare(b,e,c,true,d);break;case"x":this.drawX(b,e,c,true,d);break;case"plus":this.drawPlus(b,e,c,true,d);break;case"dash":this.drawDash(b,e,c,true,d);break;case"line":this.drawLine(b,e,c,false,d);break;default:this.drawDiamond(b,e,c,false,d);break}}}})(jQuery);(function(a){a.jqplot.DivTitleRenderer=function(){};a.jqplot.DivTitleRenderer.prototype.init=function(b){a.extend(true,this,b)};a.jqplot.DivTitleRenderer.prototype.draw=function(){if(this._elem){this._elem.emptyForce();this._elem=null}var e=this.renderer;var d=document.createElement("div");this._elem=a(d);this._elem.addClass("jqplot-title");if(!this.text){this.show=false;this._elem.height(0);this._elem.width(0)}else{if(this.text){var b;if(this.color){b=this.color}else{if(this.textColor){b=this.textColor}}var c={position:"absolute",top:"0px",left:"0px"};
if(this._plotWidth){c.width=this._plotWidth+"px"}if(this.fontSize){c.fontSize=this.fontSize}if(typeof this.textAlign==="string"){c.textAlign=this.textAlign}else{c.textAlign="center"}if(b){c.color=b}if(this.paddingBottom){c.paddingBottom=this.paddingBottom}if(this.fontFamily){c.fontFamily=this.fontFamily}this._elem.css(c);if(this.escapeHtml){this._elem.text(this.text)}else{this._elem.html(this.text)}}}d=null;return this._elem};a.jqplot.DivTitleRenderer.prototype.pack=function(){}})(jQuery);(function(a){a.jqplot.CanvasGridRenderer=function(){this.shadowRenderer=new a.jqplot.ShadowRenderer()};a.jqplot.CanvasGridRenderer.prototype.init=function(c){this._ctx;a.extend(true,this,c);var b={lineJoin:"miter",lineCap:"round",fill:false,isarc:false,angle:this.shadowAngle,offset:this.shadowOffset,alpha:this.shadowAlpha,depth:this.shadowDepth,lineWidth:this.shadowWidth,closePath:false,strokeStyle:this.shadowColor};this.renderer.shadowRenderer.init(b)};a.jqplot.CanvasGridRenderer.prototype.createElement=function(e){var d;
if(this._elem){if(a.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==undefined){d=this._elem.get(0);window.G_vmlCanvasManager.uninitElement(d);d=null}this._elem.emptyForce();this._elem=null}d=e.canvasManager.getCanvas();var b=this._plotDimensions.width;var c=this._plotDimensions.height;d.width=b;d.height=c;this._elem=a(d);this._elem.addClass("jqplot-grid-canvas");this._elem.css({position:"absolute",left:0,top:0});d=e.canvasManager.initCanvas(d);this._top=this._offsets.top;this._bottom=c-this._offsets.bottom;this._left=this._offsets.left;this._right=b-this._offsets.right;this._width=this._right-this._left;this._height=this._bottom-this._top;d=null;return this._elem};a.jqplot.CanvasGridRenderer.prototype.draw=function(){this._ctx=this._elem.get(0).getContext("2d");var r=this._ctx;var w=this._axes;r.save();r.clearRect(0,0,this._plotDimensions.width,this._plotDimensions.height);r.fillStyle=this.backgroundColor||this.background;r.fillRect(this._left,this._top,this._width,this._height);
r.save();r.lineJoin="miter";r.lineCap="butt";r.lineWidth=this.gridLineWidth;r.strokeStyle=this.gridLineColor;var z,y,o,p;var k=["xaxis","yaxis","x2axis","y2axis"];for(var x=4;x>0;x--){var C=k[x-1];var c=w[C];var A=c._ticks;var q=A.length;if(c.show){if(c.drawBaseline){var B={};if(c.baselineWidth!==null){B.lineWidth=c.baselineWidth}if(c.baselineColor!==null){B.strokeStyle=c.baselineColor}switch(C){case"xaxis":n(this._left,this._bottom,this._right,this._bottom,B);break;case"yaxis":n(this._left,this._bottom,this._left,this._top,B);break;case"x2axis":n(this._left,this._bottom,this._right,this._bottom,B);break;case"y2axis":n(this._right,this._bottom,this._right,this._top,B);break}}for(var u=q;u>0;u--){var l=A[u-1];if(l.show){var g=Math.round(c.u2p(l.value))+0.5;switch(C){case"xaxis":if(l.showGridline&&this.drawGridlines&&((!l.isMinorTick&&c.drawMajorGridlines)||(l.isMinorTick&&c.drawMinorGridlines))){n(g,this._top,g,this._bottom)}if(l.showMark&&l.mark&&((!l.isMinorTick&&c.drawMajorTickMarks)||(l.isMinorTick&&c.drawMinorTickMarks))){o=l.markSize;
p=l.mark;var g=Math.round(c.u2p(l.value))+0.5;switch(p){case"outside":z=this._bottom;y=this._bottom+o;break;case"inside":z=this._bottom-o;y=this._bottom;break;case"cross":z=this._bottom-o;y=this._bottom+o;break;default:z=this._bottom;y=this._bottom+o;break}if(this.shadow){this.renderer.shadowRenderer.draw(r,[[g,z],[g,y]],{lineCap:"butt",lineWidth:this.gridLineWidth,offset:this.gridLineWidth*0.75,depth:2,fill:false,closePath:false})}n(g,z,g,y)}break;case"yaxis":if(l.showGridline&&this.drawGridlines&&((!l.isMinorTick&&c.drawMajorGridlines)||(l.isMinorTick&&c.drawMinorGridlines))){n(this._right,g,this._left,g)}if(l.showMark&&l.mark&&((!l.isMinorTick&&c.drawMajorTickMarks)||(l.isMinorTick&&c.drawMinorTickMarks))){o=l.markSize;p=l.mark;var g=Math.round(c.u2p(l.value))+0.5;switch(p){case"outside":z=this._left-o;y=this._left;break;case"inside":z=this._left;y=this._left+o;break;case"cross":z=this._left-o;y=this._left+o;break;default:z=this._left-o;y=this._left;break}if(this.shadow){this.renderer.shadowRenderer.draw(r,[[z,g],[y,g]],{lineCap:"butt",lineWidth:this.gridLineWidth*1.5,offset:this.gridLineWidth*0.75,fill:false,closePath:false})
}n(z,g,y,g,{strokeStyle:c.borderColor})}break;case"x2axis":if(l.showGridline&&this.drawGridlines&&((!l.isMinorTick&&c.drawMajorGridlines)||(l.isMinorTick&&c.drawMinorGridlines))){n(g,this._bottom,g,this._top)}if(l.showMark&&l.mark&&((!l.isMinorTick&&c.drawMajorTickMarks)||(l.isMinorTick&&c.drawMinorTickMarks))){o=l.markSize;p=l.mark;var g=Math.round(c.u2p(l.value))+0.5;switch(p){case"outside":z=this._top-o;y=this._top;break;case"inside":z=this._top;y=this._top+o;break;case"cross":z=this._top-o;y=this._top+o;break;default:z=this._top-o;y=this._top;break}if(this.shadow){this.renderer.shadowRenderer.draw(r,[[g,z],[g,y]],{lineCap:"butt",lineWidth:this.gridLineWidth,offset:this.gridLineWidth*0.75,depth:2,fill:false,closePath:false})}n(g,z,g,y)}break;case"y2axis":if(l.showGridline&&this.drawGridlines&&((!l.isMinorTick&&c.drawMajorGridlines)||(l.isMinorTick&&c.drawMinorGridlines))){n(this._left,g,this._right,g)}if(l.showMark&&l.mark&&((!l.isMinorTick&&c.drawMajorTickMarks)||(l.isMinorTick&&c.drawMinorTickMarks))){o=l.markSize;
p=l.mark;var g=Math.round(c.u2p(l.value))+0.5;switch(p){case"outside":z=this._right;y=this._right+o;break;case"inside":z=this._right-o;y=this._right;break;case"cross":z=this._right-o;y=this._right+o;break;default:z=this._right;y=this._right+o;break}if(this.shadow){this.renderer.shadowRenderer.draw(r,[[z,g],[y,g]],{lineCap:"butt",lineWidth:this.gridLineWidth*1.5,offset:this.gridLineWidth*0.75,fill:false,closePath:false})}n(z,g,y,g,{strokeStyle:c.borderColor})}break;default:break}}}l=null}c=null;A=null}k=["y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis","yMidAxis"];for(var x=7;x>0;x--){var c=w[k[x-1]];var A=c._ticks;if(c.show){var d=A[c.numberTicks-1];var h=A[0];var f=c.getLeft();var v=[[f,d.getTop()+d.getHeight()/2],[f,h.getTop()+h.getHeight()/2+1]];if(this.shadow){this.renderer.shadowRenderer.draw(r,v,{lineCap:"butt",fill:false,closePath:false})}n(v[0][0],v[0][1],v[1][0],v[1][1],{lineCap:"butt",strokeStyle:c.borderColor,lineWidth:c.borderWidth});for(var u=A.length;u>0;u--){var l=A[u-1];
o=l.markSize;p=l.mark;var g=Math.round(c.u2p(l.value))+0.5;if(l.showMark&&l.mark){switch(p){case"outside":z=f;y=f+o;break;case"inside":z=f-o;y=f;break;case"cross":z=f-o;y=f+o;break;default:z=f;y=f+o;break}v=[[z,g],[y,g]];if(this.shadow){this.renderer.shadowRenderer.draw(r,v,{lineCap:"butt",lineWidth:this.gridLineWidth*1.5,offset:this.gridLineWidth*0.75,fill:false,closePath:false})}n(z,g,y,g,{strokeStyle:c.borderColor})}l=null}h=null}c=null;A=null}r.restore();function n(m,j,e,b,i){r.save();i=i||{};if(i.lineWidth==null||i.lineWidth!=0){a.extend(true,r,i);r.beginPath();r.moveTo(m,j);r.lineTo(e,b);r.stroke();r.restore()}}if(this.shadow){var v=[[this._left,this._bottom],[this._right,this._bottom],[this._right,this._top]];this.renderer.shadowRenderer.draw(r,v)}if(this.borderWidth!=0&&this.drawBorder){n(this._left,this._top,this._right,this._top,{lineCap:"round",strokeStyle:w.x2axis.borderColor,lineWidth:w.x2axis.borderWidth});n(this._right,this._top,this._right,this._bottom,{lineCap:"round",strokeStyle:w.y2axis.borderColor,lineWidth:w.y2axis.borderWidth});
n(this._right,this._bottom,this._left,this._bottom,{lineCap:"round",strokeStyle:w.xaxis.borderColor,lineWidth:w.xaxis.borderWidth});n(this._left,this._bottom,this._left,this._top,{lineCap:"round",strokeStyle:w.yaxis.borderColor,lineWidth:w.yaxis.borderWidth})}r.restore();r=null;w=null}})(jQuery);(function(a){a.jqplot.ShadowRenderer=function(b){this.angle=45;this.offset=1;this.alpha=0.07;this.lineWidth=1.5;this.lineJoin="miter";this.lineCap="round";this.closePath=false;this.fill=false;this.depth=3;this.strokeStyle="rgba(0,0,0,0.1)";this.isarc=false;a.extend(true,this,b)};a.jqplot.ShadowRenderer.prototype.init=function(b){a.extend(true,this,b)};a.jqplot.ShadowRenderer.prototype.draw=function(q,o,s){q.save();var b=(s!=null)?s:{};var p=(b.fill!=null)?b.fill:this.fill;var l=(b.fillRect!=null)?b.fillRect:this.fillRect;var k=(b.closePath!=null)?b.closePath:this.closePath;var f=(b.offset!=null)?b.offset:this.offset;var d=(b.alpha!=null)?b.alpha:this.alpha;var h=(b.depth!=null)?b.depth:this.depth;
var r=(b.isarc!=null)?b.isarc:this.isarc;var m=(b.linePattern!=null)?b.linePattern:this.linePattern;q.lineWidth=(b.lineWidth!=null)?b.lineWidth:this.lineWidth;q.lineJoin=(b.lineJoin!=null)?b.lineJoin:this.lineJoin;q.lineCap=(b.lineCap!=null)?b.lineCap:this.lineCap;q.strokeStyle=b.strokeStyle||this.strokeStyle||"rgba(0,0,0,"+d+")";q.fillStyle=b.fillStyle||this.fillStyle||"rgba(0,0,0,"+d+")";for(var e=0;e<h;e++){var n=a.jqplot.LinePattern(q,m);q.translate(Math.cos(this.angle*Math.PI/180)*f,Math.sin(this.angle*Math.PI/180)*f);n.beginPath();if(r){q.arc(o[0],o[1],o[2],o[3],o[4],true)}else{if(l){if(l){q.fillRect(o[0],o[1],o[2],o[3])}}else{if(o&&o.length){var c=true;for(var g=0;g<o.length;g++){if(o[g][0]!=null&&o[g][1]!=null){if(c){n.moveTo(o[g][0],o[g][1]);c=false}else{n.lineTo(o[g][0],o[g][1])}}else{c=true}}}}}if(k){n.closePath()}if(p){q.fill()}else{q.stroke()}}q.restore()}})(jQuery);(function(a){a.jqplot.ShapeRenderer=function(b){this.lineWidth=1.5;this.linePattern="solid";this.lineJoin="miter";
this.lineCap="round";this.closePath=false;this.fill=false;this.isarc=false;this.fillRect=false;this.strokeRect=false;this.clearRect=false;this.strokeStyle="#999999";this.fillStyle="#999999";a.extend(true,this,b)};a.jqplot.ShapeRenderer.prototype.init=function(b){a.extend(true,this,b)};a.jqplot.ShapeRenderer.prototype.draw=function(n,l,p){n.save();var b=(p!=null)?p:{};var m=(b.fill!=null)?b.fill:this.fill;var g=(b.closePath!=null)?b.closePath:this.closePath;var h=(b.fillRect!=null)?b.fillRect:this.fillRect;var e=(b.strokeRect!=null)?b.strokeRect:this.strokeRect;var c=(b.clearRect!=null)?b.clearRect:this.clearRect;var o=(b.isarc!=null)?b.isarc:this.isarc;var j=(b.linePattern!=null)?b.linePattern:this.linePattern;var k=a.jqplot.LinePattern(n,j);n.lineWidth=b.lineWidth||this.lineWidth;n.lineJoin=b.lineJoin||this.lineJoin;n.lineCap=b.lineCap||this.lineCap;n.strokeStyle=(b.strokeStyle||b.color)||this.strokeStyle;n.fillStyle=b.fillStyle||this.fillStyle;n.beginPath();if(o){n.arc(l[0],l[1],l[2],l[3],l[4],true);
if(g){n.closePath()}if(m){n.fill()}else{n.stroke()}n.restore();return}else{if(c){n.clearRect(l[0],l[1],l[2],l[3]);n.restore();return}else{if(h||e){if(h){n.fillRect(l[0],l[1],l[2],l[3])}if(e){n.strokeRect(l[0],l[1],l[2],l[3]);n.restore();return}}else{if(l&&l.length){var d=true;for(var f=0;f<l.length;f++){if(l[f][0]!=null&&l[f][1]!=null){if(d){k.moveTo(l[f][0],l[f][1]);d=false}else{k.lineTo(l[f][0],l[f][1])}}else{d=true}}if(g){k.closePath()}if(m){n.fill()}else{n.stroke()}}}}}n.restore()}})(jQuery);(function(a){a.jqplot.sprintf=function(){function h(n,i,k,m){var l=(n.length>=i)?"":Array(1+i-n.length>>>0).join(k);return m?n+l:l+n}function e(m){var l=new String(m);for(var k=10;k>0;k--){if(l==(l=l.replace(/^(\d+)(\d{3})/,"$1"+a.jqplot.sprintf.thousandsSeparator+"$2"))){break}}return l}function d(o,n,q,l,m,k){var p=l-o.length;if(p>0){var i=" ";if(k){i="&nbsp;"}if(q||!m){o=h(o,l,i,q)}else{o=o.slice(0,n.length)+h("",p,"0",true)+o.slice(n.length)}}return o}function j(r,k,p,l,i,o,q,n){var m=r>>>0;
p=p&&m&&{"2":"0b","8":"0","16":"0x"}[k]||"";r=p+h(m.toString(k),o||0,"0",false);return d(r,p,l,i,q,n)}function b(n,o,l,i,m,k){if(i!=null){n=n.slice(0,i)}return d(n,"",o,l,m,k)}var c=arguments,f=0,g=c[f++];return g.replace(a.jqplot.sprintf.regex,function(F,q,r,u,H,C,o){if(F=="%%"){return"%"}var w=false,s="",t=false,E=false,p=false,n=false;for(var B=0;r&&B<r.length;B++){switch(r.charAt(B)){case" ":s=" ";break;case"+":s="+";break;case"-":w=true;break;case"0":t=true;break;case"#":E=true;break;case"&":p=true;break;case"'":n=true;break}}if(!u){u=0}else{if(u=="*"){u=+c[f++]}else{if(u.charAt(0)=="*"){u=+c[u.slice(1,-1)]}else{u=+u}}}if(u<0){u=-u;w=true}if(!isFinite(u)){throw new Error("$.jqplot.sprintf: (minimum-)width must be finite")}if(!C){C="fFeE".indexOf(o)>-1?6:(o=="d")?0:void (0)}else{if(C=="*"){C=+c[f++]}else{if(C.charAt(0)=="*"){C=+c[C.slice(1,-1)]}else{C=+C}}}var y=q?c[q.slice(0,-1)]:c[f++];switch(o){case"s":if(y==null){return""}return b(String(y),w,u,C,t,p);case"c":return b(String.fromCharCode(+y),w,u,C,t,p);
case"b":return j(y,2,E,w,u,C,t,p);case"o":return j(y,8,E,w,u,C,t,p);case"x":return j(y,16,E,w,u,C,t,p);case"X":return j(y,16,E,w,u,C,t,p).toUpperCase();case"u":return j(y,10,E,w,u,C,t,p);case"i":var l=parseInt(+y,10);if(isNaN(l)){return""}var A=l<0?"-":s;var D=n?e(String(Math.abs(l))):String(Math.abs(l));y=A+h(D,C,"0",false);return d(y,A,w,u,t,p);case"d":var l=Math.round(+y);if(isNaN(l)){return""}var A=l<0?"-":s;var D=n?e(String(Math.abs(l))):String(Math.abs(l));y=A+h(D,C,"0",false);return d(y,A,w,u,t,p);case"e":case"E":case"f":case"F":case"g":case"G":var l=+y;if(isNaN(l)){return""}var A=l<0?"-":s;var m=["toExponential","toFixed","toPrecision"]["efg".indexOf(o.toLowerCase())];var G=["toString","toUpperCase"]["eEfFgG".indexOf(o)%2];var D=Math.abs(l)[m](C);var x=D.toString().split(".");x[0]=n?e(x[0]):x[0];D=x.join(a.jqplot.sprintf.decimalMark);y=A+D;var v=d(y,A,w,u,t,p)[G]();return v;case"p":case"P":var l=+y;if(isNaN(l)){return""}var A=l<0?"-":s;var x=String(Number(Math.abs(l)).toExponential()).split(/e|E/);
var k=(x[0].indexOf(".")!=-1)?x[0].length-1:String(l).length;var z=(x[1]<0)?-x[1]-1:0;if(Math.abs(l)<1){if(k+z<=C){y=A+Math.abs(l).toPrecision(k)}else{if(k<=C-1){y=A+Math.abs(l).toExponential(k-1)}else{y=A+Math.abs(l).toExponential(C-1)}}}else{var i=(k<=C)?k:C;y=A+Math.abs(l).toPrecision(i)}var G=["toString","toUpperCase"]["pP".indexOf(o)%2];return d(y,A,w,u,t,p)[G]();case"n":return"";default:return F}})};a.jqplot.sprintf.thousandsSeparator=",";a.jqplot.sprintf.decimalMark=".";a.jqplot.sprintf.regex=/%%|%(\d+\$)?([-+#0&\' ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([nAscboxXuidfegpEGP])/g;a.jqplot.getSignificantFigures=function(f){var h=String(Number(Math.abs(f)).toExponential()).split(/e|E/);var g=(h[0].indexOf(".")!=-1)?h[0].length-1:h[0].length;var c=(h[1]<0)?-h[1]-1:0;var b=parseInt(h[1],10);var d=(b+1>0)?b+1:0;var e=(g<=d)?0:g-b-1;return{significantDigits:g,digitsLeft:d,digitsRight:e,zeros:c,exponent:b}};a.jqplot.getPrecision=function(b){return a.jqplot.getSignificantFigures(b).digitsRight
}})(jQuery);(function(g){g.jqplot.ThemeEngine=function(){this.themes={};this.activeTheme=null};g.jqplot.ThemeEngine.prototype.init=function(){var r=new g.jqplot.Theme({_name:"Default"});var v,p,u;for(v in r.target){if(v=="textColor"){r.target[v]=this.target.css("color")}else{r.target[v]=this.target.css(v)}}if(this.title.show&&this.title._elem){for(v in r.title){if(v=="textColor"){r.title[v]=this.title._elem.css("color")}else{r.title[v]=this.title._elem.css(v)}}}for(v in r.grid){r.grid[v]=this.grid[v]}if(r.grid.backgroundColor==null&&this.grid.background!=null){r.grid.backgroundColor=this.grid.background}if(this.legend.show&&this.legend._elem){for(v in r.legend){if(v=="textColor"){r.legend[v]=this.legend._elem.css("color")}else{r.legend[v]=this.legend._elem.css(v)}}}var q;for(p=0;p<this.series.length;p++){q=this.series[p];if(q.renderer.constructor==g.jqplot.LineRenderer){r.series.push(new h())}else{if(q.renderer.constructor==g.jqplot.BarRenderer){r.series.push(new a())}else{if(q.renderer.constructor==g.jqplot.PieRenderer){r.series.push(new b())
}else{if(q.renderer.constructor==g.jqplot.DonutRenderer){r.series.push(new c())}else{if(q.renderer.constructor==g.jqplot.FunnelRenderer){r.series.push(new j())}else{if(q.renderer.constructor==g.jqplot.MeterGaugeRenderer){r.series.push(new m())}else{r.series.push({})}}}}}}for(v in r.series[p]){r.series[p][v]=q[v]}}var o,t;for(v in this.axes){t=this.axes[v];o=r.axes[v]=new d();o.borderColor=t.borderColor;o.borderWidth=t.borderWidth;if(t._ticks&&t._ticks[0]){for(u in o.ticks){if(t._ticks[0].hasOwnProperty(u)){o.ticks[u]=t._ticks[0][u]}else{if(t._ticks[0]._elem){o.ticks[u]=t._ticks[0]._elem.css(u)}}}}if(t._label&&t._label.show){for(u in o.label){if(t._label[u]){o.label[u]=t._label[u]}else{if(t._label._elem){if(u=="textColor"){o.label[u]=t._label._elem.css("color")}else{o.label[u]=t._label._elem.css(u)}}}}}}this.themeEngine._add(r);this.themeEngine.activeTheme=this.themeEngine.themes[r._name]};g.jqplot.ThemeEngine.prototype.get=function(o){if(!o){return this.activeTheme}else{return this.themes[o]
}};function i(p,o){return p-o}g.jqplot.ThemeEngine.prototype.getThemeNames=function(){var o=[];for(var p in this.themes){o.push(p)}return o.sort(i)};g.jqplot.ThemeEngine.prototype.getThemes=function(){var p=[];var o=[];for(var r in this.themes){p.push(r)}p.sort(i);for(var q=0;q<p.length;q++){o.push(this.themes[p[q]])}return o};g.jqplot.ThemeEngine.prototype.activate=function(B,G){var o=false;if(!G&&this.activeTheme&&this.activeTheme._name){G=this.activeTheme._name}if(!this.themes.hasOwnProperty(G)){throw new Error("No theme of that name")}else{var t=this.themes[G];this.activeTheme=t;var F,z=false,y=false;var p=["xaxis","x2axis","yaxis","y2axis"];for(C=0;C<p.length;C++){var u=p[C];if(t.axesStyles.borderColor!=null){B.axes[u].borderColor=t.axesStyles.borderColor}if(t.axesStyles.borderWidth!=null){B.axes[u].borderWidth=t.axesStyles.borderWidth}}for(var E in B.axes){var r=B.axes[E];if(r.show){var x=t.axes[E]||{};var v=t.axesStyles;var s=g.jqplot.extend(true,{},x,v);F=(t.axesStyles.borderColor!=null)?t.axesStyles.borderColor:s.borderColor;
if(s.borderColor!=null){r.borderColor=s.borderColor;o=true}F=(t.axesStyles.borderWidth!=null)?t.axesStyles.borderWidth:s.borderWidth;if(s.borderWidth!=null){r.borderWidth=s.borderWidth;o=true}if(r._ticks&&r._ticks[0]){for(var q in s.ticks){F=s.ticks[q];if(F!=null){r.tickOptions[q]=F;r._ticks=[];o=true}}}if(r._label&&r._label.show){for(var q in s.label){F=s.label[q];if(F!=null){r.labelOptions[q]=F;o=true}}}}}for(var A in t.grid){if(t.grid[A]!=null){B.grid[A]=t.grid[A]}}if(!o){B.grid.draw()}if(B.legend.show){for(A in t.legend){if(t.legend[A]!=null){B.legend[A]=t.legend[A]}}}if(B.title.show){for(A in t.title){if(t.title[A]!=null){B.title[A]=t.title[A]}}}var C;for(C=0;C<t.series.length;C++){var w={};var D=false;for(A in t.series[C]){F=(t.seriesStyles[A]!=null)?t.seriesStyles[A]:t.series[C][A];if(F!=null){w[A]=F;if(A=="color"){B.series[C].renderer.shapeRenderer.fillStyle=F;B.series[C].renderer.shapeRenderer.strokeStyle=F;B.series[C][A]=F}else{if((A=="lineWidth")||(A=="linePattern")){B.series[C].renderer.shapeRenderer[A]=F;
B.series[C][A]=F}else{if(A=="markerOptions"){l(B.series[C].markerOptions,F);l(B.series[C].markerRenderer,F)}else{B.series[C][A]=F}}}o=true}}}if(o){B.target.empty();B.draw()}for(A in t.target){if(t.target[A]!=null){B.target.css(A,t.target[A])}}}};g.jqplot.ThemeEngine.prototype._add=function(p,o){if(o){p._name=o}if(!p._name){p._name=Date.parse(new Date())}if(!this.themes.hasOwnProperty(p._name)){this.themes[p._name]=p}else{throw new Error("jqplot.ThemeEngine Error: Theme already in use")}};g.jqplot.ThemeEngine.prototype.remove=function(o){if(o=="Default"){return false}return delete this.themes[o]};g.jqplot.ThemeEngine.prototype.newTheme=function(o,q){if(typeof(o)=="object"){q=q||o;o=null}if(q&&q._name){o=q._name}else{o=o||Date.parse(new Date())}var p=this.copy(this.themes.Default._name,o);g.jqplot.extend(p,q);return p};function k(q){if(q==null||typeof(q)!="object"){return q}var o=new q.constructor();for(var p in q){o[p]=k(q[p])}return o}g.jqplot.clone=k;function l(q,p){if(p==null||typeof(p)!="object"){return
}for(var o in p){if(o=="highlightColors"){q[o]=k(p[o])}if(p[o]!=null&&typeof(p[o])=="object"){if(!q.hasOwnProperty(o)){q[o]={}}l(q[o],p[o])}else{q[o]=p[o]}}}g.jqplot.merge=l;g.jqplot.extend=function(){var t=arguments[0]||{},r=1,s=arguments.length,o=false,q;if(typeof t==="boolean"){o=t;t=arguments[1]||{};r=2}if(typeof t!=="object"&&!toString.call(t)==="[object Function]"){t={}}for(;r<s;r++){if((q=arguments[r])!=null){for(var p in q){var u=t[p],v=q[p];if(t===v){continue}if(o&&v&&typeof v==="object"&&!v.nodeType){t[p]=g.jqplot.extend(o,u||(v.length!=null?[]:{}),v)}else{if(v!==undefined){t[p]=v}}}}}return t};g.jqplot.ThemeEngine.prototype.rename=function(p,o){if(p=="Default"||o=="Default"){throw new Error("jqplot.ThemeEngine Error: Cannot rename from/to Default")}if(this.themes.hasOwnProperty(o)){throw new Error("jqplot.ThemeEngine Error: New name already in use.")}else{if(this.themes.hasOwnProperty(p)){var q=this.copy(p,o);this.remove(p);return q}}throw new Error("jqplot.ThemeEngine Error: Old name or new name invalid")
};g.jqplot.ThemeEngine.prototype.copy=function(o,q,t){if(q=="Default"){throw new Error("jqplot.ThemeEngine Error: Cannot copy over Default theme")}if(!this.themes.hasOwnProperty(o)){var p="jqplot.ThemeEngine Error: Source name invalid";throw new Error(p)}if(this.themes.hasOwnProperty(q)){var p="jqplot.ThemeEngine Error: Target name invalid";throw new Error(p)}else{var r=k(this.themes[o]);r._name=q;g.jqplot.extend(true,r,t);this._add(r);return r}};g.jqplot.Theme=function(o,p){if(typeof(o)=="object"){p=p||o;o=null}o=o||Date.parse(new Date());this._name=o;this.target={backgroundColor:null};this.legend={textColor:null,fontFamily:null,fontSize:null,border:null,background:null};this.title={textColor:null,fontFamily:null,fontSize:null,textAlign:null};this.seriesStyles={};this.series=[];this.grid={drawGridlines:null,gridLineColor:null,gridLineWidth:null,backgroundColor:null,borderColor:null,borderWidth:null,shadow:null};this.axesStyles={label:{},ticks:{}};this.axes={};if(typeof(p)=="string"){this._name=p
}else{if(typeof(p)=="object"){g.jqplot.extend(true,this,p)}}};var d=function(){this.borderColor=null;this.borderWidth=null;this.ticks=new f();this.label=new e()};var f=function(){this.show=null;this.showGridline=null;this.showLabel=null;this.showMark=null;this.size=null;this.textColor=null;this.whiteSpace=null;this.fontSize=null;this.fontFamily=null};var e=function(){this.textColor=null;this.whiteSpace=null;this.fontSize=null;this.fontFamily=null;this.fontWeight=null};var h=function(){this.color=null;this.lineWidth=null;this.linePattern=null;this.shadow=null;this.fillColor=null;this.showMarker=null;this.markerOptions=new n()};var n=function(){this.show=null;this.style=null;this.lineWidth=null;this.size=null;this.color=null;this.shadow=null};var a=function(){this.color=null;this.seriesColors=null;this.lineWidth=null;this.shadow=null;this.barPadding=null;this.barMargin=null;this.barWidth=null;this.highlightColors=null};var b=function(){this.seriesColors=null;this.padding=null;this.sliceMargin=null;
this.fill=null;this.shadow=null;this.startAngle=null;this.lineWidth=null;this.highlightColors=null};var c=function(){this.seriesColors=null;this.padding=null;this.sliceMargin=null;this.fill=null;this.shadow=null;this.startAngle=null;this.lineWidth=null;this.innerDiameter=null;this.thickness=null;this.ringMargin=null;this.highlightColors=null};var j=function(){this.color=null;this.lineWidth=null;this.shadow=null;this.padding=null;this.sectionMargin=null;this.seriesColors=null;this.highlightColors=null};var m=function(){this.padding=null;this.backgroundColor=null;this.ringColor=null;this.tickColor=null;this.ringWidth=null;this.intervalColors=null;this.intervalInnerRadius=null;this.intervalOuterRadius=null;this.hubRadius=null;this.needleThickness=null;this.needlePad=null}})(jQuery);(function(e){e.jqplot.PieRenderer=function(){e.jqplot.LineRenderer.call(this)};e.jqplot.PieRenderer.prototype=new e.jqplot.LineRenderer();e.jqplot.PieRenderer.prototype.constructor=e.jqplot.PieRenderer;e.jqplot.PieRenderer.prototype.init=function(q,u){this.diameter=null;
this.padding=20;this.sliceMargin=0;this.fill=true;this.shadowOffset=2;this.shadowAlpha=0.07;this.shadowDepth=5;this.highlightMouseOver=true;this.highlightMouseDown=false;this.highlightColors=[];this.dataLabels="percent";this.showDataLabels=false;this.dataLabelFormatString=null;this.dataLabelThreshold=3;this.dataLabelPositionFactor=0.52;this.dataLabelNudge=2;this.dataLabelCenterOn=true;this.startAngle=0;this.tickRenderer=e.jqplot.PieTickRenderer;this._drawData=true;this._type="pie";if(q.highlightMouseDown&&q.highlightMouseOver==null){q.highlightMouseOver=false}e.extend(true,this,q);if(this.sliceMargin<0){this.sliceMargin=0}this._diameter=null;this._radius=null;this._sliceAngles=[];this._highlightedPoint=null;if(this.highlightColors.length==0){for(var s=0;s<this.seriesColors.length;s++){var r=e.jqplot.getColorComponents(this.seriesColors[s]);var o=[r[0],r[1],r[2]];var t=o[0]+o[1]+o[2];for(var p=0;p<3;p++){o[p]=(t>570)?o[p]*0.8:o[p]+0.3*(255-o[p]);o[p]=parseInt(o[p],10)}this.highlightColors.push("rgb("+o[0]+","+o[1]+","+o[2]+")")
}}this.highlightColorGenerator=new e.jqplot.ColorGenerator(this.highlightColors);u.postParseOptionsHooks.addOnce(m);u.postInitHooks.addOnce(g);u.eventListenerHooks.addOnce("jqplotMouseMove",b);u.eventListenerHooks.addOnce("jqplotMouseDown",a);u.eventListenerHooks.addOnce("jqplotMouseUp",l);u.eventListenerHooks.addOnce("jqplotClick",f);u.eventListenerHooks.addOnce("jqplotRightClick",n);u.postDrawHooks.addOnce(i)};e.jqplot.PieRenderer.prototype.setGridData=function(t){var p=[];var u=[];var o=this.startAngle/180*Math.PI;var s=0;this._drawData=false;for(var r=0;r<this.data.length;r++){if(this.data[r][1]!=0){this._drawData=true}p.push(this.data[r][1]);u.push([this.data[r][0]]);if(r>0){p[r]+=p[r-1]}s+=this.data[r][1]}var q=Math.PI*2/p[p.length-1];for(var r=0;r<p.length;r++){u[r][1]=p[r]*q;u[r][2]=this.data[r][1]/s}this.gridData=u};e.jqplot.PieRenderer.prototype.makeGridData=function(t,u){var p=[];var v=[];var s=0;var o=this.startAngle/180*Math.PI;this._drawData=false;for(var r=0;r<t.length;r++){if(this.data[r][1]!=0){this._drawData=true
}p.push(t[r][1]);v.push([t[r][0]]);if(r>0){p[r]+=p[r-1]}s+=t[r][1]}var q=Math.PI*2/p[p.length-1];for(var r=0;r<p.length;r++){v[r][1]=p[r]*q;v[r][2]=t[r][1]/s}return v};function h(o){return Math.sin((o-(o-Math.PI)/8/Math.PI)/2)}function j(u,t,o,v,r){var w=0;var q=t-u;var s=Math.abs(q);var p=o;if(v==false){p+=r}if(p>0&&s>0.01&&s<6.282){w=parseFloat(p)/2/h(q)}return w}e.jqplot.PieRenderer.prototype.drawSlice=function(B,z,y,u,w){if(this._drawData){var p=this._radius;var A=this.fill;var x=this.lineWidth;var s=this.sliceMargin;if(this.fill==false){s+=this.lineWidth}B.save();B.translate(this._center[0],this._center[1]);var D=j(z,y,this.sliceMargin,this.fill,this.lineWidth);var o=D*Math.cos((z+y)/2);var C=D*Math.sin((z+y)/2);if((y-z)<=Math.PI){p-=D}else{p+=D}B.translate(o,C);if(w){for(var v=0,t=this.shadowDepth;v<t;v++){B.save();B.translate(this.shadowOffset*Math.cos(this.shadowAngle/180*Math.PI),this.shadowOffset*Math.sin(this.shadowAngle/180*Math.PI));q(p)}for(var v=0,t=this.shadowDepth;v<t;v++){B.restore()
}}else{q(p)}B.restore()}function q(r){if(y>6.282+this.startAngle){y=6.282+this.startAngle;if(z>y){z=6.281+this.startAngle}}if(z>=y){return}B.beginPath();B.fillStyle=u;B.strokeStyle=u;B.lineWidth=x;B.arc(0,0,r,z,y,false);B.lineTo(0,0);B.closePath();if(A){B.fill()}else{B.stroke()}}};e.jqplot.PieRenderer.prototype.draw=function(B,z,E,o){var W;var H=(E!=undefined)?E:{};var t=0;var s=0;var N=1;var L=new e.jqplot.ColorGenerator(this.seriesColors);if(E.legendInfo&&E.legendInfo.placement=="insideGrid"){var J=E.legendInfo;switch(J.location){case"nw":t=J.width+J.xoffset;break;case"w":t=J.width+J.xoffset;break;case"sw":t=J.width+J.xoffset;break;case"ne":t=J.width+J.xoffset;N=-1;break;case"e":t=J.width+J.xoffset;N=-1;break;case"se":t=J.width+J.xoffset;N=-1;break;case"n":s=J.height+J.yoffset;break;case"s":s=J.height+J.yoffset;N=-1;break;default:break}}var K=(H.shadow!=undefined)?H.shadow:this.shadow;var A=(H.fill!=undefined)?H.fill:this.fill;var C=parseInt(B.canvas.style.width);var I=parseInt(B.canvas.style.height);
var Q=C-t-2*this.padding;var X=I-s-2*this.padding;var M=Math.min(Q,X);var Y=M;this._sliceAngles=[];var v=this.sliceMargin;if(this.fill==false){v+=this.lineWidth}var q;var G=0;var R,aa,Z,ab;var D=this.startAngle/180*Math.PI;for(var W=0,V=z.length;W<V;W++){aa=(W==0)?D:z[W-1][1]+D;Z=z[W][1]+D;this._sliceAngles.push([aa,Z]);q=j(aa,Z,this.sliceMargin,this.fill,this.lineWidth);if(Math.abs(Z-aa)>Math.PI){G=Math.max(q,G)}}if(this.diameter!=null&&this.diameter>0){this._diameter=this.diameter-2*G}else{this._diameter=Y-2*G}if(this._diameter<6){e.jqplot.log("Diameter of pie too small, not rendering.");return}var S=this._radius=this._diameter/2;this._center=[(C-N*t)/2+N*t+G*Math.cos(D),(I-N*s)/2+N*s+G*Math.sin(D)];if(this.shadow){for(var W=0,V=z.length;W<V;W++){ab="rgba(0,0,0,"+this.shadowAlpha+")";this.renderer.drawSlice.call(this,B,this._sliceAngles[W][0],this._sliceAngles[W][1],ab,true)}}for(var W=0;W<z.length;W++){this.renderer.drawSlice.call(this,B,this._sliceAngles[W][0],this._sliceAngles[W][1],L.next(),false);
if(this.showDataLabels&&z[W][2]*100>=this.dataLabelThreshold){var F,U=(this._sliceAngles[W][0]+this._sliceAngles[W][1])/2,T;if(this.dataLabels=="label"){F=this.dataLabelFormatString||"%s";T=e.jqplot.sprintf(F,z[W][0])}else{if(this.dataLabels=="value"){F=this.dataLabelFormatString||"%d";T=e.jqplot.sprintf(F,this.data[W][1])}else{if(this.dataLabels=="percent"){F=this.dataLabelFormatString||"%d%%";T=e.jqplot.sprintf(F,z[W][2]*100)}else{if(this.dataLabels.constructor==Array){F=this.dataLabelFormatString||"%s";T=e.jqplot.sprintf(F,this.dataLabels[W])}}}}var p=(this._radius)*this.dataLabelPositionFactor+this.sliceMargin+this.dataLabelNudge;var P=this._center[0]+Math.cos(U)*p+this.canvas._offsets.left;var O=this._center[1]+Math.sin(U)*p+this.canvas._offsets.top;var u=e('<div class="jqplot-pie-series jqplot-data-label" style="position:absolute;">'+T+"</div>").insertBefore(o.eventCanvas._elem);if(this.dataLabelCenterOn){P-=u.width()/2;O-=u.height()/2}else{P-=u.width()*Math.sin(U/2);O-=u.height()/2
}P=Math.round(P);O=Math.round(O);u.css({left:P,top:O})}}};e.jqplot.PieAxisRenderer=function(){e.jqplot.LinearAxisRenderer.call(this)};e.jqplot.PieAxisRenderer.prototype=new e.jqplot.LinearAxisRenderer();e.jqplot.PieAxisRenderer.prototype.constructor=e.jqplot.PieAxisRenderer;e.jqplot.PieAxisRenderer.prototype.init=function(o){this.tickRenderer=e.jqplot.PieTickRenderer;e.extend(true,this,o);this._dataBounds={min:0,max:100};this.min=0;this.max=100;this.showTicks=false;this.ticks=[];this.showMark=false;this.show=false};e.jqplot.PieLegendRenderer=function(){e.jqplot.TableLegendRenderer.call(this)};e.jqplot.PieLegendRenderer.prototype=new e.jqplot.TableLegendRenderer();e.jqplot.PieLegendRenderer.prototype.constructor=e.jqplot.PieLegendRenderer;e.jqplot.PieLegendRenderer.prototype.init=function(o){this.numberRows=null;this.numberColumns=null;e.extend(true,this,o)};e.jqplot.PieLegendRenderer.prototype.draw=function(){var r=this;if(this.show){var B=this._series;this._elem=e(document.createElement("table"));
this._elem.addClass("jqplot-table-legend");var E={position:"absolute"};if(this.background){E.background=this.background}if(this.border){E.border=this.border}if(this.fontSize){E.fontSize=this.fontSize}if(this.fontFamily){E.fontFamily=this.fontFamily}if(this.textColor){E.textColor=this.textColor}if(this.marginTop!=null){E.marginTop=this.marginTop}if(this.marginBottom!=null){E.marginBottom=this.marginBottom}if(this.marginLeft!=null){E.marginLeft=this.marginLeft}if(this.marginRight!=null){E.marginRight=this.marginRight}this._elem.css(E);var I=false,A=false,o,y;var C=B[0];var p=new e.jqplot.ColorGenerator(C.seriesColors);if(C.show){var J=C.data;if(this.numberRows){o=this.numberRows;if(!this.numberColumns){y=Math.ceil(J.length/o)}else{y=this.numberColumns}}else{if(this.numberColumns){y=this.numberColumns;o=Math.ceil(J.length/this.numberColumns)}else{o=J.length;y=1}}var H,G;var q,w,v;var x,z,F;var D=0;var u,t;for(H=0;H<o;H++){q=e(document.createElement("tr"));q.addClass("jqplot-table-legend");
if(A){q.prependTo(this._elem)}else{q.appendTo(this._elem)}for(G=0;G<y;G++){if(D<J.length){x=this.labels[D]||J[D][0].toString();F=p.next();if(!A){if(H>0){I=true}else{I=false}}else{if(H==o-1){I=false}else{I=true}}z=(I)?this.rowSpacing:"0";w=e(document.createElement("td"));w.addClass("jqplot-table-legend jqplot-table-legend-swatch");w.css({textAlign:"center",paddingTop:z});u=e(document.createElement("div"));u.addClass("jqplot-table-legend-swatch-outline");t=e(document.createElement("div"));t.addClass("jqplot-table-legend-swatch");t.css({backgroundColor:F,borderColor:F});w.append(u.append(t));v=e(document.createElement("td"));v.addClass("jqplot-table-legend jqplot-table-legend-label");v.css("paddingTop",z);if(this.escapeHtml){v.text(x)}else{v.html(x)}if(A){v.prependTo(q);w.prependTo(q)}else{w.appendTo(q);v.appendTo(q)}I=true}D++}}}}return this._elem};e.jqplot.PieRenderer.prototype.handleMove=function(q,p,t,s,r){if(s){var o=[s.seriesIndex,s.pointIndex,s.data];r.target.trigger("jqplotDataMouseOver",o);
if(r.series[o[0]].highlightMouseOver&&!(o[0]==r.plugins.pieRenderer.highlightedSeriesIndex&&o[1]==r.series[o[0]]._highlightedPoint)){r.target.trigger("jqplotDataHighlight",o);d(r,o[0],o[1])}}else{if(s==null){k(r)}}};function c(s,r,p){p=p||{};p.axesDefaults=p.axesDefaults||{};p.legend=p.legend||{};p.seriesDefaults=p.seriesDefaults||{};var o=false;if(p.seriesDefaults.renderer==e.jqplot.PieRenderer){o=true}else{if(p.series){for(var q=0;q<p.series.length;q++){if(p.series[q].renderer==e.jqplot.PieRenderer){o=true}}}}if(o){p.axesDefaults.renderer=e.jqplot.PieAxisRenderer;p.legend.renderer=e.jqplot.PieLegendRenderer;p.legend.preDraw=true;p.seriesDefaults.pointLabels={show:false}}}function g(r,q,o){for(var p=0;p<this.series.length;p++){if(this.series[p].renderer.constructor==e.jqplot.PieRenderer){if(this.series[p].highlightMouseOver){this.series[p].highlightMouseDown=false}}}}function m(o){for(var p=0;p<this.series.length;p++){this.series[p].seriesColors=this.seriesColors;this.series[p].colorGenerator=e.jqplot.colorGenerator
}}function d(t,r,q){var p=t.series[r];var o=t.plugins.pieRenderer.highlightCanvas;o._ctx.clearRect(0,0,o._ctx.canvas.width,o._ctx.canvas.height);p._highlightedPoint=q;t.plugins.pieRenderer.highlightedSeriesIndex=r;p.renderer.drawSlice.call(p,o._ctx,p._sliceAngles[q][0],p._sliceAngles[q][1],p.highlightColorGenerator.get(q),false)}function k(q){var o=q.plugins.pieRenderer.highlightCanvas;o._ctx.clearRect(0,0,o._ctx.canvas.width,o._ctx.canvas.height);for(var p=0;p<q.series.length;p++){q.series[p]._highlightedPoint=null}q.plugins.pieRenderer.highlightedSeriesIndex=null;q.target.trigger("jqplotDataUnhighlight")}function b(s,r,v,u,t){if(u){var q=[u.seriesIndex,u.pointIndex,u.data];var p=jQuery.Event("jqplotDataMouseOver");p.pageX=s.pageX;p.pageY=s.pageY;t.target.trigger(p,q);if(t.series[q[0]].highlightMouseOver&&!(q[0]==t.plugins.pieRenderer.highlightedSeriesIndex&&q[1]==t.series[q[0]]._highlightedPoint)){var o=jQuery.Event("jqplotDataHighlight");o.which=s.which;o.pageX=s.pageX;o.pageY=s.pageY;
t.target.trigger(o,q);d(t,q[0],q[1])}}else{if(u==null){k(t)}}}function a(r,q,u,t,s){if(t){var p=[t.seriesIndex,t.pointIndex,t.data];if(s.series[p[0]].highlightMouseDown&&!(p[0]==s.plugins.pieRenderer.highlightedSeriesIndex&&p[1]==s.series[p[0]]._highlightedPoint)){var o=jQuery.Event("jqplotDataHighlight");o.which=r.which;o.pageX=r.pageX;o.pageY=r.pageY;s.target.trigger(o,p);d(s,p[0],p[1])}}else{if(t==null){k(s)}}}function l(q,p,t,s,r){var o=r.plugins.pieRenderer.highlightedSeriesIndex;if(o!=null&&r.series[o].highlightMouseDown){k(r)}}function f(r,q,u,t,s){if(t){var p=[t.seriesIndex,t.pointIndex,t.data];var o=jQuery.Event("jqplotDataClick");o.which=r.which;o.pageX=r.pageX;o.pageY=r.pageY;s.target.trigger(o,p)}}function n(s,r,v,u,t){if(u){var q=[u.seriesIndex,u.pointIndex,u.data];var o=t.plugins.pieRenderer.highlightedSeriesIndex;if(o!=null&&t.series[o].highlightMouseDown){k(t)}var p=jQuery.Event("jqplotDataRightClick");p.which=s.which;p.pageX=s.pageX;p.pageY=s.pageY;t.target.trigger(p,q)
}}function i(){if(this.plugins.pieRenderer&&this.plugins.pieRenderer.highlightCanvas){this.plugins.pieRenderer.highlightCanvas.resetCanvas();this.plugins.pieRenderer.highlightCanvas=null}this.plugins.pieRenderer={highlightedSeriesIndex:null};this.plugins.pieRenderer.highlightCanvas=new e.jqplot.GenericCanvas();var p=e(this.targetId+" .jqplot-data-label");if(p.length){e(p[0]).before(this.plugins.pieRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-pieRenderer-highlight-canvas",this._plotDimensions,this))}else{this.eventCanvas._elem.before(this.plugins.pieRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-pieRenderer-highlight-canvas",this._plotDimensions,this))}var o=this.plugins.pieRenderer.highlightCanvas.setContext();this.eventCanvas._elem.bind("mouseleave",{plot:this},function(q){k(q.data.plot)})}e.jqplot.preInitHooks.push(c);e.jqplot.PieTickRenderer=function(){e.jqplot.AxisTickRenderer.call(this)};e.jqplot.PieTickRenderer.prototype=new e.jqplot.AxisTickRenderer();
e.jqplot.PieTickRenderer.prototype.constructor=e.jqplot.PieTickRenderer})(jQuery);(function(d){d.jqplot.BarRenderer=function(){d.jqplot.LineRenderer.call(this)};d.jqplot.BarRenderer.prototype=new d.jqplot.LineRenderer();d.jqplot.BarRenderer.prototype.constructor=d.jqplot.BarRenderer;d.jqplot.BarRenderer.prototype.init=function(o,q){this.barPadding=8;this.barMargin=10;this.barDirection="vertical";this.barWidth=null;this.shadowOffset=2;this.shadowDepth=5;this.shadowAlpha=0.08;this.waterfall=false;this.groups=1;this.varyBarColor=false;this.highlightMouseOver=true;this.highlightMouseDown=false;this.highlightColors=[];this.transposedData=true;this.renderer.animation={show:false,direction:"down",speed:3000,_supported:true};this._type="bar";if(o.highlightMouseDown&&o.highlightMouseOver==null){o.highlightMouseOver=false}d.extend(true,this,o);d.extend(true,this.renderer,o);this.fill=true;if(this.barDirection==="horizontal"&&this.rendererOptions.animation&&this.rendererOptions.animation.direction==null){this.renderer.animation.direction="left"
}if(this.waterfall){this.fillToZero=false;this.disableStack=true}if(this.barDirection=="vertical"){this._primaryAxis="_xaxis";this._stackAxis="y";this.fillAxis="y"}else{this._primaryAxis="_yaxis";this._stackAxis="x";this.fillAxis="x"}this._highlightedPoint=null;this._plotSeriesInfo=null;this._dataColors=[];this._barPoints=[];var p={lineJoin:"miter",lineCap:"round",fill:true,isarc:false,strokeStyle:this.color,fillStyle:this.color,closePath:this.fill};this.renderer.shapeRenderer.init(p);var n={lineJoin:"miter",lineCap:"round",fill:true,isarc:false,angle:this.shadowAngle,offset:this.shadowOffset,alpha:this.shadowAlpha,depth:this.shadowDepth,closePath:this.fill};this.renderer.shadowRenderer.init(n);q.postInitHooks.addOnce(h);q.postDrawHooks.addOnce(j);q.eventListenerHooks.addOnce("jqplotMouseMove",b);q.eventListenerHooks.addOnce("jqplotMouseDown",a);q.eventListenerHooks.addOnce("jqplotMouseUp",l);q.eventListenerHooks.addOnce("jqplotClick",e);q.eventListenerHooks.addOnce("jqplotRightClick",m)
};function g(t,p,o,w){if(this.rendererOptions.barDirection=="horizontal"){this._stackAxis="x";this._primaryAxis="_yaxis"}if(this.rendererOptions.waterfall==true){this._data=d.extend(true,[],this.data);var s=0;var u=(!this.rendererOptions.barDirection||this.rendererOptions.barDirection==="vertical"||this.transposedData===false)?1:0;for(var q=0;q<this.data.length;q++){s+=this.data[q][u];if(q>0){this.data[q][u]+=this.data[q-1][u]}}this.data[this.data.length]=(u==1)?[this.data.length+1,s]:[s,this.data.length+1];this._data[this._data.length]=(u==1)?[this._data.length+1,s]:[s,this._data.length+1]}if(this.rendererOptions.groups>1){this.breakOnNull=true;var n=this.data.length;var v=parseInt(n/this.rendererOptions.groups,10);var r=0;for(var q=v;q<n;q+=v){this.data.splice(q+r,0,[null,null]);this._plotData.splice(q+r,0,[null,null]);this._stackData.splice(q+r,0,[null,null]);r++}for(q=0;q<this.data.length;q++){if(this._primaryAxis=="_xaxis"){this.data[q][0]=q+1;this._plotData[q][0]=q+1;this._stackData[q][0]=q+1
}else{this.data[q][1]=q+1;this._plotData[q][1]=q+1;this._stackData[q][1]=q+1}}}}d.jqplot.preSeriesInitHooks.push(g);d.jqplot.BarRenderer.prototype.calcSeriesNumbers=function(){var r=0;var t=0;var q=this[this._primaryAxis];var p,o,u;for(var n=0;n<q._series.length;n++){o=q._series[n];if(o===this){u=n}if(o.renderer.constructor==d.jqplot.BarRenderer){r+=o.data.length;t+=1}}return[r,t,u]};d.jqplot.BarRenderer.prototype.setBarWidth=function(){var q;var n=0;var o=0;var t=this[this._primaryAxis];var x,r,v;var w=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);n=w[0];o=w[1];var u=t.numberTicks;var p=(u-1)/2;if(t.name=="xaxis"||t.name=="x2axis"){if(this._stack){this.barWidth=(t._offsets.max-t._offsets.min)/n*o-this.barMargin}else{this.barWidth=((t._offsets.max-t._offsets.min)/p-this.barPadding*(o-1)-this.barMargin*2)/o}}else{if(this._stack){this.barWidth=(t._offsets.min-t._offsets.max)/n*o-this.barMargin}else{this.barWidth=((t._offsets.min-t._offsets.max)/p-this.barPadding*(o-1)-this.barMargin*2)/o
}}return[n,o]};function f(o){var q=[];for(var s=0;s<o.length;s++){var r=d.jqplot.getColorComponents(o[s]);var n=[r[0],r[1],r[2]];var t=n[0]+n[1]+n[2];for(var p=0;p<3;p++){n[p]=(t>570)?n[p]*0.8:n[p]+0.3*(255-n[p]);n[p]=parseInt(n[p],10)}q.push("rgb("+n[0]+","+n[1]+","+n[2]+")")}return q}function i(v,u,s,t,o){var q=v,w=v-1,n,p,r=(o==="x")?0:1;if(q>0){p=t.series[w]._plotData[u][r];if((s*p)<0){n=i(w,u,s,t,o)}else{n=t.series[w].gridData[u][r]}}else{n=(r===0)?t.series[q]._xaxis.series_u2p(0):t.series[q]._yaxis.series_u2p(0)}return n}d.jqplot.BarRenderer.prototype.draw=function(E,L,q,G){var I;var A=d.extend({},q);var w=(A.shadow!=undefined)?A.shadow:this.shadow;var O=(A.showLine!=undefined)?A.showLine:this.showLine;var F=(A.fill!=undefined)?A.fill:this.fill;var p=this.xaxis;var J=this.yaxis;var y=this._xaxis.series_u2p;var K=this._yaxis.series_u2p;var D,C;this._dataColors=[];this._barPoints=[];if(this.barWidth==null){this.renderer.setBarWidth.call(this)}var N=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);
var x=N[0];var v=N[1];var s=N[2];var H=[];if(this._stack){this._barNudge=0}else{this._barNudge=(-Math.abs(v/2-0.5)+s)*(this.barWidth+this.barPadding)}if(O){var u=new d.jqplot.ColorGenerator(this.negativeSeriesColors);var B=new d.jqplot.ColorGenerator(this.seriesColors);var M=u.get(this.index);if(!this.useNegativeColors){M=A.fillStyle}var t=A.fillStyle;var r;var P;var o;if(this.barDirection=="vertical"){for(var I=0;I<L.length;I++){if(!this._stack&&this.data[I][1]==null){continue}H=[];r=L[I][0]+this._barNudge;if(this._stack&&this._prevGridData.length){o=i(this.index,I,this._plotData[I][1],G,"y")}else{if(this.fillToZero){o=this._yaxis.series_u2p(0)}else{if(this.waterfall&&I>0&&I<this.gridData.length-1){o=this.gridData[I-1][1]}else{if(this.waterfall&&I==0&&I<this.gridData.length-1){if(this._yaxis.min<=0&&this._yaxis.max>=0){o=this._yaxis.series_u2p(0)}else{if(this._yaxis.min>0){o=E.canvas.height}else{o=0}}}else{if(this.waterfall&&I==this.gridData.length-1){if(this._yaxis.min<=0&&this._yaxis.max>=0){o=this._yaxis.series_u2p(0)
}else{if(this._yaxis.min>0){o=E.canvas.height}else{o=0}}}else{o=E.canvas.height}}}}}if((this.fillToZero&&this._plotData[I][1]<0)||(this.waterfall&&this._data[I][1]<0)){if(this.varyBarColor&&!this._stack){if(this.useNegativeColors){A.fillStyle=u.next()}else{A.fillStyle=B.next()}}else{A.fillStyle=M}}else{if(this.varyBarColor&&!this._stack){A.fillStyle=B.next()}else{A.fillStyle=t}}if(!this.fillToZero||this._plotData[I][1]>=0){H.push([r-this.barWidth/2,o]);H.push([r-this.barWidth/2,L[I][1]]);H.push([r+this.barWidth/2,L[I][1]]);H.push([r+this.barWidth/2,o])}else{H.push([r-this.barWidth/2,L[I][1]]);H.push([r-this.barWidth/2,o]);H.push([r+this.barWidth/2,o]);H.push([r+this.barWidth/2,L[I][1]])}this._barPoints.push(H);if(w&&!this._stack){var z=d.extend(true,{},A);delete z.fillStyle;this.renderer.shadowRenderer.draw(E,H,z)}var n=A.fillStyle||this.color;this._dataColors.push(n);this.renderer.shapeRenderer.draw(E,H,A)}}else{if(this.barDirection=="horizontal"){for(var I=0;I<L.length;I++){if(!this._stack&&this.data[I][0]==null){continue
}H=[];r=L[I][1]-this._barNudge;P;if(this._stack&&this._prevGridData.length){P=i(this.index,I,this._plotData[I][0],G,"x")}else{if(this.fillToZero){P=this._xaxis.series_u2p(0)}else{if(this.waterfall&&I>0&&I<this.gridData.length-1){P=this.gridData[I-1][0]}else{if(this.waterfall&&I==0&&I<this.gridData.length-1){if(this._xaxis.min<=0&&this._xaxis.max>=0){P=this._xaxis.series_u2p(0)}else{if(this._xaxis.min>0){P=0}else{P=0}}}else{if(this.waterfall&&I==this.gridData.length-1){if(this._xaxis.min<=0&&this._xaxis.max>=0){P=this._xaxis.series_u2p(0)}else{if(this._xaxis.min>0){P=0}else{P=E.canvas.width}}}else{P=0}}}}}if((this.fillToZero&&this._plotData[I][0]<0)||(this.waterfall&&this._data[I][0]<0)){if(this.varyBarColor&&!this._stack){if(this.useNegativeColors){A.fillStyle=u.next()}else{A.fillStyle=B.next()}}else{A.fillStyle=M}}else{if(this.varyBarColor&&!this._stack){A.fillStyle=B.next()}else{A.fillStyle=t}}if(!this.fillToZero||this._plotData[I][0]>=0){H.push([P,r+this.barWidth/2]);H.push([P,r-this.barWidth/2]);
H.push([L[I][0],r-this.barWidth/2]);H.push([L[I][0],r+this.barWidth/2])}else{H.push([L[I][0],r+this.barWidth/2]);H.push([L[I][0],r-this.barWidth/2]);H.push([P,r-this.barWidth/2]);H.push([P,r+this.barWidth/2])}this._barPoints.push(H);if(w&&!this._stack){var z=d.extend(true,{},A);delete z.fillStyle;this.renderer.shadowRenderer.draw(E,H,z)}var n=A.fillStyle||this.color;this._dataColors.push(n);this.renderer.shapeRenderer.draw(E,H,A)}}}}if(this.highlightColors.length==0){this.highlightColors=d.jqplot.computeHighlightColors(this._dataColors)}else{if(typeof(this.highlightColors)=="string"){var N=this.highlightColors;this.highlightColors=[];for(var I=0;I<this._dataColors.length;I++){this.highlightColors.push(N)}}}};d.jqplot.BarRenderer.prototype.drawShadow=function(z,G,p,B){var D;var w=(p!=undefined)?p:{};var t=(w.shadow!=undefined)?w.shadow:this.shadow;var I=(w.showLine!=undefined)?w.showLine:this.showLine;var A=(w.fill!=undefined)?w.fill:this.fill;var o=this.xaxis;var E=this.yaxis;var v=this._xaxis.series_u2p;
var F=this._yaxis.series_u2p;var y,C,x,u,s,r;if(this._stack&&this.shadow){if(this.barWidth==null){this.renderer.setBarWidth.call(this)}var H=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);u=H[0];s=H[1];r=H[2];if(this._stack){this._barNudge=0}else{this._barNudge=(-Math.abs(s/2-0.5)+r)*(this.barWidth+this.barPadding)}if(I){if(this.barDirection=="vertical"){for(var D=0;D<G.length;D++){if(this.data[D][1]==null){continue}C=[];var q=G[D][0]+this._barNudge;var n;if(this._stack&&this._prevGridData.length){n=i(this.index,D,this._plotData[D][1],B,"y")}else{if(this.fillToZero){n=this._yaxis.series_u2p(0)}else{n=z.canvas.height}}C.push([q-this.barWidth/2,n]);C.push([q-this.barWidth/2,G[D][1]]);C.push([q+this.barWidth/2,G[D][1]]);C.push([q+this.barWidth/2,n]);this.renderer.shadowRenderer.draw(z,C,w)}}else{if(this.barDirection=="horizontal"){for(var D=0;D<G.length;D++){if(this.data[D][0]==null){continue}C=[];var q=G[D][1]-this._barNudge;var J;if(this._stack&&this._prevGridData.length){J=i(this.index,D,this._plotData[D][0],B,"x")
}else{if(this.fillToZero){J=this._xaxis.series_u2p(0)}else{J=0}}C.push([J,q+this.barWidth/2]);C.push([G[D][0],q+this.barWidth/2]);C.push([G[D][0],q-this.barWidth/2]);C.push([J,q-this.barWidth/2]);this.renderer.shadowRenderer.draw(z,C,w)}}}}}};function h(q,p,n){for(var o=0;o<this.series.length;o++){if(this.series[o].renderer.constructor==d.jqplot.BarRenderer){if(this.series[o].highlightMouseOver){this.series[o].highlightMouseDown=false}}}}function j(){if(this.plugins.barRenderer&&this.plugins.barRenderer.highlightCanvas){this.plugins.barRenderer.highlightCanvas.resetCanvas();this.plugins.barRenderer.highlightCanvas=null}this.plugins.barRenderer={highlightedSeriesIndex:null};this.plugins.barRenderer.highlightCanvas=new d.jqplot.GenericCanvas();this.eventCanvas._elem.before(this.plugins.barRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-barRenderer-highlight-canvas",this._plotDimensions,this));this.plugins.barRenderer.highlightCanvas.setContext();this.eventCanvas._elem.bind("mouseleave",{plot:this},function(n){k(n.data.plot)
})}function c(u,t,q,p){var o=u.series[t];var n=u.plugins.barRenderer.highlightCanvas;n._ctx.clearRect(0,0,n._ctx.canvas.width,n._ctx.canvas.height);o._highlightedPoint=q;u.plugins.barRenderer.highlightedSeriesIndex=t;var r={fillStyle:o.highlightColors[q]};o.renderer.shapeRenderer.draw(n._ctx,p,r);n=null}function k(p){var n=p.plugins.barRenderer.highlightCanvas;n._ctx.clearRect(0,0,n._ctx.canvas.width,n._ctx.canvas.height);for(var o=0;o<p.series.length;o++){p.series[o]._highlightedPoint=null}p.plugins.barRenderer.highlightedSeriesIndex=null;p.target.trigger("jqplotDataUnhighlight");n=null}function b(r,q,u,t,s){if(t){var p=[t.seriesIndex,t.pointIndex,t.data];var o=jQuery.Event("jqplotDataMouseOver");o.pageX=r.pageX;o.pageY=r.pageY;s.target.trigger(o,p);if(s.series[p[0]].show&&s.series[p[0]].highlightMouseOver&&!(p[0]==s.plugins.barRenderer.highlightedSeriesIndex&&p[1]==s.series[p[0]]._highlightedPoint)){var n=jQuery.Event("jqplotDataHighlight");n.which=r.which;n.pageX=r.pageX;n.pageY=r.pageY;
s.target.trigger(n,p);c(s,t.seriesIndex,t.pointIndex,t.points)}}else{if(t==null){k(s)}}}function a(q,p,t,s,r){if(s){var o=[s.seriesIndex,s.pointIndex,s.data];if(r.series[o[0]].highlightMouseDown&&!(o[0]==r.plugins.barRenderer.highlightedSeriesIndex&&o[1]==r.series[o[0]]._highlightedPoint)){var n=jQuery.Event("jqplotDataHighlight");n.which=q.which;n.pageX=q.pageX;n.pageY=q.pageY;r.target.trigger(n,o);c(r,s.seriesIndex,s.pointIndex,s.points)}}else{if(s==null){k(r)}}}function l(p,o,s,r,q){var n=q.plugins.barRenderer.highlightedSeriesIndex;if(n!=null&&q.series[n].highlightMouseDown){k(q)}}function e(q,p,t,s,r){if(s){var o=[s.seriesIndex,s.pointIndex,s.data];var n=jQuery.Event("jqplotDataClick");n.which=q.which;n.pageX=q.pageX;n.pageY=q.pageY;r.target.trigger(n,o)}}function m(r,q,u,t,s){if(t){var p=[t.seriesIndex,t.pointIndex,t.data];var n=s.plugins.barRenderer.highlightedSeriesIndex;if(n!=null&&s.series[n].highlightMouseDown){k(s)}var o=jQuery.Event("jqplotDataRightClick");o.which=r.which;o.pageX=r.pageX;
o.pageY=r.pageY;s.target.trigger(o,p)}}})(jQuery);(function(a){a.jqplot.CategoryAxisRenderer=function(b){a.jqplot.LinearAxisRenderer.call(this);this.sortMergedLabels=false};a.jqplot.CategoryAxisRenderer.prototype=new a.jqplot.LinearAxisRenderer();a.jqplot.CategoryAxisRenderer.prototype.constructor=a.jqplot.CategoryAxisRenderer;a.jqplot.CategoryAxisRenderer.prototype.init=function(e){this.groups=1;this.groupLabels=[];this._groupLabels=[];this._grouped=false;this._barsPerGroup=null;this.reverse=false;a.extend(true,this,{tickOptions:{formatString:"%d"}},e);var b=this._dataBounds;for(var f=0;f<this._series.length;f++){var g=this._series[f];if(g.groups){this.groups=g.groups}var h=g.data;for(var c=0;c<h.length;c++){if(this.name=="xaxis"||this.name=="x2axis"){if(h[c][0]<b.min||b.min==null){b.min=h[c][0]}if(h[c][0]>b.max||b.max==null){b.max=h[c][0]}}else{if(h[c][1]<b.min||b.min==null){b.min=h[c][1]}if(h[c][1]>b.max||b.max==null){b.max=h[c][1]}}}}if(this.groupLabels.length){this.groups=this.groupLabels.length
}};a.jqplot.CategoryAxisRenderer.prototype.createTicks=function(){var D=this._ticks;var z=this.ticks;var F=this.name;var C=this._dataBounds;var v,A;var q,w;var d,c;var b,x;if(z.length){if(this.groups>1&&!this._grouped){var r=z.length;var p=parseInt(r/this.groups,10);var e=0;for(var x=p;x<r;x+=p){z.splice(x+e,0," ");e++}this._grouped=true}this.min=0.5;this.max=z.length+0.5;var m=this.max-this.min;this.numberTicks=2*z.length+1;for(x=0;x<z.length;x++){b=this.min+2*x*m/(this.numberTicks-1);var h=new this.tickRenderer(this.tickOptions);h.showLabel=false;h.setTick(b,this.name);this._ticks.push(h);var h=new this.tickRenderer(this.tickOptions);h.label=z[x];h.showMark=false;h.showGridline=false;h.setTick(b+0.5,this.name);this._ticks.push(h)}var h=new this.tickRenderer(this.tickOptions);h.showLabel=false;h.setTick(b+1,this.name);this._ticks.push(h)}else{if(F=="xaxis"||F=="x2axis"){v=this._plotDimensions.width}else{v=this._plotDimensions.height}if(this.min!=null&&this.max!=null&&this.numberTicks!=null){this.tickInterval=null
}if(this.min!=null&&this.max!=null&&this.tickInterval!=null){if(parseInt((this.max-this.min)/this.tickInterval,10)!=(this.max-this.min)/this.tickInterval){this.tickInterval=null}}var y=[];var B=0;var q=0.5;var w,E;var f=false;for(var x=0;x<this._series.length;x++){var k=this._series[x];for(var u=0;u<k.data.length;u++){if(this.name=="xaxis"||this.name=="x2axis"){E=k.data[u][0]}else{E=k.data[u][1]}if(a.inArray(E,y)==-1){f=true;B+=1;y.push(E)}}}if(f&&this.sortMergedLabels){if(typeof y[0]=="string"){y.sort()}else{y.sort(function(j,i){return j-i})}}this.ticks=y;for(var x=0;x<this._series.length;x++){var k=this._series[x];for(var u=0;u<k.data.length;u++){if(this.name=="xaxis"||this.name=="x2axis"){E=k.data[u][0]}else{E=k.data[u][1]}var n=a.inArray(E,y)+1;if(this.name=="xaxis"||this.name=="x2axis"){k.data[u][0]=n}else{k.data[u][1]=n}}}if(this.groups>1&&!this._grouped){var r=y.length;var p=parseInt(r/this.groups,10);var e=0;for(var x=p;x<r;x+=p+1){y[x]=" "}this._grouped=true}w=B+0.5;if(this.numberTicks==null){this.numberTicks=2*B+1
}var m=w-q;this.min=q;this.max=w;var o=0;var g=parseInt(3+v/10,10);var p=parseInt(B/g,10);if(this.tickInterval==null){this.tickInterval=m/(this.numberTicks-1)}for(var x=0;x<this.numberTicks;x++){b=this.min+x*this.tickInterval;var h=new this.tickRenderer(this.tickOptions);if(x/2==parseInt(x/2,10)){h.showLabel=false;h.showMark=true}else{if(p>0&&o<p){h.showLabel=false;o+=1}else{h.showLabel=true;o=0}h.label=h.formatter(h.formatString,y[(x-1)/2]);h.showMark=false;h.showGridline=false}h.setTick(b,this.name);this._ticks.push(h)}}};a.jqplot.CategoryAxisRenderer.prototype.draw=function(b,j){if(this.show){this.renderer.createTicks.call(this);var h=0;var c;if(this._elem){this._elem.emptyForce()}this._elem=this._elem||a('<div class="jqplot-axis jqplot-'+this.name+'" style="position:absolute;"></div>');if(this.name=="xaxis"||this.name=="x2axis"){this._elem.width(this._plotDimensions.width)}else{this._elem.height(this._plotDimensions.height)}this.labelOptions.axis=this.name;this._label=new this.labelRenderer(this.labelOptions);
if(this._label.show){var g=this._label.draw(b,j);g.appendTo(this._elem)}var f=this._ticks;for(var e=0;e<f.length;e++){var d=f[e];if(d.showLabel&&(!d.isMinorTick||this.showMinorTicks)){var g=d.draw(b,j);g.appendTo(this._elem)}}this._groupLabels=[];for(var e=0;e<this.groupLabels.length;e++){var g=a('<div style="position:absolute;" class="jqplot-'+this.name+'-groupLabel"></div>');g.html(this.groupLabels[e]);this._groupLabels.push(g);g.appendTo(this._elem)}}return this._elem};a.jqplot.CategoryAxisRenderer.prototype.set=function(){var e=0;var m;var k=0;var f=0;var d=(this._label==null)?false:this._label.show;if(this.show){var n=this._ticks;for(var c=0;c<n.length;c++){var g=n[c];if(g.showLabel&&(!g.isMinorTick||this.showMinorTicks)){if(this.name=="xaxis"||this.name=="x2axis"){m=g._elem.outerHeight(true)}else{m=g._elem.outerWidth(true)}if(m>e){e=m}}}var j=0;for(var c=0;c<this._groupLabels.length;c++){var b=this._groupLabels[c];if(this.name=="xaxis"||this.name=="x2axis"){m=b.outerHeight(true)}else{m=b.outerWidth(true)
}if(m>j){j=m}}if(d){k=this._label._elem.outerWidth(true);f=this._label._elem.outerHeight(true)}if(this.name=="xaxis"){e+=j+f;this._elem.css({height:e+"px",left:"0px",bottom:"0px"})}else{if(this.name=="x2axis"){e+=j+f;this._elem.css({height:e+"px",left:"0px",top:"0px"})}else{if(this.name=="yaxis"){e+=j+k;this._elem.css({width:e+"px",left:"0px",top:"0px"});if(d&&this._label.constructor==a.jqplot.AxisLabelRenderer){this._label._elem.css("width",k+"px")}}else{e+=j+k;this._elem.css({width:e+"px",right:"0px",top:"0px"});if(d&&this._label.constructor==a.jqplot.AxisLabelRenderer){this._label._elem.css("width",k+"px")}}}}}};a.jqplot.CategoryAxisRenderer.prototype.pack=function(e,c){var C=this._ticks;var v=this.max;var s=this.min;var n=c.max;var l=c.min;var q=(this._label==null)?false:this._label.show;var x;for(var r in e){this._elem.css(r,e[r])}this._offsets=c;var g=n-l;var k=v-s;if(!this.reverse){this.u2p=function(h){return(h-s)*g/k+l};this.p2u=function(h){return(h-l)*k/g+s};if(this.name=="xaxis"||this.name=="x2axis"){this.series_u2p=function(h){return(h-s)*g/k
};this.series_p2u=function(h){return h*k/g+s}}else{this.series_u2p=function(h){return(h-v)*g/k};this.series_p2u=function(h){return h*k/g+v}}}else{this.u2p=function(h){return l+(v-h)*g/k};this.p2u=function(h){return s+(h-l)*k/g};if(this.name=="xaxis"||this.name=="x2axis"){this.series_u2p=function(h){return(v-h)*g/k};this.series_p2u=function(h){return h*k/g+v}}else{this.series_u2p=function(h){return(s-h)*g/k};this.series_p2u=function(h){return h*k/g+s}}}if(this.show){if(this.name=="xaxis"||this.name=="x2axis"){for(x=0;x<C.length;x++){var o=C[x];if(o.show&&o.showLabel){var b;if(o.constructor==a.jqplot.CanvasAxisTickRenderer&&o.angle){var A=(this.name=="xaxis")?1:-1;switch(o.labelPosition){case"auto":if(A*o.angle<0){b=-o.getWidth()+o._textRenderer.height*Math.sin(-o._textRenderer.angle)/2}else{b=-o._textRenderer.height*Math.sin(o._textRenderer.angle)/2}break;case"end":b=-o.getWidth()+o._textRenderer.height*Math.sin(-o._textRenderer.angle)/2;break;case"start":b=-o._textRenderer.height*Math.sin(o._textRenderer.angle)/2;
break;case"middle":b=-o.getWidth()/2+o._textRenderer.height*Math.sin(-o._textRenderer.angle)/2;break;default:b=-o.getWidth()/2+o._textRenderer.height*Math.sin(-o._textRenderer.angle)/2;break}}else{b=-o.getWidth()/2}var D=this.u2p(o.value)+b+"px";o._elem.css("left",D);o.pack()}}var z=["bottom",0];if(q){var m=this._label._elem.outerWidth(true);this._label._elem.css("left",l+g/2-m/2+"px");if(this.name=="xaxis"){this._label._elem.css("bottom","0px");z=["bottom",this._label._elem.outerHeight(true)]}else{this._label._elem.css("top","0px");z=["top",this._label._elem.outerHeight(true)]}this._label.pack()}var d=parseInt(this._ticks.length/this.groups,10)+1;for(x=0;x<this._groupLabels.length;x++){var B=0;var f=0;for(var u=x*d;u<(x+1)*d;u++){if(u>=this._ticks.length-1){continue}if(this._ticks[u]._elem&&this._ticks[u].label!=" "){var o=this._ticks[u]._elem;var r=o.position();B+=r.left+o.outerWidth(true)/2;f++}}B=B/f;this._groupLabels[x].css({left:(B-this._groupLabels[x].outerWidth(true)/2)});this._groupLabels[x].css(z[0],z[1])
}}else{for(x=0;x<C.length;x++){var o=C[x];if(o.show&&o.showLabel){var b;if(o.constructor==a.jqplot.CanvasAxisTickRenderer&&o.angle){var A=(this.name=="yaxis")?1:-1;switch(o.labelPosition){case"auto":case"end":if(A*o.angle<0){b=-o._textRenderer.height*Math.cos(-o._textRenderer.angle)/2}else{b=-o.getHeight()+o._textRenderer.height*Math.cos(o._textRenderer.angle)/2}break;case"start":if(o.angle>0){b=-o._textRenderer.height*Math.cos(-o._textRenderer.angle)/2}else{b=-o.getHeight()+o._textRenderer.height*Math.cos(o._textRenderer.angle)/2}break;case"middle":b=-o.getHeight()/2;break;default:b=-o.getHeight()/2;break}}else{b=-o.getHeight()/2}var D=this.u2p(o.value)+b+"px";o._elem.css("top",D);o.pack()}}var z=["left",0];if(q){var y=this._label._elem.outerHeight(true);this._label._elem.css("top",n-g/2-y/2+"px");if(this.name=="yaxis"){this._label._elem.css("left","0px");z=["left",this._label._elem.outerWidth(true)]}else{this._label._elem.css("right","0px");z=["right",this._label._elem.outerWidth(true)]
}this._label.pack()}var d=parseInt(this._ticks.length/this.groups,10)+1;for(x=0;x<this._groupLabels.length;x++){var B=0;var f=0;for(var u=x*d;u<(x+1)*d;u++){if(u>=this._ticks.length-1){continue}if(this._ticks[u]._elem&&this._ticks[u].label!=" "){var o=this._ticks[u]._elem;var r=o.position();B+=r.top+o.outerHeight()/2;f++}}B=B/f;this._groupLabels[x].css({top:B-this._groupLabels[x].outerHeight()/2});this._groupLabels[x].css(z[0],z[1])}}}}})(jQuery);(function(a){a.jqplot.CanvasTextRenderer=function(b){this.fontStyle="normal";this.fontVariant="normal";this.fontWeight="normal";this.fontSize="10px";this.fontFamily="sans-serif";this.fontStretch=1;this.fillStyle="#666666";this.angle=0;this.textAlign="start";this.textBaseline="alphabetic";this.text;this.width;this.height;this.pt2px=1.28;a.extend(true,this,b);this.normalizedFontSize=this.normalizeFontSize(this.fontSize);this.setHeight()};a.jqplot.CanvasTextRenderer.prototype.init=function(b){a.extend(true,this,b);this.normalizedFontSize=this.normalizeFontSize(this.fontSize);
this.setHeight()};a.jqplot.CanvasTextRenderer.prototype.normalizeFontSize=function(b){b=String(b);var c=parseFloat(b);if(b.indexOf("px")>-1){return c/this.pt2px}else{if(b.indexOf("pt")>-1){return c}else{if(b.indexOf("em")>-1){return c*12}else{if(b.indexOf("%")>-1){return c*12/100}else{return c/this.pt2px}}}}};a.jqplot.CanvasTextRenderer.prototype.fontWeight2Float=function(b){if(Number(b)){return b/400}else{switch(b){case"normal":return 1;break;case"bold":return 1.75;break;case"bolder":return 2.25;break;case"lighter":return 0.75;break;default:return 1;break}}};a.jqplot.CanvasTextRenderer.prototype.getText=function(){return this.text};a.jqplot.CanvasTextRenderer.prototype.setText=function(c,b){this.text=c;this.setWidth(b);return this};a.jqplot.CanvasTextRenderer.prototype.getWidth=function(b){return this.width};a.jqplot.CanvasTextRenderer.prototype.setWidth=function(c,b){if(!b){this.width=this.measure(c,this.text)}else{this.width=b}return this};a.jqplot.CanvasTextRenderer.prototype.getHeight=function(b){return this.height
};a.jqplot.CanvasTextRenderer.prototype.setHeight=function(b){if(!b){this.height=this.normalizedFontSize*this.pt2px}else{this.height=b}return this};a.jqplot.CanvasTextRenderer.prototype.letter=function(b){return this.letters[b]};a.jqplot.CanvasTextRenderer.prototype.ascent=function(){return this.normalizedFontSize};a.jqplot.CanvasTextRenderer.prototype.descent=function(){return 7*this.normalizedFontSize/25};a.jqplot.CanvasTextRenderer.prototype.measure=function(d,g){var f=0;var b=g.length;for(var e=0;e<b;e++){var h=this.letter(g.charAt(e));if(h){f+=h.width*this.normalizedFontSize/25*this.fontStretch}}return f};a.jqplot.CanvasTextRenderer.prototype.draw=function(s,n){var r=0;var o=this.height*0.72;var p=0;var l=n.length;var k=this.normalizedFontSize/25;s.save();var h,f;if((-Math.PI/2<=this.angle&&this.angle<=0)||(Math.PI*3/2<=this.angle&&this.angle<=Math.PI*2)){h=0;f=-Math.sin(this.angle)*this.width}else{if((0<this.angle&&this.angle<=Math.PI/2)||(-Math.PI*2<=this.angle&&this.angle<=-Math.PI*3/2)){h=Math.sin(this.angle)*this.height;
f=0}else{if((-Math.PI<this.angle&&this.angle<-Math.PI/2)||(Math.PI<=this.angle&&this.angle<=Math.PI*3/2)){h=-Math.cos(this.angle)*this.width;f=-Math.sin(this.angle)*this.width-Math.cos(this.angle)*this.height}else{if((-Math.PI*3/2<this.angle&&this.angle<Math.PI)||(Math.PI/2<this.angle&&this.angle<Math.PI)){h=Math.sin(this.angle)*this.height-Math.cos(this.angle)*this.width;f=-Math.cos(this.angle)*this.height}}}}s.strokeStyle=this.fillStyle;s.fillStyle=this.fillStyle;s.translate(h,f);s.rotate(this.angle);s.lineCap="round";var t=(this.normalizedFontSize>30)?2:2+(30-this.normalizedFontSize)/20;s.lineWidth=t*k*this.fontWeight2Float(this.fontWeight);for(var g=0;g<l;g++){var m=this.letter(n.charAt(g));if(!m){continue}s.beginPath();var e=1;var b=0;for(var d=0;d<m.points.length;d++){var q=m.points[d];if(q[0]==-1&&q[1]==-1){e=1;continue}if(e){s.moveTo(r+q[0]*k*this.fontStretch,o-q[1]*k);e=false}else{s.lineTo(r+q[0]*k*this.fontStretch,o-q[1]*k)}}s.stroke();r+=m.width*k*this.fontStretch}s.restore();
return p};a.jqplot.CanvasTextRenderer.prototype.letters={" ":{width:16,points:[]},"!":{width:10,points:[[5,21],[5,7],[-1,-1],[5,2],[4,1],[5,0],[6,1],[5,2]]},'"':{width:16,points:[[4,21],[4,14],[-1,-1],[12,21],[12,14]]},"#":{width:21,points:[[11,25],[4,-7],[-1,-1],[17,25],[10,-7],[-1,-1],[4,12],[18,12],[-1,-1],[3,6],[17,6]]},"$":{width:20,points:[[8,25],[8,-4],[-1,-1],[12,25],[12,-4],[-1,-1],[17,18],[15,20],[12,21],[8,21],[5,20],[3,18],[3,16],[4,14],[5,13],[7,12],[13,10],[15,9],[16,8],[17,6],[17,3],[15,1],[12,0],[8,0],[5,1],[3,3]]},"%":{width:24,points:[[21,21],[3,0],[-1,-1],[8,21],[10,19],[10,17],[9,15],[7,14],[5,14],[3,16],[3,18],[4,20],[6,21],[8,21],[10,20],[13,19],[16,19],[19,20],[21,21],[-1,-1],[17,7],[15,6],[14,4],[14,2],[16,0],[18,0],[20,1],[21,3],[21,5],[19,7],[17,7]]},"&":{width:26,points:[[23,12],[23,13],[22,14],[21,14],[20,13],[19,11],[17,6],[15,3],[13,1],[11,0],[7,0],[5,1],[4,2],[3,4],[3,6],[4,8],[5,9],[12,13],[13,14],[14,16],[14,18],[13,20],[11,21],[9,20],[8,18],[8,16],[9,13],[11,10],[16,3],[18,1],[20,0],[22,0],[23,1],[23,2]]},"'":{width:10,points:[[5,19],[4,20],[5,21],[6,20],[6,18],[5,16],[4,15]]},"(":{width:14,points:[[11,25],[9,23],[7,20],[5,16],[4,11],[4,7],[5,2],[7,-2],[9,-5],[11,-7]]},")":{width:14,points:[[3,25],[5,23],[7,20],[9,16],[10,11],[10,7],[9,2],[7,-2],[5,-5],[3,-7]]},"*":{width:16,points:[[8,21],[8,9],[-1,-1],[3,18],[13,12],[-1,-1],[13,18],[3,12]]},"+":{width:26,points:[[13,18],[13,0],[-1,-1],[4,9],[22,9]]},",":{width:10,points:[[6,1],[5,0],[4,1],[5,2],[6,1],[6,-1],[5,-3],[4,-4]]},"-":{width:18,points:[[6,9],[12,9]]},".":{width:10,points:[[5,2],[4,1],[5,0],[6,1],[5,2]]},"/":{width:22,points:[[20,25],[2,-7]]},"0":{width:20,points:[[9,21],[6,20],[4,17],[3,12],[3,9],[4,4],[6,1],[9,0],[11,0],[14,1],[16,4],[17,9],[17,12],[16,17],[14,20],[11,21],[9,21]]},"1":{width:20,points:[[6,17],[8,18],[11,21],[11,0]]},"2":{width:20,points:[[4,16],[4,17],[5,19],[6,20],[8,21],[12,21],[14,20],[15,19],[16,17],[16,15],[15,13],[13,10],[3,0],[17,0]]},"3":{width:20,points:[[5,21],[16,21],[10,13],[13,13],[15,12],[16,11],[17,8],[17,6],[16,3],[14,1],[11,0],[8,0],[5,1],[4,2],[3,4]]},"4":{width:20,points:[[13,21],[3,7],[18,7],[-1,-1],[13,21],[13,0]]},"5":{width:20,points:[[15,21],[5,21],[4,12],[5,13],[8,14],[11,14],[14,13],[16,11],[17,8],[17,6],[16,3],[14,1],[11,0],[8,0],[5,1],[4,2],[3,4]]},"6":{width:20,points:[[16,18],[15,20],[12,21],[10,21],[7,20],[5,17],[4,12],[4,7],[5,3],[7,1],[10,0],[11,0],[14,1],[16,3],[17,6],[17,7],[16,10],[14,12],[11,13],[10,13],[7,12],[5,10],[4,7]]},"7":{width:20,points:[[17,21],[7,0],[-1,-1],[3,21],[17,21]]},"8":{width:20,points:[[8,21],[5,20],[4,18],[4,16],[5,14],[7,13],[11,12],[14,11],[16,9],[17,7],[17,4],[16,2],[15,1],[12,0],[8,0],[5,1],[4,2],[3,4],[3,7],[4,9],[6,11],[9,12],[13,13],[15,14],[16,16],[16,18],[15,20],[12,21],[8,21]]},"9":{width:20,points:[[16,14],[15,11],[13,9],[10,8],[9,8],[6,9],[4,11],[3,14],[3,15],[4,18],[6,20],[9,21],[10,21],[13,20],[15,18],[16,14],[16,9],[15,4],[13,1],[10,0],[8,0],[5,1],[4,3]]},":":{width:10,points:[[5,14],[4,13],[5,12],[6,13],[5,14],[-1,-1],[5,2],[4,1],[5,0],[6,1],[5,2]]},";":{width:10,points:[[5,14],[4,13],[5,12],[6,13],[5,14],[-1,-1],[6,1],[5,0],[4,1],[5,2],[6,1],[6,-1],[5,-3],[4,-4]]},"<":{width:24,points:[[20,18],[4,9],[20,0]]},"=":{width:26,points:[[4,12],[22,12],[-1,-1],[4,6],[22,6]]},">":{width:24,points:[[4,18],[20,9],[4,0]]},"?":{width:18,points:[[3,16],[3,17],[4,19],[5,20],[7,21],[11,21],[13,20],[14,19],[15,17],[15,15],[14,13],[13,12],[9,10],[9,7],[-1,-1],[9,2],[8,1],[9,0],[10,1],[9,2]]},"@":{width:27,points:[[18,13],[17,15],[15,16],[12,16],[10,15],[9,14],[8,11],[8,8],[9,6],[11,5],[14,5],[16,6],[17,8],[-1,-1],[12,16],[10,14],[9,11],[9,8],[10,6],[11,5],[-1,-1],[18,16],[17,8],[17,6],[19,5],[21,5],[23,7],[24,10],[24,12],[23,15],[22,17],[20,19],[18,20],[15,21],[12,21],[9,20],[7,19],[5,17],[4,15],[3,12],[3,9],[4,6],[5,4],[7,2],[9,1],[12,0],[15,0],[18,1],[20,2],[21,3],[-1,-1],[19,16],[18,8],[18,6],[19,5]]},A:{width:18,points:[[9,21],[1,0],[-1,-1],[9,21],[17,0],[-1,-1],[4,7],[14,7]]},B:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,15],[17,13],[16,12],[13,11],[-1,-1],[4,11],[13,11],[16,10],[17,9],[18,7],[18,4],[17,2],[16,1],[13,0],[4,0]]},C:{width:21,points:[[18,16],[17,18],[15,20],[13,21],[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5]]},D:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[11,21],[14,20],[16,18],[17,16],[18,13],[18,8],[17,5],[16,3],[14,1],[11,0],[4,0]]},E:{width:19,points:[[4,21],[4,0],[-1,-1],[4,21],[17,21],[-1,-1],[4,11],[12,11],[-1,-1],[4,0],[17,0]]},F:{width:18,points:[[4,21],[4,0],[-1,-1],[4,21],[17,21],[-1,-1],[4,11],[12,11]]},G:{width:21,points:[[18,16],[17,18],[15,20],[13,21],[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[18,8],[-1,-1],[13,8],[18,8]]},H:{width:22,points:[[4,21],[4,0],[-1,-1],[18,21],[18,0],[-1,-1],[4,11],[18,11]]},I:{width:8,points:[[4,21],[4,0]]},J:{width:16,points:[[12,21],[12,5],[11,2],[10,1],[8,0],[6,0],[4,1],[3,2],[2,5],[2,7]]},K:{width:21,points:[[4,21],[4,0],[-1,-1],[18,21],[4,7],[-1,-1],[9,12],[18,0]]},L:{width:17,points:[[4,21],[4,0],[-1,-1],[4,0],[16,0]]},M:{width:24,points:[[4,21],[4,0],[-1,-1],[4,21],[12,0],[-1,-1],[20,21],[12,0],[-1,-1],[20,21],[20,0]]},N:{width:22,points:[[4,21],[4,0],[-1,-1],[4,21],[18,0],[-1,-1],[18,21],[18,0]]},O:{width:22,points:[[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[19,8],[19,13],[18,16],[17,18],[15,20],[13,21],[9,21]]},P:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,14],[17,12],[16,11],[13,10],[4,10]]},Q:{width:22,points:[[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[19,8],[19,13],[18,16],[17,18],[15,20],[13,21],[9,21],[-1,-1],[12,4],[18,-2]]},R:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,15],[17,13],[16,12],[13,11],[4,11],[-1,-1],[11,11],[18,0]]},S:{width:20,points:[[17,18],[15,20],[12,21],[8,21],[5,20],[3,18],[3,16],[4,14],[5,13],[7,12],[13,10],[15,9],[16,8],[17,6],[17,3],[15,1],[12,0],[8,0],[5,1],[3,3]]},T:{width:16,points:[[8,21],[8,0],[-1,-1],[1,21],[15,21]]},U:{width:22,points:[[4,21],[4,6],[5,3],[7,1],[10,0],[12,0],[15,1],[17,3],[18,6],[18,21]]},V:{width:18,points:[[1,21],[9,0],[-1,-1],[17,21],[9,0]]},W:{width:24,points:[[2,21],[7,0],[-1,-1],[12,21],[7,0],[-1,-1],[12,21],[17,0],[-1,-1],[22,21],[17,0]]},X:{width:20,points:[[3,21],[17,0],[-1,-1],[17,21],[3,0]]},Y:{width:18,points:[[1,21],[9,11],[9,0],[-1,-1],[17,21],[9,11]]},Z:{width:20,points:[[17,21],[3,0],[-1,-1],[3,21],[17,21],[-1,-1],[3,0],[17,0]]},"[":{width:14,points:[[4,25],[4,-7],[-1,-1],[5,25],[5,-7],[-1,-1],[4,25],[11,25],[-1,-1],[4,-7],[11,-7]]},"\\":{width:14,points:[[0,21],[14,-3]]},"]":{width:14,points:[[9,25],[9,-7],[-1,-1],[10,25],[10,-7],[-1,-1],[3,25],[10,25],[-1,-1],[3,-7],[10,-7]]},"^":{width:16,points:[[6,15],[8,18],[10,15],[-1,-1],[3,12],[8,17],[13,12],[-1,-1],[8,17],[8,0]]},_:{width:16,points:[[0,-2],[16,-2]]},"`":{width:10,points:[[6,21],[5,20],[4,18],[4,16],[5,15],[6,16],[5,17]]},a:{width:19,points:[[15,14],[15,0],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},b:{width:19,points:[[4,21],[4,0],[-1,-1],[4,11],[6,13],[8,14],[11,14],[13,13],[15,11],[16,8],[16,6],[15,3],[13,1],[11,0],[8,0],[6,1],[4,3]]},c:{width:18,points:[[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},d:{width:19,points:[[15,21],[15,0],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},e:{width:18,points:[[3,8],[15,8],[15,10],[14,12],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},f:{width:12,points:[[10,21],[8,21],[6,20],[5,17],[5,0],[-1,-1],[2,14],[9,14]]},g:{width:19,points:[[15,14],[15,-2],[14,-5],[13,-6],[11,-7],[8,-7],[6,-6],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},h:{width:19,points:[[4,21],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0]]},i:{width:8,points:[[3,21],[4,20],[5,21],[4,22],[3,21],[-1,-1],[4,14],[4,0]]},j:{width:10,points:[[5,21],[6,20],[7,21],[6,22],[5,21],[-1,-1],[6,14],[6,-3],[5,-6],[3,-7],[1,-7]]},k:{width:17,points:[[4,21],[4,0],[-1,-1],[14,14],[4,4],[-1,-1],[8,8],[15,0]]},l:{width:8,points:[[4,21],[4,0]]},m:{width:30,points:[[4,14],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0],[-1,-1],[15,10],[18,13],[20,14],[23,14],[25,13],[26,10],[26,0]]},n:{width:19,points:[[4,14],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0]]},o:{width:19,points:[[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3],[16,6],[16,8],[15,11],[13,13],[11,14],[8,14]]},p:{width:19,points:[[4,14],[4,-7],[-1,-1],[4,11],[6,13],[8,14],[11,14],[13,13],[15,11],[16,8],[16,6],[15,3],[13,1],[11,0],[8,0],[6,1],[4,3]]},q:{width:19,points:[[15,14],[15,-7],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},r:{width:13,points:[[4,14],[4,0],[-1,-1],[4,8],[5,11],[7,13],[9,14],[12,14]]},s:{width:17,points:[[14,11],[13,13],[10,14],[7,14],[4,13],[3,11],[4,9],[6,8],[11,7],[13,6],[14,4],[14,3],[13,1],[10,0],[7,0],[4,1],[3,3]]},t:{width:12,points:[[5,21],[5,4],[6,1],[8,0],[10,0],[-1,-1],[2,14],[9,14]]},u:{width:19,points:[[4,14],[4,4],[5,1],[7,0],[10,0],[12,1],[15,4],[-1,-1],[15,14],[15,0]]},v:{width:16,points:[[2,14],[8,0],[-1,-1],[14,14],[8,0]]},w:{width:22,points:[[3,14],[7,0],[-1,-1],[11,14],[7,0],[-1,-1],[11,14],[15,0],[-1,-1],[19,14],[15,0]]},x:{width:17,points:[[3,14],[14,0],[-1,-1],[14,14],[3,0]]},y:{width:16,points:[[2,14],[8,0],[-1,-1],[14,14],[8,0],[6,-4],[4,-6],[2,-7],[1,-7]]},z:{width:17,points:[[14,14],[3,0],[-1,-1],[3,14],[14,14],[-1,-1],[3,0],[14,0]]},"{":{width:14,points:[[9,25],[7,24],[6,23],[5,21],[5,19],[6,17],[7,16],[8,14],[8,12],[6,10],[-1,-1],[7,24],[6,22],[6,20],[7,18],[8,17],[9,15],[9,13],[8,11],[4,9],[8,7],[9,5],[9,3],[8,1],[7,0],[6,-2],[6,-4],[7,-6],[-1,-1],[6,8],[8,6],[8,4],[7,2],[6,1],[5,-1],[5,-3],[6,-5],[7,-6],[9,-7]]},"|":{width:8,points:[[4,25],[4,-7]]},"}":{width:14,points:[[5,25],[7,24],[8,23],[9,21],[9,19],[8,17],[7,16],[6,14],[6,12],[8,10],[-1,-1],[7,24],[8,22],[8,20],[7,18],[6,17],[5,15],[5,13],[6,11],[10,9],[6,7],[5,5],[5,3],[6,1],[7,0],[8,-2],[8,-4],[7,-6],[-1,-1],[8,8],[6,6],[6,4],[7,2],[8,1],[9,-1],[9,-3],[8,-5],[7,-6],[5,-7]]},"~":{width:24,points:[[3,6],[3,8],[4,11],[6,12],[8,12],[10,11],[14,8],[16,7],[18,7],[20,8],[21,10],[-1,-1],[3,8],[4,10],[6,11],[8,11],[10,10],[14,7],[16,6],[18,6],[20,7],[21,10],[21,12]]}};
a.jqplot.CanvasFontRenderer=function(b){b=b||{};if(!b.pt2px){b.pt2px=1.5}a.jqplot.CanvasTextRenderer.call(this,b)};a.jqplot.CanvasFontRenderer.prototype=new a.jqplot.CanvasTextRenderer({});a.jqplot.CanvasFontRenderer.prototype.constructor=a.jqplot.CanvasFontRenderer;a.jqplot.CanvasFontRenderer.prototype.measure=function(c,e){var d=this.fontSize+" "+this.fontFamily;c.save();c.font=d;var b=c.measureText(e).width;c.restore();return b};a.jqplot.CanvasFontRenderer.prototype.draw=function(e,g){var c=0;var h=this.height*0.72;e.save();var d,b;if((-Math.PI/2<=this.angle&&this.angle<=0)||(Math.PI*3/2<=this.angle&&this.angle<=Math.PI*2)){d=0;b=-Math.sin(this.angle)*this.width}else{if((0<this.angle&&this.angle<=Math.PI/2)||(-Math.PI*2<=this.angle&&this.angle<=-Math.PI*3/2)){d=Math.sin(this.angle)*this.height;b=0}else{if((-Math.PI<this.angle&&this.angle<-Math.PI/2)||(Math.PI<=this.angle&&this.angle<=Math.PI*3/2)){d=-Math.cos(this.angle)*this.width;b=-Math.sin(this.angle)*this.width-Math.cos(this.angle)*this.height
}else{if((-Math.PI*3/2<this.angle&&this.angle<Math.PI)||(Math.PI/2<this.angle&&this.angle<Math.PI)){d=Math.sin(this.angle)*this.height-Math.cos(this.angle)*this.width;b=-Math.cos(this.angle)*this.height}}}}e.strokeStyle=this.fillStyle;e.fillStyle=this.fillStyle;var f=this.fontSize+" "+this.fontFamily;e.font=f;e.translate(d,b);e.rotate(this.angle);e.fillText(g,c,h);e.restore()}})(jQuery);(function(a){a.jqplot.CanvasAxisTickRenderer=function(b){this.mark="outside";this.showMark=true;this.showGridline=true;this.isMinorTick=false;this.angle=0;this.markSize=4;this.show=true;this.showLabel=true;this.labelPosition="auto";this.label="";this.value=null;this._styles={};this.formatter=a.jqplot.DefaultTickFormatter;this.formatString="";this.prefix="";this.fontFamily='"Trebuchet MS", Arial, Helvetica, sans-serif';this.fontSize="10pt";this.fontWeight="normal";this.fontStretch=1;this.textColor="#666666";this.enableFontSupport=true;this.pt2px=null;this._elem;this._ctx;this._plotWidth;this._plotHeight;this._plotDimensions={height:null,width:null};
a.extend(true,this,b);var c={fontSize:this.fontSize,fontWeight:this.fontWeight,fontStretch:this.fontStretch,fillStyle:this.textColor,angle:this.getAngleRad(),fontFamily:this.fontFamily};if(this.pt2px){c.pt2px=this.pt2px}if(this.enableFontSupport){if(a.jqplot.support_canvas_text()){this._textRenderer=new a.jqplot.CanvasFontRenderer(c)}else{this._textRenderer=new a.jqplot.CanvasTextRenderer(c)}}else{this._textRenderer=new a.jqplot.CanvasTextRenderer(c)}};a.jqplot.CanvasAxisTickRenderer.prototype.init=function(b){a.extend(true,this,b);this._textRenderer.init({fontSize:this.fontSize,fontWeight:this.fontWeight,fontStretch:this.fontStretch,fillStyle:this.textColor,angle:this.getAngleRad(),fontFamily:this.fontFamily})};a.jqplot.CanvasAxisTickRenderer.prototype.getWidth=function(d){if(this._elem){return this._elem.outerWidth(true)}else{var f=this._textRenderer;var c=f.getWidth(d);var e=f.getHeight(d);var b=Math.abs(Math.sin(f.angle)*e)+Math.abs(Math.cos(f.angle)*c);return b}};a.jqplot.CanvasAxisTickRenderer.prototype.getHeight=function(d){if(this._elem){return this._elem.outerHeight(true)
}else{var f=this._textRenderer;var c=f.getWidth(d);var e=f.getHeight(d);var b=Math.abs(Math.cos(f.angle)*e)+Math.abs(Math.sin(f.angle)*c);return b}};a.jqplot.CanvasAxisTickRenderer.prototype.getTop=function(b){if(this._elem){return this._elem.position().top}else{return null}};a.jqplot.CanvasAxisTickRenderer.prototype.getAngleRad=function(){var b=this.angle*Math.PI/180;return b};a.jqplot.CanvasAxisTickRenderer.prototype.setTick=function(b,d,c){this.value=b;if(c){this.isMinorTick=true}return this};a.jqplot.CanvasAxisTickRenderer.prototype.draw=function(c,f){if(!this.label){this.label=this.prefix+this.formatter(this.formatString,this.value)}if(this._elem){if(a.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==undefined){window.G_vmlCanvasManager.uninitElement(this._elem.get(0))}this._elem.emptyForce();this._elem=null}var e=f.canvasManager.getCanvas();this._textRenderer.setText(this.label,c);var b=this.getWidth(c);var d=this.getHeight(c);e.width=b;e.height=d;e.style.width=b;e.style.height=d;
e.style.textAlign="left";e.style.position="absolute";e=f.canvasManager.initCanvas(e);this._elem=a(e);this._elem.css(this._styles);this._elem.addClass("jqplot-"+this.axis+"-tick");e=null;return this._elem};a.jqplot.CanvasAxisTickRenderer.prototype.pack=function(){this._textRenderer.draw(this._elem.get(0).getContext("2d"),this.label)}})(jQuery);
;(function(global){"use strict";var lastId=-1;var self={onVisible:function(callback){var support=self.isSupported();if(!support||!self.hidden()){callback();return support;}
var listener=self.change(function(e,state){if(!self.hidden()){self.unbind(listener);callback();}});return listener;},change:function(callback){if(!self.isSupported()){return false;}
lastId+=1;var number=lastId;self._callbacks[number]=callback;self._listen();return number;},unbind:function(id){delete self._callbacks[id];},afterPrerendering:function(callback){var support=self.isSupported();var prerender='prerender';if(!support||prerender!=self.state()){callback();return support;}
var listener=self.change(function(e,state){if(prerender!=state){self.unbind(listener);callback();}});return listener;},hidden:function(){return!!(self._doc.hidden||self._doc.webkitHidden);},state:function(){return self._doc.visibilityState||self._doc.webkitVisibilityState||'visible';},isSupported:function(){return!!(self._doc.visibilityState||self._doc.webkitVisibilityState);},_doc:document||{},_callbacks:{},_change:function(event){var state=self.state();for(var i in self._callbacks){self._callbacks[i].call(self._doc,event,state);}},_listen:function(){if(self._init){return;}
var event='visibilitychange';if(self._doc.webkitVisibilityState){event='webkit'+event;}
var listener=function(){self._change.apply(self,arguments);};if(self._doc.addEventListener){self._doc.addEventListener(event,listener);}else{self._doc.attachEvent(event,listener);}
self._init=true;}};if(typeof(module)!='undefined'&&module.exports){module.exports=self;}else{global.Visibility=self;}})(this);
/** echo  * @license echo  * while read i do echo  *  done echo
*/
!function(){var Color,K,PITHIRD,TWOPI,X,Y,Z,bezier,brewer,chroma,clip_rgb,colors,cos,css2rgb,hex2rgb,hsi2rgb,hsl2rgb,hsv2rgb,lab2lch,lab2rgb,lab_xyz,lch2lab,lch2rgb,limit,luminance,luminance_x,rgb2hex,rgb2hsi,rgb2hsl,rgb2hsv,rgb2lab,rgb2lch,rgb_xyz,root,type,unpack,xyz_lab,xyz_rgb,_ref;chroma=function(x,y,z,m){return new Color(x,y,z,m)};if(typeof module!=="undefined"&&module!==null&&module.exports!=null){module.exports=chroma}if(typeof define==="function"&&define.amd){define([],function(){return chroma})}else{root=typeof exports!=="undefined"&&exports!==null?exports:this;root.chroma=chroma}chroma.color=function(x,y,z,m){return new Color(x,y,z,m)};chroma.hsl=function(h,s,l,a){return new Color(h,s,l,a,"hsl")};chroma.hsv=function(h,s,v,a){return new Color(h,s,v,a,"hsv")};chroma.rgb=function(r,g,b,a){return new Color(r,g,b,a,"rgb")};chroma.hex=function(x){return new Color(x)};chroma.css=function(x){return new Color(x)};chroma.lab=function(l,a,b){return new Color(l,a,b,"lab")};chroma.lch=function(l,c,h){return new Color(l,c,h,"lch")};chroma.hsi=function(h,s,i){return new Color(h,s,i,"hsi")};chroma.gl=function(r,g,b,a){return new Color(r*255,g*255,b*255,a,"gl")};chroma.interpolate=function(a,b,f,m){if(a==null||b==null){return"#000"}if(type(a)==="string"){a=new Color(a)}if(type(b)==="string"){b=new Color(b)}return a.interpolate(f,b,m)};chroma.mix=chroma.interpolate;chroma.contrast=function(a,b){var l1,l2;if(type(a)==="string"){a=new Color(a)}if(type(b)==="string"){b=new Color(b)}l1=a.luminance();l2=b.luminance();if(l1>l2){return(l1+.05)/(l2+.05)}else{return(l2+.05)/(l1+.05)}};chroma.luminance=function(color){return chroma(color).luminance()};chroma._Color=Color;Color=function(){function Color(){var a,arg,args,m,me,me_rgb,x,y,z,_i,_len,_ref,_ref1,_ref2,_ref3,_ref4;me=this;args=[];for(_i=0,_len=arguments.length;_i<_len;_i++){arg=arguments[_i];if(arg!=null){args.push(arg)}}if(args.length===0){_ref=[255,0,255,1,"rgb"],x=_ref[0],y=_ref[1],z=_ref[2],a=_ref[3],m=_ref[4]}else if(type(args[0])==="array"){if(args[0].length===3){_ref1=args[0],x=_ref1[0],y=_ref1[1],z=_ref1[2];a=1}else if(args[0].length===4){_ref2=args[0],x=_ref2[0],y=_ref2[1],z=_ref2[2],a=_ref2[3]}else{throw"unknown input argument"}m=(_ref3=args[1])!=null?_ref3:"rgb"}else if(type(args[0])==="string"){x=args[0];m="hex"}else if(type(args[0])==="object"){_ref4=args[0]._rgb,x=_ref4[0],y=_ref4[1],z=_ref4[2],a=_ref4[3];m="rgb"}else if(args.length>=3){x=args[0];y=args[1];z=args[2]}if(args.length===3){m="rgb";a=1}else if(args.length===4){if(type(args[3])==="string"){m=args[3];a=1}else if(type(args[3])==="number"){m="rgb";a=args[3]}}else if(args.length===5){a=args[3];m=args[4]}if(a==null){a=1}if(m==="rgb"){me._rgb=[x,y,z,a]}else if(m==="gl"){me._rgb=[x*255,y*255,z*255,a]}else if(m==="hsl"){me._rgb=hsl2rgb(x,y,z);me._rgb[3]=a}else if(m==="hsv"){me._rgb=hsv2rgb(x,y,z);me._rgb[3]=a}else if(m==="hex"){me._rgb=hex2rgb(x)}else if(m==="lab"){me._rgb=lab2rgb(x,y,z);me._rgb[3]=a}else if(m==="lch"){me._rgb=lch2rgb(x,y,z);me._rgb[3]=a}else if(m==="hsi"){me._rgb=hsi2rgb(x,y,z);me._rgb[3]=a}me_rgb=clip_rgb(me._rgb)}Color.prototype.rgb=function(){return this._rgb.slice(0,3)};Color.prototype.rgba=function(){return this._rgb};Color.prototype.hex=function(){return rgb2hex(this._rgb)};Color.prototype.toString=function(){return this.name()};Color.prototype.hsl=function(){return rgb2hsl(this._rgb)};Color.prototype.hsv=function(){return rgb2hsv(this._rgb)};Color.prototype.lab=function(){return rgb2lab(this._rgb)};Color.prototype.lch=function(){return rgb2lch(this._rgb)};Color.prototype.hsi=function(){return rgb2hsi(this._rgb)};Color.prototype.gl=function(){return[this._rgb[0]/255,this._rgb[1]/255,this._rgb[2]/255,this._rgb[3]]};Color.prototype.luminance=function(){return luminance(this._rgb)};Color.prototype.name=function(){var h,k;h=this.hex();for(k in chroma.colors){if(h===chroma.colors[k]){return k}}return h};Color.prototype.alpha=function(alpha){if(arguments.length){this._rgb[3]=alpha;return this}return this._rgb[3]};Color.prototype.css=function(mode){var hsl,me,rgb,rnd;if(mode==null){mode="rgb"}me=this;rgb=me._rgb;if(mode.length===3&&rgb[3]<1){mode+="a"}if(mode==="rgb"){return mode+"("+rgb.slice(0,3).map(Math.round).join(",")+")"}else if(mode==="rgba"){return mode+"("+rgb.slice(0,3).map(Math.round).join(",")+","+rgb[3]+")"}else if(mode==="hsl"||mode==="hsla"){hsl=me.hsl();rnd=function(a){return Math.round(a*100)/100};hsl[0]=rnd(hsl[0]);hsl[1]=rnd(hsl[1]*100)+"%";hsl[2]=rnd(hsl[2]*100)+"%";if(mode.length===4){hsl[3]=rgb[3]}return mode+"("+hsl.join(",")+")"}};Color.prototype.interpolate=function(f,col,m){var dh,hue,hue0,hue1,lbv,lbv0,lbv1,me,res,sat,sat0,sat1,xyz0,xyz1;me=this;if(m==null){m="rgb"}if(type(col)==="string"){col=new Color(col)}if(m==="hsl"||m==="hsv"||m==="lch"||m==="hsi"){if(m==="hsl"){xyz0=me.hsl();xyz1=col.hsl()}else if(m==="hsv"){xyz0=me.hsv();xyz1=col.hsv()}else if(m==="hsi"){xyz0=me.hsi();xyz1=col.hsi()}else if(m==="lch"){xyz0=me.lch();xyz1=col.lch()}if(m.substr(0,1)==="h"){hue0=xyz0[0],sat0=xyz0[1],lbv0=xyz0[2];hue1=xyz1[0],sat1=xyz1[1],lbv1=xyz1[2]}else{lbv0=xyz0[0],sat0=xyz0[1],hue0=xyz0[2];lbv1=xyz1[0],sat1=xyz1[1],hue1=xyz1[2]}if(!isNaN(hue0)&&!isNaN(hue1)){if(hue1>hue0&&hue1-hue0>180){dh=hue1-(hue0+360)}else if(hue1<hue0&&hue0-hue1>180){dh=hue1+360-hue0}else{dh=hue1-hue0}hue=hue0+f*dh}else if(!isNaN(hue0)){hue=hue0;if((lbv1===1||lbv1===0)&&m!=="hsv"){sat=sat0}}else if(!isNaN(hue1)){hue=hue1;if((lbv0===1||lbv0===0)&&m!=="hsv"){sat=sat1}}else{hue=Number.NaN}if(sat==null){sat=sat0+f*(sat1-sat0)}lbv=lbv0+f*(lbv1-lbv0);if(m.substr(0,1)==="h"){res=new Color(hue,sat,lbv,m)}else{res=new Color(lbv,sat,hue,m)}}else if(m==="rgb"){xyz0=me._rgb;xyz1=col._rgb;res=new Color(xyz0[0]+f*(xyz1[0]-xyz0[0]),xyz0[1]+f*(xyz1[1]-xyz0[1]),xyz0[2]+f*(xyz1[2]-xyz0[2]),m)}else if(m==="lab"){xyz0=me.lab();xyz1=col.lab();res=new Color(xyz0[0]+f*(xyz1[0]-xyz0[0]),xyz0[1]+f*(xyz1[1]-xyz0[1]),xyz0[2]+f*(xyz1[2]-xyz0[2]),m)}else{throw"color mode "+m+" is not supported"}res.alpha(me.alpha()+f*(col.alpha()-me.alpha()));return res};Color.prototype.premultiply=function(){var a,rgb;rgb=this.rgb();a=this.alpha();return chroma(rgb[0]*a,rgb[1]*a,rgb[2]*a,a)};Color.prototype.darken=function(amount){var lch,me;if(amount==null){amount=20}me=this;lch=me.lch();lch[0]-=amount;return chroma.lch(lch).alpha(me.alpha())};Color.prototype.darker=function(amount){return this.darken(amount)};Color.prototype.brighten=function(amount){if(amount==null){amount=20}return this.darken(-amount)};Color.prototype.brighter=function(amount){return this.brighten(amount)};Color.prototype.saturate=function(amount){var lch,me;if(amount==null){amount=20}me=this;lch=me.lch();lch[1]+=amount;return chroma.lch(lch).alpha(me.alpha())};Color.prototype.desaturate=function(amount){if(amount==null){amount=20}return this.saturate(-amount)};return Color}();clip_rgb=function(rgb){var i;for(i in rgb){if(i<3){if(rgb[i]<0){rgb[i]=0}if(rgb[i]>255){rgb[i]=255}}else if(i===3){if(rgb[i]<0){rgb[i]=0}if(rgb[i]>1){rgb[i]=1}}}return rgb};css2rgb=function(css){var hsl,i,m,rgb,_i,_j,_k,_l;css=css.toLowerCase();if(chroma.colors!=null&&chroma.colors[css]){return hex2rgb(chroma.colors[css])}if(m=css.match(/rgb\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*\)/)){rgb=m.slice(1,4);for(i=_i=0;_i<=2;i=++_i){rgb[i]=+rgb[i]}rgb[3]=1}else if(m=css.match(/rgba\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*,\s*([01]|[01]?\.\d+)\)/)){rgb=m.slice(1,5);for(i=_j=0;_j<=3;i=++_j){rgb[i]=+rgb[i]}}else if(m=css.match(/rgb\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/)){rgb=m.slice(1,4);for(i=_k=0;_k<=2;i=++_k){rgb[i]=Math.round(rgb[i]*2.55)}rgb[3]=1}else if(m=css.match(/rgba\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/)){rgb=m.slice(1,5);for(i=_l=0;_l<=2;i=++_l){rgb[i]=Math.round(rgb[i]*2.55)}rgb[3]=+rgb[3]}else if(m=css.match(/hsl\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/)){hsl=m.slice(1,4);hsl[1]*=.01;hsl[2]*=.01;rgb=hsl2rgb(hsl);rgb[3]=1}else if(m=css.match(/hsla\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/)){hsl=m.slice(1,4);hsl[1]*=.01;hsl[2]*=.01;rgb=hsl2rgb(hsl);rgb[3]=+m[4]}return rgb};hex2rgb=function(hex){var a,b,g,r,rgb,u;if(hex.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)){if(hex.length===4||hex.length===7){hex=hex.substr(1)}if(hex.length===3){hex=hex.split("");hex=hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]}u=parseInt(hex,16);r=u>>16;g=u>>8&255;b=u&255;return[r,g,b,1]}if(hex.match(/^#?([A-Fa-f0-9]{8})$/)){if(hex.length===9){hex=hex.substr(1)}u=parseInt(hex,16);r=u>>24&255;g=u>>16&255;b=u>>8&255;a=u&255;return[r,g,b,a]}if(rgb=css2rgb(hex)){return rgb}throw"unknown color: "+hex};hsi2rgb=function(h,s,i){var b,g,r,_ref;_ref=unpack(arguments),h=_ref[0],s=_ref[1],i=_ref[2];h/=360;if(h<1/3){b=(1-s)/3;r=(1+s*cos(TWOPI*h)/cos(PITHIRD-TWOPI*h))/3;g=1-(b+r)}else if(h<2/3){h-=1/3;r=(1-s)/3;g=(1+s*cos(TWOPI*h)/cos(PITHIRD-TWOPI*h))/3;b=1-(r+g)}else{h-=2/3;g=(1-s)/3;b=(1+s*cos(TWOPI*h)/cos(PITHIRD-TWOPI*h))/3;r=1-(g+b)}r=limit(i*r*3);g=limit(i*g*3);b=limit(i*b*3);return[r*255,g*255,b*255]};hsl2rgb=function(){var b,c,g,h,i,l,r,s,t1,t2,t3,_i,_ref,_ref1;_ref=unpack(arguments),h=_ref[0],s=_ref[1],l=_ref[2];if(s===0){r=g=b=l*255}else{t3=[0,0,0];c=[0,0,0];t2=l<.5?l*(1+s):l+s-l*s;t1=2*l-t2;h/=360;t3[0]=h+1/3;t3[1]=h;t3[2]=h-1/3;for(i=_i=0;_i<=2;i=++_i){if(t3[i]<0){t3[i]+=1}if(t3[i]>1){t3[i]-=1}if(6*t3[i]<1){c[i]=t1+(t2-t1)*6*t3[i]}else if(2*t3[i]<1){c[i]=t2}else if(3*t3[i]<2){c[i]=t1+(t2-t1)*(2/3-t3[i])*6}else{c[i]=t1}}_ref1=[Math.round(c[0]*255),Math.round(c[1]*255),Math.round(c[2]*255)],r=_ref1[0],g=_ref1[1],b=_ref1[2]}return[r,g,b]};hsv2rgb=function(){var b,f,g,h,i,p,q,r,s,t,v,_ref,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6;_ref=unpack(arguments),h=_ref[0],s=_ref[1],v=_ref[2];v*=255;if(s===0){r=g=b=v}else{if(h===360){h=0}if(h>360){h-=360}if(h<0){h+=360}h/=60;i=Math.floor(h);f=h-i;p=v*(1-s);q=v*(1-s*f);t=v*(1-s*(1-f));switch(i){case 0:_ref1=[v,t,p],r=_ref1[0],g=_ref1[1],b=_ref1[2];break;case 1:_ref2=[q,v,p],r=_ref2[0],g=_ref2[1],b=_ref2[2];break;case 2:_ref3=[p,v,t],r=_ref3[0],g=_ref3[1],b=_ref3[2];break;case 3:_ref4=[p,q,v],r=_ref4[0],g=_ref4[1],b=_ref4[2];break;case 4:_ref5=[t,p,v],r=_ref5[0],g=_ref5[1],b=_ref5[2];break;case 5:_ref6=[v,p,q],r=_ref6[0],g=_ref6[1],b=_ref6[2]}}r=Math.round(r);g=Math.round(g);b=Math.round(b);return[r,g,b]};K=18;X=.95047;Y=1;Z=1.08883;lab2lch=function(){var a,b,c,h,l,_ref;_ref=unpack(arguments),l=_ref[0],a=_ref[1],b=_ref[2];c=Math.sqrt(a*a+b*b);h=Math.atan2(b,a)/Math.PI*180;return[l,c,h]};lab2rgb=function(l,a,b){var g,r,x,y,z,_ref,_ref1;if(l!==void 0&&l.length===3){_ref=l,l=_ref[0],a=_ref[1],b=_ref[2]}if(l!==void 0&&l.length===3){_ref1=l,l=_ref1[0],a=_ref1[1],b=_ref1[2]}y=(l+16)/116;x=y+a/500;z=y-b/200;x=lab_xyz(x)*X;y=lab_xyz(y)*Y;z=lab_xyz(z)*Z;r=xyz_rgb(3.2404542*x-1.5371385*y-.4985314*z);g=xyz_rgb(-.969266*x+1.8760108*y+.041556*z);b=xyz_rgb(.0556434*x-.2040259*y+1.0572252*z);return[limit(r,0,255),limit(g,0,255),limit(b,0,255),1]};lab_xyz=function(x){if(x>.206893034){return x*x*x}else{return(x-4/29)/7.787037}};xyz_rgb=function(r){return Math.round(255*(r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055))};lch2lab=function(){var c,h,l,_ref;_ref=unpack(arguments),l=_ref[0],c=_ref[1],h=_ref[2];h=h*Math.PI/180;return[l,Math.cos(h)*c,Math.sin(h)*c]};lch2rgb=function(l,c,h){var L,a,b,g,r,_ref,_ref1;_ref=lch2lab(l,c,h),L=_ref[0],a=_ref[1],b=_ref[2];_ref1=lab2rgb(L,a,b),r=_ref1[0],g=_ref1[1],b=_ref1[2];return[limit(r,0,255),limit(g,0,255),limit(b,0,255)]};luminance=function(r,g,b){var _ref;_ref=unpack(arguments),r=_ref[0],g=_ref[1],b=_ref[2];r=luminance_x(r);g=luminance_x(g);b=luminance_x(b);return.2126*r+.7152*g+.0722*b};luminance_x=function(x){x/=255;if(x<=.03928){return x/12.92}else{return Math.pow((x+.055)/1.055,2.4)}};rgb2hex=function(){var b,g,r,str,u,_ref;_ref=unpack(arguments),r=_ref[0],g=_ref[1],b=_ref[2];u=r<<16|g<<8|b;str="000000"+u.toString(16);return"#"+str.substr(str.length-6)};rgb2hsi=function(){var TWOPI,b,g,h,i,min,r,s,_ref;_ref=unpack(arguments),r=_ref[0],g=_ref[1],b=_ref[2];TWOPI=Math.PI*2;r/=255;g/=255;b/=255;min=Math.min(r,g,b);i=(r+g+b)/3;s=1-min/i;if(s===0){h=0}else{h=(r-g+(r-b))/2;h/=Math.sqrt((r-g)*(r-g)+(r-b)*(g-b));h=Math.acos(h);if(b>g){h=TWOPI-h}h/=TWOPI}return[h*360,s,i]};rgb2hsl=function(r,g,b){var h,l,max,min,s,_ref;if(r!==void 0&&r.length>=3){_ref=r,r=_ref[0],g=_ref[1],b=_ref[2]}r/=255;g/=255;b/=255;min=Math.min(r,g,b);max=Math.max(r,g,b);l=(max+min)/2;if(max===min){s=0;h=Number.NaN}else{s=l<.5?(max-min)/(max+min):(max-min)/(2-max-min)}if(r===max){h=(g-b)/(max-min)}else if(g===max){h=2+(b-r)/(max-min)}else if(b===max){h=4+(r-g)/(max-min)}h*=60;if(h<0){h+=360}return[h,s,l]};rgb2hsv=function(){var b,delta,g,h,max,min,r,s,v,_ref;_ref=unpack(arguments),r=_ref[0],g=_ref[1],b=_ref[2];min=Math.min(r,g,b);max=Math.max(r,g,b);delta=max-min;v=max/255;if(max===0){h=Number.NaN;s=0}else{s=delta/max;if(r===max){h=(g-b)/delta}if(g===max){h=2+(b-r)/delta}if(b===max){h=4+(r-g)/delta}h*=60;if(h<0){h+=360}}return[h,s,v]};rgb2lab=function(){var b,g,r,x,y,z,_ref;_ref=unpack(arguments),r=_ref[0],g=_ref[1],b=_ref[2];r=rgb_xyz(r);g=rgb_xyz(g);b=rgb_xyz(b);x=xyz_lab((.4124564*r+.3575761*g+.1804375*b)/X);y=xyz_lab((.2126729*r+.7151522*g+.072175*b)/Y);z=xyz_lab((.0193339*r+.119192*g+.9503041*b)/Z);return[116*y-16,500*(x-y),200*(y-z)]};rgb_xyz=function(r){if((r/=255)<=.04045){return r/12.92}else{return Math.pow((r+.055)/1.055,2.4)}};xyz_lab=function(x){if(x>.008856){return Math.pow(x,1/3)}else{return 7.787037*x+4/29}};rgb2lch=function(){var a,b,g,l,r,_ref,_ref1;_ref=unpack(arguments),r=_ref[0],g=_ref[1],b=_ref[2];_ref1=rgb2lab(r,g,b),l=_ref1[0],a=_ref1[1],b=_ref1[2];return lab2lch(l,a,b)};chroma.scale=function(colors,positions){var classifyValue,f,getClass,getColor,resetCache,setColors,setDomain,tmap,_colorCache,_colors,_correctLightness,_domain,_fixed,_max,_min,_mode,_nacol,_numClasses,_out,_pos,_spread;_mode="rgb";_nacol=chroma("#ccc");_spread=0;_fixed=false;_domain=[0,1];_colors=[];_out=false;_pos=[];_min=0;_max=1;_correctLightness=false;_numClasses=0;_colorCache={};setColors=function(colors,positions){var c,col,_i,_j,_ref,_ref1,_ref2;if(colors==null){colors=["#ddd","#222"]}if(colors!=null&&type(colors)==="string"&&((_ref=chroma.brewer)!=null?_ref[colors]:void 0)!=null){colors=chroma.brewer[colors]}if(type(colors)==="array"){colors=colors.slice(0);for(c=_i=0,_ref1=colors.length-1;0<=_ref1?_i<=_ref1:_i>=_ref1;c=0<=_ref1?++_i:--_i){col=colors[c];if(type(col)==="string"){colors[c]=chroma(col)}}if(positions!=null){_pos=positions}else{_pos=[];for(c=_j=0,_ref2=colors.length-1;0<=_ref2?_j<=_ref2:_j>=_ref2;c=0<=_ref2?++_j:--_j){_pos.push(c/(colors.length-1))}}}resetCache();return _colors=colors};setDomain=function(domain){if(domain==null){domain=[]}_domain=domain;_min=domain[0];_max=domain[domain.length-1];resetCache();if(domain.length===2){return _numClasses=0}else{return _numClasses=domain.length-1}};getClass=function(value){var i,n;if(_domain!=null){n=_domain.length-1;i=0;while(i<n&&value>=_domain[i]){i++}return i-1}return 0};tmap=function(t){return t};classifyValue=function(value){var i,maxc,minc,n,val;val=value;if(_domain.length>2){n=_domain.length-1;i=getClass(value);minc=_domain[0]+(_domain[1]-_domain[0])*(0+_spread*.5);maxc=_domain[n-1]+(_domain[n]-_domain[n-1])*(1-_spread*.5);val=_min+(_domain[i]+(_domain[i+1]-_domain[i])*.5-minc)/(maxc-minc)*(_max-_min)}return val};getColor=function(val,bypassMap){var c,col,f0,i,k,p,t,_i,_ref;if(bypassMap==null){bypassMap=false}if(isNaN(val)){return _nacol}if(!bypassMap){if(_domain.length>2){c=getClass(val);t=c/(_numClasses-1)}else{t=f0=(val-_min)/(_max-_min);t=Math.min(1,Math.max(0,t))}}else{t=val}if(!bypassMap){t=tmap(t)}k=Math.floor(t*1e4);if(_colorCache[k]){col=_colorCache[k]}else{if(type(_colors)==="array"){for(i=_i=0,_ref=_pos.length-1;0<=_ref?_i<=_ref:_i>=_ref;i=0<=_ref?++_i:--_i){p=_pos[i];if(t<=p){col=_colors[i];break}if(t>=p&&i===_pos.length-1){col=_colors[i];break}if(t>p&&t<_pos[i+1]){t=(t-p)/(_pos[i+1]-p);col=chroma.interpolate(_colors[i],_colors[i+1],t,_mode);break}}}else if(type(_colors)==="function"){col=_colors(t)}_colorCache[k]=col}return col};resetCache=function(){return _colorCache={}};setColors(colors,positions);f=function(v){var c;c=getColor(v);if(_out&&c[_out]){return c[_out]()}else{return c}};f.domain=function(domain,classes,mode,key){var d;if(mode==null){mode="e"}if(!arguments.length){return _domain}if(classes!=null){d=chroma.analyze(domain,key);if(classes===0){domain=[d.min,d.max]}else{domain=chroma.limits(d,mode,classes)}}setDomain(domain);return f};f.mode=function(_m){if(!arguments.length){return _mode}_mode=_m;resetCache();return f};f.range=function(colors,_pos){setColors(colors,_pos);return f};f.out=function(_o){_out=_o;return f};f.spread=function(val){if(!arguments.length){return _spread}_spread=val;return f};f.correctLightness=function(v){if(!arguments.length){return _correctLightness}_correctLightness=v;resetCache();if(_correctLightness){tmap=function(t){var L0,L1,L_actual,L_diff,L_ideal,max_iter,pol,t0,t1;L0=getColor(0,true).lab()[0];L1=getColor(1,true).lab()[0];pol=L0>L1;L_actual=getColor(t,true).lab()[0];L_ideal=L0+(L1-L0)*t;L_diff=L_actual-L_ideal;t0=0;t1=1;max_iter=20;while(Math.abs(L_diff)>.01&&max_iter-->0){!function(){if(pol){L_diff*=-1}if(L_diff<0){t0=t;t+=(t1-t)*.5}else{t1=t;t+=(t0-t)*.5}L_actual=getColor(t,true).lab()[0];return L_diff=L_actual-L_ideal}()}return t}}else{tmap=function(t){return t}}return f};f.colors=function(out){var i,samples,_i,_j,_len,_ref;if(out==null){out="hex"}colors=[];samples=[];if(_domain.length>2){for(i=_i=1,_ref=_domain.length;1<=_ref?_i<_ref:_i>_ref;i=1<=_ref?++_i:--_i){samples.push((_domain[i-1]+_domain[i])*.5)}}else{samples=_domain}for(_j=0,_len=samples.length;_j<_len;_j++){i=samples[_j];colors.push(f(i)[out]())}return colors};return f};if((_ref=chroma.scales)==null){chroma.scales={}}chroma.scales.cool=function(){return chroma.scale([chroma.hsl(180,1,.9),chroma.hsl(250,.7,.4)])};chroma.scales.hot=function(){return chroma.scale(["#000","#f00","#ff0","#fff"],[0,.25,.75,1]).mode("rgb")};chroma.analyze=function(data,key,filter){var add,k,r,val,visit,_i,_len;r={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};if(filter==null){filter=function(){return true}}add=function(val){if(val!=null&&!isNaN(val)){r.values.push(val);r.sum+=val;if(val<r.min){r.min=val}if(val>r.max){r.max=val}r.count+=1}};visit=function(val,k){if(filter(val,k)){if(key!=null&&type(key)==="function"){return add(key(val))}else if(key!=null&&type(key)==="string"||type(key)==="number"){return add(val[key])}else{return add(val)}}};if(type(data)==="array"){for(_i=0,_len=data.length;_i<_len;_i++){val=data[_i];visit(val)}}else{for(k in data){val=data[k];visit(val,k)}}r.domain=[r.min,r.max];r.limits=function(mode,num){return chroma.limits(r,mode,num)};return r};chroma.limits=function(data,mode,num){var assignments,best,centroids,cluster,clusterSizes,dist,i,j,kClusters,limits,max,max_log,min,min_log,mindist,n,nb_iters,newCentroids,p,pb,pr,repeat,sum,tmpKMeansBreaks,value,values,_i,_j,_k,_l,_m,_n,_o,_p,_q,_r,_ref1,_ref10,_ref11,_ref12,_ref13,_ref14,_ref15,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8,_ref9,_s,_t,_u,_v,_w;if(mode==null){mode="equal"}if(num==null){num=7}if(type(data)==="array"){data=chroma.analyze(data)}min=data.min;max=data.max;sum=data.sum;values=data.values.sort(function(a,b){return a-b});limits=[];if(mode.substr(0,1)==="c"){limits.push(min);limits.push(max)}if(mode.substr(0,1)==="e"){limits.push(min);for(i=_i=1,_ref1=num-1;1<=_ref1?_i<=_ref1:_i>=_ref1;i=1<=_ref1?++_i:--_i){limits.push(min+i/num*(max-min))}limits.push(max)}else if(mode.substr(0,1)==="l"){if(min<=0){throw"Logarithmic scales are only possible for values > 0"}min_log=Math.LOG10E*Math.log(min);max_log=Math.LOG10E*Math.log(max);limits.push(min);for(i=_j=1,_ref2=num-1;1<=_ref2?_j<=_ref2:_j>=_ref2;i=1<=_ref2?++_j:--_j){limits.push(Math.pow(10,min_log+i/num*(max_log-min_log)))}limits.push(max)}else if(mode.substr(0,1)==="q"){limits.push(min);for(i=_k=1,_ref3=num-1;1<=_ref3?_k<=_ref3:_k>=_ref3;i=1<=_ref3?++_k:--_k){p=values.length*i/num;pb=Math.floor(p);if(pb===p){limits.push(values[pb])}else{pr=p-pb;limits.push(values[pb]*pr+values[pb+1]*(1-pr))}}limits.push(max)}else if(mode.substr(0,1)==="k"){n=values.length;assignments=new Array(n);clusterSizes=new Array(num);repeat=true;nb_iters=0;centroids=null;centroids=[];centroids.push(min);for(i=_l=1,_ref4=num-1;1<=_ref4?_l<=_ref4:_l>=_ref4;i=1<=_ref4?++_l:--_l){centroids.push(min+i/num*(max-min))}centroids.push(max);while(repeat){for(j=_m=0,_ref5=num-1;0<=_ref5?_m<=_ref5:_m>=_ref5;j=0<=_ref5?++_m:--_m){clusterSizes[j]=0}for(i=_n=0,_ref6=n-1;0<=_ref6?_n<=_ref6:_n>=_ref6;i=0<=_ref6?++_n:--_n){value=values[i];mindist=Number.MAX_VALUE;for(j=_o=0,_ref7=num-1;0<=_ref7?_o<=_ref7:_o>=_ref7;j=0<=_ref7?++_o:--_o){dist=Math.abs(centroids[j]-value);if(dist<mindist){mindist=dist;best=j}}clusterSizes[best]++;assignments[i]=best}newCentroids=new Array(num);for(j=_p=0,_ref8=num-1;0<=_ref8?_p<=_ref8:_p>=_ref8;j=0<=_ref8?++_p:--_p){newCentroids[j]=null}for(i=_q=0,_ref9=n-1;0<=_ref9?_q<=_ref9:_q>=_ref9;i=0<=_ref9?++_q:--_q){cluster=assignments[i];if(newCentroids[cluster]===null){newCentroids[cluster]=values[i]}else{newCentroids[cluster]+=values[i]}}for(j=_r=0,_ref10=num-1;0<=_ref10?_r<=_ref10:_r>=_ref10;j=0<=_ref10?++_r:--_r){newCentroids[j]*=1/clusterSizes[j]}repeat=false;for(j=_s=0,_ref11=num-1;0<=_ref11?_s<=_ref11:_s>=_ref11;j=0<=_ref11?++_s:--_s){if(newCentroids[j]!==centroids[i]){repeat=true;break}}centroids=newCentroids;nb_iters++;if(nb_iters>200){repeat=false}}kClusters={};for(j=_t=0,_ref12=num-1;0<=_ref12?_t<=_ref12:_t>=_ref12;j=0<=_ref12?++_t:--_t){kClusters[j]=[]}for(i=_u=0,_ref13=n-1;0<=_ref13?_u<=_ref13:_u>=_ref13;i=0<=_ref13?++_u:--_u){cluster=assignments[i];kClusters[cluster].push(values[i])}tmpKMeansBreaks=[];for(j=_v=0,_ref14=num-1;0<=_ref14?_v<=_ref14:_v>=_ref14;j=0<=_ref14?++_v:--_v){tmpKMeansBreaks.push(kClusters[j][0]);tmpKMeansBreaks.push(kClusters[j][kClusters[j].length-1])}tmpKMeansBreaks=tmpKMeansBreaks.sort(function(a,b){return a-b});limits.push(tmpKMeansBreaks[0]);for(i=_w=1,_ref15=tmpKMeansBreaks.length-1;_w<=_ref15;i=_w+=2){if(!isNaN(tmpKMeansBreaks[i])){limits.push(tmpKMeansBreaks[i])}}}return limits};/**
  	ColorBrewer colors for chroma.js
  
  	Copyright (c) 2002 Cynthia Brewer, Mark Harrower, and The 
  	Pennsylvania State University.
  
  	Licensed under the Apache License, Version 2.0 (the "License"); 
  	you may not use this file except in compliance with the License.
  	You may obtain a copy of the License at	
  	http://www.apache.org/licenses/LICENSE-2.0
  
  	Unless required by applicable law or agreed to in writing, software distributed
  	under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
  	CONDITIONS OF ANY KIND, either express or implied. See the License for the
  	specific language governing permissions and limitations under the License.
  
      @preserve
  */
chroma.brewer=brewer={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]};chroma.colors=colors={indigo:"#4b0082",gold:"#ffd700",hotpink:"#ff69b4",firebrick:"#b22222",indianred:"#cd5c5c",yellow:"#ffff00",mistyrose:"#ffe4e1",darkolivegreen:"#556b2f",olive:"#808000",darkseagreen:"#8fbc8f",pink:"#ffc0cb",tomato:"#ff6347",lightcoral:"#f08080",orangered:"#ff4500",navajowhite:"#ffdead",lime:"#00ff00",palegreen:"#98fb98",darkslategrey:"#2f4f4f",greenyellow:"#adff2f",burlywood:"#deb887",seashell:"#fff5ee",mediumspringgreen:"#00fa9a",fuchsia:"#ff00ff",papayawhip:"#ffefd5",blanchedalmond:"#ffebcd",chartreuse:"#7fff00",dimgray:"#696969",black:"#000000",peachpuff:"#ffdab9",springgreen:"#00ff7f",aquamarine:"#7fffd4",white:"#ffffff",orange:"#ffa500",lightsalmon:"#ffa07a",darkslategray:"#2f4f4f",brown:"#a52a2a",ivory:"#fffff0",dodgerblue:"#1e90ff",peru:"#cd853f",lawngreen:"#7cfc00",chocolate:"#d2691e",crimson:"#dc143c",forestgreen:"#228b22",darkgrey:"#a9a9a9",lightseagreen:"#20b2aa",cyan:"#00ffff",mintcream:"#f5fffa",silver:"#c0c0c0",antiquewhite:"#faebd7",mediumorchid:"#ba55d3",skyblue:"#87ceeb",gray:"#808080",darkturquoise:"#00ced1",goldenrod:"#daa520",darkgreen:"#006400",floralwhite:"#fffaf0",darkviolet:"#9400d3",darkgray:"#a9a9a9",moccasin:"#ffe4b5",saddlebrown:"#8b4513",grey:"#808080",darkslateblue:"#483d8b",lightskyblue:"#87cefa",lightpink:"#ffb6c1",mediumvioletred:"#c71585",slategrey:"#708090",red:"#ff0000",deeppink:"#ff1493",limegreen:"#32cd32",darkmagenta:"#8b008b",palegoldenrod:"#eee8aa",plum:"#dda0dd",turquoise:"#40e0d0",lightgrey:"#d3d3d3",lightgoldenrodyellow:"#fafad2",darkgoldenrod:"#b8860b",lavender:"#e6e6fa",maroon:"#800000",yellowgreen:"#9acd32",sandybrown:"#f4a460",thistle:"#d8bfd8",violet:"#ee82ee",navy:"#000080",magenta:"#ff00ff",dimgrey:"#696969",tan:"#d2b48c",rosybrown:"#bc8f8f",olivedrab:"#6b8e23",blue:"#0000ff",lightblue:"#add8e6",ghostwhite:"#f8f8ff",honeydew:"#f0fff0",cornflowerblue:"#6495ed",slateblue:"#6a5acd",linen:"#faf0e6",darkblue:"#00008b",powderblue:"#b0e0e6",seagreen:"#2e8b57",darkkhaki:"#bdb76b",snow:"#fffafa",sienna:"#a0522d",mediumblue:"#0000cd",royalblue:"#4169e1",lightcyan:"#e0ffff",green:"#008000",mediumpurple:"#9370db",midnightblue:"#191970",cornsilk:"#fff8dc",paleturquoise:"#afeeee",bisque:"#ffe4c4",slategray:"#708090",darkcyan:"#008b8b",khaki:"#f0e68c",wheat:"#f5deb3",teal:"#008080",darkorchid:"#9932cc",deepskyblue:"#00bfff",salmon:"#fa8072",darkred:"#8b0000",steelblue:"#4682b4",palevioletred:"#db7093",lightslategray:"#778899",aliceblue:"#f0f8ff",lightslategrey:"#778899",lightgreen:"#90ee90",orchid:"#da70d6",gainsboro:"#dcdcdc",mediumseagreen:"#3cb371",lightgray:"#d3d3d3",mediumturquoise:"#48d1cc",lemonchiffon:"#fffacd",cadetblue:"#5f9ea0",lightyellow:"#ffffe0",lavenderblush:"#fff0f5",coral:"#ff7f50",purple:"#800080",aqua:"#00ffff",whitesmoke:"#f5f5f5",mediumslateblue:"#7b68ee",darkorange:"#ff8c00",mediumaquamarine:"#66cdaa",darksalmon:"#e9967a",beige:"#f5f5dc",blueviolet:"#8a2be2",azure:"#f0ffff",lightsteelblue:"#b0c4de",oldlace:"#fdf5e6"};type=function(){var classToType,name,_i,_len,_ref1;classToType={};_ref1="Boolean Number String Function Array Date RegExp Undefined Null".split(" ");for(_i=0,_len=_ref1.length;_i<_len;_i++){name=_ref1[_i];classToType["[object "+name+"]"]=name.toLowerCase()}return function(obj){var strType;strType=Object.prototype.toString.call(obj);return classToType[strType]||"object"}}();limit=function(x,min,max){if(min==null){min=0}if(max==null){max=1}if(x<min){x=min}if(x>max){x=max}return x};unpack=function(args){if(args.length>=3){return args}else{return args[0]}};TWOPI=Math.PI*2;PITHIRD=Math.PI/3;cos=Math.cos;bezier=function(colors){var I,I0,I1,c,lab0,lab1,lab2,lab3,_ref1,_ref2,_ref3;colors=function(){var _i,_len,_results;_results=[];for(_i=0,_len=colors.length;_i<_len;_i++){c=colors[_i];_results.push(chroma(c))}return _results}();if(colors.length===2){_ref1=function(){var _i,_len,_results;_results=[];for(_i=0,_len=colors.length;_i<_len;_i++){c=colors[_i];_results.push(c.lab())}return _results}(),lab0=_ref1[0],lab1=_ref1[1];I=function(t){var i,lab;lab=function(){var _i,_results;_results=[];for(i=_i=0;_i<=2;i=++_i){_results.push(lab0[i]+t*(lab1[i]-lab0[i]))}return _results}();return chroma.lab.apply(chroma,lab)}}else if(colors.length===3){_ref2=function(){var _i,_len,_results;_results=[];for(_i=0,_len=colors.length;_i<_len;_i++){c=colors[_i];_results.push(c.lab())}return _results}(),lab0=_ref2[0],lab1=_ref2[1],lab2=_ref2[2];I=function(t){var i,lab;lab=function(){var _i,_results;_results=[];for(i=_i=0;_i<=2;i=++_i){_results.push((1-t)*(1-t)*lab0[i]+2*(1-t)*t*lab1[i]+t*t*lab2[i])}return _results}();return chroma.lab.apply(chroma,lab)}}else if(colors.length===4){_ref3=function(){var _i,_len,_results;_results=[];for(_i=0,_len=colors.length;_i<_len;_i++){c=colors[_i];_results.push(c.lab())}return _results}(),lab0=_ref3[0],lab1=_ref3[1],lab2=_ref3[2],lab3=_ref3[3];I=function(t){var i,lab;lab=function(){var _i,_results;_results=[];for(i=_i=0;_i<=2;i=++_i){_results.push((1-t)*(1-t)*(1-t)*lab0[i]+3*(1-t)*(1-t)*t*lab1[i]+3*(1-t)*t*t*lab2[i]+t*t*t*lab3[i])}return _results}();return chroma.lab.apply(chroma,lab)}}else if(colors.length===5){I0=bezier(colors.slice(0,3));I1=bezier(colors.slice(2,5));I=function(t){if(t<.5){return I0(t*2)}else{return I1((t-.5)*2)}}}return I};chroma.interpolate.bezier=bezier}.call(this);
(function(window){var MODULE_SPLIT_REGEX=/[\/.\\]/;window.require=function(moduleId){var parts=moduleId.split(MODULE_SPLIT_REGEX);var currentModule=window;for(var i=0;i!=parts.length;++i){var part=parts[i];currentModule[part]=currentModule[part]||{};currentModule=currentModule[part];}
return currentModule;};})(window);
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
function _pk_translate(translationStringId,values){if(typeof(piwik_translations[translationStringId])!='undefined'){var translation=piwik_translations[translationStringId];if(typeof values!='undefined'&&values&&values.length){values.unshift(translation);return sprintf.apply(null,values);}
return translation;}
return"The string "+translationStringId+" was not loaded in javascript. Make sure it is added in the Translate.getClientSideTranslationKeys hook.";}
var piwikHelper={htmlDecode:function(value){var textArea=document.createElement('textarea');textArea.innerHTML=value;return textArea.value;},sendContentAsDownload:function(filename,content,mimeType){if(!mimeType){mimeType='text/plain';}
function downloadFile(content){var node=document.createElement('a');node.style.display='none';if('string'===typeof content){node.setAttribute('href','data:'+mimeType+';charset=utf-8,'+encodeURIComponent(content));}else{node.href=window.URL.createObjectURL(blob);}
node.setAttribute('download',filename);document.body.appendChild(node);node.click();document.body.removeChild(node);}
var node;if('function'===typeof Blob){try{var blob=new Blob([content],{type:mimeType});if(window.navigator.msSaveOrOpenBlob){window.navigator.msSaveBlob(blob,filename);return;}else{downloadFile(blob);return;}}catch(e){downloadFile(content);}}
downloadFile(content);},log:function(){try{console.log.apply(console,arguments);}catch(e){try{opera.postError.apply(opera,arguments);}catch(f){}}},error:function(){try{console.error.apply(console,arguments);}catch(e){try{opera.postError.apply(opera,arguments);}catch(f){alert(Array.prototype.join.call(arguments,' '));}}},htmlEntities:function(value){if(!value){return value;}
var findReplace=[[/&/g,"&amp;"],[/</g,"&lt;"],[/>/g,"&gt;"],[/"/g,"&quot;"],[/{{/g,'{&#8291;{']];for(var item in findReplace){value=value.replace(findReplace[item][0],findReplace[item][1]);}
return value;},escape:function(value){var escape=angular.element(document).injector().get('$sanitize');return escape(value);},addBreakpoints:function(text,breakpointMarkup){return text.replace(/([\/&=?\.%#:_-])/g,'$1'+
(typeof breakpointMarkup=='undefined'?'<wbr>&#8203;':breakpointMarkup));},addBreakpointsToUrl:function(url){try{url=decodeURIComponent(url);}catch(e){}
url=piwikHelper.addBreakpoints(url,'|||');url=$(document.createElement('p')).text(url).html();url=url.replace(/\|\|\|/g,'<wbr />&#8203;');return url;},getAngularDependency:function(dependency){return angular.element(document).injector().get(dependency);},compileAngularComponents:function(selector,options){options=options||{};var $element=$(selector);if(!$element.length){return;}
angular.element(document).injector().invoke(function($compile,$rootScope){var scope=null;if(options.scope){scope=options.scope;}else if(!options.forceNewScope){scope=angular.element($element).scope();}
if(!scope){scope=$rootScope.$new(true);}
if(options.params){$.extend(scope,options.params);}
$compile($element)(scope);});},isAlreadyCompiledAngularComponent:function(selector){var $element=$(selector);return($element.length&&$element.hasClass('ng-isolate-scope'));},isAngularRenderingThePage:function(){return $('[piwik-reporting-page]').length;},setMarginLeftToBeInViewport:function(elementToPosition){var availableWidth=$(window).width();$(elementToPosition).css('marginLeft','0px');var offset=$(elementToPosition).offset();if(!offset){return;}
var leftPos=offset.left;if(leftPos<0){leftPos=0;}
var widthSegmentForm=$(elementToPosition).outerWidth();if(leftPos+widthSegmentForm>availableWidth){var extraSpaceForMoreBeauty=16;var newLeft=availableWidth-widthSegmentForm-extraSpaceForMoreBeauty;if(newLeft<extraSpaceForMoreBeauty){newLeft=extraSpaceForMoreBeauty;}
var marginLeft=Math.abs(leftPos-newLeft);if(marginLeft>extraSpaceForMoreBeauty){$(elementToPosition).css('marginLeft',(parseInt(marginLeft,10)*-1)+'px');}}},modalConfirm:function(domSelector,handles,options){if(!options){options={};}
var domElem=$(domSelector);var buttons=[];var content='<div class="modal"><div class="modal-content"></div>';content+='<div class="modal-footer"></div></div>';var $content=$(content).hide();var $footer=$content.find('.modal-footer');$('[role]',domElem).each(function(){var $button=$(this);var role=$button.attr('role');var title=$button.attr('title');var text=$button.val();$button.hide();var button=$('<a href="javascript:;" class="modal-action modal-close waves-effect waves-light btn-flat "></a>');button.text(text);if(title){button.attr('title',title);}
if(typeof handles!=='undefined'&&typeof handles[role]=='function'){button.on('click',function(){handles[role].apply()});}
if(typeof $button.data('href')!=='undefined'){button.on('click',function(){window.location.href=$button.data('href');})}
$footer.append(button);});$('body').append($content);$content.find('.modal-content').append(domElem);if(options&&options.fixedFooter){$content.addClass('modal-fixed-footer');delete options.fixedFooter;}
if(options&&options.extraWide){$content.addClass('modal-extra-wide');delete options.extraWide;}
if(options&&!options.ready){options.ready=function(){$(".modal.open a").focus();var modalContent=$(".modal.open");if(modalContent&&modalContent[0]){modalContent[0].scrollTop=0;}};}
domElem.show();$content.openModal(options);},getQueryStringWithParametersModified:function(queryString,newParameters){if(queryString!=''){var r,i,keyvalue,keysvalues=newParameters.split('&');var appendUrl='';for(i=0;i<keysvalues.length;i++){keyvalue=keysvalues[i].split('=');r=new RegExp('(^|[?&])'+keyvalue[0]+'=[^&]*');queryString=queryString.replace(r,'');if(keyvalue[1].length==0){continue;}
appendUrl+='&'+keyvalue[0]+'='+keyvalue[1];}
queryString+=appendUrl;if(queryString[0]=='&'){queryString='?'+queryString.substring(1);}}else{queryString='?'+newParameters;}
return queryString;},getCurrentQueryStringWithParametersModified:function(newparams){var queryString=String(window.location.search);if(newparams){queryString=this.getQueryStringWithParametersModified(queryString,newparams);}
return String(window.location.pathname)+queryString;},getArrayFromQueryString:function(query){var params={};var vars=query.split("&");for(var i=0;i<vars.length;i++){var keyValue=vars[i].split("=");params[keyValue[0]]=decodeURIComponent(keyValue[1]);}
return params;},getQueryStringFromParameters:function(parameters){var queryString='';if(!parameters||parameters.length==0){return queryString;}
for(var name in parameters){var value=parameters[name];if(typeof value=='object'){for(var i in value){queryString+=name+'[]='+value[i]+'&';}}else{queryString+=name+'='+value+'&';}}
return queryString.substring(0,queryString.length-1);},showAjaxError:function(message,errorDivID){errorDivID=errorDivID||'ajaxError';$('#'+errorDivID).html(message).show();},hideAjaxError:function(errorDivID){errorDivID=errorDivID||'ajaxError';$('#'+errorDivID).hide();},showAjaxLoading:function(loadingDivID){loadingDivID=loadingDivID||'ajaxLoadingDiv';$('#'+loadingDivID).show();},hideAjaxLoading:function(loadingDivID){loadingDivID=loadingDivID||'ajaxLoadingDiv';$('#'+loadingDivID).hide();},refreshAfter:function(timeoutPeriod){if(timeoutPeriod==0){location.reload();}else{setTimeout("location.reload();",timeoutPeriod);}},redirect:function(params){if(typeof params=='object'){params=this.getQueryStringFromParameters(params);}
var urlToRedirect=this.getCurrentQueryStringWithParametersModified(params);var updatedUrl=new RegExp('&updated=([0-9]+)');var updatedCounter=updatedUrl.exec(urlToRedirect);if(!updatedCounter){urlToRedirect+='&updated=1';}else{updatedCounter=1+parseInt(updatedCounter[1]);urlToRedirect=urlToRedirect.replace(new RegExp('(&updated=[0-9]+)'),'&updated='+updatedCounter);}
var currentHashStr=window.location.hash;if(currentHashStr.length>0){urlToRedirect+=currentHashStr;}
this.redirectToUrl(urlToRedirect);},redirectToUrl:function(url){window.location=url;},lazyScrollToContent:function(){this.lazyScrollTo('#content',250);},lazyScrollTo:function(elem,time,forceScroll){var $elem=$(elem);if(!$elem.length){return;}
var elemTop=$elem.offset().top;if(elemTop<$(window).scrollTop()||elemTop>$(window).scrollTop()+$(window).height()||forceScroll){$.scrollTo(elem,time);}},getApiFormatTextarea:function(textareaContent){if(typeof textareaContent=='undefined'){return'';}
return textareaContent.trim().split("\n").join(',');},shortcuts:{},registerShortcut:function(key,description,callback){piwikHelper.shortcuts[key]=description;Mousetrap.bind(key,callback);},calculateEvolution:function(currentValue,pastValue){var dividend=currentValue-pastValue;var divisor=pastValue;if(dividend==0){return 0;}else if(divisor==0){return 1;}else{return Math.round((dividend / divisor)*1000)/ 1000;}}};if(typeof String.prototype.trim!=='function'){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"");};}
function isEnterKey(e){return(window.event?window.event.keyCode:e.which)==13;}
function isEscapeKey(e){return(window.event?window.event.keyCode:e.which)==27;}
(function($){try{var oldArc=CanvasRenderingContext2D.prototype.arc;CanvasRenderingContext2D.prototype.arc=function(x,y,r,sAngle,eAngle,clockwise){if(Math.abs(eAngle-sAngle-Math.PI*2)<0.000001&&!clockwise)
eAngle-=0.000001;oldArc.call(this,x,y,r,sAngle,eAngle,clockwise);};jQuery.ui.dialog.prototype._focusTabbable=$.noop;jQuery(document).keyup(function(e){if(e.keyCode==27){$('.ui-tooltip').hide();}});}catch(e){}}(jQuery));
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
var globalAjaxQueue=[];globalAjaxQueue.active=0;globalAjaxQueue.clean=function(){for(var i=this.length;i--;){if(!this[i]||this[i].readyState==4){this.splice(i,1);}}};globalAjaxQueue.push=function(){this.active+=arguments.length;this.clean();return Array.prototype.push.apply(this,arguments);};globalAjaxQueue.abort=function(){for(var i=this.length;i--;){this[i]&&this[i].abort&&this[i].abort();}
this.splice(0,this.length);this.active=0;};function ajaxHelper(){this.format='json';this.async=true;this.timeout=null;this.callback=function(){};this.useRegularCallbackInCaseOfError=false;this.errorCallback;this.withToken=false;this.completeCallback=function(){};this.getParams={};this.getUrl='?';this.postParams={};this.loadingElement=null;this.errorElement='#ajaxError';this.requestHandle=null;this.defaultParams=['idSite','period','date','segment'];this.addParams=function(params,type){if(typeof params=='string'){params=broadcast.getValuesFromUrl(params);}
var arrayParams=['compareSegments','comparePeriods','compareDates'];for(var key in params){if(arrayParams.indexOf(key)!==-1&&!params[key]){continue;}
if(type.toLowerCase()=='get'){this.getParams[key]=params[key];}else if(type.toLowerCase()=='post'){this.postParams[key]=params[key];}}};this.withTokenInUrl=function(){this.withToken=true;};this.setUrl=function(url){this.addParams(broadcast.getValuesFromUrl(url),'GET');};this.setBulkRequests=function(){var urls=[];for(var i=0;i!=arguments.length;++i){urls.push($.param(arguments[i]));}
this.addParams({module:'API',method:'API.getBulkRequest',urls:urls,format:'json'},'post');};this.setTimeout=function(timeout){this.timeout=timeout;};this.setCallback=function(callback){this.callback=callback;};this.useCallbackInCaseOfError=function(){this.useRegularCallbackInCaseOfError=true;};this.redirectOnSuccess=function(params){this.setCallback(function(){piwikHelper.redirect(params);});};this.setErrorCallback=function(callback){this.errorCallback=callback;};this.setCompleteCallback=function(callback){this.completeCallback=callback;};this.defaultErrorCallback=function(deferred,status){if(status=='abort'){return;}
var loadingError=$('#loadingError');if(Piwik_Popover.isOpen()&&deferred&&deferred.status===500){if(deferred&&deferred.status===500){$(document.body).html(piwikHelper.escape(deferred.responseText));}}else{loadingError.show();}}
this.errorCallback=this.defaultErrorCallback;this.setFormat=function(format){this.format=format;};this.setLoadingElement=function(element){if(!element){element='#ajaxLoadingDiv';}
this.loadingElement=element;};this.setErrorElement=function(element){if(!element){return;}
this.errorElement=element;};this._useGETDefaultParameter=function(parameter){if(parameter&&this.defaultParams){var i;for(i=0;i<this.defaultParams.length;i++){if(this.defaultParams[i]===parameter){return true;}}}
return false;}
this.removeDefaultParameter=function(parameter){if(parameter&&this.defaultParams){var i;for(i=0;i<this.defaultParams.length;i++){if(this.defaultParams[i]===parameter){this.defaultParams.splice(i,1);}}}}
this.send=function(sync){if(sync===true){this.async=false;}
if($(this.errorElement).length){$(this.errorElement).hide();}
if(this.loadingElement){$(this.loadingElement).fadeIn();}
this.requestHandle=this._buildAjaxCall();globalAjaxQueue.push(this.requestHandle);};this.abort=function(){if(this.requestHandle&&typeof this.requestHandle.abort=='function'){this.requestHandle.abort();this.requestHandle=null;}};this._buildAjaxCall=function(){var that=this;var parameters=this._mixinDefaultGetParams(this.getParams);var url=this.getUrl;if(url[url.length-1]!='?'){url+='&';}
if(parameters['segment']){url+='segment='+parameters['segment']+'&';delete parameters['segment'];}
if(parameters['date']){url+='date='+decodeURIComponent(parameters['date'])+'&';delete parameters['date'];}
url+=$.param(parameters);var ajaxCall={type:'POST',async:this.async!==false,url:url,dataType:this.format||'json',complete:this.completeCallback,error:function(){--globalAjaxQueue.active;if(that.errorCallback){that.errorCallback.apply(this,arguments);}},success:function(response,status,request){if(that.loadingElement){$(that.loadingElement).hide();}
if(response&&response.result=='error'&&!that.useRegularCallbackInCaseOfError){var placeAt=null;var type='toast';if($(that.errorElement).length&&response.message){$(that.errorElement).show();placeAt=that.errorElement;type=null;}
if(response.message){var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(response.message,{placeat:placeAt,context:'error',type:type,id:'ajaxHelper'});notification.scrollToNotification();}}else{that.callback(response,status,request);}
--globalAjaxQueue.active;var piwik=window.piwik;if(piwik&&piwik.ajaxRequestFinished){piwik.ajaxRequestFinished();}},data:this._mixinDefaultPostParams(this.postParams)};if(this.timeout!==null){ajaxCall.timeout=this.timeout;}
return $.ajax(ajaxCall);};this._isRequestToApiMethod=function(){return(this.getParams&&this.getParams['module']==='API'&&this.getParams['method'])||(this.postParams&&this.postParams['module']==='API'&&this.postParams['method']);};this._isWidgetizedRequest=function(){return(broadcast.getValueFromUrl('module')=='Widgetize');};this._getDefaultPostParams=function(){if(this.withToken||this._isRequestToApiMethod()||piwik.shouldPropagateTokenAuth){return{token_auth:piwik.token_auth};}
return{};};this._mixinDefaultPostParams=function(params){var defaultParams=this._getDefaultPostParams();for(var index in defaultParams){if(!params[index]){params[index]=defaultParams[index];}}
return params;};this._mixinDefaultGetParams=function(params){var piwikUrl=piwikHelper.getAngularDependency('piwikUrl');var segment=piwikUrl.getSearchParam('segment');var defaultParams={idSite:piwik.idSite||broadcast.getValueFromUrl('idSite'),period:piwik.period||broadcast.getValueFromUrl('period'),segment:segment};if(params.token_auth){params.token_auth=null;delete params.token_auth;}
for(var key in defaultParams){if(this._useGETDefaultParameter(key)&&!params[key]&&!this.postParams[key]&&defaultParams[key]){params[key]=defaultParams[key];}}
if(this._useGETDefaultParameter('date')&&!params.date&&!this.postParams.date){params.date=piwik.currentDateString;}
return params;};return this;}
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
$(function(){function adjustSize(content){var width=$('body').width()-content.offset().left-16;content.css('width',width+'px');}
var contentAdmin=$('#content.admin');if(contentAdmin.length){adjustSize(contentAdmin);$(window).resize(function(){adjustSize(contentAdmin);});}});
(function($,require){var exports=require('piwik/UI');var ARRAY_PARAM_NAMES=['compareDates','comparePeriods','compareSegments'];var UIControl=function(element){if(!element){throw new Error("no element passed to UIControl constructor");}
this._controlId=UIControl._nextControlId++;UIControl._controls.push(this);var $element=this.$element=$(element);$element.data('uiControlObject',this);var params=JSON.parse($element.attr('data-params')||'{}');for(var key in params){if(params[key]instanceof Array&&ARRAY_PARAM_NAMES.indexOf(key)===-1){params[key]=params[key].join(',');}}
this.param=params;this.props=JSON.parse($element.attr('data-props')||'{}');};UIControl._controls=[];UIControl._nextControlId=0;UIControl.cleanupUnusedControls=function(){var controls=UIControl._controls;var activeControls=UIControl._controls=[];for(var i=0;i!=controls.length;++i){var control=controls[i];if(control&&control.$element&&!$.contains(document.documentElement,control.$element[0])){controls[i]=null;control._destroy();if(!control._baseDestroyCalled){throw new Error("Error: "+control.constructor.name+"'s destroy method does not call "+"UIControl.destroy. You may have a memory leak.");}}else{activeControls.push(control);}}};UIControl.initElements=function(klass,selector){$(selector).each(function(){if(!$(this).attr('data-inited')){var control=new klass(this);$(this).attr('data-inited',1);}});};UIControl.prototype={_destroy:function(){this.$element.removeData('uiControlObject');delete this.$element;this._baseDestroyCalled=true;},onWidgetResize:function(handler){var $widget=this.$element.closest('.widgetContent');$widget.on('widget:maximise',handler).on('widget:minimise',handler).on('widget:resize',handler);}};exports.UIControl=UIControl;})(jQuery,require);
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
var broadcast={_isInit:false,currentHashUrl:false,currentPopoverParameter:false,popoverHandlers:[],popoverParamStack:[],forceReload:false,updateHashOnly:false,init:function(noLoadingMessage){if(broadcast._isInit){return;}
broadcast._isInit=true;angular.element(document).injector().invoke(function(historyService){historyService.init();});if(noLoadingMessage!=true){piwikHelper.showAjaxLoading();}},pageload:function(hash){broadcast.init();$(window).off('resize');if(broadcast.updateHashOnly){broadcast.updateHashOnly=false;return;}
if(hash&&0===(''+hash).indexOf('/')){hash=(''+hash).substr(1);}
if(hash){if(/^popover=/.test(hash)){var hashParts=['',hash.replace(/^popover=/,'')];}else{var hashParts=hash.split('&popover=');}
var hashUrl=hashParts[0];var popoverParam='';if(hashParts.length>1){popoverParam=hashParts[1];popoverParam=decodeURIComponent(popoverParam);popoverParam=popoverParam.replace(/\$/g,'%');popoverParam=decodeURIComponent(popoverParam);}
var pageUrlUpdated=(popoverParam==''||(broadcast.currentHashUrl!==false&&broadcast.currentHashUrl!=hashUrl));var popoverParamUpdated=(popoverParam!=''&&hashUrl==broadcast.currentHashUrl);if(broadcast.currentHashUrl===false){pageUrlUpdated=true;popoverParamUpdated=(popoverParam!='');}
if(!broadcast.isWidgetizedDashboard()&&(pageUrlUpdated||broadcast.forceReload)){Piwik_Popover.close();if(hashUrl!=broadcast.currentHashUrl||broadcast.forceReload){broadcast.loadAjaxContent(hashUrl);$('.top_controls .dashboard-manager').hide();$('#dashboardWidgetsArea').dashboard('destroy');require('piwik/UI').UIControl.cleanupUnusedControls();}}
broadcast.forceReload=false;broadcast.currentHashUrl=hashUrl;broadcast.currentPopoverParameter=popoverParam;Piwik_Popover.close();if(popoverParamUpdated){var popoverParamParts=popoverParam.split(':');var handlerName=popoverParamParts[0];popoverParamParts.shift();var param=popoverParamParts.join(':');if(typeof broadcast.popoverHandlers[handlerName]!='undefined'&&!broadcast.isLoginPage()){broadcast.popoverHandlers[handlerName](param);}}}else{Piwik_Popover.close();if(!broadcast.isWidgetizedDashboard()){$('.pageWrap #content:not(.admin)').empty();}}},isWidgetizedDashboard:function(){return broadcast.getValueFromUrl('module')=='Widgetize'&&broadcast.getValueFromUrl('moduleToWidgetize')=='Dashboard';},isLoginPage:function(){return!!$('body#loginPage').length;},propagateAjax:function(ajaxUrl,disableHistory){broadcast.init();globalAjaxQueue.abort();var currentHashStr=broadcast.getHash();ajaxUrl=ajaxUrl.replace(/^\?|&#/,'');var params_vals=ajaxUrl.split("&");for(var i=0;i<params_vals.length;i++){currentHashStr=broadcast.updateParamValue(params_vals[i],currentHashStr);}
var action=broadcast.getParamValue('action',currentHashStr);if(action!='goalReport'&&action!='ecommerceReport'&&action!='products'&&action!='sales'&&(''+ajaxUrl).indexOf('&idGoal=')===-1){currentHashStr=broadcast.updateParamValue('idGoal=',currentHashStr);}
var module=broadcast.getParamValue('module',currentHashStr);if(module!='Dashboard'){currentHashStr=broadcast.updateParamValue('idDashboard=',currentHashStr);}
if(module!='CustomDimensions'){currentHashStr=broadcast.updateParamValue('idDimension=',currentHashStr);}
if(disableHistory){var $window=piwikHelper.getAngularDependency('$window');var newLocation=$window.location.href.split('#')[0]+'#?'+currentHashStr;$window.location.replace(newLocation);}
else{broadcast.forceReload=true;angular.element(document).injector().invoke(function(historyService){historyService.load(currentHashStr);});}},buildReportingUrl:function(ajaxUrl){var currentHashStr=broadcast.getHash();ajaxUrl=ajaxUrl.replace(/^\?|&#/,'');var params_vals=ajaxUrl.split("&");for(var i=0;i<params_vals.length;i++){currentHashStr=broadcast.updateParamValue(params_vals[i],currentHashStr);}
var action=broadcast.getParamValue('action',currentHashStr);if(action!='goalReport'&&action!='ecommerceReport'&&action!='products'&&action!='sales'){currentHashStr=broadcast.updateParamValue('idGoal=',currentHashStr);}
var module=broadcast.getParamValue('module',currentHashStr);if(module!='Dashboard'){currentHashStr=broadcast.updateParamValue('idDashboard=',currentHashStr);}
return'#'+currentHashStr;},propagateNewPage:function(str,showAjaxLoading,strHash,paramsToRemove){globalAjaxQueue.abort();paramsToRemove=paramsToRemove||[];if(typeof showAjaxLoading==='undefined'||showAjaxLoading){piwikHelper.showAjaxLoading();}
var params_vals=str.split("&");var $window=piwikHelper.getAngularDependency('$window');var currentSearchStr=$window.location.search;var currentHashStr=broadcast.getHashFromUrl();if(!currentSearchStr){currentSearchStr='?';}
var oldUrl=currentSearchStr+currentHashStr;params_vals.forEach(function(param){if(/\[]=/.test(decodeURIComponent(param))){var paramName=decodeURIComponent(param).split('[]=')[0];removeParam(paramName);}});paramsToRemove.forEach(function(paramName){removeParam(paramName);});params_vals.forEach(function(param){if(!param.length){return;}
if(/\[]=/.test(decodeURIComponent(param))){currentSearchStr=broadcast.addArrayParamValue(param,currentSearchStr);if(currentHashStr.length!==0){currentHashStr=broadcast.addArrayParamValue(param,currentHashStr);}}else{currentSearchStr=broadcast.updateParamValue(param,currentSearchStr);if(currentHashStr.length!==0){currentHashStr=broadcast.updateParamValue(param,currentHashStr);}}});var updatedUrl=new RegExp('&updated=([0-9]+)');var updatedCounter=updatedUrl.exec(currentSearchStr);if(!updatedCounter){currentSearchStr+='&updated=1';}else{updatedCounter=1+parseInt(updatedCounter[1]);currentSearchStr=currentSearchStr.replace(new RegExp('(&updated=[0-9]+)'),'&updated='+updatedCounter);}
if(strHash&&currentHashStr.length!=0){var params_hash_vals=strHash.split("&");for(var i=0;i<params_hash_vals.length;i++){currentHashStr=broadcast.updateParamValue(params_hash_vals[i],currentHashStr);}}
var newUrl=currentSearchStr+currentHashStr;var $rootScope=piwikHelper.getAngularDependency('$rootScope');if($rootScope){$rootScope.$on('$locationChangeStart',function(event){if(event){event.preventDefault();}});}
if(oldUrl==newUrl){$window.location.reload();}else{this.forceReload=true;$window.location.href=newUrl;}
return false;function removeParam(paramName){var paramRegex=new RegExp(paramName+'(\\[]|%5B%5D)?=[^&?#]*&?','gi');currentSearchStr=currentSearchStr.replace(paramRegex,'');currentHashStr=currentHashStr.replace(paramRegex,'');}},updateParamValue:function(newParamValue,urlStr){var p_v=newParamValue.split("=");var paramName=p_v[0];var valFromUrl=broadcast.getParamValue(paramName,urlStr);var paramValue=p_v[1];if(paramValue==''){newParamValue='';}
var getQuotedRegex=function(str){return(str+'').replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");};if(valFromUrl!=''||urlStr.indexOf(paramName+'=')!==-1){valFromUrl=getQuotedRegex(valFromUrl);var regToBeReplace=new RegExp(paramName+'='+valFromUrl,'ig');if(newParamValue==''){regToBeReplace=new RegExp('[\&]?'+paramName+'='+valFromUrl,'ig');}
urlStr=urlStr.replace(regToBeReplace,newParamValue);}else if(newParamValue!=''){urlStr+=(urlStr=='')?newParamValue:'&'+newParamValue;}
return urlStr;},addArrayParamValue:function(newParamValue,urlStr){if(urlStr.indexOf('?')===-1){urlStr+='?';}else{urlStr+='&';}
return urlStr+newParamValue;},propagateNewPopoverParameter:function(handlerName,value){var $location=angular.element(document).injector().get('$location');var popover='';if(handlerName&&''!=value&&'undefined'!=typeof value){popover=handlerName+':'+value;popover=encodeURIComponent(popover);popover=popover.replace(/%/g,'\$');broadcast.popoverParamStack.push(popover);}else{broadcast.popoverParamStack.pop();if(broadcast.popoverParamStack.length){popover=broadcast.popoverParamStack[broadcast.popoverParamStack.length-1];}}
var $window=piwikHelper.getAngularDependency('$window');var urlStr=$window.location.hash;urlStr=broadcast.updateParamValue('popover='+encodeURIComponent(popover),urlStr);urlStr=urlStr.replace(/^[#?]+/,'');$location.search(urlStr);setTimeout(function(){angular.element(document).injector().get('$rootScope').$apply();},1);},resetPopoverStack:function(){broadcast.popoverParamStack=[];},addPopoverHandler:function(handlerName,callback){broadcast.popoverHandlers[handlerName]=callback;},loadAjaxContent:function(urlAjax){if(broadcast.getParamValue('module',urlAjax)=='API'){broadcast.lastUrlRequested=null;$('#content').html("Loading content from the API and displaying it within Piwik is not allowed.");piwikHelper.hideAjaxLoading();return false;}
piwikHelper.hideAjaxError('loadingError');piwikHelper.showAjaxLoading();$('#content').empty();$("object").remove();urlAjax=urlAjax.match(/^\?/)?urlAjax:"?"+urlAjax;broadcast.lastUrlRequested=urlAjax;function sectionLoaded(content,status,request){if(request){var responseHeader=request.getResponseHeader('Content-Type');if(responseHeader&&0<=responseHeader.toLowerCase().indexOf('json')){var message='JSON cannot be displayed for';if(this.getParams&&this.getParams['module']){message+=' module='+this.getParams['module'];}
if(this.getParams&&this.getParams['action']){message+=' action='+this.getParams['action'];}
$('#content').text(message);piwikHelper.hideAjaxLoading();return;}}
var htmlDocType='<!DOCTYPE';if(content.substring(0,htmlDocType.length)==htmlDocType){if($(content).filter('title').text()=='Piwik › Error'){content=$(content).filter('#contentsimple');}else{return;}}
if(urlAjax==broadcast.lastUrlRequested){$('#content').html(content).show();$(broadcast).trigger('locationChangeSuccess',{element:$('#content'),content:content});piwikHelper.hideAjaxLoading();broadcast.lastUrlRequested=null;piwikHelper.compileAngularComponents('#content');}
initTopControls();}
var ajax=new ajaxHelper();ajax.setUrl(urlAjax);ajax._getDefaultPostParams=function(){return{};};ajax.setErrorCallback(broadcast.customAjaxHandleError);ajax.setCallback(sectionLoaded);ajax.setFormat('html');ajax.send();return false;},customAjaxHandleError:function(deferred,status){broadcast.lastUrlRequested=null;piwikHelper.hideAjaxLoading();if(status=='abort'){return;}
$('#loadingError').show();},isHashExists:function(){var hashStr=broadcast.getHashFromUrl();if(hashStr!=""){return hashStr;}else{return false;}},getHashFromUrl:function(url){var hashStr="";if(url&&url.match('#')){hashStr=url.substring(url.indexOf("#"),url.length);}
else{locationSplit=location.href.split('#');if(typeof locationSplit[1]!='undefined'){hashStr='#'+locationSplit[1];}}
return hashStr;},getSearchFromUrl:function(url){var searchStr="";if(url&&url.match(/\?/)){searchStr=url.substring(url.indexOf("?"),url.length);}else{searchStr=location.search;}
return searchStr;},extractKeyValuePairsFromQueryString:function(queryString){var pairs=queryString.split('&');var result={};for(var i=0;i!=pairs.length;++i){var pair=pairs[i].split('=');var key=pair.shift();result[key]=pair.join('=');}
return result;},getValuesFromUrl:function(url){var searchString=this._removeHashFromUrl(url).split('?')[1]||'';return this.extractKeyValuePairsFromQueryString(searchString);},getValueFromUrl:function(param,url){var searchString=this._removeHashFromUrl(url);return broadcast.getParamValue(param,searchString);},getValueFromHash:function(param,url){var hashStr=broadcast.getHashFromUrl(url);if(hashStr.substr(0,1)=='#'){hashStr=hashStr.substr(1);}
hashStr=hashStr.split('#')[0];return broadcast.getParamValue(param,hashStr);},getParamValue:function(param,url){var lookFor=param+'=';var startStr=url.indexOf(lookFor);if(startStr>=0){return getSingleValue(startStr,url);}else{url=decodeURIComponent(url);lookFor=param+'[]=';startStr=url.indexOf(lookFor);if(startStr>=0){var result=[getSingleValue(startStr)];while((startStr=url.indexOf(lookFor,startStr+1))!==-1){result.push(getSingleValue(startStr));}
return result;}else{return'';}}
function getSingleValue(startPos){var endStr=url.indexOf("&",startPos);if(endStr===-1){endStr=url.length;}
var value=url.substring(startPos+lookFor.length,endStr);if(param!='segment'){value=value.replace(/[^_%~\*\+\-\<\>!@\$\.()=,;0-9a-zA-Z]/gi,'');}
return value;}},getHash:function(){return broadcast.getHashFromUrl().replace(/^#/,'').split('#')[0];},_removeHashFromUrl:function(url){var searchString='';if(url){var urlParts=url.split('#');searchString=urlParts[0];}else{searchString=window.location.search;}
return searchString;}};
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
var Piwik_Popover=(function(){var container=false;var isOpen=false;var closeCallback=false;var isProgrammaticClose=false;var createContainer=function(){if(container===false){container=$(document.createElement('div')).attr('id','Piwik_Popover');}};var openPopover=function(title,dialogClass){createContainer();var options={title:title,modal:true,width:'1050px',position:['center','center'],resizable:false,autoOpen:true,open:function(event,ui){if(dialogClass){$(this).parent().addClass(dialogClass).attr('style','');}
$('.ui-widget-overlay').on('click.popover',function(){container.dialog('close');});var self=this;setTimeout(function(){piwikHelper.lazyScrollTo(self,0);},0);},close:function(event,ui){if(!event.currentTarget&&!$(event.currentTarget).is('button')){broadcast.resetPopoverStack();}
container.find('div.jqplot-target').trigger('piwikDestroyPlot');container[0].innerHTML='';container.dialog('destroy').remove();globalAjaxQueue.abort();$('.ui-widget-overlay').off('click.popover');isOpen=false;require('piwik/UI').UIControl.cleanupUnusedControls();if(typeof closeCallback=='function'){closeCallback();closeCallback=false;}
$('body > .ui-tooltip').remove();if(!isProgrammaticClose){broadcast.propagateNewPopoverParameter(false);}}};container.dialog(options);container.data("uiDialog")._title=function(title){title.html(this.options.title);};isOpen=true;};var centerPopover=function(){if(container!==false){container.dialog({position:['center','center']});}};return{showLoading:function(popoverName,popoverSubject,height,dialogClass){var loading=$(document.createElement('div')).addClass('Piwik_Popover_Loading');var loadingMessage=popoverSubject?translations.General_LoadingPopoverFor:translations.General_LoadingPopover;loadingMessage=sprintf(loadingMessage,popoverName);var p1=$(document.createElement('p')).addClass('Piwik_Popover_Loading_Name');loading.append(p1.text(loadingMessage));var p2;if(popoverSubject){popoverSubject=piwikHelper.addBreakpointsToUrl(popoverSubject);p1.addClass('Piwik_Popover_Loading_NameWithSubject');p2=$(document.createElement('p')).addClass('Piwik_Popover_Loading_Subject');loading.append(p2.html(popoverSubject));}
if(height){loading.height(height);}
if(!isOpen){openPopover(null,dialogClass);}
this.setContent(loading);this.setTitle('');if(height){var offset=loading.height()-p1.outerHeight();if(popoverSubject){offset-=p2.outerHeight();}
var spacingEl=$(document.createElement('div'));spacingEl.height(Math.round(offset / 2));loading.prepend(spacingEl);}
return container;},addHelpButton:function(helpUrl){if(!isOpen){return;}
var titlebar=container.parent().find('.ui-dialog-titlebar');var button=$(document.createElement('a')).addClass('ui-dialog-titlebar-help');button.attr({href:helpUrl,target:'_blank'});titlebar.append(button);},setTitle:function(titleHtml){var titleText=piwikHelper.htmlDecode(titleHtml);if(titleText.length>60){titleHtml=$('<span>').attr('class','tooltip').attr('title',titleText).html(titleHtml);}
container.dialog('option','title',titleHtml);try{$('.tooltip',container.parentNode).tooltip('destroy');}catch(e){}
if(titleText.length>60){$('.tooltip',container.parentNode).tooltip({track:true,items:'.tooltip'});}},setContent:function(html){if(typeof closeCallback=='function'){closeCallback();closeCallback=false;}
container.html(html);container.children().each(function(i,childNode){piwikHelper.compileAngularComponents(childNode);})
centerPopover();},showError:function(title,message,backLabel){var error=$(document.createElement('div')).addClass('Piwik_Popover_Error');var p=$(document.createElement('p')).addClass('Piwik_Popover_Error_Title');error.append(p.html(title));if(message){p=$(document.createElement('p')).addClass('Piwik_Popover_Error_Message');error.append(p.html(message));}
if(backLabel){var back=$(document.createElement('a')).addClass('Piwik_Popover_Error_Back');back.attr('href','#').click(function(){history.back();return false;});error.append(back.html(backLabel));}
if(!isOpen){openPopover();}
this.setContent(error);},onClose:function(callback){closeCallback=callback;},close:function(){if(isOpen){isProgrammaticClose=true;container.dialog('close');isProgrammaticClose=false;}},createPopupAndLoadUrl:function(url,loadingName,dialogClass,ajaxRequest){var ensureMinimumTop=function(){var popoverContainer=$('#Piwik_Popover').parent();if(popoverContainer.position().top<106){popoverContainer.css('top','15px');}};var box=Piwik_Popover.showLoading(loadingName,null,null,dialogClass);ensureMinimumTop();var callback=function(html){function setPopoverTitleIfOneFoundInContainer(){var title=$('h1,h2',container);if(title.length==1){Piwik_Popover.setTitle(title.text());$(title).hide();}}
Piwik_Popover.setContent(html);setPopoverTitleIfOneFoundInContainer();ensureMinimumTop();};if('undefined'===typeof ajaxRequest){ajaxRequest=new ajaxHelper();}
ajaxRequest.addParams(piwikHelper.getArrayFromQueryString(url),'get');ajaxRequest.setCallback(callback);ajaxRequest.setFormat('html');ajaxRequest.send();},isOpen:function(){return isOpen;}};})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($){$(document).ready(function(){var donateAmounts=[0,30,60,90,120];var getTickWidth=function(slider){var effectiveSliderWidth=$('.slider-range',slider).width()-$('.slider-position',slider).width();return effectiveSliderWidth /(donateAmounts.length-1);};var getPositionFromPageCoord=function(slider,pageX){return Math.round((pageX-$('.slider-range',slider).offset().left)/ getTickWidth(slider));};var setSmileyFaceAndAmount=function(slider,pos){$('.slider-donate-amount',slider).text('$'+donateAmounts[pos]+'/'+_pk_translate('Intl_Year_Short'));$('.slider-smiley-face').attr('src','plugins/Morpheus/images/smileyprog_'+pos+'.png');var option=Math.max(1,pos);$('.piwik-donate-call input[name=os0]').val("Option "+option);};var moveSliderPosition=function(slider,to){if(to<0){to=0;}
else if(to>=donateAmounts.length){to=donateAmounts.length-1;}
var left=to*getTickWidth(slider);if(left==0){left=-1;}
$('.slider-position',slider).css({left:left+'px'});setSmileyFaceAndAmount(slider,to);};$('body').on('click','.piwik-donate-slider>.slider-range',function(e){var slider=$(this).parent(),currentPageX=$('.slider-position',this).offset().left,currentPos=getPositionFromPageCoord(slider,currentPageX),pos=getPositionFromPageCoord(slider,e.pageX);if(currentPos==pos){if(e.pageX>currentPageX){++pos;}
else{--pos;}}
moveSliderPosition(slider,pos);});$('body').on('click','.piwik-donate-slider .slider-smiley-face,.piwik-donate-slider .slider-donate-amount',function(e){var slider=$(this).closest('.piwik-donate-slider'),currentPageX=$('.slider-position',slider).offset().left,currentPos=getPositionFromPageCoord(slider,currentPageX);moveSliderPosition(slider,currentPos+1);});var draggingSlider=false;$('body').on('mousedown','.piwik-donate-slider .slider-position',function(){draggingSlider=$(this).parent().parent();});$('body').on('mousemove',function(e){if(draggingSlider){var slider=draggingSlider.find('.slider-range'),sliderPos=slider.find('.slider-position'),left=e.pageX-slider.offset().left;if(left<=slider.width()-sliderPos.width()+2&&left>=-2){sliderPos.css({left:left+'px'});var closestPos=Math.round(left / getTickWidth(draggingSlider));setSmileyFaceAndAmount(draggingSlider,closestPos);}}});$('body').on('mouseup',function(){if(draggingSlider){var sliderPos=$('.slider-position',draggingSlider),slider=sliderPos.parent();if(sliderPos.length){var pos=getPositionFromPageCoord(draggingSlider,sliderPos.offset().left);moveSliderPosition(draggingSlider,pos);}
draggingSlider=false;}});$('body').on('piwik:changePosition','.piwik-donate-slider',function(e,data){moveSliderPosition(this,data.position);});});}(jQuery));
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($,require){var exports=require('piwik/UI'),UIControl=exports.UIControl;function DataTable(element){UIControl.call(this,element);this.init();}
DataTable._footerIconHandlers={};DataTable.initNewDataTables=function(){$('div.dataTable').each(function(){if(!$(this).attr('id')){var tableType=$(this).attr('data-table-type')||'DataTable',klass=require('piwik/UI')[tableType]||require(tableType);if(klass&&$.isFunction(klass)){var table=new klass(this);}}});};DataTable.registerFooterIconHandler=function(id,handler){var handlers=DataTable._footerIconHandlers;if(handlers[id]){setTimeout(function(){throw new Exception("DataTable footer icon handler '"+id+"' is already being used.")},1);return;}
handlers[id]=handler;};DataTable.getDataTableByReport=function(report){var result=undefined;$('div.dataTable').each(function(){if($(this).attr('data-report')==report){result=this;return false;}});return result;};$.extend(DataTable.prototype,UIControl.prototype,{_init:function(domElem){},_destroy:function(){UIControl.prototype._destroy.call(this);if(this.windowResizeTableAttached){$(window).off('resize',this._resizeDataTable);}
if(this._bodyMouseUp){$('body').off('mouseup',this._bodyMouseUp);}},init:function(){var domElem=this.$element;this.workingDivId=this._createDivId();domElem.attr('id',this.workingDivId);this.loadedSubDataTable={};this.isEmpty=$('.pk-emptyDataTable',domElem).length>0;this.bindEventsAndApplyStyle(domElem);this._init(domElem);this.initialized=true;},onClickSort:function(domElem){var self=this;var newColumnToSort=$(domElem).attr('id');if(self.param.filter_sort_column==newColumnToSort){if(this.param.filter_sort_order=='asc'){self.param.filter_sort_order='desc';}
else{self.param.filter_sort_order='asc';}}
self.param.filter_offset=0;self.param.filter_sort_column=newColumnToSort;if(!self.isDashboard()){self.notifyWidgetParametersChange(domElem,{filter_sort_column:newColumnToSort,filter_sort_order:self.param.filter_sort_order});}
self.reloadAjaxDataTable();},setGraphedColumn:function(columnName){this.param.columns=columnName;},isWithinDialog:function(domElem){return!!$(domElem).parents('.ui-dialog').length;},isDashboard:function(){return!!$('#dashboardWidgetsArea').length;},getReportMetadata:function(){return JSON.parse(this.$element.attr('data-report-metadata')||'{}');},resetAllFilters:function(){var self=this;var FiltersToRestore={};var filters=['filter_column','filter_pattern','filter_column_recursive','filter_pattern_recursive','enable_filter_excludelowpop','filter_offset','filter_limit','filter_sort_column','filter_sort_order','disable_generic_filters','columns','flat','totals','include_aggregate_rows','totalRows','pivotBy','pivotByColumn'];for(var key=0;key<filters.length;key++){var value=filters[key];FiltersToRestore[value]=self.param[value];delete self.param[value];}
return FiltersToRestore;},restoreAllFilters:function(FiltersToRestore){var self=this;for(var key in FiltersToRestore){self.param[key]=FiltersToRestore[key];}},cleanParams:function(){var self=this;for(var key in self.param){if(self.param[key]=='true')self.param[key]=true;if(self.param[key]=='false')self.param[key]=false;}},reloadAjaxDataTable:function(displayLoading,callbackSuccess,extraParams){var self=this;if(typeof displayLoading=="undefined"){displayLoading=true;}
if(typeof callbackSuccess=="undefined"){callbackSuccess=function(response){self.dataTableLoaded(response,self.workingDivId);};}
if(displayLoading){$('#'+self.workingDivId+' .loadingPiwik').last().css('display','block');}
$('#loadingError').hide();if(self&&self.param&&self.param.viewDataTable&&String(self.param.viewDataTable).indexOf('graph')===0){delete self.param.filter_offset;delete self.param.filter_limit;}
delete self.param.showtitle;var container=$('#'+self.workingDivId+' .piwik-graph');var ajaxRequest=new ajaxHelper();if(self.param.totalRows){ajaxRequest.addParams({'totalRows':self.param.totalRows},'post');delete self.param.totalRows;}
var params={};for(var key in self.param){if(typeof self.param[key]!="undefined"&&self.param[key]!==null&&self.param[key]!==''){if(key=='filter_column'||key=='filter_column_recursive'){if(self.param.flat=="1"&&self.param.show_dimensions=="1"){params[key]='combinedLabel';}else{params[key]='label';}
continue;}
params[key]=self.param[key];}}
ajaxRequest.addParams(params,'get');if(extraParams){ajaxRequest.addParams(extraParams,'post');}
ajaxRequest.withTokenInUrl();ajaxRequest.setCallback(function(response){container.trigger('piwikDestroyPlot');container.off('piwikDestroyPlot');callbackSuccess(response);});ajaxRequest.setErrorCallback(function(deferred,status){if(status=='abort'||!deferred||deferred.status<400||deferred.status>=600){return;}
$('#'+self.workingDivId+' .loadingPiwik').last().css('display','none');$('#loadingError').show();});ajaxRequest.setFormat('html');ajaxRequest.send();},dataTableLoaded:function(response,workingDivId,doScroll){var content=$(response);if($.trim($('.dataTableControls',content).html())===''){$('.dataTableControls',content).append('&nbsp;');}
var idToReplace=workingDivId||$(content).attr('id');var dataTableSel=$('#'+idToReplace);table=$(content).parents('table.dataTable');if(dataTableSel.parents('.dataTable').is('table')){$(content).find('table.dataTable').addClass('subDataTable');$(content).find('.dataTableFeatures').addClass('subDataTable');dataTableSel.replaceWith(content);}
else{dataTableSel.find('object').remove();dataTableSel.replaceWith(content);}
content.trigger('piwik:dataTableLoaded');if(doScroll||'undefined'===typeof doScroll){piwikHelper.lazyScrollTo(content[0],400);}
piwikHelper.compileAngularComponents(content);return content;},bindEventsAndApplyStyle:function(domElem){var self=this;self.cleanParams();self.preBindEventsAndApplyStyleHook(domElem);self.handleSort(domElem);self.handleLimit(domElem);self.handlePeriod(domElem);self.handleOffsetInformation(domElem);self.handleAnnotationsButton(domElem);self.handleEvolutionAnnotations(domElem);self.handleExportBox(domElem);self.applyCosmetics(domElem);self.handleSubDataTable(domElem);self.handleConfigurationBox(domElem);self.handleSearchBox(domElem);self.handleColumnDocumentation(domElem);self.handleRowActions(domElem);self.handleCellTooltips(domElem);self.handleRelatedReports(domElem);self.handleTriggeredEvents(domElem);self.handleColumnHighlighting(domElem);self.setFixWidthToMakeEllipsisWork(domElem);self.handleSummaryRow(domElem);self.postBindEventsAndApplyStyleHook(domElem);},preBindEventsAndApplyStyleHook:function(domElem){},postBindEventsAndApplyStyleHook:function(domElem){},isWidgetized:function(){return-1!==location.search.indexOf('module=Widgetize');},setFixWidthToMakeEllipsisWork:function(domElem){var self=this;function getTableWidth(domElem){var totalWidth=$(domElem).width();var totalWidthTable=$('table.dataTable',domElem).width();if(totalWidthTable<totalWidth){totalWidth=totalWidthTable;}
if(!totalWidth){totalWidth=0;}
return parseInt(totalWidth,10);}
function setMaxTableWidthIfNeeded(domElem,maxTableWidth){var $domElem=$(domElem);var dataTableInCard=$domElem.parents('.card').first();var parentDataTable=$domElem.parent('.dataTable');dataTableInCard.width('');$domElem.width('');parentDataTable.width('');var $table=$('table.dataTable',domElem);if($table.closest('.reportsByDimensionView').length){var requiredTableWidth=$table.width()-40;if(domElem.width()>requiredTableWidth){domElem.css('max-width',requiredTableWidth+'px');}}
var tableWidth=getTableWidth(domElem);if(tableWidth<=maxTableWidth){return;}
if(self.isWidgetized()||self.isDashboard()){return;}
if(dataTableInCard&&dataTableInCard.length){dataTableInCard.width(maxTableWidth);}else{$domElem.width(maxTableWidth);}
if(parentDataTable&&parentDataTable.length){if(dataTableInCard.length){dataTableInCard.width(maxTableWidth);}else{parentDataTable.width(maxTableWidth);}}}
function getLabelWidth(domElem,tableWidth,minLabelWidth,maxLabelWidth){var labelWidth=minLabelWidth;var columnsInFirstRow=$('tbody tr:not(.parentComparisonRow):not(.comparePeriod):eq(0) td:not(.label)',domElem);var widthOfAllColumns=0;columnsInFirstRow.each(function(index,column){widthOfAllColumns+=$(column).outerWidth();});if(tableWidth-widthOfAllColumns>=minLabelWidth){labelWidth=tableWidth-widthOfAllColumns;}else if(widthOfAllColumns>=tableWidth){labelWidth=tableWidth*0.5;}
var innerWidth=0;var innerWrapper=domElem.find('.dataTableWrapper');if(innerWrapper&&innerWrapper.length){innerWidth=innerWrapper.width();}
if(labelWidth>maxLabelWidth&&!self.isWidgetized()&&innerWidth!==domElem.width()&&!self.isDashboard()){labelWidth=maxLabelWidth;}
return parseInt(labelWidth / $('tr:nth-child(1) td.label',domElem).length,10);}
function getLabelColumnMinWidth(domElem){var minWidth=0;var minWidthHead=$('thead .first.label',domElem).css('minWidth');if(minWidthHead){minWidth=parseInt(minWidthHead,10);}
var minWidthBody=$('tbody tr:nth-child(1) td.label',domElem).css('minWidth');if(minWidthBody){minWidthBody=parseInt(minWidthBody,10);if(minWidthBody&&minWidthBody>minWidth){minWidth=minWidthBody;}}
return parseInt(minWidth,10);}
function getLabelColumnMaxWidth(domElem){var maxWidth=0;var maxWidthHead=$('thead .first.label',domElem).css('maxWidth');if(maxWidthHead){maxWidthHead=parseInt(maxWidthHead,10);if(maxWidthHead>0){maxWidth=parseInt(maxWidthHead,10);}}
var maxWidthBody=$('tbody tr:nth-child(1) td.label',domElem).css('maxWidth');if(maxWidthBody){maxWidthBody=parseInt(maxWidthBody,10);if(maxWidthBody&&maxWidthBody>0&&(maxWidth===0||maxWidthBody<maxWidth)){maxWidth=maxWidthBody;}}
return parseInt(maxWidth,10);}
function removePaddingFromWidth(elem,labelWidth){var paddingLeft=elem.css('paddingLeft');paddingLeft=paddingLeft?Math.round(parseFloat(paddingLeft)):0;var paddingRight=elem.css('paddingRight');paddingRight=paddingRight?Math.round(parseFloat(paddingLeft)):0;labelWidth=labelWidth-paddingLeft-paddingRight;return labelWidth;}
setMaxTableWidthIfNeeded(domElem,1200);var isTableVisualization=this.jsViewDataTable&&typeof this.jsViewDataTable==='string'&&typeof this.jsViewDataTable.indexOf==='function'&&this.jsViewDataTable.indexOf('table')!==-1;if(isTableVisualization){var tableWidth=getTableWidth(domElem);var labelColumnMinWidth=getLabelColumnMinWidth(domElem);var labelColumnMaxWidth=getLabelColumnMaxWidth(domElem);var labelColumnWidth=getLabelWidth(domElem,tableWidth,125,440);if(labelColumnMinWidth>labelColumnWidth){labelColumnWidth=labelColumnMinWidth;}
if(labelColumnMaxWidth&&labelColumnMaxWidth<labelColumnWidth){labelColumnWidth=labelColumnMaxWidth;}
if(labelColumnWidth){$('td.label',domElem).each(function(){$(this).width(removePaddingFromWidth($(this),labelColumnWidth));});}
$('td span.label',domElem).each(function(){self.tooltip($(this));});self.overflowContentIfNeeded(domElem);}
if(!self.windowResizeTableAttached){self.windowResizeTableAttached=true;var timeout=null;var resizeDataTable=function(){if(timeout){clearTimeout(timeout);}
timeout=setTimeout(function(){var isInDom=domElem&&domElem[0]&&document&&document.body&&document.body.contains(domElem[0]);if(isInDom){if(isTableVisualization){$('td.label',domElem).width('');}
self.setFixWidthToMakeEllipsisWork(domElem);}else{$(window).off('resize',resizeDataTable);}
timeout=null;},Math.floor((Math.random()*80)+220));}
$(window).on('resize',resizeDataTable);self._resizeDataTable=resizeDataTable;}},overflowContentIfNeeded:function(domElem,showScrollbarIfMoreThanThisPxOverlap){var $domNodeToSetOverflow;if(this.isDashboard()){$domNodeToSetOverflow=domElem.parents('.widgetContent').first();}else if(this.isWidgetized()){$domNodeToSetOverflow=domElem.parents('.widget').first();}else{var inReportPage=domElem.parents('.theWidgetContent').first();var displayedAsCard=inReportPage.find('> .card > .card-content');if(displayedAsCard.length){$domNodeToSetOverflow=displayedAsCard.first();}else{$domNodeToSetOverflow=inReportPage;}}
if(!$domNodeToSetOverflow||!$domNodeToSetOverflow.length){return;}
var tableWidth=domElem.width();var dataTableWidth=domElem.find('table.dataTable').width();var widthToCheckElementIsActuallyThere=10;var normalOverlapBecauseTableIsFullWidth=showScrollbarIfMoreThanThisPxOverlap||51;if(tableWidth>widthToCheckElementIsActuallyThere&&dataTableWidth>widthToCheckElementIsActuallyThere&&(dataTableWidth-tableWidth)>normalOverlapBecauseTableIsFullWidth){$domNodeToSetOverflow.css('overflow-y','scroll');}else if($domNodeToSetOverflow.css('overflow-y')==='scroll'){$domNodeToSetOverflow.css('overflow-y','auto');}},handleLimit:function(domElem){var tableRowLimits=this.props.datatable_row_limits||piwik.config.datatable_row_limits,evolutionLimits={day:[8,30,60,90,180],week:[4,12,26,52,104],month:[3,6,12,24,36,120],year:[3,5,10]};if(!parseInt(this.param.flat)){evolutionLimits.day.push(365,500);evolutionLimits.week.push(500);}
var self=this;if(typeof self.parentId!="undefined"&&self.parentId!=''){$('.limitSelection',domElem).remove();return;}
if(self.props.disable_all_rows_filter_limit){var tempTableRowLimits=[];tableRowLimits.forEach(function(limit){if(limit!=-1){tempTableRowLimits.push(limit);}});tableRowLimits=tempTableRowLimits;}
var setLimitValue,numbers,limitParamName;if(self.param.viewDataTable=='graphEvolution'){limitParamName='evolution_'+self.param.period+'_last_n';numbers=evolutionLimits[self.param.period]||tableRowLimits;setLimitValue=function(params,limit){params[limitParamName]=limit;};}
else{numbers=tableRowLimits;limitParamName='filter_limit';setLimitValue=function(params,value){params.filter_limit=value;params.filter_offset=0;};}
function getFilterLimitAsString(limit){if(limit=='-1'){return _pk_translate('General_All').toLowerCase();}
return limit;}
var selectionMarkup='<div class="input-field"><select value="'+self.param[limitParamName]+'">';var selectedValue=getFilterLimitAsString(self.param[limitParamName]);if(self.props.show_limit_control){for(var i=0;i<numbers.length;i++){var currentValue=getFilterLimitAsString(numbers[i]);var optionSelected='';if(selectedValue==currentValue){optionSelected='selected';}
selectionMarkup+='<option value="'+numbers[i]+'"'+optionSelected+'>'+currentValue+'</option>';}
selectionMarkup+='</select></div>';$('.limitSelection',domElem).append(selectionMarkup);var $limitSelect=$('.limitSelection select',domElem);if(!self.isEmpty){$limitSelect.on('change',function(event){var limit=$(this).val();if(limit!=self.param[limitParamName]){setLimitValue(self.param,limit);self.reloadAjaxDataTable();var data={};data[limitParamName]=self.param[limitParamName];self.notifyWidgetParametersChange(domElem,data);}});}
else{$limitSelect.toggleClass('disabled');}
$limitSelect.material_select();$('.limitSelection input',domElem).attr('title',_pk_translate('General_RowsToDisplay'));}
else{$('.limitSelection',domElem).hide();}},handlePeriod:function(domElem){var $periodSelect=$('.dataTablePeriods .tableIcon',domElem);var self=this;$periodSelect.click(function(){var period=$(this).attr('data-period');if(!period||period==self.param['period']){return;}
self.param['period']=period;self.reloadAjaxDataTable();});},handleSort:function(domElem){var self=this;if(self.props.enable_sort){$('.sortable',domElem).off('click.dataTableSort').on('click.dataTableSort',function(){$(this).off('click.dataTableSort');self.onClickSort(this);});}
if(self.param.filter_sort_column){var currentIsSubDataTable=$(domElem).parent().hasClass('cellSubDataTable');var imageSortClassType=currentIsSubDataTable?'sortSubtable':''
var imageSortWidth=16;var imageSortHeight=16;var sortOrder=self.param.filter_sort_order||'desc';var head=$('th',domElem).filter(function(){return $(this).attr('id')==self.param.filter_sort_column;}).addClass('columnSorted');var sortIconHtml='<span class="sortIcon '+sortOrder+' '+imageSortClassType+'" width="'+imageSortWidth+'" height="'+imageSortHeight+'" />';var div=head.find('.thDIV');if(head.hasClass('first')||head.attr('id')=='label'){div.append(sortIconHtml);}else{div.prepend(sortIconHtml);}}},handleSearchBox:function(domElem,callbackSuccess){var self=this;var currentPattern=self.param.filter_pattern;if(typeof self.param.filter_pattern!="undefined"&&self.param.filter_pattern.length>0){currentPattern=self.param.filter_pattern;}
else if(typeof self.param.filter_pattern_recursive!="undefined"&&self.param.filter_pattern_recursive.length>0){currentPattern=self.param.filter_pattern_recursive;}
else{currentPattern='';}
currentPattern=piwikHelper.htmlDecode(currentPattern);var patternsToReplace=[{from:'?',to:'\\?'},{from:'+',to:'\\+'},{from:'*',to:'\\*'}]
$.each(patternsToReplace,function(index,pattern){if(0===currentPattern.indexOf(pattern.to)){currentPattern=pattern.from+currentPattern.substr(2);}});var $searchAction=$('.dataTableAction.searchAction',domElem);if(!$searchAction.length){return;}
$searchAction.on('click',showSearch);$searchAction.find('.icon-close').on('click',hideSearch);var $searchInput=$('.dataTableSearchInput',domElem);function getOptimalWidthForSearchField(){var controlBarWidth=$('.dataTableControls',domElem).width();var spaceLeft=controlBarWidth-$searchAction.position().left;var idealWidthForSearchBar=250;var minimalWidthForSearchBar=150;var width=idealWidthForSearchBar;if(spaceLeft>minimalWidthForSearchBar&&spaceLeft<idealWidthForSearchBar){width=spaceLeft;}
if(width>controlBarWidth){width=controlBarWidth;}
return width;}
function hideSearch(event){event.preventDefault();event.stopPropagation();var $searchAction=$(this).parents('.searchAction').first();$searchAction.removeClass('searchActive active forceActionVisible');$searchAction.css('width','');$searchAction.on('click',showSearch);$searchAction.find('.icon-search').off('click',searchForPattern);$searchInput.val('');if(currentPattern){searchForPattern();}}
function showSearch(event){event.preventDefault();event.stopPropagation();var $searchAction=$(this);$searchAction.addClass('searchActive forceActionVisible');var width=getOptimalWidthForSearchField();$searchAction.css('width',width+'px');$searchAction.find('.dataTableSearchInput').focus();$searchAction.find('.icon-search').on('click',searchForPattern);$searchAction.off('click',showSearch);}
function searchForPattern(){var keyword=$searchInput.val();if(!keyword&&!currentPattern){return;}
self.param.filter_offset=0;$.each(patternsToReplace,function(index,pattern){if(0===keyword.indexOf(pattern.from)){keyword=pattern.to+keyword.substr(1);}});if(self.param.search_recursive){self.param.filter_column_recursive='label';self.param.filter_pattern_recursive=keyword;}
else{self.param.filter_column='label';self.param.filter_pattern=keyword;}
delete self.param.totalRows;self.reloadAjaxDataTable(true,callbackSuccess);}
$searchInput.on("keyup",function(e){if(isEnterKey(e)){searchForPattern();}else if(isEscapeKey(e)){$searchAction.find('.icon-close').click();}});if(currentPattern){$searchInput.val(currentPattern);$searchAction.click();}
if(this.isEmpty&&!currentPattern){$searchAction.css({display:'none'});}},handleOffsetInformation:function(domElem){var self=this;$('.dataTablePages',domElem).each(function(){var offset=1+Number(self.param.filter_offset);var offsetEnd=Number(self.param.filter_offset)+Number(self.param.filter_limit);var totalRows=Number(self.param.totalRows);var offsetEndDisp=offsetEnd;if(self.param.keep_summary_row==1)--totalRows;if(offsetEnd>totalRows||Number(self.param.filter_limit)==-1)offsetEndDisp=totalRows;if(totalRows!=0){var str=sprintf(_pk_translate('General_Pagination'),offset,offsetEndDisp,totalRows);$(this).text(str);}else{$(this).hide();}});var $next=$('.dataTableNext',domElem);$next.each(function(){var offsetEnd=Number(self.param.filter_offset)
+Number(self.param.filter_limit);var totalRows=Number(self.param.totalRows);if(self.param.keep_summary_row==1)--totalRows;if(offsetEnd<totalRows){$(this).css('visibility','visible');}});$next.off('click');$next.click(function(){$(this).off('click');self.param.filter_offset=Number(self.param.filter_offset)+Number(self.param.filter_limit);self.reloadAjaxDataTable();});var $prev=$('.dataTablePrevious',domElem);$prev.each(function(){var offset=1+Number(self.param.filter_offset);if(offset!=1){$(this).css('visibility','visible');}});$prev.off('click');$prev.click(function(){$(this).off('click');var offset=Number(self.param.filter_offset)-Number(self.param.filter_limit);if(offset<0){offset=0;}
self.param.filter_offset=offset;self.param.previous=1;self.reloadAjaxDataTable();});},handleEvolutionAnnotations:function(domElem){var self=this;if(self.param.viewDataTable=='graphEvolution'&&$('.annotationView',domElem).length>0){$('.dataTableFeatures',domElem).addClass('hasEvolution');piwik.annotations.api.getEvolutionIcons(self.param.idSite,self.param.date,self.param.period,self.param['evolution_'+self.param.period+'_last_n'],function(response){var annotations=$(response),datatableFeatures=$('.dataTableFeatures',domElem),noteSize=16,annotationAxisHeight=30;var annotationsCss={left:6};annotations.css(annotationsCss);piwik.annotations.placeEvolutionIcons(annotations,domElem);annotations.insertBefore($('.dataTableFooterNavigation',domElem));$('.piwik-graph',domElem).on('resizeGraph',function(){piwik.annotations.placeEvolutionIcons(annotations,domElem);});datatableFeatures.on('mouseenter','.evolution-annotations>span',function(){$(this).css('opacity',1);});datatableFeatures.on('mouseleave','.evolution-annotations>span',function(){if($(this).attr('data-count')==0){$(this).css('opacity',0);}});datatableFeatures.on('click','.evolution-annotations>span',function(){var spanSelf=$(this),date=spanSelf.attr('data-date'),oldDate=$('.annotation-manager',domElem).attr('data-date');if(date){var period=self.param.period;if(period=='range'){period='day';}
piwik.annotations.showAnnotationViewer(domElem,self.param.idSite,date,period,undefined,function(manager){manager.attr('data-is-range',0);$('.annotationView',domElem).attr('title',_pk_translate('Annotations_IconDesc'));var viewAndAdd=_pk_translate('Annotations_ViewAndAddAnnotations'),hideNotes=_pk_translate('Annotations_HideAnnotationsFor');if(oldDate){$('span',annotations).each(function(){if($(this).attr('data-date')==oldDate){$(this).attr('title',sprintf(viewAndAdd,oldDate));return false;}});}
if(manager.is(':hidden')){spanSelf.attr('title',sprintf(viewAndAdd,date));}
else{spanSelf.attr('title',sprintf(hideNotes,date));}});}});var runningAnimation=null;domElem.on('mouseenter','.annotation',function(e){var date=$(this).attr('data-date');var icon=$();$('span',annotations).each(function(){if($(this).attr('data-date')==date){icon=$('img',this);return false;}});if(icon[0]==runningAnimation){return;}
$('span',annotations).each(function(){$('img',this).removeAttr('style');});icon.effect("bounce",{times:1,distance:10},1000);runningAnimation=icon[0];});domElem.on('mouseleave','.annotations',function(e){runningAnimation=null;});self.$element.trigger('piwik:annotationsLoaded');});}},handleAnnotationsButton:function(domElem){var self=this;if(self.param.idSubtable){return;}
$('.annotationView',domElem).click(function(){var annotationManager=$('.annotation-manager',domElem);if(annotationManager.length>0&&annotationManager.attr('data-is-range')==1){if(annotationManager.is(':hidden')){annotationManager.slideDown('slow');$(this).attr('title',_pk_translate('Annotations_IconDescHideNotes'));}
else{annotationManager.slideUp('slow');$(this).attr('title',_pk_translate('Annotations_IconDesc'));}}
else{var lastN=self.param['evolution_'+self.param.period+'_last_n'];piwik.annotations.showAnnotationViewer(domElem,self.param.idSite,self.param.date,self.param.period,lastN,function(manager){manager.attr('data-is-range',1);});$(this).attr('title',_pk_translate('Annotations_IconDescHideNotes'));}});},handleExportBox:function(domElem){var self=this;if(self.param.idSubtable){return;}
self.jsViewDataTable=self.param.viewDataTable;$('.tableAllColumnsSwitch a',domElem).show();$('.dataTableFooterIcons .tableIcon',domElem).click(function(){var id=$(this).attr('data-footer-icon-id');if(!id){return;}
var handler=DataTable._footerIconHandlers[id];if(!handler){handler=DataTable._footerIconHandlers['table'];}
handler(self,id);});self.currentGraphViewIcon=0;self.graphViewEnabled=0;self.graphViewStartingThreads=0;self.graphViewStartingKeep=false;},handleConfigurationBox:function(domElem,callbackSuccess){var self=this;if(typeof self.parentId!="undefined"&&self.parentId!=''){return;}
if((typeof self.numberOfSubtables=='undefined'||self.numberOfSubtables==0)&&(typeof self.param.flat=='undefined'||self.param.flat!=1)){$('.dataTableFlatten',domElem).parent().remove();}
var ul=$('ul.tableConfiguration',domElem);function hideConfigurationIcon(){$('.dropdownConfigureIcon',domElem).remove();}
if(!ul.find('li').length){hideConfigurationIcon();return;}
var icon=$('a.dropdownConfigureIcon',domElem);var iconHighlighted=false;var generateClickCallback=function(paramName,callbackAfterToggle,setParamCallback){return function(){if(setParamCallback){var data=setParamCallback();}else{self.param[paramName]=(1-self.param[paramName])+'';var data={};}
self.param.filter_offset=0;delete self.param.totalRows;if(callbackAfterToggle)callbackAfterToggle();self.reloadAjaxDataTable(true,callbackSuccess);data[paramName]=self.param[paramName];self.notifyWidgetParametersChange(domElem,data);};};var getText=function(text,addDefault,replacement){if(/(%(.\$)?s+)/g.test(_pk_translate(text))){var values=['<br /><span class="action">'];if(replacement){values.push(replacement);}
text=_pk_translate(text,values);if(addDefault)text+=' ('+_pk_translate('CoreHome_Default')+')';text+='</span>';return text;}
return _pk_translate(text);};var setText=function(el,paramName,textA,textB){if(typeof self.param[paramName]!='undefined'&&self.param[paramName]==1){$(el).html(getText(textA,true));iconHighlighted=true;}
else{self.param[paramName]=0;$(el).html(getText(textB));}};$('.dataTableExcludeLowPopulation',domElem).each(function(){if(typeof self.param.enable_filter_excludelowpop=='undefined'){self.param.enable_filter_excludelowpop=0;}
if(Number(self.param.enable_filter_excludelowpop)!=0){var string=getText('CoreHome_IncludeRowsWithLowPopulation',true);self.param.enable_filter_excludelowpop=1;iconHighlighted=true;}
else{var string=getText('CoreHome_ExcludeRowsWithLowPopulation');self.param.enable_filter_excludelowpop=0;}
$(this).html(string);}).click(generateClickCallback('enable_filter_excludelowpop'));$('.dataTableFlatten',domElem).each(function(){setText(this,'flat','CoreHome_UnFlattenDataTable','CoreHome_FlattenDataTable');}).click(generateClickCallback('flat'));$('.dataTableShowTotalsRow',domElem).each(function(){setText(this,'keep_totals_row','CoreHome_RemoveTotalsRowDataTable','CoreHome_AddTotalsRowDataTable');}).click(generateClickCallback('keep_totals_row'));$('.dataTableIncludeAggregateRows',domElem).each(function(){setText(this,'include_aggregate_rows','CoreHome_DataTableExcludeAggregateRows','CoreHome_DataTableIncludeAggregateRows');}).click(generateClickCallback('include_aggregate_rows',function(){if(self.param.include_aggregate_rows==1){self.param.filter_sort_column='';self.notifyWidgetParametersChange(domElem,{filter_sort_column:''});}}));$('.dataTableShowDimensions',domElem).each(function(){setText(this,'show_dimensions','CoreHome_DataTableCombineDimensions','CoreHome_DataTableShowDimensions');}).click(generateClickCallback('show_dimensions'));$('.dataTablePivotBySubtable',domElem).each(function(){if(self.param.pivotBy&&self.param.pivotBy!='0'){$(this).html(getText('CoreHome_UndoPivotBySubtable',true));iconHighlighted=true;}else{var optionLabelText=getText('CoreHome_PivotBySubtable',false,self.props.pivot_dimension_name);$(this).html(optionLabelText);}}).click(generateClickCallback('pivotBy',null,function(){if(self.param.pivotBy&&self.param.pivotBy!='0'){self.param.pivotBy='0';self.param.pivotByColumn='0';}else{self.param.pivotBy=self.props.pivot_by_dimension;if(self.props.pivot_by_column){self.param.pivotByColumn=self.props.pivot_by_column;}}
self.param.filter_sort_column='';return{filter_sort_column:''};}));if(iconHighlighted){icon.addClass('highlighted');}
if(!iconHighlighted&&!(self.param.viewDataTable=='table'||self.param.viewDataTable=='tableAllColumns'||self.param.viewDataTable=='tableGoals')){hideConfigurationIcon();return;}},notifyWidgetParametersChange:function(domWidget,parameters){var widget=$(domWidget).closest('[widgetId],[containerid]');if(widget&&widget.length&&widget[0].hasAttribute('widgetId')){widget.trigger('setParameters',parameters);}else{var containerId=widget&&widget.length?widget.attr('containerid'):undefined;var reportId=$(domWidget).closest('[data-report]').attr('data-report');var ajaxRequest=new ajaxHelper();ajaxRequest.addParams({module:'CoreHome',action:'saveViewDataTableParameters',report_id:reportId,containerId:containerId},'get');ajaxRequest.withTokenInUrl();ajaxRequest.addParams({parameters:JSON.stringify(parameters)},'post');ajaxRequest.setCallback(function(){});ajaxRequest.setFormat('html');ajaxRequest.send();}},tooltip:function(domElement){function isTextEllipsized($element){return!($element&&$element[0]&&$element.outerWidth()>=$element[0].scrollWidth);}
var $domElement=$(domElement);if($domElement.data('tooltip')=='enabled'){return;}
$domElement.data('tooltip','enabled');if(!isTextEllipsized($domElement)){return;}
var customToolTipText=$domElement.attr('title')||$domElement.text();if(customToolTipText){$domElement.attr('title',customToolTipText);}
$domElement.tooltip({track:true,show:false,hide:false});},applyCosmetics:function(domElem){},handleColumnHighlighting:function(domElem){var maxWidth={};var currentNthChild=null;var self=this;$('td',domElem).each(function(){var $this=$(this);if($this.hasClass('label')){return;}
var table=$this.closest('table');var nthChild=$this.parent('tr').children().index($(this))+1;var rows=$('> tbody > tr',table);if(!maxWidth[nthChild]){maxWidth[nthChild]=0;rows.find("td:nth-child("+(nthChild)+").column .value").add('> thead th:not(.label) .thDIV',table).each(function(index,element){var width=$(element).width();if(width>maxWidth[nthChild]){maxWidth[nthChild]=width;}});rows.find("td:nth-child("+(nthChild)+").column .value").each(function(index,element){$(element).closest('td').css({width:maxWidth[nthChild]});});}});$(domElem).on('mouseenter','td',function(e){e.stopPropagation();var $this=$(e.target);if($this.hasClass('label')){return;}
var table=$this.closest('table');var nthChild=$this.parent('tr').children().index($(e.target))+1;var rows=$('> tbody > tr',table);if(currentNthChild===nthChild){return;}
currentNthChild=nthChild;rows.children("td:nth-child("+(nthChild)+")").addClass('highlight');self.repositionRowActions($this.parent('tr'));});$(domElem).on('mouseleave','td',function(event){var $this=$(event.target);var table=$this.closest('table');var $parentTr=$this.parent('tr');var tr=$parentTr.children();var nthChild=$parentTr.children().index($this);var targetTd=$(event.relatedTarget).closest('td');var nthChildTarget=targetTd.parent('tr').children().index(targetTd);if(nthChild==nthChildTarget){return;}
currentNthChild=null;var rows=$('tr',table);rows.find("td:nth-child("+(nthChild+1)+")").removeClass('highlight');});},getComparisonIdSubtables:function($row){if($row.is('.parentComparisonRow')){var comparisonRows=$row.nextUntil('.parentComparisonRow').filter('.comparisonRow');var comparisonIdSubtables={};comparisonRows.each(function(){var comparisonSeriesIndex=+$(this).data('comparison-series');comparisonIdSubtables[comparisonSeriesIndex]=$(this).data('idsubtable');});return JSON.stringify(comparisonIdSubtables);}
return undefined;},handleSubDataTable:function(domElem){var self=this;self.numberOfSubtables=$('tr.subDataTable',domElem).click(function(){var idSubTable=$(this).attr('id');var divIdToReplaceWithSubTable='subDataTable_'+idSubTable;if(typeof self.loadedSubDataTable[divIdToReplaceWithSubTable]=="undefined"){var numberOfColumns=$(this).closest('table').find('thead tr').first().children().length;var $insertAfter=$(this).nextUntil(':not(.comparePeriod):not(.comparisonRow)').last();if(!$insertAfter.length){$insertAfter=$(this);}
var newRow=$insertAfter.after('<tr class="subDataTableContainer">'+'<td colspan="'+numberOfColumns+'" class="cellSubDataTable">'+'<div id="'+divIdToReplaceWithSubTable+'">'+'<span class="loadingPiwik" style="display:inline"><img src="plugins/Morpheus/images/loading-blue.gif" />'+_pk_translate('General_Loading')+'</span>'+'</div>'+'</td>'+'</tr>');piwikHelper.lazyScrollTo(newRow);var savedActionVariable=self.param.action;var filtersToRestore=self.resetAllFilters();self.param.enable_filter_excludelowpop=filtersToRestore.enable_filter_excludelowpop;self.param.idSubtable=idSubTable;self.param.action=self.props.subtable_controller_action;delete self.param.totalRows;var extraParams={};extraParams.comparisonIdSubtables=self.getComparisonIdSubtables($(this));self.reloadAjaxDataTable(false,function(response){self.dataTableLoaded(response,divIdToReplaceWithSubTable);},extraParams);self.param.action=savedActionVariable;delete self.param.idSubtable;self.restoreAllFilters(filtersToRestore);self.loadedSubDataTable[divIdToReplaceWithSubTable]=true;$(this).find('div.dataTableRowActions').hide();}else{var $toToggle=$(this).nextUntil('.subDataTableContainer').last();$toToggle=$toToggle.length?$toToggle:$(this);$toToggle.next().toggle();}
$(this).toggleClass('expanded');self.repositionRowActions($(this));}).length;},handleColumnDocumentation:function(domElem){if(this.isDashboard()){return;}
$('th:has(.columnDocumentation)',domElem).each(function(){var th=$(this);var tooltip=th.find('.columnDocumentation');tooltip.next().hover(function(){var left=(-1*tooltip.outerWidth()/ 2)+th.width()/ 2;var top=-1*tooltip.outerHeight();var thPos=th.position();var thPosTop=0;if(thPos&&thPos.top){thPosTop=thPos.top;}
top=top+thPosTop;if(!th.next().length){left=(-1*tooltip.outerWidth())+th.width()+
parseInt(th.css('padding-right'),10);}
if(th.offset().top+top<0){top=thPosTop+th.outerHeight();}
tooltip.css({marginLeft:left,marginTop:top,top:0});tooltip.stop(true,true).fadeIn(250);},function(){$(this).prev().stop(true,true).fadeOut(400);});});},handleRowActions:function(domElem){this.doHandleRowActions(domElem.find('table > tbody > tr'));},handleCellTooltips:function(domElem){domElem.find('span.cell-tooltip').tooltip({track:true,items:'span',content:function(){return $(this).parent().data('tooltip');},show:false,hide:false,tooltipClass:'small'});domElem.find('span.ratio').tooltip({track:true,content:function(){var title=$(this).attr('title');return piwikHelper.escape(title.replace(/\n/g,'<br />'));},show:{delay:700,duration:200},hide:false})},handleRelatedReports:function(domElem){var self=this,hideShowRelatedReports=function(thisReport){$('span',$(thisReport).parent().parent()).each(function(){if(thisReport==this)
$(this).hide();else
$(this).show();});},thisReport=$('.datatableRelatedReports span:hidden',domElem)[0];function replaceReportTitleAndHelp(domElem,relatedReportName){if(!domElem||!domElem.length){return;}
var $title='';var $headline=domElem.prev('h2');if($headline.length){$title=$headline.find('.title:not(.ng-hide)');}else{var $widget=domElem.parents('.widget');if($widget.length){$title=$widget.find('.widgetName > span');}}
if($title.length){$title.text(relatedReportName);var scope=$title.scope();if(scope){var $doc=domElem.find('.reportDocumentation');if($doc.length){scope.inlineHelp=$.trim($doc.html());}
scope.featureName=$.trim(relatedReportName);setTimeout(function(){scope.$apply();},1);}}}
hideShowRelatedReports(thisReport);var relatedReports=$('.datatableRelatedReports span',domElem);if(!relatedReports.length){$('.datatableRelatedReports',domElem).hide();}
relatedReports.each(function(){var clicked=this;$(this).unbind('click').click(function(e){var $this=$(this);var url=$this.attr('href');self.resetAllFilters();var newParams=broadcast.getValuesFromUrl(url);for(var key in newParams){self.param[key]=decodeURIComponent(newParams[key]);}
delete self.param.pivotBy;delete self.param.pivotByColumn;var relatedReportName=$this.text();self.reloadAjaxDataTable(true,(function(relatedReportName){return function(newReport){var newDomElem=self.dataTableLoaded(newReport,self.workingDivId);hideShowRelatedReports(clicked);replaceReportTitleAndHelp(newDomElem,relatedReportName);}})(relatedReportName));});});},handleTriggeredEvents:function(domElem){var self=this;$(domElem).bind('reload',function(e,paramOverride){paramOverride=paramOverride||{};for(var name in paramOverride){self.param[name]=paramOverride[name];}
self.reloadAjaxDataTable(true);});},handleSummaryRow:function(domElem){var details=_pk_translate('General_LearnMore',[' (<a href="https://matomo.org/faq/how-to/faq_54/" rel="noreferrer noopener" target="_blank">','</a>)']);domElem.find('tr.summaryRow').each(function(){var labelSpan=$(this).find('.label .value').filter(function(index,elem){return $(elem).text()!='-';}).last();var defaultLabel=labelSpan.text();$(this).hover(function(){labelSpan.html(defaultLabel+details);},function(){labelSpan.text(defaultLabel);});});},doHandleRowActions:function(trs){if(!trs||!trs.length||!trs[0]){return;}
var parent=$(trs[0]).parents('table');var self=this;var merged=$.extend({},self.param,self.props);var availableActionsForReport=DataTable_RowActions_Registry.getAvailableActionsForReport(merged);if(availableActionsForReport.length==0){return;}
var actionInstances={};for(var i=0;i<availableActionsForReport.length;i++){var action=availableActionsForReport[i];actionInstances[action.name]=action.createInstance(self);}
var useTouchEvent=false;var listenEvent='mouseenter';var userAgent=String(navigator.userAgent).toLowerCase();if(userAgent.match(/(iPod|iPhone|iPad|Android|IEMobile|Windows Phone)/i)){useTouchEvent=true;listenEvent='click';}
parent.on(listenEvent,'tr:not(.subDataTableContainer)',function(){var tr=this;var $tr=$(tr);var td=$tr.find('td.label:last');for(var i=0;i<availableActionsForReport.length;i++){var action=availableActionsForReport[i];actionInstances[action.name].initTr($tr);}
td.css('minWidth',$tr.is('.comparisonRow')?'117px':'145px');if($(this).is('.parentComparisonRow,.comparePeriod').length){return;}
if(useTouchEvent&&tr.actionsDom&&tr.actionsDom.prop('rowActionsVisible')){tr.actionsDom.prop('rowActionsVisible',false);tr.actionsDom.hide();return;}
if(!tr.actionsDom){tr.actionsDom=self.createRowActions(availableActionsForReport,$tr,actionInstances);td.prepend(tr.actionsDom);}
self.repositionRowActions($tr);if($(window).width()>=600||useTouchEvent){tr.actionsDom.show();}
if(useTouchEvent){tr.actionsDom.prop('rowActionsVisible',true);}});if(!useTouchEvent){parent.on('mouseleave','tr',function(){var tr=this;if(tr.actionsDom){tr.actionsDom.hide();}});}},createRowActions:function(availableActionsForReport,tr,actionInstances){var container=$(document.createElement('div')).addClass('dataTableRowActions');for(var i=availableActionsForReport.length-1;i>=0;i--){var action=availableActionsForReport[i];if(!action.isAvailableOnRow(this.param,tr)){continue;}
var actionEl=$(document.createElement('a')).attr({href:'#'}).addClass('action'+action.name);if(action.dataTableIcon.indexOf('icon-')===0){actionEl.append($(document.createElement('span')).addClass(action.dataTableIcon+' rowActionIcon'));}else{actionEl.append($(document.createElement('img')).attr({src:action.dataTableIcon}));}
container.append(actionEl);if(i==availableActionsForReport.length-1){actionEl.addClass('leftmost');}
if(i==0){actionEl.addClass('rightmost');}
actionEl.click((function(action,el){return function(e){$(this).blur().tooltip('close');container.hide();if(typeof actionInstances[action.name].onClick=='function'){return actionInstances[action.name].onClick(el,tr,e);}
actionInstances[action.name].trigger(tr,e);return false;}})(action,actionEl));if(typeof action.dataTableIconHover!='undefined'){actionEl.append($(document.createElement('img')).attr({src:action.dataTableIconHover}).hide());actionEl.hover(function(){var img=$(this).find('img');img.eq(0).hide();img.eq(1).show();},function(){var img=$(this).find('img');img.eq(1).hide();img.eq(0).show();});}
if(typeof action.dataTableIconTooltip!='undefined'){actionEl.tooltip({track:true,items:'a',content:'<h3>'+action.dataTableIconTooltip[0]+'</h3>'+action.dataTableIconTooltip[1],tooltipClass:'rowActionTooltip',show:false,hide:false});}}
return container;},repositionRowActions:function(tr){if(!tr){return;}
var td=tr.find('td.label:last');var actions=tr.find('div.dataTableRowActions');if(!actions){return;}
actions.height(tr.innerHeight()-6);actions.css('marginLeft',(td.width()-3-actions.outerWidth())+'px');},_findReportHeader:function(domElem){var h2=false;if(domElem.prev().is('h2')){h2=domElem.prev();}
else if(this.param.viewDataTable=='tableGoals'){h2=$('#titleGoalsByDimension');}
else if($('h2',domElem)){h2=$('h2',domElem);}
return h2;},_createDivId:function(){return'dataTable_'+this._controlId;}});var switchToHtmlTable=function(dataTable,viewDataTable){dataTable.param.viewDataTable=viewDataTable;delete dataTable.param.enable_filter_excludelowpop;delete dataTable.param.filter_sort_column;delete dataTable.param.filter_sort_order;delete dataTable.param.columns;delete dataTable.param.totals;dataTable.reloadAjaxDataTable();dataTable.notifyWidgetParametersChange(dataTable.$element,{viewDataTable:viewDataTable});};var switchToEcommerceView=function(dataTable,viewDataTable){if(viewDataTable=='ecommerceOrder'){dataTable.param.abandonedCarts='0';}else{dataTable.param.abandonedCarts='1';}
var viewDataTable=dataTable.param.viewDataTable;if(viewDataTable=='ecommerceOrder'||viewDataTable=='ecommerceAbandonedCart'){viewDataTable='table';}
switchToHtmlTable(dataTable,viewDataTable);};DataTable.registerFooterIconHandler('table',switchToHtmlTable);DataTable.registerFooterIconHandler('tableAllColumns',switchToHtmlTable);DataTable.registerFooterIconHandler('tableGoals',switchToHtmlTable);DataTable.registerFooterIconHandler('ecommerceOrder',switchToEcommerceView);DataTable.registerFooterIconHandler('ecommerceAbandonedCart',switchToEcommerceView);DataTable.switchToGraph=function(dataTable,viewDataTable){var filters=dataTable.resetAllFilters();dataTable.param.flat=filters.flat;dataTable.param.keep_totals_row=filters.keep_totals_row;dataTable.param.columns=filters.columns;dataTable.param.viewDataTable=viewDataTable;dataTable.reloadAjaxDataTable();dataTable.notifyWidgetParametersChange(dataTable.$element,{viewDataTable:viewDataTable});};DataTable.registerFooterIconHandler('cloud',DataTable.switchToGraph);exports.DataTable=DataTable;})(jQuery,require);
var DataTable_RowActions_Registry={registry:[],register:function(action){var createInstance=action.createInstance;action.createInstance=function(dataTable,param){var instance=createInstance(dataTable,param);instance.actionName=action.name;return instance;};this.registry.push(action);},getAvailableActionsForReport:function(dataTableParams,tr){if(dataTableParams.disable_row_actions=='1'){return[];}
var available=[];for(var i=0;i<this.registry.length;i++){if(this.registry[i].isAvailableOnReport(dataTableParams,tr)){available.push(this.registry[i]);}}
available.sort(function(a,b){return b.order-a.order;});return available;},getActionByName:function(name){for(var i=0;i<this.registry.length;i++){if(this.registry[i].name==name){return this.registry[i];}}
return false;}};DataTable_RowActions_Registry.register({name:'RowEvolution',dataTableIcon:'icon-evolution',order:50,dataTableIconTooltip:[_pk_translate('General_RowEvolutionRowActionTooltipTitle'),_pk_translate('General_RowEvolutionRowActionTooltip')],createInstance:function(dataTable,param){if(dataTable!==null&&typeof dataTable.rowEvolutionActionInstance!='undefined'){return dataTable.rowEvolutionActionInstance;}
if(dataTable===null&&param){var report=param.split(':')[0];var div=$(require('piwik/UI').DataTable.getDataTableByReport(report));if(div.length&&div.data('uiControlObject')){dataTable=div.data('uiControlObject');if(typeof dataTable.rowEvolutionActionInstance!='undefined'){return dataTable.rowEvolutionActionInstance;}}}
var instance=new DataTable_RowActions_RowEvolution(dataTable);if(dataTable!==null){dataTable.rowEvolutionActionInstance=instance;}
return instance;},isAvailableOnReport:function(dataTableParams){return(typeof dataTableParams.disable_row_evolution=='undefined'||dataTableParams.disable_row_evolution=="0");},isAvailableOnRow:function(dataTableParams,tr){return!tr.hasClass('totalsRow');}});function DataTable_RowAction(dataTable){this.dataTable=dataTable;this.trEventName='piwikTriggerRowAction';this.actionName='RowAction';}
DataTable_RowAction.prototype.initTr=function(tr){var self=this;tr.bind(self.trEventName,function(e,params){self.trigger($(this),params.originalEvent,params.label,params.originalRow);});};DataTable_RowAction.prototype.trigger=function(tr,e,subTableLabel,originalRow){var label=this.getLabelFromTr(tr);if(subTableLabel){var separator=' > ';label+=separator+subTableLabel;}
var subtable=tr.closest('table');if(subtable.is('.subDataTable')){subtable.closest('tr').prev().trigger(this.trEventName,{label:label,originalEvent:e,originalRow:tr});return;}
if(subtable.closest('div.dataTableActions').length){var allClasses=tr.attr('class');var matches=allClasses.match(/level[0-9]+/);var level=parseInt(matches[0].substring(5,matches[0].length),10);if(level>0){var findLevel='level'+(level-1);var ptr=tr;while((ptr=ptr.prev()).length){if(!ptr.hasClass(findLevel)||ptr.hasClass('nodata')){continue;}
ptr.trigger(this.trEventName,{label:label,originalEvent:e,originalRow:tr});return;}}}
this.performAction(label,tr,e,originalRow);};DataTable_RowAction.prototype.getLabelFromTr=function(tr){if(tr.data('label')){return tr.data('label');}
var rowMetadata=this.getRowMetadata(tr);if(rowMetadata.combinedLabel){return'@'+rowMetadata.combinedLabel;}
var label=tr.find('span.label');var value=label.data('originalText');if(!value){value=label.text();}
value=value.trim();value=encodeURIComponent(value);if(!tr.hasClass('subDataTable')){value='@'+value;}
return value;};DataTable_RowAction.prototype.getRowMetadata=function(tr){return tr.data('row-metadata')||{};};DataTable_RowAction.prototype.openPopover=function(parameter){broadcast.propagateNewPopoverParameter('RowAction',this.actionName+':'+parameter);};broadcast.addPopoverHandler('RowAction',function(param){var paramParts=param.split(':');var rowActionName=paramParts[0];paramParts.shift();param=paramParts.join(':');var rowAction=DataTable_RowActions_Registry.getActionByName(rowActionName);if(rowAction){rowAction.createInstance(null,param).doOpenPopover(param);}});DataTable_RowAction.prototype.performAction=function(label,tr,e){};DataTable_RowAction.prototype.doOpenPopover=function(parameter){};function DataTable_RowActions_RowEvolution(dataTable){this.dataTable=dataTable;this.trEventName='piwikTriggerRowEvolution';this.multiEvolutionRows=[];this.multiEvolutionRowsSeries=[];}
DataTable_RowActions_RowEvolution.launch=function(apiMethod,label){var param='RowEvolution:'+apiMethod+':0:'+label;broadcast.propagateNewPopoverParameter('RowAction',param);};DataTable_RowActions_RowEvolution.prototype=new DataTable_RowAction;DataTable_RowActions_RowEvolution.prototype.performAction=function(label,tr,e,originalRow){if(e.shiftKey){this.addMultiEvolutionRow(label,$(originalRow||tr).data('comparison-series'));return;}
this.addMultiEvolutionRow(label,$(originalRow||tr).data('comparison-series'));var extraParams=$.extend({},$(originalRow||tr).data('param-override'));if(typeof extraParams!=='object'){extraParams={};}
if(this.multiEvolutionRows.length>1){extraParams.action='getMultiRowEvolutionPopover';label=this.multiEvolutionRows.join(',');if(this.multiEvolutionRowsSeries.length>1){var piwikUrl=piwikHelper.getAngularDependency('piwikUrl');extraParams.compareDates=piwikUrl.getSearchParam('compareDates');extraParams.comparePeriods=piwikUrl.getSearchParam('comparePeriods');extraParams.compareSegments=piwikUrl.getSearchParam('compareSegments');extraParams.labelSeries=this.multiEvolutionRowsSeries.join(',');delete extraParams.period;delete extraParams.date;delete extraParams.segment;}}
$.each(this.dataTable.param,function(index,value){if(index!=='idSite'&&index.indexOf('id')===0&&$.isNumeric(value)){extraParams[index]=value;}});if(this.dataTable.param.abandonedCarts!==undefined){extraParams['abandonedCarts']=this.dataTable.param.abandonedCarts;}
if(this.dataTable.param.flat!==undefined){extraParams['flat']=this.dataTable.param.flat;}
var apiMethod=this.dataTable.param.module+'.'+this.dataTable.param.action;this.openPopover(apiMethod,extraParams,label);};DataTable_RowActions_RowEvolution.prototype.addMultiEvolutionRow=function(label,seriesIndex){if(typeof seriesIndex!=='undefined'){var self=this;var found=false;this.multiEvolutionRows.forEach(function(rowLabel,index){var rowSeriesIndex=self.multiEvolutionRowsSeries[index];if(label===rowLabel&&seriesIndex===rowSeriesIndex){found=true;return false;}});if(!found){this.multiEvolutionRows.push(label);this.multiEvolutionRowsSeries.push(seriesIndex);}}else if($.inArray(label,this.multiEvolutionRows)===-1){this.multiEvolutionRows.push(label);this.multiEvolutionRowsSeries=[];}};DataTable_RowActions_RowEvolution.prototype.openPopover=function(apiMethod,extraParams,label){var urlParam=apiMethod+':'+encodeURIComponent(JSON.stringify(extraParams))+':'+label;DataTable_RowAction.prototype.openPopover.apply(this,[urlParam]);};DataTable_RowActions_RowEvolution.prototype.doOpenPopover=function(urlParam){var urlParamParts=urlParam.split(':');var apiMethod=urlParamParts.shift();var extraParamsString=urlParamParts.shift(),extraParams={};try{extraParams=JSON.parse(decodeURIComponent(extraParamsString));}catch(e){if(extraParamsString=='1'){extraParams.action='getMultiRowEvolutionPopover';}else if(extraParamsString!='0'){extraParams.action='getMultiRowEvolutionPopover';extraParams.column=extraParamsString;}}
var label=urlParamParts.join(':');this.showRowEvolution(apiMethod,label,extraParams);};DataTable_RowActions_RowEvolution.prototype.showRowEvolution=function(apiMethod,label,extraParams){var self=this;var box=Piwik_Popover.showLoading('Row Evolution');box.addClass('rowEvolutionPopover');var requestParams={apiMethod:apiMethod,label:label,disableLink:1};var callback=function(html){Piwik_Popover.setContent(html);var title=box.find('div.popover-title');if(title.length){Piwik_Popover.setTitle(title.html());title.remove();}
Piwik_Popover.onClose(function(){self.multiEvolutionRows=[];self.multiEvolutionRowsSeries=[];});if(self.dataTable!==null){box.find('.rowevolution-startmulti').click(function(){Piwik_Popover.onClose(false);broadcast.propagateNewPopoverParameter(false);return false;});}else{box.find('.compare-container, .rowevolution-startmulti').remove();}
box.find('select.multirowevoltion-metric').change(function(){var metric=$(this).val();Piwik_Popover.onClose(false);var extraParams={action:'getMultiRowEvolutionPopover',column:metric};self.openPopover(apiMethod,extraParams,label);return true;});};requestParams.module='CoreHome';requestParams.action='getRowEvolutionPopover';requestParams.colors=JSON.stringify(piwik.getSparklineColors());var idDimension;if(broadcast.getValueFromUrl('module')==='Widgetize'){idDimension=broadcast.getValueFromUrl('subcategory');}else{idDimension=broadcast.getValueFromHash('subcategory');}
if(idDimension&&(''+idDimension).indexOf('customdimension')===0){idDimension=(''+idDimension).replace('customdimension','');idDimension=parseInt(idDimension,10);if(idDimension>0){requestParams.idDimension=idDimension;}}
if(self.dataTable&&self.dataTable.jsViewDataTable==='tableGoals'){if(extraParams['idGoal']){delete(extraParams['idGoal']);}}
$.extend(requestParams,extraParams);var ajaxRequest=new ajaxHelper();ajaxRequest.addParams(requestParams,'get');ajaxRequest.setCallback(callback);ajaxRequest.setFormat('html');ajaxRequest.send();};
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($){var piwikMinDate=new Date(piwik.minDateYear,piwik.minDateMonth-1,piwik.minDateDay),piwikMaxDate=new Date(piwik.maxDateYear,piwik.maxDateMonth-1,piwik.maxDateDay);piwik.getBaseDatePickerOptions=function(defaultDate){return{showOtherMonths:false,dateFormat:'yy-mm-dd',firstDay:1,minDate:piwikMinDate,maxDate:piwikMaxDate,prevText:"",nextText:"",currentText:"",defaultDate:defaultDate,changeMonth:true,changeYear:true,stepMonths:1,dayNamesMin:[_pk_translate('Intl_Day_Min_StandAlone_7'),_pk_translate('Intl_Day_Min_StandAlone_1'),_pk_translate('Intl_Day_Min_StandAlone_2'),_pk_translate('Intl_Day_Min_StandAlone_3'),_pk_translate('Intl_Day_Min_StandAlone_4'),_pk_translate('Intl_Day_Min_StandAlone_5'),_pk_translate('Intl_Day_Min_StandAlone_6')],dayNamesShort:[_pk_translate('Intl_Day_Short_StandAlone_7'),_pk_translate('Intl_Day_Short_StandAlone_1'),_pk_translate('Intl_Day_Short_StandAlone_2'),_pk_translate('Intl_Day_Short_StandAlone_3'),_pk_translate('Intl_Day_Short_StandAlone_4'),_pk_translate('Intl_Day_Short_StandAlone_5'),_pk_translate('Intl_Day_Short_StandAlone_6')],dayNames:[_pk_translate('Intl_Day_Long_StandAlone_7'),_pk_translate('Intl_Day_Long_StandAlone_1'),_pk_translate('Intl_Day_Long_StandAlone_2'),_pk_translate('Intl_Day_Long_StandAlone_3'),_pk_translate('Intl_Day_Long_StandAlone_4'),_pk_translate('Intl_Day_Long_StandAlone_5'),_pk_translate('Intl_Day_Long_StandAlone_6')],monthNamesShort:[_pk_translate('Intl_Month_Short_StandAlone_1'),_pk_translate('Intl_Month_Short_StandAlone_2'),_pk_translate('Intl_Month_Short_StandAlone_3'),_pk_translate('Intl_Month_Short_StandAlone_4'),_pk_translate('Intl_Month_Short_StandAlone_5'),_pk_translate('Intl_Month_Short_StandAlone_6'),_pk_translate('Intl_Month_Short_StandAlone_7'),_pk_translate('Intl_Month_Short_StandAlone_8'),_pk_translate('Intl_Month_Short_StandAlone_9'),_pk_translate('Intl_Month_Short_StandAlone_10'),_pk_translate('Intl_Month_Short_StandAlone_11'),_pk_translate('Intl_Month_Short_StandAlone_12')],monthNames:[_pk_translate('Intl_Month_Long_StandAlone_1'),_pk_translate('Intl_Month_Long_StandAlone_2'),_pk_translate('Intl_Month_Long_StandAlone_3'),_pk_translate('Intl_Month_Long_StandAlone_4'),_pk_translate('Intl_Month_Long_StandAlone_5'),_pk_translate('Intl_Month_Long_StandAlone_6'),_pk_translate('Intl_Month_Long_StandAlone_7'),_pk_translate('Intl_Month_Long_StandAlone_8'),_pk_translate('Intl_Month_Long_StandAlone_9'),_pk_translate('Intl_Month_Long_StandAlone_10'),_pk_translate('Intl_Month_Long_StandAlone_11'),_pk_translate('Intl_Month_Long_StandAlone_12')]};};piwikHelper.registerShortcut('d',_pk_translate('CoreHome_ShortcutCalendar'),function(event){if(event.altKey){return;}
if(event.preventDefault){event.preventDefault();}else{event.returnValue=false;}
$('#periodString .title').trigger('click').focus();});}(jQuery));
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($){var sparklineColorNames=['backgroundColor','lineColor','minPointColor','maxPointColor','lastPointColor','fillColor'];var sparklineDisplayHeight=25;var sparklineDisplayWidth=100;piwik.getSparklineColors=function(){var colors=piwik.ColorManager.getColors('sparkline-colors',sparklineColorNames);var comparisonService=piwikHelper.getAngularDependency('piwikComparisonsService');if(comparisonService.isComparing()){var comparisons=comparisonService.getAllComparisonSeries();colors.lineColor=comparisons.map(function(comp){return comp.color;});}
return colors;};piwik.initSparklines=function(){$('.sparkline img').each(function(){var $self=$(this);if($self.attr('src')){return;}
var seriesIndices=$self.closest('.sparkline').data('series-indices');var sparklineColors=piwik.getSparklineColors();if(seriesIndices&&sparklineColors.lineColor instanceof Array){sparklineColors.lineColor=sparklineColors.lineColor.filter(function(c,index){return seriesIndices.indexOf(index)!==-1;});}
var colors=JSON.stringify(sparklineColors);var appendToSparklineUrl='&colors='+encodeURIComponent(colors);var token_auth=broadcast.getValueFromUrl('token_auth');if(token_auth.length&&piwik.shouldPropagateTokenAuth){appendToSparklineUrl+='&token_auth='+token_auth;}
$self.attr('width',sparklineDisplayWidth);$self.attr('height',sparklineDisplayHeight);$self.attr('src',$self.attr('data-src')+appendToSparklineUrl);});};window.initializeSparklines=function(){$('.dataTableVizEvolution[data-report]').each(function(){var graph=$(this);var selectorsToFindParent=['.widget','[piwik-widget-container]','.reporting-page','body'];var index=0,selector,parent;for(index;index<selectorsToFindParent.length;index++){selector=selectorsToFindParent[index];parent=graph.parents(selector).first();if(parent&&parent.length){break;}}
if(!parent||!parent.length){return;}
var sparklines=parent.find('div.sparkline:not(.notLinkable)');sparklines.each(function(){var sparklineUrl=$('img',this).attr('data-src');var $this=$(this);if(sparklineUrl!=""){$this.addClass('linked');var params=$this.data('graph-params')||{};if(!Object.keys(params).length){var urlParams=broadcast.getValuesFromUrl(sparklineUrl);if(urlParams.columns){params.columns=decodeURIComponent(urlParams.columns);}
if(urlParams.rows){params.rows=decodeURIComponent(urlParams.rows);}}
$this.off('click.sparkline');$this.on('click.sparkline',function(){var reportId=graph.attr('data-report'),dataTable=graph;if(dataTable.length==0){if($(this).closest('.widget').length){dataTable=$(this).closest('.widget').find('div.dataTableVizEvolution');}else{dataTable=$('div.dataTableVizEvolution');}}
dataTable.trigger('reload',params);});}});});};}(jQuery));
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($){$(function(){var headerMessageParent=$('#header_message').parent();initTopControls();headerMessageParent.on('click','#updateCheckLinkContainer',function(e){var headerMessage=$(this).closest('#header_message');var $titleElement=headerMessage.find('.title');if($titleElement.attr('target')){return;}
e.preventDefault();var ajaxRequest=new ajaxHelper();ajaxRequest.setLoadingElement('#header_message .loadingPiwik');ajaxRequest.addParams({module:'CoreHome',action:'checkForUpdates'},'get');ajaxRequest.withTokenInUrl();$titleElement.addClass('activityIndicator');ajaxRequest.setCallback(function(response){headerMessage.fadeOut('slow',function(){response=$('#header_message',$('<div>'+response+'</div>'));$titleElement.removeClass('activityIndicator');var newVersionAvailable=response.hasClass('update_available');if(newVersionAvailable){headerMessage.replaceWith(response);headerMessage.show();}
else{headerMessage.find('.title').html(_pk_translate('CoreHome_YouAreUsingTheLatestVersion'));headerMessage.show();setTimeout(function(){headerMessage.fadeOut('slow',function(){headerMessage.replaceWith(response);});},4000);}});});ajaxRequest.setFormat('html');ajaxRequest.send();return false;});headerMessageParent.on('click','#header_message',function(e){if(e.target.tagName.toLowerCase()!='a'){$(this).toggleClass('expanded');}});});}(jQuery));$(document).ready(function(){$('.accessibility-skip-to-content').click(function(e){$('a[name="main"]').attr('tabindex',-1).focus();$(window).scrollTo($('a[name="main"]'));});$("nav .activateTopMenu").sideNav({closeOnClick:true,edge:'right'});$('select').material_select();piwikHelper.registerShortcut('?',_pk_translate('CoreHome_ShortcutHelp'),function(event){if(event.altKey||$('.modal.open').length){return;}
if(event.preventDefault){event.preventDefault();}else{event.returnValue=false;}
var list=$('#shortcuthelp dl');list.empty();var keys=Object.keys(piwikHelper.shortcuts).sort();jQuery.each(keys,function(i,key){if(piwikHelper.shortcuts.hasOwnProperty(key)){list.append($('<dt />').append($('<kbd />').text(key)));list.append($('<dd />').text(piwikHelper.shortcuts[key]));}});var isMac=navigator.userAgent.indexOf('Mac OS X')!=-1;list.append($('<dt />').append($('<kbd />').text(_pk_translate(isMac?"CoreHome_MacPageUp":"CoreHome_HomeShortcut"))));list.append($('<dd />').text(_pk_translate('CoreHome_PageUpShortcutDescription')));list.append($('<dt />').append($('<kbd />').text(_pk_translate(isMac?"CoreHome_MacPageDown":"CoreHome_EndShortcut"))));list.append($('<dd />').text(_pk_translate('CoreHome_PageDownShortcutDescription')));piwikHelper.modalConfirm('#shortcuthelp');});});
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
function initTopControls(){function getOverlap(element1,element2){if(!element1||!element1.getBoundingClientRect||!element2||!element2.getBoundingClientRect){return 0;}
var rect1=element1.getBoundingClientRect();var rect2=element2.getBoundingClientRect();var doOverlap=!(rect1.right<rect2.left||rect1.left>rect2.right);if(doOverlap){return rect1.left-rect2.right;}
return 0;}
var $topControlsContainer=$('.top_controls');var allRendered=true;if($topControlsContainer.length){$topControlsContainer.find('.piwikTopControl').each(function(){var $control=$(this);if($control.css('display')=='none'){return;}
var width=$control.outerWidth(true);var isControlFullyRendered=width>=30;if(!isControlFullyRendered){allRendered=false;}});if(allRendered){$('.top_controls').css('visibility','visible');$('.top_controls').css('opacity','1');}}}
$(document).ready(function(){$('.periodSelector').keydown(function(e){toggleCalendar(e);})
blockPropegation();$('.periodSelector .form-radio').keydown(function(e){e.stopPropagation();if(e.which==13){selectPeriodRadioButton($(this));}})});$(document).ready(function(){$('.periodSelector').keydown(function(e){toggleCalendar(e);})
blockPropegation();$('.periodSelector .form-radio').keydown(function(e){e.stopPropagation();if(e.which==13){selectPeriodRadioButton($(this));}})});function toggleCalendar(e){var calendarOpen=$('.periodSelector').hasClass('expanded');if(e.which==13){if(calendarOpen){$('.periodSelector').removeClass('expanded');}else{$('.periodSelector').addClass('expanded');}}}
function selectPeriodRadioButton(button){$('.periodSelector .form-radio').removeClass('checked');button.addClass('checked');button.find('input').click();blockPropegation();}
function blockPropegation(){$('.ui-datepicker-month, .ui-datepicker-year, .periodSelector td a').keydown(function(e){e.stopPropagation();})}
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($){var colorNames={"aliceblue":"#f0f8ff","antiquewhite":"#faebd7","aqua":"#00ffff","aquamarine":"#7fffd4","azure":"#f0ffff","beige":"#f5f5dc","bisque":"#ffe4c4","black":"#000000","blanchedalmond":"#ffebcd","blue":"#0000ff","blueviolet":"#8a2be2","brown":"#a52a2a","burlywood":"#deb887","cadetblue":"#5f9ea0","chartreuse":"#7fff00","chocolate":"#d2691e","coral":"#ff7f50","cornflowerblue":"#6495ed","cornsilk":"#fff8dc","crimson":"#dc143c","cyan":"#00ffff","darkblue":"#00008b","darkcyan":"#008b8b","darkgoldenrod":"#b8860b","darkgray":"#a9a9a9","darkgreen":"#006400","darkkhaki":"#bdb76b","darkmagenta":"#8b008b","darkolivegreen":"#556b2f","darkorange":"#ff8c00","darkorchid":"#9932cc","darkred":"#8b0000","darksalmon":"#e9967a","darkseagreen":"#8fbc8f","darkslateblue":"#483d8b","darkslategray":"#2f4f4f","darkturquoise":"#00ced1","darkviolet":"#9400d3","deeppink":"#ff1493","deepskyblue":"#00bfff","dimgray":"#696969","dodgerblue":"#1e90ff","firebrick":"#b22222","floralwhite":"#fffaf0","forestgreen":"#228b22","fuchsia":"#ff00ff","gainsboro":"#dcdcdc","ghostwhite":"#f8f8ff","gold":"#ffd700","goldenrod":"#daa520","gray":"#808080","green":"#43a047","greenyellow":"#adff2f","honeydew":"#f0fff0","hotpink":"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082","ivory":"#fffff0","khaki":"#f0e68c","lavender":"#e6e6fa","lavenderblush":"#fff0f5","lawngreen":"#7cfc00","lemonchiffon":"#fffacd","lightblue":"#add8e6","lightcoral":"#f08080","lightcyan":"#e0ffff","lightgoldenrodyellow":"#fafad2","lightgrey":"#d3d3d3","lightgreen":"#90ee90","lightpink":"#ffb6c1","lightsalmon":"#ffa07a","lightseagreen":"#20b2aa","lightskyblue":"#87cefa","lightslategray":"#778899","lightsteelblue":"#b0c4de","lightyellow":"#ffffe0","lime":"#00ff00","limegreen":"#32cd32","linen":"#faf0e6","magenta":"#ff00ff","maroon":"#800000","mediumaquamarine":"#66cdaa","mediumblue":"#0000cd","mediumorchid":"#ba55d3","mediumpurple":"#9370d8","mediumseagreen":"#3cb371","mediumslateblue":"#7b68ee","mediumspringgreen":"#00fa9a","mediumturquoise":"#48d1cc","mediumvioletred":"#c71585","midnightblue":"#191970","mintcream":"#f5fffa","mistyrose":"#ffe4e1","moccasin":"#ffe4b5","navajowhite":"#ffdead","navy":"#000080","oldlace":"#fdf5e6","olive":"#808000","olivedrab":"#6b8e23","orange":"#ffa500","orangered":"#ff4500","orchid":"#da70d6","palegoldenrod":"#eee8aa","palegreen":"#98fb98","paleturquoise":"#afeeee","palevioletred":"#d87093","papayawhip":"#ffefd5","peachpuff":"#ffdab9","peru":"#cd853f","pink":"#ffc0cb","plum":"#dda0dd","powderblue":"#b0e0e6","purple":"#800080","red":"#ff0000","rosybrown":"#bc8f8f","royalblue":"#4169e1","saddlebrown":"#8b4513","salmon":"#fa8072","sandybrown":"#f4a460","seagreen":"#2e8b57","seashell":"#fff5ee","sienna":"#a0522d","silver":"#c0c0c0","skyblue":"#87ceeb","slateblue":"#6a5acd","slategray":"#708090","snow":"#fffafa","springgreen":"#00ff7f","steelblue":"#4682b4","tan":"#d2b48c","teal":"#008080","thistle":"#d8bfd8","tomato":"#ff6347","turquoise":"#40e0d0","violet":"#ee82ee","wheat":"#f5deb3","white":"#ffffff","whitesmoke":"#f5f5f5","yellow":"#ffff00","yellowgreen":"#9acd32"};var ColorManager=function(){};ColorManager.prototype={getColor:function(namespace,name){var element=this._getElement();element.attr('class','color-manager '+namespace).attr('data-name',name);return this._normalizeColor(element.css('color'));},getColors:function(namespace,names,asArray){var colors=asArray?[]:{};for(var i=0;i!=names.length;++i){var name=names[i],color=this.getColor(namespace,name);if(color){if(asArray){colors.push(color);}else{colors[name]=color;}}}
return colors;},getSingleColorFromGradient:function(spectrumStart,spectrumEnd,percentFromStart){if(!(spectrumStart instanceof Array)){spectrumStart=this.getRgb(spectrumStart);}
if(!(spectrumEnd instanceof Array)){spectrumEnd=this.getRgb(spectrumEnd);}
var result=[];for(var channel=0;channel!=spectrumStart.length;++channel){var delta=(spectrumEnd[channel]-spectrumStart[channel])*percentFromStart;result[channel]=Math.floor(spectrumStart[channel]+delta);}
return this.getHexColor(result);},getRgb:function(hexColor){if(hexColor[0]=='#'){hexColor=hexColor.substring(1);}
if(hexColor.length==3){return[parseInt(hexColor[0],16),parseInt(hexColor[1],16),parseInt(hexColor[2],16)];}else{return[parseInt(hexColor.substring(0,2),16),parseInt(hexColor.substring(2,4),16),parseInt(hexColor.substring(4,6),16)];}},getHexColor:function(rgbColor){for(var i=0;i!=rgbColor.length;++i){rgbColor[i]=("00"+rgbColor[i].toString(16)).slice(-2);}
return'#'+rgbColor.join('');},_normalizeColor:function(color){if(color==this._getTransparentColor()){return null;}
if(color&&colorNames[color]){return colorNames[color];}
if(color&&color[0]!='#'){var parts=color.split(/[()rgb,\s]+/);parts=[+parts[1],+parts[2],+parts[3]];color=this.getHexColor(parts);}
return color;},_getElement:function(){if(!this.$element){$('body').append('<div id="color-manager"></div>');this.$element=$('#color-manager');}
return this.$element;},_getTransparentColor:function(){if(!this.transparentColor){this.transparentColor=$('<div style="color:transparent;display:none;"></div>').appendTo($('body')).css('color');}
return this.transparentColor;}};piwik.ColorManager=new ColorManager();}(jQuery));
(function($,require){var exports=require('piwik/UI');var Notification=function(){this.$node=null;};Notification.prototype.show=function(message,options){checkMessage(message);options=checkOptions(options);var template=generateNotificationHtmlMarkup(options,message);this.$node=placeNotification(template,options);};Notification.prototype.remove=function(notificationId){$('[piwik-notification][notification-id='+notificationId+']').remove();};Notification.prototype.scrollToNotification=function(){if(this.$node){piwikHelper.lazyScrollTo(this.$node,250);}};Notification.prototype.toast=function(message,options){checkMessage(message);options=checkOptions(options);var $placeat=$(options.placeat);if(!$placeat.length){throw new Error("A valid selector is required for the placeat option when using Notification.toast().");}
var $template=$(generateNotificationHtmlMarkup(options,message)).hide();$('body').append($template);compileNotification($template);$template.css({position:'absolute',left:$placeat.offset().left,top:$placeat.offset().top});setTimeout(function(){$template.animate({top:$placeat.offset().top-$template.height()},{duration:300,start:function(){$template.show();}});});};exports.Notification=Notification;function generateNotificationHtmlMarkup(options,message){var attributeMapping={id:'notification-id',title:'notification-title',context:'context',type:'type',noclear:'noclear',class:'class',toastLength:'toast-length'},html='<div piwik-notification';for(var key in attributeMapping){if(attributeMapping.hasOwnProperty(key)&&options[key]){html+=' '+attributeMapping[key]+'="'+options[key].toString().replace(/"/g,"&quot;")+'"';}}
html+='>'+message+'</div>';return html;}
function compileNotification($node){angular.element(document).injector().invoke(function($compile,$rootScope){$compile($node)($rootScope.$new(true));});}
function placeNotification(template,options){var $notificationNode=$(template);compileNotification($notificationNode);if(options.style){$notificationNode.css(options.style);}
var notificationPosition='#notificationContainer';var method='append';if(options.placeat){notificationPosition=options.placeat;}else{var modalSelector='.modal.open .modal-content';var modalOpen=$(modalSelector);if(modalOpen.length){notificationPosition=modalSelector;method='prepend';}}
$notificationNode=$notificationNode.hide();$(notificationPosition)[method]($notificationNode);if(false===options.animate){$notificationNode.show();}else{$notificationNode.fadeIn(1000);}
return $notificationNode;}
function checkMessage(message){if(!message){throw new Error('No message given, cannot display notification');}}
function checkOptions(options){if(options&&!$.isPlainObject(options)){throw new Error('Options has the wrong format, cannot display notification');}else if(!options){options={};}
return options;}})(jQuery,require);
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
var NumberFormatter=(function(){var minimumFractionDigits=0;var maximumFractionDigits=2;function format(value,pattern){if(!$.isNumeric(value)){return value;}
pattern=pattern||piwik.numbers.patternNumber;var patterns=pattern.split(';');if(patterns.length==1){patterns.push('-'+patterns[0])}
var negative=value<0;pattern=negative?patterns[1]:patterns[0];var usesGrouping=(pattern.indexOf(',')!=-1);if(usesGrouping){var primaryGroupMatches=pattern.match(/#+0/);var primaryGroupSize=primaryGroupMatches[0].length;var secondaryGroupSize=primaryGroupMatches[0].length;var numberGroups=pattern.split(',');if(numberGroups.length>2){secondaryGroupSize=numberGroups[1].length;}}
var signMultiplier=negative?'-1':'1';value=value*signMultiplier;var valueParts=value.toString().split('.');var majorDigits=valueParts[0];minorDigits=valueParts[1]||'';if(usesGrouping){majorDigits=majorDigits.split('').reverse();var groups=[];groups.push(majorDigits.splice(0,primaryGroupSize).reverse().join(''));while(majorDigits.length){groups.push(majorDigits.splice(0,secondaryGroupSize).reverse().join(''));}
groups=groups.reverse();majorDigits=groups.join(',');}
if(minimumFractionDigits<maximumFractionDigits){var minorDigits=minorDigits.replace(/0+$/,'');if(minorDigits.length<minimumFractionDigits){var neededZeroes=minimumFractionDigits-minorDigits.length;minorDigits+=(new Array(neededZeroes+1)).join('0');}}
value=minorDigits?majorDigits+'.'+minorDigits:majorDigits;value=pattern.replace(/#(?:[\.,]#+)*0(?:[,\.][0#]+)*/,value);return replaceSymbols(value);}
function replaceSymbols(value){var replacements={'.':piwik.numbers.symbolDecimal,',':piwik.numbers.symbolGroup,'+':piwik.numbers.symbolPlus,'-':piwik.numbers.symbolMinus,'%':piwik.numbers.symbolPercent};var newValue='';var valueParts=value.split('');$.each(valueParts,function(index,value){$.each(replacements,function(char,replacement){if(value.indexOf(char)!=-1){value=value.replace(char,replacement);return false;}});newValue+=value;});return newValue;}
return{formatNumber:function(value){return format(value,piwik.numbers.patternNumber);},formatPercent:function(value){return format(value,piwik.numbers.patternPercent);},formatCurrency:function(value,currency){var formatted=format(value,piwik.numbers.patternCurrency);return formatted.replace('¤',currency);}}})();
$(function(){angular.element(document).injector().invoke(handleZenMode);function handleZenMode($rootElement,$cookies){var zenMode=!!parseInt($cookies.get('zenMode'),10);var iconSwitcher=$('.top_controls .icon-arrowup');iconSwitcher.click(function(event){Mousetrap.trigger('z')});function updateZenMode(){if(zenMode){$('body').addClass('zenMode');iconSwitcher.addClass('icon-arrowdown').removeClass('icon-arrowup');iconSwitcher.prop('title',_pk_translate('CoreHome_ExitZenMode'));}else{$('body').removeClass('zenMode');iconSwitcher.removeClass('icon-arrowdown').addClass('icon-arrowup');iconSwitcher.prop('title',_pk_translate('CoreHome_EnterZenMode'));}}
piwikHelper.registerShortcut('z',_pk_translate('CoreHome_ShortcutZenMode'),function(event){if(event.altKey){return;}
zenMode=!zenMode;$cookies.put('zenMode',zenMode?'1':'0');updateZenMode();});updateZenMode();}});
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
$(function(){if($.browser.msie&&parseInt($.browser.version)===10){$(document).on('click','a[rel~="noreferrer"]',function(event){event.preventDefault();var a=event.currentTarget;var w=window.open(a.href,a.target||'_self');if(/\bnoopener\b/.test(a.rel)){w.opener=null;}});}});
/*! iFrame Resizer (iframeSizer.min.js ) - v4.1.1 - 2019-04-10
 *  Desc: Force cross domain iframes to size to content.
 *  Requires: iframeResizer.contentWindow.min.js to be loaded into the target frame.
 *  Copyright: (c) 2019 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */

!function(f){if("undefined"!=typeof window){var e,l=0,m=!1,n=!1,p="message".length,b="[iFrameSizer]",y=b.length,v=null,r=window.requestAnimationFrame,g={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},F={},i=null,h={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",onClosed:function(){},onInit:function(){},onMessage:function(){O("onMessage function not defined")},onResized:function(){},onScroll:function(){return!0}},I={};window.jQuery&&((e=window.jQuery).fn?e.fn.iFrameResize||(e.fn.iFrameResize=function(i){return this.filter("iframe").each(function(e,n){d(n,i)}).end()}):z("","Unable to bind to jQuery, it is not fully loaded.")),"function"==typeof define&&define.amd?define([],B):"object"==typeof module&&"object"==typeof module.exports&&(module.exports=B()),window.iFrameResize=window.iFrameResize||B()}function w(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function M(e,n,i){e.addEventListener(n,i,!1)}function x(e,n,i){e.removeEventListener(n,i,!1)}function o(e){return b+"["+(i="Host page: "+(n=e),window.top!==window.self&&(i=window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+": "+n:"Nested host page: "+n),i)+"]";var n,i}function t(e){return F[e]?F[e].log:m}function k(e,n){a("log",e,n,t(e))}function z(e,n){a("info",e,n,t(e))}function O(e,n){a("warn",e,n,!0)}function a(e,n,i,t){!0===t&&"object"==typeof window.console&&console[e](o(n),i)}function s(n){function a(){e("Height"),e("Width"),j(function(){S(h),N(w),l("onResized",h)},h,"init")}function e(e){var n=Number(F[w]["max"+e]),i=Number(F[w]["min"+e]),t=e.toLowerCase(),o=Number(h[t]);k(w,"Checking "+t+" is in range "+i+"-"+n),o<i&&(o=i,k(w,"Set "+t+" to min value")),n<o&&(o=n,k(w,"Set "+t+" to max value")),h[t]=""+o}function s(e){return g.substr(g.indexOf(":")+p+e)}function d(i,t){var e,n,o;e=function(){var e,n;P("Send Page Info","pageInfo:"+(e=document.body.getBoundingClientRect(),n=h.iframe.getBoundingClientRect(),JSON.stringify({iframeHeight:n.height,iframeWidth:n.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(n.top-e.top,10),offsetLeft:parseInt(n.left-e.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,documentHeight:document.documentElement.clientHeight,documentWidth:document.documentElement.clientWidth,windowHeight:window.innerHeight,windowWidth:window.innerWidth})),i,t)},n=32,I[o=t]||(I[o]=setTimeout(function(){I[o]=null,e()},n))}function c(e){var n=e.getBoundingClientRect();return W(w),{x:Math.floor(Number(n.left)+Number(v.x)),y:Math.floor(Number(n.top)+Number(v.y))}}function u(e){var n=e?c(h.iframe):{x:0,y:0},i={x:Number(h.width)+n.x,y:Number(h.height)+n.y};k(w,"Reposition requested from iFrame (offset x:"+n.x+" y:"+n.y+")"),window.top!==window.self?window.parentIFrame?window.parentIFrame["scrollTo"+(e?"Offset":"")](i.x,i.y):O(w,"Unable to scroll to requested position, window.parentIFrame not found"):(v=i,f(),k(w,"--"))}function f(){!1!==l("onScroll",v)?N(w):C()}function l(e,n){return R(w,e,n)}var i,t,o,r,m,g=n.data,h={},w=null;"[iFrameResizerChild]Ready"===g?function(){for(var e in F)P("iFrame requested init",A(e),document.getElementById(e),e)}():b===(""+g).substr(0,y)&&g.substr(y).split(":")[0]in F?(m=g.substr(y).split(":"),h={iframe:F[m[0]]&&F[m[0]].iframe,id:m[0],height:m[1],width:m[2],type:m[3]},w=h.id,F[w]&&(F[w].loaded=!0),(r=h.type in{true:1,false:1,undefined:1})&&k(w,"Ignoring init message from meta parent page"),!r&&(o=!0,F[t=w]||(o=!1,O(h.type+" No settings for "+t+". Message was: "+g)),o)&&(k(w,"Received: "+g),i=!0,null===h.iframe&&(O(w,"IFrame ("+h.id+") not found"),i=!1),i&&function(){var e,i=n.origin,t=F[w]&&F[w].checkOrigin;if(t&&""+i!="null"&&!(t.constructor===Array?function(){var e=0,n=!1;for(k(w,"Checking connection is from allowed list of origins: "+t);e<t.length;e++)if(t[e]===i){n=!0;break}return n}():(e=F[w]&&F[w].remoteHost,k(w,"Checking connection is from: "+e),i===e)))throw new Error("Unexpected message received from: "+i+" for "+h.iframe.id+". Message was: "+n.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}()&&function(){switch(F[w]&&F[w].firstRun&&F[w]&&(F[w].firstRun=!1),h.type){case"close":F[w].closeRequeston?R(w,"onCloseRequest",F[w].iframe):T(h.iframe);break;case"message":r=s(6),k(w,"onMessage passed: {iframe: "+h.iframe.id+", message: "+r+"}"),l("onMessage",{iframe:h.iframe,message:JSON.parse(r)}),k(w,"--");break;case"scrollTo":u(!1);break;case"scrollToOffset":u(!0);break;case"pageInfo":d(F[w]&&F[w].iframe,w),function(){function e(n,i){function t(){F[r]?d(F[r].iframe,r):o()}["scroll","resize"].forEach(function(e){k(r,n+e+" listener for sendPageInfo"),i(window,e,t)})}function o(){e("Remove ",x)}var r=w;e("Add ",M),F[r]&&(F[r].stopPageInfo=o)}();break;case"pageInfoStop":F[w]&&F[w].stopPageInfo&&(F[w].stopPageInfo(),delete F[w].stopPageInfo);break;case"inPageLink":e=s(9),i=e.split("#")[1]||"",t=decodeURIComponent(i),(o=document.getElementById(t)||document.getElementsByName(t)[0])?(n=c(o),k(w,"Moving to in page link (#"+i+") at x: "+n.x+" y: "+n.y),v={x:n.x,y:n.y},f(),k(w,"--")):window.top!==window.self?window.parentIFrame?window.parentIFrame.moveToAnchor(i):k(w,"In page link #"+i+" not found and window.parentIFrame not found"):k(w,"In page link #"+i+" not found");break;case"reset":H(h);break;case"init":a(),l("onInit",h.iframe);break;default:a()}var e,n,i,t,o,r}())):z(w,"Ignored: "+g)}function R(e,n,i){var t=null,o=null;if(F[e]){if("function"!=typeof(t=F[e][n]))throw new TypeError(n+" on iFrame["+e+"] is not a function");o=t(i)}return o}function E(e){var n=e.id;delete F[n]}function T(e){var n=e.id;k(n,"Removing iFrame: "+n);try{e.parentNode&&e.parentNode.removeChild(e)}catch(e){O(e)}R(n,"onClosed",n),k(n,"--"),E(e)}function W(e){null===v&&k(e,"Get page position: "+(v={x:window.pageXOffset!==f?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==f?window.pageYOffset:document.documentElement.scrollTop}).x+","+v.y)}function N(e){null!==v&&(window.scrollTo(v.x,v.y),k(e,"Set page position: "+v.x+","+v.y),C())}function C(){v=null}function H(e){k(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),W(e.id),j(function(){S(e),P("reset","reset",e.iframe,e.id)},e,"reset")}function S(i){function t(e){n||"0"!==i[e]||(n=!0,k(o,"Hidden iFrame detected, creating visibility listener"),function(){function n(){Object.keys(F).forEach(function(e){!function(n){function e(e){return"0px"===(F[n]&&F[n].iframe.style[e])}F[n]&&(i=F[n].iframe,null!==i.offsetParent)&&(e("height")||e("width"))&&P("Visibility change","resize",F[n].iframe,n);var i}(F[e])})}function e(e){k("window","Mutation observed: "+e[0].target+" "+e[0].type),c(n,16)}var i=w();i&&(t=document.querySelector("body"),o={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},new i(e).observe(t,o));var t,o}())}function e(e){var n;n=e,i.id?(i.iframe.style[n]=i[n]+"px",k(i.id,"IFrame ("+o+") "+n+" set to "+i[n]+"px")):k("undefined","messageData id not set"),t(e)}var o=i.iframe.id;F[o]&&(F[o].sizeHeight&&e("height"),F[o].sizeWidth&&e("width"))}function j(e,n,i){i!==n.type&&r?(k(n.id,"Requesting animation frame"),r(e)):e()}function P(e,n,i,t,o){var r,a=!1;t=t||i.id,F[t]&&(i&&"contentWindow"in i&&null!==i.contentWindow?(r=F[t]&&F[t].targetOrigin,k(t,"["+e+"] Sending msg to iframe["+t+"] ("+n+") targetOrigin: "+r),i.contentWindow.postMessage(b+n,r)):O(t,"["+e+"] IFrame("+t+") not found"),o&&F[t]&&F[t].warningTimeout&&(F[t].msgTimeout=setTimeout(function(){!F[t]||F[t].loaded||a||(a=!0,O(t,"IFrame has not responded within "+F[t].warningTimeout/1e3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ignored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))},F[t].warningTimeout)))}function A(e){return e+":"+F[e].bodyMarginV1+":"+F[e].sizeWidth+":"+F[e].log+":"+F[e].interval+":"+F[e].enablePublicMethods+":"+F[e].autoResize+":"+F[e].bodyMargin+":"+F[e].heightCalculationMethod+":"+F[e].bodyBackground+":"+F[e].bodyPadding+":"+F[e].tolerance+":"+F[e].inPageLinks+":"+F[e].resizeFrom+":"+F[e].widthCalculationMethod}function d(i,e){function n(e){var n=e.split("Callback");if(2===n.length){var i="on"+n[0].charAt(0).toUpperCase()+n[0].slice(1);this[i]=this[e],delete this[e],O(u,"Deprecated: '"+e+"' has been renamed '"+i+"'. The old method will be removed in the next major version.")}}var t,o,r,a,s,d,c,u=(""===(t=i.id)&&(i.id=(o=e&&e.id||h.id+l++,null!==document.getElementById(o)&&(o+=l++),t=o),m=(e||{}).log,k(t,"Added missing iframe ID: "+t+" ("+i.src+")")),t);u in F&&"iFrameResizer"in i?O(u,"Ignored iFrame, already setup."):(d=(d=e)||{},F[u]={firstRun:!0,iframe:i,remoteHost:i.src.split("/").slice(0,3).join("/")},function(e){if("object"!=typeof e)throw new TypeError("Options is not an object")}(d),Object.keys(d).forEach(n,d),function(e){for(var n in h)Object.prototype.hasOwnProperty.call(h,n)&&(F[u][n]=Object.prototype.hasOwnProperty.call(e,n)?e[n]:h[n])}(d),F[u]&&(F[u].targetOrigin=!0===F[u].checkOrigin?""===(c=F[u].remoteHost)||"file://"===c?"*":c:"*"),function(){switch(k(u,"IFrame scrolling "+(F[u]&&F[u].scrolling?"enabled":"disabled")+" for "+u),i.style.overflow=!1===(F[u]&&F[u].scrolling)?"hidden":"auto",F[u]&&F[u].scrolling){case"omit":break;case!0:i.scrolling="yes";break;case!1:i.scrolling="no";break;default:i.scrolling=F[u]?F[u].scrolling:"no"}}(),function(){function e(e){1/0!==F[u][e]&&0!==F[u][e]&&(i.style[e]=F[u][e]+"px",k(u,"Set "+e+" = "+F[u][e]+"px"))}function n(e){if(F[u]["min"+e]>F[u]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}n("Height"),n("Width"),e("maxHeight"),e("minHeight"),e("maxWidth"),e("minWidth")}(),"number"!=typeof(F[u]&&F[u].bodyMargin)&&"0"!==(F[u]&&F[u].bodyMargin)||(F[u].bodyMarginV1=F[u].bodyMargin,F[u].bodyMargin=F[u].bodyMargin+"px"),r=A(u),(s=w())&&(a=s,i.parentNode&&new a(function(e){e.forEach(function(e){Array.prototype.slice.call(e.removedNodes).forEach(function(e){e===i&&T(i)})})}).observe(i.parentNode,{childList:!0})),M(i,"load",function(){var e,n;P("iFrame.onload",r,i,f,!0),e=F[u]&&F[u].firstRun,n=F[u]&&F[u].heightCalculationMethod in g,!e&&n&&H({iframe:i,height:0,width:0,type:"init"})}),P("init",r,i,f,!0),F[u]&&(F[u].iframe.iFrameResizer={close:T.bind(null,F[u].iframe),removeListeners:E.bind(null,F[u].iframe),resize:P.bind(null,"Window resize","resize",F[u].iframe),moveToAnchor:function(e){P("Move to anchor","moveToAnchor:"+e,F[u].iframe,u)},sendMessage:function(e){P("Send Message","message:"+(e=JSON.stringify(e)),F[u].iframe,u)}}))}function c(e,n){null===i&&(i=setTimeout(function(){i=null,e()},n))}function u(){"hidden"!==document.visibilityState&&(k("document","Trigger event: Visiblity change"),c(function(){q("Tab Visable","resize")},16))}function q(i,t){Object.keys(F).forEach(function(e){var n;F[n=e]&&"parent"===F[n].resizeFrom&&F[n].autoResize&&!F[n].firstRun&&P(i,t,document.getElementById(e),e)})}function L(){M(window,"message",s),M(window,"resize",function(){var e;k("window","Trigger event: "+(e="resize")),c(function(){q("Window "+e,"resize")},16)}),M(document,"visibilitychange",u),M(document,"-webkit-visibilitychange",u)}function B(){function t(e,n){n&&(!function(){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+n.tagName+">")}(),d(n,e),o.push(n))}var o;return function(){var e,n=["moz","webkit","o","ms"];for(e=0;e<n.length&&!r;e+=1)r=window[n[e]+"RequestAnimationFrame"];r||k("setup","RequestAnimationFrame not supported")}(),L(),function(e,n){var i;switch(o=[],(i=e)&&i.enablePublicMethods&&O("enablePublicMethods option has been removed, public methods are now always available in the iFrame"),typeof n){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(n||"iframe"),t.bind(f,e));break;case"object":t(e,n);break;default:throw new TypeError("Unexpected data type ("+typeof n+")")}return o}}}();
//# 
/*! iFrame Resizer (iframeSizer.contentWindow.min.js) - v4.1.1 - 2019-04-10
 *  Desc: Include this file in any page being loaded into an iframe
 *        to force the iframe to resize to the content size.
 *  Requires: iframeResizer.min.js on host page.
 *  Copyright: (c) 2019 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */

!function(l){if("undefined"!=typeof window){var n=!0,o=10,i="",r=0,a="",t=null,u="",c=!1,s={resize:1,click:1},d=128,f=!0,m=1,h="bodyOffset",g=h,p=!0,v="",y={},b=32,e=null,w=!1,T="[iFrameSizer]",E=T.length,O="",S={max:1,min:1,bodyScroll:1,documentElementScroll:1},M="child",I=!0,N=window.parent,A="*",C=0,k=!1,z=null,R=16,x=1,L="scroll",F=L,P=window,D=function(){ue("onMessage function not defined")},j=function(){},q=function(){},H={height:function(){return ue("Custom height calculation function not defined"),document.documentElement.offsetHeight},width:function(){return ue("Custom width calculation function not defined"),document.body.scrollWidth}},W={},B=!1;try{var U=Object.create({},{passive:{get:function(){B=!0}}});window.addEventListener("test",te,U),window.removeEventListener("test",te,U)}catch(e){}var J,V,K,Q,X,Y,G,Z=Date.now||function(){return(new Date).getTime()},$={bodyOffset:function(){return document.body.offsetHeight+be("marginTop")+be("marginBottom")},offset:function(){return $.bodyOffset()},bodyScroll:function(){return document.body.scrollHeight},custom:function(){return H.height()},documentElementOffset:function(){return document.documentElement.offsetHeight},documentElementScroll:function(){return document.documentElement.scrollHeight},max:function(){return Math.max.apply(null,Te($))},min:function(){return Math.min.apply(null,Te($))},grow:function(){return $.max()},lowestElement:function(){return Math.max($.bodyOffset()||$.documentElementOffset(),we("bottom",Oe()))},taggedElement:function(){return Ee("bottom","data-iframe-height")}},_={bodyScroll:function(){return document.body.scrollWidth},bodyOffset:function(){return document.body.offsetWidth},custom:function(){return H.width()},documentElementScroll:function(){return document.documentElement.scrollWidth},documentElementOffset:function(){return document.documentElement.offsetWidth},scroll:function(){return Math.max(_.bodyScroll(),_.documentElementScroll())},max:function(){return Math.max.apply(null,Te(_))},min:function(){return Math.min.apply(null,Te(_))},rightMostElement:function(){return we("right",Oe())},taggedElement:function(){return Ee("right","data-iframe-width")}},ee=(J=Se,X=null,Y=0,G=function(){Y=Z(),X=null,Q=J.apply(V,K),X||(V=K=null)},function(){var e=Z();Y||(Y=e);var t=R-(e-Y);return V=this,K=arguments,t<=0||R<t?(X&&(clearTimeout(X),X=null),Y=e,Q=J.apply(V,K),X||(V=K=null)):X||(X=setTimeout(G,t)),Q});ne(window,"message",ke),ne(window,"readystatechange",ze),ze()}function te(){}function ne(e,t,n,o){e.addEventListener(t,n,!!B&&(o||{}))}function oe(e,t,n){e.removeEventListener(t,n,!1)}function ie(e){return e.charAt(0).toUpperCase()+e.slice(1)}function re(e){return T+"["+O+"] "+e}function ae(e){w&&"object"==typeof window.console&&console.log(re(e))}function ue(e){"object"==typeof window.console&&console.warn(re(e))}function ce(){var e;!function(){function e(e){return"true"===e}var t=v.substr(E).split(":");O=t[0],r=l!==t[1]?Number(t[1]):r,c=l!==t[2]?e(t[2]):c,w=l!==t[3]?e(t[3]):w,b=l!==t[4]?Number(t[4]):b,n=l!==t[6]?e(t[6]):n,a=t[7],g=l!==t[8]?t[8]:g,i=t[9],u=t[10],C=l!==t[11]?Number(t[11]):C,y.enable=l!==t[12]&&e(t[12]),M=l!==t[13]?t[13]:M,F=l!==t[14]?t[14]:F}(),ae("Initialising iFrame ("+location.href+")"),function(){function e(e,t){return"function"==typeof e&&(ae("Setup custom "+t+"CalcMethod"),H[t]=e,e="custom"),e}"iFrameResizer"in window&&Object===window.iFrameResizer.constructor&&(t=window.iFrameResizer,ae("Reading data from page: "+JSON.stringify(t)),Object.keys(t).forEach(se,t),D="onMessage"in t?t.onMessage:D,j="onReady"in t?t.onReady:j,A="targetOrigin"in t?t.targetOrigin:A,g="heightCalculationMethod"in t?t.heightCalculationMethod:g,F="widthCalculationMethod"in t?t.widthCalculationMethod:F,g=e(g,"height"),F=e(F,"width"));var t;ae("TargetOrigin for parent set to: "+A)}(),function(){l===a&&(a=r+"px");de("margin",function(e,t){-1!==t.indexOf("-")&&(ue("Negative CSS value ignored for "+e),t="");return t}("margin",a))}(),de("background",i),de("padding",u),(e=document.createElement("div")).style.clear="both",e.style.display="block",e.style.height="0",document.body.appendChild(e),he(),ge(),document.documentElement.style.height="",document.body.style.height="",ae('HTML & body height set to "auto"'),ae("Enable public methods"),P.parentIFrame={autoResize:function(e){return!0===e&&!1===n?(n=!0,pe()):!1===e&&!0===n&&(n=!1,ve()),n},close:function(){Ce(0,0,"close"),ae("Disable outgoing messages"),I=!1,ae("Remove event listener: Message"),oe(window,"message",ke),!0===n&&ve()},getId:function(){return O},getPageInfo:function(e){"function"==typeof e?(q=e,Ce(0,0,"pageInfo")):(q=function(){},Ce(0,0,"pageInfoStop"))},moveToAnchor:function(e){y.findTarget(e)},reset:function(){Ae("parentIFrame.reset")},scrollTo:function(e,t){Ce(t,e,"scrollTo")},scrollToOffset:function(e,t){Ce(t,e,"scrollToOffset")},sendMessage:function(e,t){Ce(0,0,"message",JSON.stringify(e),t)},setHeightCalculationMethod:function(e){g=e,he()},setWidthCalculationMethod:function(e){F=e,ge()},setTargetOrigin:function(e){ae("Set targetOrigin: "+e),A=e},size:function(e,t){var n=(e||"")+(t?","+t:"");Me("size","parentIFrame.size("+n+")",e,t)}},pe(),y=function(){function r(e){var t=e.getBoundingClientRect(),n={x:window.pageXOffset!==l?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==l?window.pageYOffset:document.documentElement.scrollTop};return{x:parseInt(t.left,10)+parseInt(n.x,10),y:parseInt(t.top,10)+parseInt(n.y,10)}}function n(e){var t,n=e.split("#")[1]||e,o=decodeURIComponent(n),i=document.getElementById(o)||document.getElementsByName(o)[0];l!==i?(t=r(i),ae("Moving to in page link (#"+n+") at x: "+t.x+" y: "+t.y),Ce(t.y,t.x,"scrollToOffset")):(ae("In page link (#"+n+") not found in iFrame, so sending to parent"),Ce(0,0,"inPageLink","#"+n))}function e(){""!==location.hash&&"#"!==location.hash&&n(location.href)}function t(){Array.prototype.forEach.call(document.querySelectorAll('a[href^="#"]'),function(e){function t(e){e.preventDefault(),n(this.getAttribute("href"))}"#"!==e.getAttribute("href")&&ne(e,"click",t)})}y.enable?Array.prototype.forEach&&document.querySelectorAll?(ae("Setting up location.hash handlers"),t(),ne(window,"hashchange",e),setTimeout(e,d)):ue("In page linking not fully supported in this browser! (See README.md for IE8 workaround)"):ae("In page linking not enabled");return{findTarget:n}}(),Me("init","Init message from host page"),j()}function se(e){var t=e.split("Callback");if(2===t.length){var n="on"+t[0].charAt(0).toUpperCase()+t[0].slice(1);this[n]=this[e],delete this[e],ue("Deprecated: '"+e+"' has been renamed '"+n+"'. The old method will be removed in the next major version.")}}function de(e,t){l!==t&&""!==t&&"null"!==t&&ae("Body "+e+' set to "'+(document.body.style[e]=t)+'"')}function le(n){var e={add:function(e){function t(){Me(n.eventName,n.eventType)}W[e]=t,ne(window,e,t,{passive:!0})},remove:function(e){var t=W[e];delete W[e],oe(window,e,t)}};n.eventNames&&Array.prototype.map?(n.eventName=n.eventNames[0],n.eventNames.map(e[n.method])):e[n.method](n.eventName),ae(ie(n.method)+" event listener: "+n.eventType)}function fe(e){le({method:e,eventType:"Animation Start",eventNames:["animationstart","webkitAnimationStart"]}),le({method:e,eventType:"Animation Iteration",eventNames:["animationiteration","webkitAnimationIteration"]}),le({method:e,eventType:"Animation End",eventNames:["animationend","webkitAnimationEnd"]}),le({method:e,eventType:"Input",eventName:"input"}),le({method:e,eventType:"Mouse Up",eventName:"mouseup"}),le({method:e,eventType:"Mouse Down",eventName:"mousedown"}),le({method:e,eventType:"Orientation Change",eventName:"orientationchange"}),le({method:e,eventType:"Print",eventName:["afterprint","beforeprint"]}),le({method:e,eventType:"Ready State Change",eventName:"readystatechange"}),le({method:e,eventType:"Touch Start",eventName:"touchstart"}),le({method:e,eventType:"Touch End",eventName:"touchend"}),le({method:e,eventType:"Touch Cancel",eventName:"touchcancel"}),le({method:e,eventType:"Transition Start",eventNames:["transitionstart","webkitTransitionStart","MSTransitionStart","oTransitionStart","otransitionstart"]}),le({method:e,eventType:"Transition Iteration",eventNames:["transitioniteration","webkitTransitionIteration","MSTransitionIteration","oTransitionIteration","otransitioniteration"]}),le({method:e,eventType:"Transition End",eventNames:["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","otransitionend"]}),"child"===M&&le({method:e,eventType:"IFrame Resized",eventName:"resize"})}function me(e,t,n,o){return t!==e&&(e in n||(ue(e+" is not a valid option for "+o+"CalculationMethod."),e=t),ae(o+' calculation method set to "'+e+'"')),e}function he(){g=me(g,h,$,"height")}function ge(){F=me(F,L,_,"width")}function pe(){var e;!0===n?(fe("add"),e=b<0,window.MutationObserver||window.WebKitMutationObserver?e?ye():t=function(){function t(e){function t(e){!1===e.complete&&(ae("Attach listeners to "+e.src),e.addEventListener("load",i,!1),e.addEventListener("error",r,!1),c.push(e))}"attributes"===e.type&&"src"===e.attributeName?t(e.target):"childList"===e.type&&Array.prototype.forEach.call(e.target.querySelectorAll("img"),t)}function o(e){var t;ae("Remove listeners from "+e.src),e.removeEventListener("load",i,!1),e.removeEventListener("error",r,!1),t=e,c.splice(c.indexOf(t),1)}function n(e,t,n){o(e.target),Me(t,n+": "+e.target.src,l,l)}function i(e){n(e,"imageLoad","Image loaded")}function r(e){n(e,"imageLoadFailed","Image load failed")}function e(e){Me("mutationObserver","mutationObserver: "+e[0].target+" "+e[0].type),e.forEach(t)}var a,u,c=[],s=window.MutationObserver||window.WebKitMutationObserver,d=(a=document.querySelector("body"),u={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},d=new s(e),ae("Create body MutationObserver"),d.observe(a,u),d);return{disconnect:function(){"disconnect"in d&&(ae("Disconnect body MutationObserver"),d.disconnect(),c.forEach(o))}}}():(ae("MutationObserver not supported in this browser!"),ye())):ae("Auto Resize disabled")}function ve(){fe("remove"),null!==t&&t.disconnect(),clearInterval(e)}function ye(){0!==b&&(ae("setInterval: "+b+"ms"),e=setInterval(function(){Me("interval","setInterval: "+b)},Math.abs(b)))}function be(e,t){var n=0;return t=t||document.body,n=null!==(n=document.defaultView.getComputedStyle(t,null))?n[e]:0,parseInt(n,o)}function we(e,t){for(var n,o=t.length,i=0,r=0,a=ie(e),u=Z(),c=0;c<o;c++)r<(i=t[c].getBoundingClientRect()[e]+be("margin"+a,t[c]))&&(r=i);return u=Z()-u,ae("Parsed "+o+" HTML elements"),ae("Element position calculated in "+u+"ms"),R/2<(n=u)&&ae("Event throttle increased to "+(R=2*n)+"ms"),r}function Te(e){return[e.bodyOffset(),e.bodyScroll(),e.documentElementOffset(),e.documentElementScroll()]}function Ee(e,t){var n=document.querySelectorAll("["+t+"]");return 0===n.length&&(ue("No tagged elements ("+t+") found on page"),document.querySelectorAll("body *")),we(e,n)}function Oe(){return document.querySelectorAll("body *")}function Se(e,t,n,o){var i,r;!function(){function e(e,t){return!(Math.abs(e-t)<=C)}return i=l!==n?n:$[g](),r=l!==o?o:_[F](),e(m,i)||c&&e(x,r)}()&&"init"!==e?e in{init:1,interval:1,size:1}||!(g in S||c&&F in S)?e in{interval:1}||ae("No change in size detected"):Ae(t):(Ie(),Ce(m=i,x=r,e))}function Me(e,t,n,o){k&&e in s?ae("Trigger event cancelled: "+e):(e in{reset:1,resetPage:1,init:1}||ae("Trigger event: "+t),"init"===e?Se(e,t,n,o):ee(e,t,n,o))}function Ie(){k||(k=!0,ae("Trigger event lock on")),clearTimeout(z),z=setTimeout(function(){k=!1,ae("Trigger event lock off"),ae("--")},d)}function Ne(e){m=$[g](),x=_[F](),Ce(m,x,e)}function Ae(e){var t=g;g=h,ae("Reset trigger event: "+e),Ie(),Ne("reset"),g=t}function Ce(e,t,n,o,i){var r;!0===I&&(l===i?i=A:ae("Message targetOrigin: "+i),ae("Sending message to host page ("+(r=O+":"+e+":"+t+":"+n+(l!==o?":"+o:""))+")"),N.postMessage(T+r,i))}function ke(t){var n={init:function(){v=t.data,N=t.source,ce(),f=!1,setTimeout(function(){p=!1},d)},reset:function(){p?ae("Page reset ignored by init"):(ae("Page size reset by host page"),Ne("resetPage"))},resize:function(){Me("resizeParent","Parent window requested size check")},moveToAnchor:function(){y.findTarget(i())},inPageLink:function(){this.moveToAnchor()},pageInfo:function(){var e=i();ae("PageInfoFromParent called from parent: "+e),q(JSON.parse(e)),ae(" --")},message:function(){var e=i();ae("onMessage called from parent: "+e),D(JSON.parse(e)),ae(" --")}};function o(){return t.data.split("]")[1].split(":")[0]}function i(){return t.data.substr(t.data.indexOf(":")+1)}function r(){return t.data.split(":")[2]in{true:1,false:1}}function e(){var e=o();e in n?n[e]():("undefined"==typeof module||!module.exports)&&"iFrameResize"in window||"jQuery"in window&&"iFrameResize"in window.jQuery.prototype||r()||ue("Unexpected message ("+t.data+")")}T===(""+t.data).substr(0,E)&&(!1===f?e():r()?n.init():ae('Ignored message of type "'+o()+'". Received before initialization.'))}function ze(){"loading"!==document.readyState&&window.parent.postMessage("[iFrameResizerChild]Ready","*")}}();
//# 
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
$(document).ready(function(){if(!piwik||!location.protocol){return;}
if(!piwik.hasSuperUserAccess){return;}
if(piwik.hasServerDetectedHttps){return;}
var isHttpsUsed=0===location.protocol.indexOf('https');if(!isHttpsUsed){return;}
var params=['"config/config.ini.php"','"assume_secure_protocol=1"','"[General]"','<a target="_blank" href="https://matomo.org/faq/how-to-install/faq_98/">','</a>'];var message=_pk_translate('CoreAdminHome_ProtocolNotDetectedCorrectly')+" "+_pk_translate('CoreAdminHome_ProtocolNotDetectedCorrectlySolution',params);var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(message,{context:'warning'});});
(function(){angular.module('piwikApp.config',[]);if('undefined'===(typeof piwik)||!piwik){return;}
var piwikAppConfig=angular.module('piwikApp.config');for(var index in piwik.config){piwikAppConfig.constant(index.toUpperCase(),piwik.config[index]);}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.service',[]);})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.service').service('globalAjaxQueue',ajaxQueue);function ajaxQueue(){return globalAjaxQueue;}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.service').service('piwik',piwikService);piwikService.$inject=['piwikPeriods'];function piwikService(piwikPeriods){var originalTitle;piwik.helper=piwikHelper;piwik.broadcast=broadcast;piwik.updatePeriodParamsFromUrl=updatePeriodParamsFromUrl;piwik.updateDateInTitle=updateDateInTitle;piwik.hasUserCapability=hasUserCapability;return piwik;function hasUserCapability(capability){return angular.isArray(piwik.userCapabilities)&&piwik.userCapabilities.indexOf(capability)!==-1;}
function updatePeriodParamsFromUrl(){var date=piwik.broadcast.getValueFromHash('date')||piwik.broadcast.getValueFromUrl('date');var period=piwik.broadcast.getValueFromHash('period')||piwik.broadcast.getValueFromUrl('period');if(!isValidPeriod(period,date)){return;}
if(piwik.period===period&&piwik.currentDateString===date){return;}
piwik.period=period;var dateRange=piwikPeriods.parse(period,date).getDateRange();piwik.startDateString=piwikPeriods.format(dateRange[0]);piwik.endDateString=piwikPeriods.format(dateRange[1]);updateDateInTitle(date,period);if(piwik.period==='range'){date=piwik.startDateString+','+piwik.endDateString;}
piwik.currentDateString=date;}
function isValidPeriod(periodStr,dateStr){try{piwikPeriods.get(periodStr).parse(dateStr);return true;}catch(e){return false;}}
function updateDateInTitle(date,period){if(!$('.top_controls #periodString').length){return;}
originalTitle=originalTitle||document.title;if(0===originalTitle.indexOf(piwik.siteName)){var dateString=' - '+piwikPeriods.parse(period,date).getPrettyString()+' ';document.title=piwik.siteName+dateString+originalTitle.substr(piwik.siteName.length);}}}
angular.module('piwikApp.service').run(initPiwikService);initPiwikService.$inject=['piwik','$rootScope'];function initPiwikService(piwik,$rootScope){$rootScope.$on('$locationChangeSuccess',piwik.updatePeriodParamsFromUrl);}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
var hasBlockedContent=false;(function(){angular.module('piwikApp.service').factory('piwikApi',piwikApiService);piwikApiService.$inject=['$http','$q','$rootScope','piwik','$window','piwikUrl'];function piwikApiService($http,$q,$rootScope,piwik,$window,piwikUrl){var url='index.php';var format='json';var getParams={};var postParams={};var allRequests=[];function addParams(params){if(typeof params=='string'){params=piwik.broadcast.getValuesFromUrl(params);}
var arrayParams=['compareSegments','comparePeriods','compareDates'];for(var key in params){if(arrayParams.indexOf(key)!==-1&&!params[key]){continue;}
getParams[key]=params[key];}}
function withTokenInUrl(){postParams['token_auth']=piwik.token_auth;}
function isRequestToApiMethod(){return getParams&&getParams['module']==='API'&&getParams['method'];}
function reset(){getParams={};postParams={};}
function isErrorResponse(response){return response&&angular.isObject(response)&&response.result=='error';}
function createResponseErrorNotification(response,options){if(response.message&&options.createErrorNotification){var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(response.message,{context:'error',type:'toast',id:'ajaxHelper',placeat:options.placeat});setTimeout(function(){notification.scrollToNotification();},100);}}
function send(options){if(!options){options={};}
if(options.createErrorNotification===undefined){options.createErrorNotification=true;}
function onSuccess(response){var headers=response.headers;response=response.data;if(!angular.isDefined(response)||response===null){return $q.reject(null);}else if(isErrorResponse(response)){createResponseErrorNotification(response,options);return $q.reject(response.message||null);}else{return options.includeHeaders?{headers:headers,response:response}:response;}}
function onError(response){var message='Something went wrong';if(response&&(response.status===0||response.status===-1)){message='Request was possibly aborted';}
return $q.reject(message);}
var deferred=$q.defer(),requestPromise=deferred.promise;var headers={'Content-Type':'application/x-www-form-urlencoded','cache-control':'no-cache'};var requestFormat=format;if(getParams.format&&getParams.format.toLowerCase()!=='json'&&getParams.format.toLowerCase()!=='json2'){requestFormat=getParams.format;}
var ajaxCall={method:'POST',url:url+'?'+$.param(mixinDefaultGetParams(getParams)),responseType:requestFormat,data:$.param(getPostParams(postParams)),timeout:requestPromise,headers:headers};var promise=$http(ajaxCall).then(onSuccess,onError);var addAbortMethod=function(to,deferred){return{then:function(){return addAbortMethod(to.then.apply(to,arguments),deferred);},'finally':function(){return addAbortMethod(to.finally.apply(to,arguments),deferred);},'catch':function(){return addAbortMethod(to.catch.apply(to,arguments),deferred);},abort:function(){deferred.resolve();return this;}};};var request=addAbortMethod(promise,deferred);allRequests.push(request);return request.finally(function(){var index=allRequests.indexOf(request);if(index!==-1){allRequests.splice(index,1);}});}
function getPostParams(params){if(isRequestToApiMethod()||piwik.shouldPropagateTokenAuth){params.token_auth=piwik.token_auth;}
return params;}
function mixinDefaultGetParams(getParamsToMixin){var segment=piwikUrl.getSearchParam('segment');if(segment){segment=decodeURIComponent(segment);}
var defaultParams={idSite:piwik.idSite||piwikUrl.getSearchParam('idSite'),period:piwik.period||piwikUrl.getSearchParam('period'),segment:segment};if(getParamsToMixin.token_auth){getParamsToMixin.token_auth=null;delete getParamsToMixin.token_auth;}
for(var key in defaultParams){if(!(key in getParamsToMixin)&&!(key in postParams)&&defaultParams[key]){getParamsToMixin[key]=defaultParams[key];}}
if(!getParamsToMixin.date&&!postParams.date){getParamsToMixin.date=piwik.currentDateString;}
return getParamsToMixin;}
function abortAll(){reset();allRequests.forEach(function(request){request.abort();});allRequests=[];}
function abort(){abortAll();}
function fetch(getParams,options){getParams.module=getParams.module||'API';if(!getParams.format){getParams.format='JSON2';}
addParams(getParams);var promise=send(options);reset();return promise;}
function post(getParams,_postParams_,options){if(_postParams_){if(postParams&&postParams.token_auth&&!_postParams_.token_auth){_postParams_.token_auth=postParams.token_auth;}
postParams=_postParams_;}
return fetch(getParams,options);}
function addPostParams(_postParams_){if(_postParams_){angular.merge(postParams,_postParams_);}}
function bulkFetch(requests,options){var bulkApiRequestParams={urls:requests.map(function(requestObj){return'?'+$.param(requestObj);})};var deferred=$q.defer(),requestPromise=post({method:"API.getBulkRequest"},bulkApiRequestParams,options).then(function(response){if(!(response instanceof Array)){response=[response];}
for(var i=0;i!=response.length;++i){var specificResponse=response[i];if(isErrorResponse(specificResponse)){deferred.reject(specificResponse.message||null);createResponseErrorNotification(specificResponse,options||{});return;}}
deferred.resolve(response);}).catch(function(){deferred.reject.apply(deferred,arguments);});return deferred.promise;}
return{withTokenInUrl:withTokenInUrl,bulkFetch:bulkFetch,post:post,fetch:fetch,addPostParams:addPostParams,abort:abort,abortAll:abortAll,mixinDefaultGetParams:mixinDefaultGetParams};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.service').service('piwikUrl',piwikUrl);piwikUrl.$inject=['$location','piwik','$window'];function piwikUrl($location,piwik,$window){var model={getSearchParam:getSearchParam};return model;function getSearchParam(paramName){var hash=$window.location.href.split('#');if(hash&&hash[1]&&(new RegExp(paramName+'(\\[]|=)')).test(decodeURIComponent(hash[1]))){return broadcast.getValueFromHash(paramName,$window.location.href);}
return broadcast.getValueFromUrl(paramName,$window.location.search);}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.service').factory('reportMetadataModel',reportMetadataModel);reportMetadataModel.$inject=['piwik','piwikApi'];function reportMetadataModel(piwik,piwikApi){var reportsPromise=null;var model={reports:[],fetchReportMetadata:fetchReportMetadata,findReport:findReport};return model;function findReport(module,action){var found=[];angular.forEach(model.reports,function(report){if(report.module===module&&report.action===action){found=report;}});return found;}
function fetchReportMetadata(){if(!reportsPromise){reportsPromise=piwikApi.fetch({method:'API.getReportMetadata',filter_limit:'-1',idSite:piwik.idSite||piwik.broadcast.getValueFromUrl('idSite')}).then(function(response){model.reports=response;return response;});}
return reportsPromise;}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.service').factory('reportingPagesModel',reportingPagesModelService);reportingPagesModelService.$inject=['piwikApi'];function reportingPagesModelService(piwikApi){var fetchAllPagesPromise=false;var model={pages:[],findPage:findPage,findPageInCategory:findPageInCategory,reloadAllPages:reloadAllPages,getAllPages:getAllPages};return model;function findPageInCategory(categoryId){var found=null;angular.forEach(model.pages,function(page){if(!found&&page&&page.category&&page.subcategory&&page.category.id===categoryId&&page.subcategory.id){found=page;}});return found;}
function findPage(categoryId,subcategoryId){var found=null;angular.forEach(model.pages,function(page){if(!found&&page&&page.category&&page.subcategory&&page.category.id===categoryId&&(''+page.subcategory.id)===subcategoryId){found=page;}});return found;}
function reloadAllPages(){fetchAllPagesPromise=null;return getAllPages();}
function getAllPages(){if(!fetchAllPagesPromise){fetchAllPagesPromise=piwikApi.fetch({method:'API.getReportPagesMetadata',filter_limit:'-1'}).then(function(response){model.pages=response;return response;});}
return fetchAllPagesPromise;}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.service').factory('piwikPeriods',piwikPeriods);var periods={},periodOrder=[];piwik.addCustomPeriod=addCustomPeriod;function DayPeriod(date){this.dateInPeriod=date;}
DayPeriod.parse=singleDatePeriodFactory(DayPeriod);DayPeriod.getDisplayText=function(){return _pk_translate('Intl_PeriodDay');};DayPeriod.prototype={getPrettyString:function(){return format(this.dateInPeriod);},getDateRange:function(){return[this.dateInPeriod,this.dateInPeriod];}};addCustomPeriod('day',DayPeriod);function WeekPeriod(date){this.dateInPeriod=date;}
WeekPeriod.parse=singleDatePeriodFactory(WeekPeriod);WeekPeriod.getDisplayText=function(){return _pk_translate('Intl_PeriodWeek');};WeekPeriod.prototype={getPrettyString:function(){var weekDates=this.getDateRange(this.dateInPeriod);var startWeek=format(weekDates[0]);var endWeek=format(weekDates[1]);return _pk_translate('General_DateRangeFromTo',[startWeek,endWeek]);},getDateRange:function(){var daysToMonday=(this.dateInPeriod.getDay()+6)%7;var startWeek=new Date(this.dateInPeriod.getTime());startWeek.setDate(this.dateInPeriod.getDate()-daysToMonday);var endWeek=new Date(startWeek.getTime());endWeek.setDate(startWeek.getDate()+6);return[startWeek,endWeek];}};addCustomPeriod('week',WeekPeriod);function MonthPeriod(date){this.dateInPeriod=date;}
MonthPeriod.parse=singleDatePeriodFactory(MonthPeriod);MonthPeriod.getDisplayText=function(){return _pk_translate('Intl_PeriodMonth');};MonthPeriod.prototype={getPrettyString:function(){return _pk_translate('Intl_Month_Long_StandAlone_'+(this.dateInPeriod.getMonth()+1))+' '+
this.dateInPeriod.getFullYear();},getDateRange:function(){var startMonth=new Date(this.dateInPeriod.getTime());startMonth.setDate(1);var endMonth=new Date(this.dateInPeriod.getTime());endMonth.setMonth(endMonth.getMonth()+1);endMonth.setDate(0);return[startMonth,endMonth];}};addCustomPeriod('month',MonthPeriod);function YearPeriod(date){this.dateInPeriod=date;}
YearPeriod.parse=singleDatePeriodFactory(YearPeriod);YearPeriod.getDisplayText=function(){return _pk_translate('Intl_PeriodYear');};YearPeriod.prototype={getPrettyString:function(){return this.dateInPeriod.getFullYear();},getDateRange:function(){var startYear=new Date(this.dateInPeriod.getTime());startYear.setMonth(0);startYear.setDate(1);var endYear=new Date(this.dateInPeriod.getTime());endYear.setMonth(12);endYear.setDate(0);return[startYear,endYear];}};addCustomPeriod('year',YearPeriod);function RangePeriod(startDate,endDate,childPeriodType){this.startDate=startDate;this.endDate=endDate;this.childPeriodType=childPeriodType;}
RangePeriod.parse=function parseRangePeriod(strDate,childPeriodType){childPeriodType=childPeriodType||'day';if(/^previous/.test(strDate)){var endDate=RangePeriod.getLastNRange(childPeriodType,2).startDate;return RangePeriod.getLastNRange(childPeriodType,strDate.substring(8),endDate);}else if(/^last/.test(strDate)){return RangePeriod.getLastNRange(childPeriodType,strDate.substring(4));}else{var parts=decodeURIComponent(strDate).split(',');return new RangePeriod(parseDate(parts[0]),parseDate(parts[1]),childPeriodType)}};RangePeriod.getLastNRange=function(childPeriodType,strAmount,endDate){var nAmount=Math.max(parseInt(strAmount)-1,0);if(isNaN(nAmount)){throw new Error('Invalid range date: '+strDate);}
endDate=endDate?parseDate(endDate):getToday();var startDate=new Date(endDate.getTime());if(childPeriodType==='day'){startDate.setDate(startDate.getDate()-nAmount);}else if(childPeriodType==='week'){startDate.setDate(startDate.getDate()-(nAmount*7));}else if(childPeriodType==='month'){startDate.setMonth(startDate.getMonth()-nAmount);}else if(childPeriodType==='year'){startDate.setFullYear(startDate.getFullYear()-nAmount);}else{throw new Error("Unknown period type '"+childPeriodType+"'.");}
if(childPeriodType!=='day'){var startPeriod=periods[childPeriodType].parse(startDate);var endPeriod=periods[childPeriodType].parse(endDate);startDate=startPeriod.getDateRange()[0];endDate=endPeriod.getDateRange()[1];}
var firstWebsiteDate=new Date(1991,7,6);if(startDate-firstWebsiteDate<0){switch(childPeriodType){case'year':startDate=new Date(1992,0,1);break;case'month':startDate=new Date(1991,8,1);break;case'week':startDate=new Date(1991,8,12);break;case'day':default:startDate=firstWebsiteDate;break;}}
return new RangePeriod(startDate,endDate,childPeriodType);};RangePeriod.getDisplayText=function(){return _pk_translate('General_DateRangeInPeriodList');};RangePeriod.prototype={getPrettyString:function(){var start=format(this.startDate);var end=format(this.endDate);return _pk_translate('General_DateRangeFromTo',[start,end]);},getDateRange:function(){return[this.startDate,this.endDate];}};addCustomPeriod('range',RangePeriod);function piwikPeriods(){return{getAllLabels:getAllLabels,isRecognizedPeriod:isRecognizedPeriod,get:get,parse:parse,parseDate:parseDate,format:format,RangePeriod:RangePeriod};function getAllLabels(){return[].concat(periodOrder);}
function get(strPeriod){var periodClass=periods[strPeriod];if(!periodClass){throw new Error('Invalid period label: '+strPeriod);}
return periodClass;}
function parse(strPeriod,strDate){return get(strPeriod).parse(strDate);}
function isRecognizedPeriod(strPeriod){return!!periods[strPeriod];}}
function addCustomPeriod(name,periodClass){if(periods[name]){throw new Error('The "'+name+'" period already exists! It cannot be overridden.');}
periods[name]=periodClass;periodOrder.push(name);}
function singleDatePeriodFactory(periodClass){return function(strDate){return new periodClass(parseDate(strDate));};}
function format(date){return $.datepicker.formatDate('yy-mm-dd',date);}
function parseDate(strDate){if(strDate instanceof Date){return strDate;}
if(strDate==='today'||strDate==='now'){return getToday();}
if(strDate==='yesterday'||strDate==='yesterdaySameTime'){var yesterday=getToday();yesterday.setDate(yesterday.getDate()-1);return yesterday;}
try{return $.datepicker.parseDate('yy-mm-dd',strDate);}catch(err){console.error(err.message||err);throw err;}}
function getToday(){var date=new Date(Date.now());date.setTime(date.getTime()+date.getTimezoneOffset()*60*1000);date.setHours(date.getHours()+((piwik.timezoneOffset||0)/ 3600));date.setHours(0);date.setMinutes(0);date.setSeconds(0);date.setMilliseconds(0);return date;}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.filter',[]);})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.filter').filter('translate',translate);function translate(){return function(key,value1,value2,value3){var values=[];if(arguments&&arguments.length>1){for(var index=1;index<arguments.length;index++){values.push(arguments[index]);}}
return _pk_translate(key,values);};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.filter').filter('startFrom',startFrom);function startFrom(){return function(input,start){start=+start;return input.slice(start);};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.filter').filter('evolution',evolutionFilter);function evolutionFilter(){function calculateEvolution(currentValue,pastValue){pastValue=parseInt(pastValue,10);currentValue=parseInt(currentValue,10)-pastValue;var evolution;if(currentValue===0||isNaN(currentValue)){evolution=0;}else if(pastValue===0||isNaN(pastValue)){evolution=100;}else{evolution=(currentValue / pastValue)*100;}
return evolution;}
function formatEvolution(evolution){evolution=Math.round(evolution);if(evolution>0){evolution='+'+evolution;}
evolution+='%';return evolution;}
return function(currentValue,pastValue){var evolution=calculateEvolution(currentValue,pastValue);return formatEvolution(evolution);};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.filter').filter('length',length);function length(){return function(stringOrArray){if(stringOrArray&&stringOrArray.length){return stringOrArray.length;}
return 0;};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.filter').filter('trim',trim);function trim(){return function(string){if(string){return $.trim(''+string);}
return string;};}})();
/*!
 * Piwik - Web Analytics
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.filter').filter('prettyUrl',prettyUrl);function prettyUrl(){return function(input){return input.trim().replace('http://','');};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.filter').filter('escape',escape);function escape(){return function(value){return piwikHelper.escape(piwikHelper.htmlEntities(value));};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.filter').filter('htmldecode',htmldecode);htmldecode.$inject=['piwik'];function htmldecode(piwik){return function(text){if(text&&text.length){return piwik.helper.htmlDecode(text);}
return text;};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.filter').filter('ucfirst',ucfirst);function ucfirst(){return function(value){if(!value){return value;}
var firstLetter=(value+'').charAt(0).toUpperCase();return firstLetter+value.substr(1);};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive',[]);})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('piwikAttributes',piwikAttributes);piwikAttributes.$inject=['$sanitize'];function piwikAttributes(piwik,$sanitize){return{link:function(scope,element,attrs){if(!attrs.piwikAttributes||!angular.isString(attrs.piwikAttributes)){return;}
function applyAttributes(attributes){if(angular.isObject(attributes)){angular.forEach(attributes,function(value,key){if(angular.isObject(value)){value=JSON.stringify(value);}
if(key==='placeholder'&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){value=value.replace(/(?:\r\n|\r|\n)/g,(new Array(200)).join(' '));}
if(key==='disabled'){element.prop(key,value);}else{element.attr(key,value);}});}}
applyAttributes(JSON.parse(attrs.piwikAttributes));attrs.$observe('piwikAttributes',function(newVal){applyAttributes(JSON.parse(newVal));});}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('fieldCondition',piwikFieldCondition);piwikFieldCondition.$inject=['piwik','$timeout'];function piwikFieldCondition(piwik,$timeout){function evaluate(scope,condition,element){if(scope.$eval(condition,scope.allValues)){element.show();}else{element.hide();}}
function getValueFromElement(element){if(element.attr('type')==='checkbox'){return element.is(':checked');}else if(element.attr('type')==='radio'){return $('.form-group [name='+element.attr('name')+']:checked').val();}else if(element.prop('tagName').toLowerCase()==='select'){var name=element.val();if(name.indexOf('string:')===0){return name.substr('string:'.length);}
return name;}
return element.val();}
function evaluateConditionalExpression(scope,condition,element){var fieldParts=condition.replace('!','');fieldParts=fieldParts.split(' ');var fieldNames=[];fieldParts.forEach(function(name){name=$.trim(name);if(name&&name.length>3){fieldNames.push(name);}});scope.allValues={};angular.forEach(fieldNames,function(name){var actualField=$('.form-group [name='+name+']').first();if(actualField.length){scope.allValues[name]=getValueFromElement(actualField);actualField.on('change',function(){scope.allValues[name]=getValueFromElement($(this));evaluate(scope,condition,element);});}});evaluate(scope,condition,element);}
return{priority:10,restrict:'A',link:function(scope,element,attrs){var condition=attrs.fieldCondition;if(condition){$timeout(function(){evaluateConditionalExpression(scope,condition,element);});}},};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('piwikShowSensitiveData',piwikShowSensitiveData);function piwikShowSensitiveData(){return{restrict:'A',link:function(scope,element,attr){var sensitiveData=attr.piwikShowSensitiveData||attr.text();var showCharacters=attr.showCharacters||6;var clickElement=attr.clickElementSelector||element;var protectedData='';if(showCharacters>0){protectedData+=sensitiveData.substr(0,showCharacters);}
protectedData+=sensitiveData.substr(showCharacters).replace(/./g,'*');element.html(protectedData);function onClickHandler(event){element.html(sensitiveData);$(clickElement).css({cursor:''});$(clickElement).tooltip("destroy");}
$(clickElement).tooltip({content:_pk_translate('CoreHome_ClickToSeeFullInformation'),items:'*',track:true});$(clickElement).one('click',onClickHandler);$(clickElement).css({cursor:'pointer'});}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('piwikAutocompleteMatched',piwikAutocompleteMatched);piwikAutocompleteMatched.$inject=['piwik','$sanitize'];function piwikAutocompleteMatched(piwik,$sanitize){return{priority:10,link:function(scope,element,attrs){var searchTerm;scope.$watch(attrs.piwikAutocompleteMatched,function(value){searchTerm=value;updateText();});function updateText(){if(!searchTerm||!element){return;}
var content=piwik.helper.htmlEntities(element.text());var startTerm=content.toLowerCase().indexOf(searchTerm.toLowerCase());if(-1!==startTerm){var word=content.substr(startTerm,searchTerm.length);var escapedword=$sanitize(piwik.helper.htmlEntities(word));content=content.replace(word,'<span class="autocompleteMatched">'+escapedword+'</span>');element.html(content);}}}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('piwikFocusAnywhereButHere',piwikFocusAnywhereButHere);piwikFocusAnywhereButHere.$inject=['$document'];function piwikFocusAnywhereButHere($document){return{restrict:'A',link:function(scope,element,attr,ctrl){var isMouseDown=false;var hasScrolled=false;function onClickOutsideElement(event){var hadUsedScrollbar=isMouseDown&&hasScrolled;isMouseDown=false;hasScrolled=false;if(hadUsedScrollbar){return;}
if(element.has(event.target).length===0){setTimeout(function(){scope.$apply(attr.piwikFocusAnywhereButHere);},0);}}
function onScroll(event){hasScrolled=true;}
function onMouseDown(event){isMouseDown=true;hasScrolled=false;}
function onEscapeHandler(event){if(event.which===27){setTimeout(function(){isMouseDown=false;hasScrolled=false;scope.$apply(attr.piwikFocusAnywhereButHere);},0);}}
$document.on('keyup',onEscapeHandler);$document.on('mousedown',onMouseDown);$document.on('mouseup',onClickOutsideElement);$document.on('scroll',onScroll);scope.$on('$destroy',function(){$document.off('keyup',onEscapeHandler);$document.off('mousedown',onMouseDown);$document.off('mouseup',onClickOutsideElement);$document.off('scroll',onScroll);});}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('piwikIgnoreClick',piwikIgnoreClick);function piwikIgnoreClick(){return function(scope,element,attrs){$(element).click(function(event){event.preventDefault();});};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('piwikOnenter',piwikOnenter);function piwikOnenter(){return function(scope,element,attrs){element.bind("keydown keypress",function(event){if(event.which===13){scope.$apply(function(){scope.$eval(attrs.piwikOnenter,{'event':event});});event.preventDefault();}});};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('piwikFocusIf',piwikFocusIf);piwikFocusIf.$inject=['$timeout'];function piwikFocusIf($timeout){return{restrict:'A',link:function(scope,element,attrs){scope.$watch(attrs.piwikFocusIf,function(newValue,oldValue){if(newValue){$timeout(function(){element[0].focus();},5);}});}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('piwikDialog',piwikDialog);piwikDialog.$inject=['piwik','$parse'];function piwikDialog(piwik,$parse){return{restrict:'A',link:function(scope,element,attrs){element.css('display','none');scope.$watch(attrs.piwikDialog,function(newValue,oldValue){if(newValue){piwik.helper.modalConfirm(element,{yes:function(){if(attrs.yes){scope.$eval(attrs.yes);setTimeout(function(){scope.$apply();},0);}},no:function(){if(attrs.no){scope.$eval(attrs.no);setTimeout(function(){scope.$apply();},0);}}},{complete:function(){setTimeout(function(){scope.$apply($parse(attrs.piwikDialog).assign(scope,false));},0);}});}else if(newValue===false&&oldValue===true){if(attrs.close){scope.$eval(attrs.close);setTimeout(function(){scope.$apply();},0);}}});}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('piwikTranslate',piwikTranslate);function piwikTranslate(){return{priority:1,restrict:'A',compile:function(element,attrs){var parts=element.html().split('::'),translated=_pk_translate(attrs.piwikTranslate,parts);element.html(translated);}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('dropdownButton',piwikDropdownButton);piwikDropdownButton.$inject=['piwik'];function piwikDropdownButton(piwik){return{restrict:'C',compile:function(element,attrs){$(element).dropdown({inDuration:300,outDuration:225,constrain_width:false,belowOrigin:true});return function(scope,element,attrs){};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('piwikSelectOnFocus',piwikSelectOnFocus);function piwikSelectOnFocus(){return{restrict:'A',link:function(scope,element,attr,ctrl){var focusedElement=null;var tagName=(element.prop('tagName')+'').toLowerCase();var elementSupportsSelect=tagName==='textarea';function onFocusHandler(event){if(focusedElement!==this){focusedElement=this;angular.element(this).select();}}
function onClickHandler(event){var range=document.createRange();range.selectNode(this);var selection=window.getSelection();if(selection&&selection.rangeCount>0){selection.removeAllRanges();}
if(selection){selection.addRange(range);}}
function onBlurHandler(event){focusedElement=null;}
if(elementSupportsSelect){element.on('focus',onFocusHandler);element.on('blur',onBlurHandler);}else{element.on('click',onClickHandler);}
scope.$on('$destroy',function(){if(elementSupportsSelect){element.off('focus',onFocusHandler);element.off('blur',onBlurHandler);}else{element.off('click',onClickHandler);}});}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('piwikSideNav',piwikSideNav);piwikSideNav.$inject=['$timeout'];var initialized=false;function piwikSideNav($timeout){return{restrict:'A',priority:10,link:function(scope,element,attr,ctrl){if(attr.piwikSideNav){$timeout(function(){if(!initialized){initialized=true;var sideNavActivator=$(attr.piwikSideNav).show();sideNavActivator.sideNav({closeOnClick:true});}
if(element.hasClass('collapsible')){element.collapsible();}});}}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('stringToNumber',function(){return{require:'ngModel',link:function(scope,element,attrs,ngModel){ngModel.$parsers.push(function(value){return''+value;});ngModel.$formatters.push(function(value){return parseFloat(value);});}};});})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp',['ngSanitize','ngAnimate','ngCookies','ngDialog','piwikApp.config','piwikApp.service','piwikApp.directive','piwikApp.filter']);angular.module('app',[]);angular.module('piwikApp').config(['$locationProvider',function($locationProvider){$locationProvider.hashPrefix('');}]);})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){function scrollToAnchorNode($node){$.scrollTo($node,20);}
function preventDefaultIfEventExists(event){if(event){event.preventDefault();}}
function scrollToAnchorIfPossible(hash,event){if(!hash){return;}
if(-1!==hash.indexOf('&')){return;}
try{var $node=$('#'+hash);}catch(err){return;}
if($node&&$node.length){scrollToAnchorNode($node);preventDefaultIfEventExists(event);return;}
$node=$('a[name='+hash+']');if($node&&$node.length){scrollToAnchorNode($node);preventDefaultIfEventExists(event);}}
function isLinkWithinSamePage(location,newUrl){if(location&&location.origin&&-1===newUrl.indexOf(location.origin)){return false;}
if(location&&location.pathname&&-1===newUrl.indexOf(location.pathname)){return false;}
if(location&&location.search&&-1===newUrl.indexOf(location.search)){return false;}
return true;}
function handleScrollToAnchorIfPresentOnPageLoad(){if(location.hash.substr(0,2)=='#/'){var hash=location.hash.substr(2);scrollToAnchorIfPossible(hash,null);}}
function handleScrollToAnchorAfterPageLoad(){angular.module('piwikApp').run(['$rootScope',function($rootScope){$rootScope.$on('$locationChangeStart',onLocationChangeStart);function onLocationChangeStart(event,newUrl,oldUrl,$location){if(!newUrl){return;}
var hashPos=newUrl.indexOf('#/');if(-1===hashPos){return;}
if(!isLinkWithinSamePage(this.location,newUrl)){return;}
var hash=newUrl.substr(hashPos+2);scrollToAnchorIfPossible(hash,event);}}]);}
handleScrollToAnchorAfterPageLoad();$(handleScrollToAnchorIfPresentOnPageLoad);})();
(function(){angular.module('piwikApp').factory('http404CheckInterceptor',http404CheckInterceptor);http404CheckInterceptor.$inject=['$q','globalAjaxQueue'];function http404CheckInterceptor($q,globalAjaxQueue){function isClientError(rejection){if(rejection.status===500||rejection.status<=0){return true;}
return rejection.status>=400&&rejection.status<408;}
return{'request':function(config){if('object'===typeof piwik.relativePluginWebDirs&&config&&config.url&&config.url.indexOf('plugins/')===0&&config.url.indexOf('.html')>0&&config.url.indexOf('/angularjs/')>0){var urlParts=config.url.split('/');if(urlParts&&urlParts.length>2&&urlParts[1]){var pluginName=urlParts[1];if(pluginName&&pluginName in piwik.relativePluginWebDirs&&piwik.relativePluginWebDirs[pluginName]){urlParts[0]=piwik.relativePluginWebDirs[pluginName];config.url=urlParts.join('/');}}}
return config;},'responseError':function(rejection){if(rejection&&isClientError(rejection)&&rejection.config&&rejection.config.url&&-1!==rejection.config.url.indexOf('.html')&&-1!==rejection.config.url.indexOf('plugins')){var posEndUrl=rejection.config.url.indexOf('.html')+5;var url=rejection.config.url.substr(0,posEndUrl);var message='Please check your server configuration. You may want to whitelist "*.html" files from the "plugins" directory.';message+=' The HTTP status code is '+rejection.status+' for URL "'+url+'"';if(rejection.status===-1){message='Please check if you have an ad blocker or something similar enabled.';}
var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(message,{title:'Failed to load HTML file:',context:'error',id:'Network_HtmlFileLoadingError'});}
return $q.reject(rejection);}};}
angular.module('piwikApp').config(['$httpProvider',function($httpProvider){$httpProvider.interceptors.push('http404CheckInterceptor');}]);})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(window,$,broadcast){angular.module('piwikApp').service('historyService',historyService);historyService.$inject=['$location','$rootScope'];function historyService($location,$rootScope){var service={};service.load=load;service.init=init;return service;function init(){if($location.path()!='/'){changePathToSearch();}
$rootScope.$on('$locationChangeSuccess',function(){loadCurrentPage();});loadCurrentPage();}
function changePathToSearch(){var path=$location.path();if(!path||path=='/'){return;}
var searchParams=broadcast.getValuesFromUrl('?'+path.substring(1));$location.search(searchParams);$location.path('');}
function loadCurrentPage(){var searchObject=$location.search(),searchString=[];for(var name in searchObject){if(!searchObject.hasOwnProperty(name)||name=='_'){continue;}
if(searchObject[name]instanceof Array){searchObject[name]=searchObject[name][searchObject[name].length-1];}
var value=searchObject[name];if(name!='columns'){value=encodeURIComponent(value);}
searchString.push(name+'='+value);}
searchString=searchString.join('&');broadcast.pageload(searchString);}
function load(hash){hash=normalizeHash(hash);var currentHash=normalizeHash(location.hash);if(currentHash===hash){loadCurrentPage();}else if(hash){$location.search(hash);}else{$location.search('_=');}
setTimeout(function(){$rootScope.$apply();},1);}
function normalizeHash(hash){var chars=['#','/','?'];for(var i=0;i!=chars.length;++i){var charToRemove=chars[i];if(hash.charAt(0)==charToRemove){hash=hash.substring(1);}}
return hash;}}})(window,jQuery,broadcast);
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikActivityIndicator',piwikActivityIndicator);piwikActivityIndicator.$inject=['piwik'];function piwikActivityIndicator(piwik){return{restrict:'A',transclude:true,scope:{loading:'=',loadingMessage:'=?'},templateUrl:'plugins/CoreHome/angularjs/activity-indicator/activityindicator.html?cb='+piwik.cacheBuster,compile:function(element,attrs){return function(scope,element,attrs){if(!scope.loadingMessage){scope.loadingMessage=_pk_translate('General_LoadingData');}};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikProgressbar',piwikProgressbar);piwikProgressbar.$inject=['piwik'];function piwikProgressbar(piwik){var defaults={label:'',progress:0};return{restrict:'A',scope:{progress:'=',label:'='},templateUrl:'plugins/CoreHome/angularjs/progressbar/progressbar.directive.html?cb='+piwik.cacheBuster,compile:function(element,attrs){for(var index in defaults){if(defaults.hasOwnProperty(index)&&attrs[index]===undefined){attrs[index]=defaults[index];}}
return function(scope,element,attrs){scope.$watch('progress',function(val,oldVal){if(val!==oldVal){if(val>100){scope.progress=100;}else if(val<0){scope.progress=0;}}});};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikAlert',piwikAlert);piwikAlert.$inject=['piwik'];function piwikAlert(piwik){return{restrict:'A',transclude:true,scope:{severity:'@piwikAlert'},templateUrl:'plugins/CoreHome/angularjs/alert/alert.directive.html?cb='+piwik.cacheBuster};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').component('piwikSparkline',{template:'<img />',bindings:{seriesIndices:'<',params:'<'},controller:SparklineController});SparklineController.$inject=['$element','$httpParamSerializer','piwikApi','piwik','piwikPeriods'];function SparklineController($element,$httpParamSerializer,piwikApi,piwik,piwikPeriods){var vm=this;vm.$onChanges=$onChanges;function $onChanges(){$element.find('img').attr('src',getSparklineUrl());}
function getSparklineUrl(){var seriesIndices=vm.seriesIndices;var sparklineColors=piwik.getSparklineColors();if(seriesIndices){sparklineColors.lineColor=sparklineColors.lineColor.filter(function(c,index){return seriesIndices.indexOf(index)!==-1;});}
var colors=JSON.stringify(sparklineColors);var defaultParams={forceView:'1',viewDataTable:'sparkline',widget:$element.closest('[widgetId]').length?'1':'0',showtitle:'1',colors:colors,random:Date.now(),date:getDefaultDate()};var urlParams=piwikApi.mixinDefaultGetParams($element.extend(defaultParams,vm.params));var token_auth=piwik.broadcast.getValueFromUrl("token_auth");if(token_auth.length&&piwik.shouldPropagateTokenAuth){urlParams.token_auth=token_auth;}
return'?'+$httpParamSerializer(urlParams);}
function getDefaultDate(){if(piwik.period==='range'){return piwik.startDateString+','+piwik.endDateString;}
var dateRange=piwikPeriods.get('range').getLastNRange(piwik.period,30,piwik.currentDateString).getDateRange();var piwikMinDate=new Date(piwik.minDateYear,piwik.minDateMonth-1,piwik.minDateDay);if(dateRange[0]<piwikMinDate){dateRange[0]=piwikMinDate;}
var startDateStr=piwikPeriods.format(dateRange[0]);var endDateStr=piwikPeriods.format(dateRange[1]);return startDateStr+','+endDateStr;}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').factory('siteSelectorModel',siteSelectorModel);siteSelectorModel.$inject=['piwikApi','$filter','piwik'];function siteSelectorModel(piwikApi,$filter,piwik){var initialSites=null;var limitPromise=null;var model={sites:[],hasMultipleWebsites:false,isLoading:false,firstSiteName:'',onlySitesWithAdminAccess:false,updateWebsitesList:updateWebsitesList,searchSite:searchSite,loadSite:loadSite,loadInitialSites:loadInitialSites};return model;function updateWebsitesList(sites){if(!sites||!sites.length){model.sites=[];return[];}
angular.forEach(sites,function(site){if(site.group)site.name='['+site.group+'] '+site.name;});model.sites=sortSites(sites);if(!model.firstSiteName){model.firstSiteName=model.sites[0].name;}
model.hasMultipleWebsites=model.hasMultipleWebsites||sites.length>1;return model.sites;}
function searchSite(term){if(!term){loadInitialSites();return;}
if(model.isLoading){if(model.currentRequest){model.currentRequest.abort();}else if(limitPromise){limitPromise.abort();limitPromise=null;}}
model.isLoading=true;if(!limitPromise){limitPromise=piwikApi.fetch({method:'SitesManager.getNumWebsitesToDisplayPerPage'});}
return limitPromise.then(function(response){var limit=response.value;var methodToCall='SitesManager.getPatternMatchSites';if(model.onlySitesWithAdminAccess){methodToCall='SitesManager.getSitesWithAdminAccess';}
model.currentRequest=piwikApi.fetch({method:methodToCall,limit:limit,pattern:term});return model.currentRequest;}).then(function(response){if(angular.isDefined(response)){return updateWebsitesList(response);}}).finally(function(){model.isLoading=false;model.currentRequest=null;});}
function loadSite(idsite){if(idsite=='all'){piwik.broadcast.propagateNewPage('module=MultiSites&action=index');}else{piwik.broadcast.propagateNewPage('segment=&idSite='+idsite,false);}}
function sortSites(websites){return $filter('orderBy')(websites,'+name');}
function loadInitialSites(){if(initialSites){model.sites=initialSites;return;}
searchSite('%').then(function(){initialSites=model.sites});}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('SiteSelectorController',SiteSelectorController);SiteSelectorController.$inject=['$scope','siteSelectorModel','piwik','AUTOCOMPLETE_MIN_SITES'];function SiteSelectorController($scope,siteSelectorModel,piwik,AUTOCOMPLETE_MIN_SITES){$scope.model=siteSelectorModel;$scope.autocompleteMinSites=AUTOCOMPLETE_MIN_SITES;$scope.activeSiteId=piwik.idSite;$scope.switchSite=function(site,$event){var controlKey=navigator.userAgent.indexOf("Mac OS X")!==-1?$event.metaKey:$event.ctrlKey;if($event&&controlKey&&$event.target&&$event.target.href){window.open($event.target.href,"_blank");return;}
$scope.selectedSite={id:site.idsite,name:site.name};if(!$scope.switchSiteOnSelect||$scope.activeSiteId==site.idsite){return;}
$scope.model.loadSite(site.idsite);};$scope.getUrlAllSites=function(){var newParameters='module=MultiSites&action=index';return piwik.helper.getCurrentQueryStringWithParametersModified(newParameters);};$scope.getUrlForSiteId=function(idSite){var idSiteParam='idSite='+idSite;var newParameters='segment=&'+idSiteParam;var hash=piwik.broadcast.isHashExists()?piwik.broadcast.getHashFromUrl():"";return piwik.helper.getCurrentQueryStringWithParametersModified(newParameters)+'#'+piwik.helper.getQueryStringWithParametersModified(hash.substring(1),newParameters);};piwikHelper.registerShortcut('w',_pk_translate('CoreHome_ShortcutWebsiteSelector'),function(event){if(event.altKey){return;}
if(event.preventDefault){event.preventDefault();}else{event.returnValue=false;}
$('.siteSelector .title').trigger('click').focus();});}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikSiteselector',piwikSiteselector);piwikSiteselector.$inject=['$document','piwik','$filter','$timeout'];function piwikSiteselector($document,piwik,$filter,$timeout){var defaults={name:'',siteid:piwik.idSite,sitename:piwik.helper.htmlDecode(piwik.siteName),allSitesLocation:'bottom',allSitesText:$filter('translate')('General_MultiSitesSummary'),showSelectedSite:'false',showAllSitesItem:'true',switchSiteOnSelect:'true',onlySitesWithAdminAccess:'false'};return{restrict:'A',scope:{showSelectedSite:'=',showAllSitesItem:'=',switchSiteOnSelect:'=',onlySitesWithAdminAccess:'=',inputName:'@name',allSitesText:'@',allSitesLocation:'@',placeholder:'@'},require:"?ngModel",templateUrl:'plugins/CoreHome/angularjs/siteselector/siteselector.directive.html?cb='+piwik.cacheBuster,controller:'SiteSelectorController',compile:function(element,attrs){for(var index in defaults){if(attrs[index]===undefined){attrs[index]=defaults[index];}}
return function(scope,element,attrs,ngModel){if(attrs.siteid&&attrs.sitename){scope.selectedSite={id:attrs.siteid,name:attrs.sitename};}
scope.model.onlySitesWithAdminAccess=scope.onlySitesWithAdminAccess;if(ngModel){ngModel.$setViewValue(scope.selectedSite);}
scope.$watch('selectedSite.id',function(newValue,oldValue,scope){if(newValue!=oldValue){element.attr('siteid',newValue);element.trigger('change',scope.selectedSite);}});if(ngModel){ngModel.$render=function(){if(angular.isString(ngModel.$viewValue)){scope.selectedSite=JSON.parse(ngModel.$viewValue);}else{scope.selectedSite=ngModel.$viewValue;}};}
scope.$watch('selectedSite',function(newValue){if(ngModel){ngModel.$setViewValue(newValue);}});scope.$watch('view.showSitesList',function(newValue){element.toggleClass('expanded',!!newValue);});$timeout(function(){initTopControls();});};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikMenudropdown',piwikMenudropdown);function piwikMenudropdown(){return{transclude:true,replace:true,restrict:'A',scope:{menuTitle:'@',tooltip:'@',showSearch:'=',menuTitleChangeOnClick:'='},templateUrl:'plugins/CoreHome/angularjs/menudropdown/menudropdown.directive.html?cb='+piwik.cacheBuster,link:function(scope,element,attrs){scope.selectItem=function(event){var $self=angular.element(event.target);if(!$self.hasClass('item')||$self.hasClass('disabled')||$self.hasClass('separator')){return;}
if(scope.menuTitleChangeOnClick!==false){scope.menuTitle=$self.text().replace(/[\u0000-\u2666]/g,function(c){return'&#'+c.charCodeAt(0)+';';});}
scope.$eval('view.showItems = false');setTimeout(function(){scope.$apply();},0);element.find('.item').removeClass('active');$self.addClass('active');};scope.searchItems=function(searchTerm){searchTerm=searchTerm.toLowerCase();element.find('.item').each(function(index,node){var $node=angular.element(node);if(-1===$node.text().toLowerCase().indexOf(searchTerm)){$node.hide();}else{$node.show();}});};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikEnrichedHeadline',piwikEnrichedHeadline);piwikEnrichedHeadline.$inject=['$document','piwik','$filter','$parse'];function piwikEnrichedHeadline($document,piwik,$filter,$parse){var defaults={helpUrl:'',editUrl:''};return{transclude:true,restrict:'A',scope:{helpUrl:'@',editUrl:'@',featureName:'@',inlineHelp:'@?'},templateUrl:'plugins/CoreHome/angularjs/enrichedheadline/enrichedheadline.directive.html?cb='+piwik.cacheBuster,compile:function(element,attrs){for(var index in defaults){if(!attrs[index]){attrs[index]=defaults[index];}}
return function(scope,element,attrs){if(!scope.inlineHelp){var helpNode=$('[ng-transclude] .inlineHelp',element);if((!helpNode||!helpNode.length)&&element.next()){helpNode=element.next().find('.reportDocumentation');}
if(helpNode&&helpNode.length){var helpParagraph=$('p[ng-bind-html]',helpNode);if(helpParagraph.length){helpParagraph.html($parse(helpParagraph.attr('ng-bind-html')));}
if($.trim(helpNode.text())){scope.inlineHelp=$.trim(helpNode.html());}
helpNode.remove();}}
if(!attrs.featureName){attrs.featureName=$.trim(element.find('.title').first().text());}};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikContentIntro',piwikContentIntro);piwikContentIntro.$inject=['piwik'];function piwikContentIntro(piwik){return{restrict:'A',compile:function(element,attrs){element.addClass('piwik-content-intro');}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikContentBlock',piwikContentBlock);piwikContentBlock.$inject=['piwik'];function piwikContentBlock(piwik){var adminContent=null;return{restrict:'A',replace:true,transclude:true,scope:{contentTitle:'@',feature:'@',helpUrl:'@',helpText:'@',anchor:'@?'},templateUrl:'plugins/CoreHome/angularjs/content-block/content-block.directive.html?cb='+piwik.cacheBuster,controllerAs:'contentBlock',compile:function(element,attrs){if(attrs.feature==='true'){attrs.feature=true;}
return function(scope,element,attrs){if(scope.anchor){var anchor=$('<a></a>').attr('id',scope.anchor);element.prepend(anchor);}
var inlineHelp=element.find('[ng-transclude] > .contentHelp');if(inlineHelp.length){scope.helpText=inlineHelp.html();inlineHelp.remove();}
if(scope.feature&&(scope.feature===true||scope.feature==='true')){scope.feature=scope.contentTitle;}
if(adminContent===null){adminContent=$('#content.admin');}
var contentTopPosition=false;if(adminContent.length){contentTopPosition=adminContent.offset().top;}
if(contentTopPosition||contentTopPosition===0){var parents=element.parentsUntil('.col','[piwik-widget-loader]');var topThis;if(parents.length){topThis=parents.offset().top;}else{topThis=element.offset().top;}
if((topThis-contentTopPosition)<17){element.css('marginTop','0');}}};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikDialogtoggler',piwikDialogtoggler);function piwikDialogtoggler(){return{restrict:'A',controller:'DialogTogglerController'};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('DialogTogglerController',DialogTogglerController);DialogTogglerController.$inject=['$scope','piwik','ngDialog','piwikDialogtogglerUrllistener'];function DialogTogglerController($scope,piwik,ngDialog,piwikDialogtogglerUrllistener){$scope.open=function(contentsInfo){var ngDialogInfo;if(typeof(contentsInfo)=='object'){ngDialogInfo=contentsInfo;}else if(contentsInfo.substr(0,1)=='#'){ngDialogInfo={template:contentsInfo.substr(1)};}else if(contentsInfo.substr(-4)=='.html'){ngDialogInfo={template:contentsInfo};}else{ngDialogInfo={template:contentsInfo,plain:true};}
return ngDialog.open(ngDialogInfo);};$scope.persist=function(directive,attributes){piwikDialogtogglerUrllistener.propagatePersistedDialog(directive,attributes);};$scope.close=function(){ngDialog.close();};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').factory('piwikDialogtogglerUrllistener',piwikDialogtogglerUrllistener);piwikDialogtogglerUrllistener.$inject=['$rootScope','$location','$injector','$rootElement','ngDialog'];function piwikDialogtogglerUrllistener($rootScope,$location,$injector,$rootElement,ngDialog){var service={},dialogQueryParamName='popover';function getHtmlFromDialogQueryParam(paramValue){var info=paramValue.split(':'),directiveName=info.shift(),dialogContent='';dialogContent+='<div '+directiveName;angular.forEach(info,function(argumentAssignment){var pair=argumentAssignment.split('='),key=pair[0],value=pair[1];dialogContent+=' '+key+'="'+decodeURIComponent(value)+'"';});dialogContent+='/>';return dialogContent;}
function directiveExists(directiveAttributeString){var PREFIX_REGEXP=/^(x[\:\-_]|data[\:\-_])/i,directiveName=angular.element.camelCase(directiveAttributeString.replace(PREFIX_REGEXP,''));return $injector.has(directiveName+'Directive');}
service.checkUrlForDialog=function(){var dialogParamValue=$location.search()[dialogQueryParamName];if(dialogParamValue&&directiveExists(dialogParamValue)){var dialog=ngDialog.open({template:getHtmlFromDialogQueryParam(dialogParamValue),plain:true,className:''});dialog.closePromise.then(function(){$location.search(dialogQueryParamName,null);});}};service.propagatePersistedDialog=function(directive,attributes){var paramValue=directive;angular.forEach(attributes,function(value,name){paramValue+=':'+name+'='+encodeURIComponent(value);});$location.search(dialogQueryParamName,paramValue);};$rootScope.$on('$locationChangeSuccess',function(){service.checkUrlForDialog();});service.checkUrlForDialog();return service;}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('NotificationController',NotificationController);NotificationController.$inject=['piwikApi'];function NotificationController(piwikApi){this.markNotificationAsRead=function(){var notificationId=this.notificationId;if(!notificationId){return;}
piwikApi.post({module:'CoreHome',action:'markNotificationAsRead'},{notificationId:notificationId});};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikNotification',piwikNotification);piwikNotification.$inject=['piwik','$timeout'];function piwikNotification(piwik,$timeout){return{restrict:'A',scope:{notificationId:'@?',title:'@?notificationTitle',context:'@?',type:'@?',noclear:'@?',toastLength:'@?'},transclude:true,templateUrl:'plugins/CoreHome/angularjs/notification/notification.directive.html?cb='+piwik.cacheBuster,controller:'NotificationController',controllerAs:'notification',link:function(scope,element){scope.toastLength=scope.toastLength||12*1000;if(scope.notificationId){closeExistingNotificationHavingSameIdIfNeeded(scope.notificationId,element);}
if(scope.context){element.children('.notification').addClass('notification-'+scope.context);}
if(scope.type=='persistent'){scope.noclear=false;}
if('toast'==scope.type){addToastEvent();}
if(!scope.noclear){addCloseEvent();}
function addToastEvent(){$timeout(function(){element.fadeOut('slow',function(){element.remove();});},scope.toastLength);}
function addCloseEvent(){element.on('click','.close',function(event){if(event&&event.delegateTarget){angular.element(event.delegateTarget).remove();}});}
function closeExistingNotificationHavingSameIdIfNeeded(id,notificationElement){var existingNode=angular.element('[notification-id='+id+']').not(notificationElement);if(existingNode&&existingNode.length){existingNode.remove();}}}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').factory('notifications',NotificationFactory);NotificationFactory.$inject=[];function NotificationFactory(){return{parseNotificationDivs:parseNotificationDivs,clearTransientNotifications:clearTransientNotifications,};function parseNotificationDivs(){var UI=require('piwik/UI');var $notificationNodes=$('[data-role="notification"]');$notificationNodes.each(function(index,notificationNode){$notificationNode=$(notificationNode);var attributes=$notificationNode.data();var message=$notificationNode.html();if(message){var notification=new UI.Notification();attributes.animate=false;notification.show(message,attributes);}
$notificationNodes.remove();});}
function clearTransientNotifications(){$('[piwik-notification][type=transient]').each(function(){var $element=angular.element(this);$element.scope().$destroy();$element.remove();});}}
angular.module('piwikApp').run(['notifications',function(notifications){$(function(){notifications.parseNotificationDivs();});}]);})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('AjaxFormController',AjaxFormController);AjaxFormController.$inject=['piwikApi','$filter'];function AjaxFormController(piwikApi,$filter){var vm=this;vm.successfulPostResponse=null;vm.errorPostResponse=null;vm.isSubmitting=false;vm.submitForm=submitForm;function submitForm(){var postParams;vm.successfulPostResponse=null;vm.errorPostResponse=null;if(vm.sendJsonPayload){postParams={data:JSON.stringify(vm.data)};}else{postParams=vm.data;}
vm.isSubmitting=true;piwikApi.post({module:'API',method:vm.submitApiMethod},postParams,{createErrorNotification:!vm.noErrorNotification}).then(function(response){vm.successResponse=response;if(!vm.noSuccessNotification){var UI=require('piwik/UI');var notification=new UI.Notification();notification.show($filter('translate')('General_YourChangesHaveBeenSaved'),{context:'success',type:'toast',id:'ajaxHelper'});notification.scrollToNotification();}}).catch(function(errorMessage){vm.errorPostResponse=errorMessage;}).finally(function(){vm.isSubmitting=false;});}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikAjaxForm',piwikAjaxForm);piwikAjaxForm.$inject=['$parse'];function piwikAjaxForm($parse){return{restrict:'A',scope:{submitApiMethod:'=',sendJsonPayload:'=',noErrorNotification:'=',noSuccessNotification:'=',useCustomDataBinding:'='},require:'?ngModel',controller:'AjaxFormController',controllerAs:'ajaxForm',transclude:true,compile:function(element,attrs){attrs.noErrorNotification=!!attrs.noErrorNotification;return function(scope,element,attrs,ngModel,transclude){if(!scope.submitApiMethod){throw new Error("submitApiMethod is required");}
scope.ajaxForm.submitApiMethod=scope.submitApiMethod;scope.ajaxForm.sendJsonPayload=scope.sendJsonPayload;scope.ajaxForm.noErrorNotification=scope.noErrorNotification;scope.ajaxForm.noSuccessNotification=scope.noSuccessNotification;scope.ajaxForm.data={};if(ngModel){var ngModelGetter=$parse(attrs.ngModel);scope.ajaxForm.data=ngModelGetter(scope.$parent);}
if(!scope.useCustomDataBinding){element.on('change','input,select',function(){setFormValueFromInput(this);});}
element.on('click','input[type=submit]',function(){scope.ajaxForm.submitForm();});transclude(scope,function(clone,scope){if(!scope.useCustomDataBinding){var $inputs=clone.find('input,select').not('[type=submit]');$inputs.each(function(){setFormValueFromInput(this,true);});}
element.append(clone);});function setFormValueFromInput(inputElement,skipScopeApply){var $=angular.element,name=$(inputElement).attr('name'),val;if($(inputElement).attr('type')=='checkbox'){val=$(inputElement).is(':checked');}else{val=$(inputElement).val();}
scope.ajaxForm.data[name]=val;if(!skipScopeApply){setTimeout(function(){scope.$apply();},0);}}};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikWidgetLoader',piwikWidgetLoader);piwikWidgetLoader.$inject=['piwik','piwikUrl','$http','$compile','$q','$location','notifications','$rootScope','$timeout','piwikComparisonsService'];function piwikWidgetLoader(piwik,piwikUrl,$http,$compile,$q,$location,notifications,$rootScope,$timeout,piwikComparisonsService){return{restrict:'A',transclude:true,scope:{piwikWidgetLoader:'=',widgetName:'@'},templateUrl:'plugins/CoreHome/angularjs/widget-loader/widgetloader.directive.html?cb='+piwik.cacheBuster,compile:function(element,attrs){return function(scope,element,attrs,ngModel){scope.widgetName=attrs.widgetName;if(!attrs.widgetName){scope.loadingMessage=_pk_translate('General_LoadingData');}else{scope.loadingMessage=_pk_translate('General_LoadingPopover',[attrs.widgetName]);}
var changeCounter=0,currentScope,currentElement,httpCanceler,contentNode=element.find('.theWidgetContent');var cleanupLastWidgetContent=function(){if(currentElement){currentElement.remove();currentElement=null;}
if(currentScope){currentScope.$destroy();currentScope=null;}};var abortHttpRequestIfNeeded=function(){if(httpCanceler){httpCanceler.resolve();httpCanceler=null;}}
function getFullWidgetUrl(parameters){var url=$.param(parameters);var $urlParams=$location.search();delete $urlParams['comparePeriods[]'];delete $urlParams['compareDates[]'];delete $urlParams['compareSegments[]'];if($.isEmptyObject($urlParams)||!$urlParams||!$urlParams['idSite']){$urlParams={idSite:'idSite',period:'period',date:'date'};if(piwikUrl.getSearchParam('widget')){$urlParams['widget']='widget';}}else{$urlParams=angular.copy($urlParams);delete $urlParams['category'];delete $urlParams['subcategory'];}
if(piwikUrl.getSearchParam('segment')){$urlParams['segment']='segment';}
angular.forEach($urlParams,function(value,key){if(!(key in parameters)){url+='&'+key+'='+piwikUrl.getSearchParam(key);}});if(piwikComparisonsService.isComparisonEnabled()){['comparePeriods','compareDates','compareSegments'].forEach(function(paramName){var value=piwikUrl.getSearchParam(paramName);if(value){var map={};map[paramName]=value;url+='&'+$.param(map);}});}
if(!parameters||!('showtitle'in parameters)){url+='&showtitle=1';}
if(piwik.shouldPropagateTokenAuth&&broadcast.getValueFromUrl('token_auth')){url+='&token_auth='+broadcast.getValueFromUrl('token_auth');}
url+='&random='+parseInt(Math.random()*10000);return'?'+url;}
function loadWidgetUrl(parameters,thisChangeId){scope.loading=true;var url=getFullWidgetUrl(parameters);abortHttpRequestIfNeeded();cleanupLastWidgetContent();httpCanceler=$q.defer();$http.get(url,{timeout:httpCanceler.promise,headers:{'X-Requested-With':'XMLHttpRequest'}}).then(function(response){if(thisChangeId!==changeCounter||!response.data){return;}
httpCanceler=null;var newScope=scope.$new();currentScope=newScope;scope.loading=false;scope.loadingFailed=false;currentElement=contentNode.html(response.data).children();if(scope.widgetName){var $title=currentElement.find('> .card-content .card-title');if(!$title.length){$title=currentElement.find('> h2');}
if($title.length){$title.html(piwik.helper.htmlEntities(scope.widgetName));}}
$compile(currentElement)(newScope);notifications.parseNotificationDivs();$timeout(function(){$rootScope.$emit('widget:loaded',{parameters:parameters,element:currentElement,});});})['catch'](function(){if(thisChangeId!==changeCounter){return;}
httpCanceler=null;cleanupLastWidgetContent();scope.loading=false;scope.loadingFailed=true;});}
scope.$watch('piwikWidgetLoader',function(parameters,oldUrl){if(parameters){loadWidgetUrl(parameters,++changeCounter);}});element.on('$destroy',function(){abortHttpRequestIfNeeded();});};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikWidgetByDimensionContainer',piwikWidgetContainer);piwikWidgetContainer.$inject=['piwik','$filter'];function piwikWidgetContainer(piwik,$filter){return{restrict:'A',scope:{container:'=piwikWidgetByDimensionContainer'},templateUrl:'plugins/CoreHome/angularjs/widget-bydimension-container/widget-bydimension-container.directive.html?cb='+piwik.cacheBuster,compile:function(element,attrs){return function(scope,element,attrs,ngModel){var widgetsSorted=$filter('orderBy')(scope.container.widgets,'order');var widgetsByCategory={};angular.forEach(widgetsSorted,function(widget){var category=widget.subcategory.name;if(!widgetsByCategory[category]){widgetsByCategory[category]={name:category,order:widget.order,widgets:[]};}
widgetsByCategory[category].widgets.push(widget);});var finalWidgetsByCategory=[];angular.forEach(widgetsByCategory,function(category){finalWidgetsByCategory.push(category);});scope.widgetsByCategory=$filter('orderBy')(finalWidgetsByCategory,'order');scope.selectWidget=function(widget){scope.selectedWidget=angular.copy(widget);};if(widgetsSorted&&widgetsSorted.length){scope.selectWidget(widgetsSorted[0]);}};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikWidgetContainer',piwikWidgetContainer);piwikWidgetContainer.$inject=['piwik'];function piwikWidgetContainer(piwik){return{restrict:'A',scope:{container:'=piwikWidgetContainer'},templateUrl:'plugins/CoreHome/angularjs/widget-container/widgetcontainer.directive.html?cb='+piwik.cacheBuster,compile:function(element,attrs){return function(scope,element,attrs,ngModel){scope.$watch('container',function(container){if(container&&container.widgets&&container.widgets[0]&&container.widgets[0].parameters){var widget=container.widgets[0];var isWidgetized=widget.parameters.widget=='1';if(isWidgetized&&widget.viewDataTable&&widget.viewDataTable=='graphEvolution'){widget.parameters.showtitle='0';}}});}}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikWidget',piwikWidget);piwikWidget.$inject=['piwik','piwikApi','reportMetadataModel'];function piwikWidget(piwik,piwikApi,reportMetadataModel){function findContainerWidget(containerId,scope){widgetsHelper.getAvailableWidgets(function(categorizedWidgets){angular.forEach(categorizedWidgets,function(widgets){angular.forEach(widgets,function(widget){if(widget&&widget.isContainer&&widget.parameters.containerId===containerId){widget=angular.copy(widget);if(scope.widgetized){widget.isFirstInPage='1';widget.parameters.widget='1';angular.forEach(widget.widgets,function(widget){widget.parameters.widget='1';widget.parameters.containerId=containerId;});}
scope.widget=widget;applyMiddleware(scope);}});});});}
function addReportDocumentationIfPossible(widget){if(widget&&widget.isReport&&!widget.documentation){var report=reportMetadataModel.findReport(widget.module,widget.action);if(report&&report.documentation){widget.documentation=report.documentation;}}}
function applyMiddleware(scope){if(!scope.widget.middlewareParameters){scope.$evalAsync('view.showWidget = true');}else{var params=angular.copy(scope.widget.middlewareParameters);piwikApi.fetch(params).then(function(response){var enabled=response?'true':'false';scope.$evalAsync('view.showWidget = '+enabled);});}}
return{restrict:'A',scope:{widget:'=?piwikWidget',widgetized:'=?',containerid:'='},templateUrl:'plugins/CoreHome/angularjs/widget/widget.directive.html?cb='+piwik.cacheBuster,compile:function(element,attrs){return function(scope,element,attrs,ngModel){if(scope.widget){addReportDocumentationIfPossible(scope.widget);applyMiddleware(scope);}else if(attrs.containerid){findContainerWidget(attrs.containerid,scope);}
$(element).tooltip({track:true,content:function(){var $this=$(this);if($this.attr('piwik-field')===''){return'';}
var title=$(this).attr('title');return piwikHelper.escape(title.replace(/\n/g,'<br />'));},show:{delay:700,duration:200},hide:false});scope.$on("$destroy",function(){try{$(element).tooltip('destroy');}catch(e){}});}}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikPopoverHandler',piwikPopoverHandler);piwikPopoverHandler.$inject=['$location','$rootScope','piwik'];function piwikPopoverHandler($location,$rootScope,piwik){return{restrict:'A',scope:{},controller:function(){function close(){Piwik_Popover.close();}
function open(popoverParam){popoverParam=decodeURIComponent(popoverParam);popoverParam=popoverParam.replace(/\$/g,'%');popoverParam=decodeURIComponent(popoverParam);var popoverParamParts=popoverParam.split(':');var handlerName=popoverParamParts[0];popoverParamParts.shift();var param=popoverParamParts.join(':');if(typeof piwik.broadcast.popoverHandlers[handlerName]!='undefined'&&!piwik.broadcast.isLoginPage()){piwik.broadcast.popoverHandlers[handlerName](param);}}
function openOrClose(){close();var popoverParam=$location.search().popover;if(popoverParam){open(popoverParam);}else{broadcast.resetPopoverStack();}}
$rootScope.$on('$locationChangeSuccess',function(){$(function(){openOrClose();});});}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikReportExport',piwikReportExport);piwikReportExport.$inject=['$document','piwik','$compile','$timeout','$location','$httpParamSerializerJQLike'];function piwikReportExport($document,piwik,$compile,$timeout,$location,$httpParamSerializerJQLike){return{restrict:'A',scope:{'reportTitle':'@','requestParams':'@','reportFormats':'@','apiMethod':'@','maxFilterLimit':'@',},link:function(scope,element,attr){var popoverParamBackup;scope.showUrl=false;scope.getExportLink=function(){var dataTable=scope.dataTable;var format=scope.reportFormat;if(!format){return;}
var method=scope.apiMethod;var limit=scope.reportLimitAll=='yes'?-1:scope.reportLimit;var type=scope.reportType;var params=scope.requestParams;if(params&&typeof params=="string"){params=JSON.parse(params);}else{params={};}
var segment=dataTable.param.segment;var label=dataTable.param.label;var idGoal=dataTable.param.idGoal;var idDimension=dataTable.param.idDimension;var param_date=dataTable.param.date;if(format=='RSS'){param_date='last10';}
if(typeof dataTable.param.dateUsedInGraph!='undefined'){param_date=dataTable.param.dateUsedInGraph;}
var period=dataTable.param.period;var formatsUseDayNotRange=piwik.config.datatable_export_range_as_day.toLowerCase();if(formatsUseDayNotRange.indexOf(format.toLowerCase())!=-1&&dataTable.param.period=='range'){period='day';}
if(dataTable.param.period=='range'&&dataTable.param.viewDataTable=="graphEvolution"){period='day';}
var exportUrlParams={module:'API'};if(type=='processed'){var apiParams=method.split('.');exportUrlParams.method='API.getProcessedReport';exportUrlParams.apiModule=apiParams[0];exportUrlParams.apiAction=apiParams[1];}else{exportUrlParams.method=method;}
exportUrlParams.format=format;exportUrlParams.idSite=dataTable.param.idSite;exportUrlParams.period=period;exportUrlParams.date=param_date;if(dataTable.param.compareDates&&dataTable.param.compareDates.length){exportUrlParams.compareDates=dataTable.param.compareDates;exportUrlParams.compare='1';}
if(dataTable.param.comparePeriods&&dataTable.param.comparePeriods.length){exportUrlParams.comparePeriods=dataTable.param.comparePeriods;exportUrlParams.compare='1';}
if(dataTable.param.compareSegments&&dataTable.param.compareSegments.length){exportUrlParams.compareSegments=dataTable.param.compareSegments;exportUrlParams.compare='1';}
if(typeof dataTable.param.filter_pattern!="undefined"){exportUrlParams.filter_pattern=dataTable.param.filter_pattern;}
if(typeof dataTable.param.filter_pattern_recursive!="undefined"){exportUrlParams.filter_pattern_recursive=dataTable.param.filter_pattern_recursive;}
if($.isPlainObject(params)){$.each(params,function(index,param){if(param===true){param=1;}else if(param===false){param=0;}
exportUrlParams[index]=param;});}
if(scope.optionFlat){exportUrlParams.flat=1;if(typeof dataTable.param.include_aggregate_rows!="undefined"&&dataTable.param.include_aggregate_rows=='1'){exportUrlParams.include_aggregate_rows=1;}}
if(!scope.optionFlat&&scope.optionExpanded){exportUrlParams.expanded=1;}
if(scope.optionFormatMetrics){exportUrlParams.format_metrics=1;}
if(dataTable.param.pivotBy){exportUrlParams.pivotBy=dataTable.param.pivotBy;exportUrlParams.pivotByColumnLimit=20;if(dataTable.props.pivot_by_column){exportUrlParams.pivotByColumn=dataTable.props.pivot_by_column;}}
if(format=='CSV'||format=='TSV'||format=='RSS'){exportUrlParams.translateColumnNames=1;exportUrlParams.language=piwik.language;}
if(typeof segment!='undefined'){exportUrlParams.segment=decodeURIComponent(segment);}
if(typeof idGoal!='undefined'&&idGoal!='-1'){exportUrlParams.idGoal=idGoal;}
if(typeof idDimension!='undefined'&&idDimension!='-1'){exportUrlParams.idDimension=idDimension;}
if(label){label=label.split(',');if(label.length>1){exportUrlParams.label=label;}else{exportUrlParams.label=label[0];}}
exportUrlParams.token_auth=piwik.token_auth;exportUrlParams.filter_limit=limit;var currentUrl=$location.absUrl();var urlParts=currentUrl.split('/');urlParts.pop();var url=urlParts.join('/');return url+'/index.php?'+$httpParamSerializerJQLike(exportUrlParams);};element.on('click',function(){popoverParamBackup=broadcast.getValueFromHash('popover');var dataTable=scope.dataTable=element.parents('[data-report]').data('uiControlObject');var popover=Piwik_Popover.showLoading('Export');var formats=JSON.parse(scope.reportFormats);scope.reportType='default';var reportLimit=dataTable.param.filter_limit;if(scope.maxFilterLimit>0){reportLimit=Math.min(reportLimit,scope.maxFilterLimit);}
scope.reportLimit=reportLimit>0?reportLimit:100;scope.reportLimitAll=reportLimit==-1?'yes':'no';scope.optionFlat=dataTable.param.flat===true||dataTable.param.flat===1||dataTable.param.flat==="1";scope.optionExpanded=1;scope.optionFormatMetrics=0;scope.hasSubtables=scope.optionFlat||dataTable.numberOfSubtables>0;scope.availableReportFormats={default:formats,processed:{'XML':formats['XML'],'JSON':formats['JSON']}};scope.availableReportTypes={default:_pk_translate('CoreHome_StandardReport'),processed:_pk_translate('CoreHome_ReportWithMetadata')};scope.limitAllOptions={yes:_pk_translate('General_All'),no:_pk_translate('CoreHome_CustomLimit')};scope.$watch('reportType',function(newVal,oldVal){if(!scope.availableReportFormats[newVal].hasOwnProperty(scope.reportFormat)){scope.reportFormat='XML';}},true);if(scope.maxFilterLimit>0){scope.$watch('reportLimit',function(newVal,oldVal){if(parseInt(newVal,10)>parseInt(scope.maxFilterLimit,10)){scope.reportLimit=oldVal;}},true);}
var elem=$document.find('#reportExport').eq(0);if(!elem.length){elem=angular.element('<span ng-include="\'plugins/CoreHome/angularjs/report-export/reportexport.popover.html?cb='+piwik.cacheBuster+'\'" id="reportExport"></span>');}
$compile(elem)(scope,function(compiled){Piwik_Popover.setTitle(_pk_translate('General_Export')+' '+piwikHelper.htmlEntities(scope.reportTitle));Piwik_Popover.setContent(compiled);if(popoverParamBackup!=''){Piwik_Popover.onClose(function(){$timeout(function(){$location.search('popover',popoverParamBackup);$timeout(function(){angular.element(document).injector().get('$rootScope').$apply();},10);},100);});}
$timeout(function(){popover.dialog({position:['center','center']});},100);});});}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('ReportingPageController',ReportingPageController);ReportingPageController.$inject=['$scope','piwik','$rootScope','$location','reportingPageModel','reportingPagesModel','notifications','piwikUrl'];function ReportingPageController($scope,piwik,$rootScope,$location,pageModel,pagesModel,notifications,piwikUrl){pageModel.resetPage();$scope.pageModel=pageModel;var currentCategory=null;var currentSubcategory=null;var currentPeriod=null;var currentDate=null;var currentSegment=null;var currentCompareDates=null;var currentComparePeriods=null;var currentCompareSegments=null;function renderInitialPage(){var $search=$location.search();currentPeriod=$search.period;currentDate=$search.date;currentSegment=$search.segment;currentCompareSegments=piwikUrl.getSearchParam('compareSegments');currentCompareDates=piwikUrl.getSearchParam('compareDates');currentComparePeriods=piwikUrl.getSearchParam('comparePeriods');$scope.renderPage($search.category,$search.subcategory);}
$scope.renderPage=function(category,subcategory){if(!category||!subcategory){pageModel.resetPage();$scope.loading=false;return;}
$rootScope.$emit('piwikPageChange',{});currentCategory=category;currentSubcategory=subcategory;notifications.clearTransientNotifications();if(category==='Dashboard_Dashboard'&&$.isNumeric(subcategory)&&$('[piwik-dashboard]').length){$scope.loading=true;var element=$('[piwik-dashboard]');var scope=angular.element(element).scope();scope.fetchDashboard(parseInt(subcategory,10)).then(function(){$scope.loading=false;},function(){$scope.loading=false;});return;}
pageModel.fetchPage(category,subcategory).then(function(){if(!pageModel.page){var page=pagesModel.findPageInCategory(category);if(page&&page.subcategory){var $search=$location.search();$search.subcategory=page.subcategory.id;$location.search($search);return;}}
$scope.hasNoPage=!pageModel.page;$scope.loading=false;});};$scope.loading=true;renderInitialPage();$rootScope.$on('$locationChangeSuccess',function(){var $search=$location.search();var category=$search.category;var subcategory=$search.subcategory;var period=$search.period;var date=$search.date;var segment=$search.segment;var compareSegments=piwikUrl.getSearchParam('compareSegments');var compareDates=piwikUrl.getSearchParam('compareDates');var comparePeriods=piwikUrl.getSearchParam('comparePeriods');if(category===currentCategory&&subcategory===currentSubcategory&&period===currentPeriod&&date===currentDate&&segment===currentSegment&&JSON.stringify(compareDates)===JSON.stringify(currentCompareDates)&&JSON.stringify(comparePeriods)===JSON.stringify(currentComparePeriods)&&JSON.stringify(compareSegments)===JSON.stringify(currentCompareSegments)){return;}
currentPeriod=period;currentDate=date;currentSegment=segment;currentCompareDates=compareDates;currentComparePeriods=comparePeriods;currentCompareSegments=compareSegments;$scope.renderPage(category,subcategory);});$rootScope.$on('loadPage',function(event,category,subcategory){$scope.renderPage(category,subcategory);});}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').factory('reportingPageModel',reportingPageModelService);reportingPageModelService.$inject=['$filter','reportingPagesModel','reportMetadataModel'];function reportingPageModelService($filter,reportingPagesModel,reportMetadataModel){var init=false;var model={fetchPage:fetchPage,resetPage:resetPage,widgets:[],page:null,pageContentUrl:'',evolutionReports:[],sparklineReports:[]};return model;function resetPage(){model.page=null;model.widgets=[];model.pageContentUrl='';model.evolutionReports=[];model.sparklineReports=[];}
function sortWidgets(widgets){return $filter('orderBy')(widgets,'order');}
function shouldBeRenderedWithFullWidth(widget){if((widget.isContainer&&widget.layout&&widget.layout==='ByDimension')||widget.viewDataTable==='bydimension'){return true;}
if('undefined'!==typeof widget.isWide&&widget.isWide){return true;}
return widget.viewDataTable&&(widget.viewDataTable==='tableAllColumns'||widget.viewDataTable==='sparklines'||widget.viewDataTable==='graphEvolution');}
function buildPage(page){if(!page){return;}
var widgets=[];var evolutionReports=[];var sparklineReports=[];var reportsToIgnore=[];angular.forEach(page.widgets,function(widget){if(isIgnoredReport(reportsToIgnore,widget)){return;}
reportsToIgnore=reportsToIgnore.concat(getRelatedReports(widget));widgets.push(widget);});widgets=sortWidgets(widgets);var groupedWidgets=[];if(widgets.length===1){groupedWidgets=widgets;}else{for(var i=0;i<widgets.length;i++){var widget=widgets[i];if(shouldBeRenderedWithFullWidth(widget)||(widgets[i+1]&&shouldBeRenderedWithFullWidth(widgets[i+1]))){widget.widgets=sortWidgets(widget.widgets);groupedWidgets.push(widget);}else{var counter=0;var left=[widget];var right=[];while(widgets[i+1]&&!shouldBeRenderedWithFullWidth(widgets[i+1])){i++;counter++;if(counter%2===0){left.push(widgets[i]);}else{right.push(widgets[i]);}}
groupedWidgets.push({group:true,left:left,right:right});}}}
var copyWidgets=angular.copy(groupedWidgets);var copyEvolution=angular.copy(evolutionReports);var copySparklines=angular.copy(sparklineReports);if(copyEvolution.length){copyEvolution=markWidgetsInFirstRowOfPage(copyEvolution);}else if(copySparklines.length){copySparklines=markWidgetsInFirstRowOfPage(copySparklines);}else{copyWidgets=markWidgetsInFirstRowOfPage(copyWidgets);}
model.evolutionReports=copyEvolution;model.sparklineReports=copySparklines;model.widgets=copyWidgets;}
function markWidgetsInFirstRowOfPage(widgets){if(widgets&&widgets[0]){if(widgets[0].group){markWidgetsInFirstRowOfPage(widgets[0].left);markWidgetsInFirstRowOfPage(widgets[0].right);}else{widgets[0].isFirstInPage=true;}}
return widgets;}
function getRelatedReports(widget){if(widget.isReport){var report=reportMetadataModel.findReport(widget.module,widget.action);if(report&&report.relatedReports){return report.relatedReports;}}
return[];}
function isIgnoredReport(reportsToIgnore,widget){var found=false;if(widget.isReport){angular.forEach(reportsToIgnore,function(report){if(report.module===widget.module&&report.action===widget.action){found=true;}});}
return found;}
function fetchPage(category,subcategory){resetPage();var pagesPromise=reportingPagesModel.getAllPages();var reportsPromise=reportMetadataModel.fetchReportMetadata();return pagesPromise.then(function(){model.page=reportingPagesModel.findPage(category,subcategory);reportsPromise.then(function(){buildPage(model.page);});return model.page;});}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikReportingPage',piwikReportingPage);piwikReportingPage.$inject=['piwik'];function piwikReportingPage(piwik){return{restrict:'A',scope:{},templateUrl:'plugins/CoreHome/angularjs/reporting-page/reportingpage.directive.html?cb='+piwik.cacheBuster,controller:'ReportingPageController'};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('ReportingMenuController',ReportingMenuController);ReportingMenuController.$inject=['$scope','piwik','$location','$timeout','reportingMenuModel','$rootScope','piwikUrl'];function ReportingMenuController($scope,piwik,$location,$timeout,menuModel,$rootScope,piwikUrl){var idSite=piwikUrl.getSearchParam('idSite');var period=piwikUrl.getSearchParam('period');var date=piwikUrl.getSearchParam('date');var segment=piwikUrl.getSearchParam('segment');var comparePeriods=piwikUrl.getSearchParam('comparePeriods');var compareDates=piwikUrl.getSearchParam('compareDates');var compareSegments=piwikUrl.getSearchParam('compareSegments');function markAllCategoriesAsInactive(){angular.forEach(menuModel.menu,function(cat){cat.active=false;});}
function markAllCategoriesAndChildrenInactive(){angular.forEach(menuModel.menu,function(cat){cat.active=false;angular.forEach(cat.subcategories,function(subcat){subcat.active=false;if(subcat.isGroup&&subcat.subcategories){angular.forEach(subcat.subcategories,function(sub){sub.active=false;});}});});}
$scope.menuModel=menuModel;function enterSubcategory(category,subcategory,subsubcategory){if(!category||!subcategory){return;}
markAllCategoriesAndChildrenInactive();category.active=true;subcategory.active=true;if(subsubcategory){subcategory.name=subsubcategory.name;subsubcategory.active=true;}};$scope.makeUrl=function(category,subcategory){var params={idSite:idSite,period:period,date:date,segment:decodeURIComponent(segment),category:category.id,subcategory:subcategory.id,};if(compareDates){params.compareDates=compareDates;}
if(comparePeriods){params.comparePeriods=comparePeriods;}
if(compareSegments){params.compareSegments=compareSegments;}
return $.param(params);};$scope.loadCategory=function(category){if(category.active){category.active=false;}else{markAllCategoriesAsInactive();category.active=true;}
if(category.active&&category.subcategories&&category.subcategories.length===1){var subcategory=category.subcategories[0];if(subcategory.active){$scope.loadSubcategory(category,subcategory);}else{var url=$scope.makeUrl(category,subcategory);$location.search(url);}}};$scope.loadSubcategory=function(category,subcategory){if(subcategory&&subcategory.active){$rootScope.$emit('loadPage',category.id,subcategory.id);}};menuModel.fetchMenuItems().then(function(menu){if(!$location.search().subcategory){enterSubcategory(menu[0],menu[0].subcategories[0]);$location.search($scope.makeUrl(menu[0],menu[0].subcategories[0]));}});$rootScope.$on('updateReportingMenu',function(){menuModel.reloadMenuItems().then(function(menu){var $search=$location.search();var category=$search.category;var subcategory=$search.subcategory;if(category&&subcategory){var found=menuModel.findSubcategory(category,subcategory);if(found){enterSubcategory(found.category,found.subcategory,found.subsubcategory);}}});if('object'===typeof widgetsHelper&&widgetsHelper.availableWidgets){delete widgetsHelper.availableWidgets;widgetsHelper.getAvailableWidgets();}});$rootScope.$on('$locationChangeSuccess',function(){var $search=$location.search();var category=$search.category;var subcategory=$search.subcategory;period=piwikUrl.getSearchParam('period');date=piwikUrl.getSearchParam('date');segment=piwikUrl.getSearchParam('segment');comparePeriods=piwikUrl.getSearchParam('comparePeriods');compareDates=piwikUrl.getSearchParam('compareDates');compareSegments=piwikUrl.getSearchParam('compareSegments');if(!category||!subcategory){return;}
var found=menuModel.findSubcategory(category,subcategory);enterSubcategory(found.category,found.subcategory,found.subsubcategory);});}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').factory('reportingMenuModel',reportingMenuModelService);reportingMenuModelService.$inject=['$filter','$q','reportingPagesModel','$location'];function reportingMenuModelService($filter,$q,reportingPagesModel,$location){var model={menu:[],selected:[],fetchMenuItems:fetchMenuItems,reloadMenuItems:reloadMenuItems,findSubcategory:findSubcategory};return model;function isNumeric(text){return!isNaN(parseFloat(text))&&isFinite(text);}
function findSubcategory(categoryId,subcategoryId){var foundCategory=null;var foundSubcategory=null;var foundSubSubcategory=null;angular.forEach(model.menu,function(category){if(category.id!==categoryId){return;}
angular.forEach(category.subcategories,function(subcategory){if(subcategory.id===subcategoryId){foundCategory=category;foundSubcategory=subcategory;}
if(subcategory.isGroup){angular.forEach(subcategory.subcategories,function(subcat){if(subcat.id===subcategoryId){foundCategory=category;foundSubcategory=subcategory;foundSubSubcategory=subcat;}});}});});return{category:foundCategory,subcategory:foundSubcategory,subsubcategory:foundSubSubcategory};}
function buildMenuFromPages(pages){var menu=[];var activeCategory=$location.search().category;var activeSubcategory=$location.search().subcategory;var categoriesHandled={};angular.forEach(pages,function(page,key){var category=page.category;var categoryId=category.id;if(categoriesHandled[categoryId]){return;}
categoriesHandled[categoryId]=true;if(activeCategory&&category.id===activeCategory){category.active=true;}
category.subcategories=[];var categoryGroups=false;angular.forEach(pages,function(page,key){if(page.category.id===categoryId){var subcategory=page.subcategory;if(subcategory.id===activeSubcategory&&categoryId===activeCategory){subcategory.active=true;}
if(page.widgets&&page.widgets[0]&&isNumeric(page.subcategory.id)){if(!categoryGroups){categoryGroups=angular.copy(subcategory);categoryGroups.name=$filter('translate')('CoreHome_ChooseX',[category.name]);categoryGroups.isGroup=true;categoryGroups.subcategories=[];categoryGroups.order=10;}
if(subcategory.active){categoryGroups.name=subcategory.name;categoryGroups.active=true;}
var goalId=page.subcategory.id;subcategory.tooltip=subcategory.name+' (id = '+goalId+' )';categoryGroups.subcategories.push(subcategory);return;}
category.subcategories.push(subcategory);}});if(categoryGroups&&categoryGroups.subcategories&&categoryGroups.subcategories.length<=5){angular.forEach(categoryGroups.subcategories,function(subcategory){category.subcategories.push(subcategory);});}else if(categoryGroups){category.subcategories.push(categoryGroups);}
category.subcategories=sortMenuItems(category.subcategories);menu.push(category);return menu;});menu=sortMenuItems(menu);return menu;}
function sortMenuItems(menu){return $filter('orderBy')(menu,'order');};function reloadMenuItems(){var pagesPromise=reportingPagesModel.reloadAllPages();return pagesPromise.then(function(pages){model.menu=buildMenuFromPages(pages);return model.menu;});}
function fetchMenuItems(){var pagesPromise=reportingPagesModel.getAllPages();return pagesPromise.then(function(pages){model.menu=buildMenuFromPages(pages);return model.menu;});}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikReportingMenu',piwikReportingMenu);piwikReportingMenu.$inject=['piwik'];function piwikReportingMenu(piwik){return{restrict:'A',replace:true,scope:{},templateUrl:'plugins/CoreHome/angularjs/reporting-menu/reportingmenu.directive.html?cb='+piwik.cacheBuster,controller:'ReportingMenuController'};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('QuickAccessController',QuickAccessController);QuickAccessController.$inject=['$scope','$filter','siteSelectorModel'];function QuickAccessController($scope,$filter,siteSelectorModel){this.menuItems=[];this.numMenuItems=0;this.sitesModel=siteSelectorModel;this.onKeypress=function(event){var areSearchResultsDisplayed=$scope.search&&$scope.search.term&&$scope.view&&$scope.view.searchActive;var isTabKey=9==event.which;var isEscKey=27==event.which;if(38==event.which){$scope.highlightPreviousItem();event.preventDefault();}else if(40==event.which){$scope.highlightNextItem();event.preventDefault();}else if(13==event.which){$scope.clickQuickAccessMenuItem();}else if(isTabKey&&areSearchResultsDisplayed){$scope.deactivateSearch();}else if(isEscKey&&areSearchResultsDisplayed){$scope.deactivateSearch();}};this.searchMenu=function(searchTerm){searchTerm=searchTerm.toLowerCase();var index=-1;var menuItemsIndex={};var menuItems=[];var moveToCategory=function(i,submenuItem){submenuItem=angular.copy(submenuItem);submenuItem.menuIndex=++index;var category=submenuItem.category;if(!(category in menuItemsIndex)){menuItems.push({title:category,items:[]});menuItemsIndex[category]=menuItems.length-1;}
var indexOfCategory=menuItemsIndex[category];menuItems[indexOfCategory].items.push(submenuItem);};$scope.resetSearchIndex();if($scope.hasSitesSelector){this.sitesModel.searchSite(searchTerm);}
var topMenuItems=$filter('filter')($scope.getTopMenuItems(),searchTerm);var leftMenuItems=$filter('filter')($scope.getLeftMenuItems(),searchTerm);var segmentItems=$filter('filter')($scope.getSegmentItems(),searchTerm);$.each(topMenuItems,moveToCategory);$.each(leftMenuItems,moveToCategory);$.each(segmentItems,moveToCategory);this.numMenuItems=topMenuItems.length+leftMenuItems.length+segmentItems.length;this.menuItems=menuItems;};this.selectSite=function(idsite){this.sitesModel.loadSite(idsite);};this.selectMenuItem=function(index){$scope.selectMenuItem(index);};if(typeof initTopControls!=='undefined'&&initTopControls){initTopControls();}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikQuickAccess',QuickAccessDirective);QuickAccessDirective.$inject=['$rootElement','$timeout','piwik','$filter'];function QuickAccessDirective($rootElement,$timeout,piwik,$filter){return{restrict:'A',replace:true,scope:{},templateUrl:'plugins/CoreHome/angularjs/quick-access/quick-access.directive.html?cb='+piwik.cacheBuster,controller:'QuickAccessController',controllerAs:'quickAccess',link:function(scope,element,attrs){var menuIndex=-1;var topMenuItems=[];var leftMenuItems=[];var segmentItems=[];var hasSegmentSelector=angular.element('.segmentEditorPanel').length;scope.hasSitesSelector=angular.element('.top_controls [piwik-siteselector]').length;var translate=$filter('translate');var searchAreasTitle='';var searchAreas=[translate('CoreHome_MenuEntries')];if(hasSegmentSelector){searchAreas.push(translate('CoreHome_Segments'));}
if(scope.hasSitesSelector){searchAreas.push(translate('SitesManager_Sites'));}
while(searchAreas.length){searchAreasTitle+=searchAreas.shift();if(searchAreas.length>=2){searchAreasTitle+=', ';}else if(searchAreas.length===1){searchAreasTitle+=' '+translate('General_And')+' ';}}
scope.quickAccessTitle=translate('CoreHome_QuickAccessTitle',searchAreasTitle);function trim(str){return str.replace(/^\s+|\s+$/g,'');}
scope.getTopMenuItems=function(){if(topMenuItems&&topMenuItems.length){return topMenuItems;}
var category=_pk_translate('CoreHome_Menu');$rootElement.find('nav .side-nav li > a').each(function(index,element){var $element=$(element);var text=trim($element.text());if(!text){text=trim($element.attr('title'));}
if(text){topMenuItems.push({name:text,index:++menuIndex,category:category});$element.attr('quick_access',menuIndex);}});return topMenuItems;};scope.getLeftMenuItems=function(){if(leftMenuItems&&leftMenuItems.length){return leftMenuItems;}
$rootElement.find('#secondNavBar .menuTab').each(function(index,element){var $element=angular.element(element);var category=trim($element.find('> .item').text());if(category&&-1!==category.lastIndexOf("\n")){category=trim(category.substr(0,category.lastIndexOf("\n")));}
$element.find('li .item').each(function(i,element){var $element=angular.element(element);var text=trim($element.text());if(text){leftMenuItems.push({name:text,category:category,index:++menuIndex});$element.attr('quick_access',menuIndex);}});});return leftMenuItems;};scope.getSegmentItems=function(){if(!hasSegmentSelector){return[];}
if(segmentItems&&segmentItems.length){return segmentItems;}
var category=_pk_translate('CoreHome_Segments');$rootElement.find('.segmentList [data-idsegment]').each(function(index,element){var $element=angular.element(element);var text=trim($element.find('.segname').text());if(text){segmentItems.push({name:text,category:category,index:++menuIndex});$element.attr('quick_access',menuIndex);}});return segmentItems;};scope.activateSearch=function(){scope.$eval('view.searchActive = true');$timeout(function(){scope.$apply();},0);};scope.deactivateSearch=function(){scope.$eval('search.term = ""');scope.$eval('view.searchActive = false');element.find('input').blur();$timeout(function(){scope.$apply();},0);};function isElementInViewport(element){var rect=element.getBoundingClientRect();return(rect.top>=0&&rect.left>=0&&rect.bottom<=$(window).height()&&rect.right<=$(window).width());}
function getCurrentlySelectedElement(index){var results=element.find('li.result');if(results&&results.length&&results[scope.search.index]){return $(results[scope.search.index]);}}
function makeSureSelectedItemIsInViewport(){var element=getCurrentlySelectedElement();if(element&&element[0]&&!isElementInViewport(element[0])){scrollFirstElementIntoView(element);}}
function scrollFirstElementIntoView(element){if(element&&element[0]&&element[0].scrollIntoView){element[0].scrollIntoView();}}
scope.highlightPreviousItem=function(){if(0>=(scope.search.index-1)){scope.search.index=0;}else{scope.search.index--;}
makeSureSelectedItemIsInViewport();};scope.resetSearchIndex=function(){scope.search.index=0;makeSureSelectedItemIsInViewport();};scope.highlightNextItem=function(){var numTotal=element.find('li.result').length;if(numTotal<=(scope.search.index+1)){scope.search.index=numTotal-1;}else{scope.search.index++;}
makeSureSelectedItemIsInViewport();};scope.clickQuickAccessMenuItem=function(){var selectedMenuElement=getCurrentlySelectedElement();if(selectedMenuElement){$timeout(function(){selectedMenuElement.click();},20);}};scope.selectMenuItem=function(index){var target=$rootElement.find('[quick_access='+index+']');if(target&&target.length&&target[0]){scope.deactivateSearch();var actualTarget=target[0];var href=$(actualTarget).attr('href');if(href&&href.length>10&&actualTarget&&actualTarget.click){try{actualTarget.click();}catch(e){$(actualTarget).click();}}else{$(actualTarget).click();}}};scope.urlEncode=function(term){return encodeURIComponent(term);};piwikHelper.registerShortcut('f',_pk_translate('CoreHome_ShortcutSearch'),function(event){if(event.altKey){return;}
if(event.preventDefault){event.preventDefault();}else{event.returnValue=false;}
scrollFirstElementIntoView(element);scope.activateSearch();});}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikExpandOnClick',piwikExpandOnClick);piwikExpandOnClick.$inject=['$document','piwik'];function piwikExpandOnClick($document,piwik){return{restrict:'A',link:function(scope,element,attr){element.find('.title').on('click',function(){element.toggleClass('expanded');var $position=element.find('.dropdown.positionInViewport');if($position.length){piwik.helper.setMarginLeftToBeInViewport($position);}});var isMouseDown=false;var hasScrolled=false;function onClickOutsideElement(event){var hadUsedScrollbar=isMouseDown&&hasScrolled;isMouseDown=false;hasScrolled=false;if(hadUsedScrollbar){return;}
if(element.has(event.target).length===0){element.removeClass('expanded');}}
function onScroll(event){hasScrolled=true;}
function onMouseDown(event){isMouseDown=true;hasScrolled=false;}
function onEscapeHandler(event){if(event.which===27){isMouseDown=false;hasScrolled=false;element.removeClass('expanded');}}
$document.on('keyup',onEscapeHandler);$document.on('mousedown',onMouseDown);$document.on('mouseup',onClickOutsideElement);$document.on('scroll',onScroll);scope.$on('$destroy',function(){$document.off('keyup',onEscapeHandler);$document.off('mousedown',onMouseDown);$document.off('mouseup',onClickOutsideElement);$document.off('scroll',onScroll);});}};}
angular.module('piwikApp').directive('piwikExpandOnHover',piwikExpandOnHover);piwikExpandOnHover.$inject=['$document','piwik'];function piwikExpandOnHover($document,piwik){return{restrict:'A',link:function(scope,element,attr){element.on('mouseenter','.title',function(){element.addClass('expanded');var $position=element.find('.dropdown.positionInViewport');if($position.length){piwik.helper.setMarginLeftToBeInViewport($position);}});element.on('mouseleave',function(){element.removeClass('expanded');});function onClickOutsideElement(event){if(element.has(event.target).length===0){element.removeClass('expanded');}}
function onEscapeHandler(event){if(event.which===27){element.removeClass('expanded');}}
$document.on('keyup',onEscapeHandler);$document.on('mouseup',onClickOutsideElement);scope.$on('$destroy',function(){$document.off('mouseup',onClickOutsideElement);$document.off('keyup',onEscapeHandler);});}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikContentTable',piwikContentTable);piwikContentTable.$inject=['piwik'];function piwikContentTable(piwik){return{restrict:'A',compile:function(element,attrs){element.addClass('card card-table entityTable');return function(scope,element,attrs){};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikDatePicker',piwikDatePicker);piwikDatePicker.$inject=['piwik','$timeout'];function piwikDatePicker(piwik,$timeout){var DEFAULT_STEP_MONTHS=1;return{restrict:'A',scope:{selectedDateStart:'<',selectedDateEnd:'<',highlightedDateStart:'<',highlightedDateEnd:'<',viewDate:'<',stepMonths:'<',disableMonthDropdown:'<',options:'<',cellHover:'&',cellHoverLeave:'&',dateSelect:'&'},template:'',link:function(scope,element){scope.$onChanges=$onChanges;var customOptions=scope.options||{};var datePickerOptions=$.extend({},piwik.getBaseDatePickerOptions(),customOptions,{onChangeMonthYear:function(){setTimeout(function(){onJqueryUiRenderedPicker();});}});element.datepicker(datePickerOptions);element.on('mouseover','tbody td a',function(event){if(event.originalEvent){setDatePickerCellColors();}});element.on('mouseenter','tbody td',function(){if(!scope.cellHover){return;}
var monthYear=getMonthYearDisplayed();var $dateCell=$(this);var dateValue=getCellDate($dateCell,monthYear[0],monthYear[1]);scope.cellHover({date:dateValue,$cell:$dateCell});$timeout();});element.on('mouseout','tbody td a',function(){setDatePickerCellColors();});element.on('mouseleave','table',onCalendarHoverLeave).on('mouseenter','thead',onCalendarHoverLeave);element.on('click','tbody td.ui-datepicker-other-month',handleOtherMonthClick);element.on('click',function(e){e.preventDefault();var $target=$(e.target).closest('a');if(!$target.is('.ui-datepicker-next')&&!$target.is('.ui-datepicker-prev')){return;}
onCalendarViewChange();});element.on('click','td[data-month]',function(event){var $cell=$(event.target).closest('td');var month=parseInt($cell.attr('data-month'));var year=parseInt($cell.attr('data-year'));var day=parseInt($cell.children('a,span').text());onDateSelected(new Date(year,month,day));});init();function init(){var renderPostProcessed=stepMonthsChanged();viewDateChanged();enableDisableMonthDropdown();if(!renderPostProcessed){onJqueryUiRenderedPicker();}
setDatePickerCellColors();}
function onJqueryUiRenderedPicker(){element.find('td[data-event]').off('click');element.find('.ui-state-active').removeClass('ui-state-active');element.find('.ui-datepicker-current-day').removeClass('ui-datepicker-current-day');element.find('.ui-datepicker-prev,.ui-datepicker-next').attr('href','');}
function $onChanges(changesObj){var redraw=changesObj.selectedDateStart||changesObj.selectedDateEnd||changesObj.highlightedDateStart||changesObj.highlightedDateEnd;if(changesObj.viewDate&&viewDateChanged()){redraw=true;}
if(changesObj.stepMonths){stepMonthsChanged();}
if(changesObj.enableDisableMonthDropdown){enableDisableMonthDropdown();}
if(redraw){setDatePickerCellColors();}}
function viewDateChanged(){var date=scope.viewDate;if(!date){return;}
if(!(date instanceof Date)){try{date=$.datepicker.parseDate('yy-mm-dd',date);}catch(e){return;}}
var monthYear=getMonthYearDisplayed();if(monthYear[0]!==date.getMonth()||monthYear[1]!==date.getFullYear()){element.datepicker('setDate',date);return true;}
return false;}
function stepMonthsChanged(){var stepMonths=scope.stepMonths||DEFAULT_STEP_MONTHS;if(element.datepicker('option','stepMonths')===stepMonths){return false;}
var currentMonth=$('.ui-datepicker-month',element).val(),currentYear=$('.ui-datepicker-year',element).val();element.datepicker('option','stepMonths',stepMonths).datepicker('setDate',new Date(currentYear,currentMonth));onJqueryUiRenderedPicker();return true;}
function onDateSelected(date){if(!scope.dateSelect){return;}
scope.dateSelect({date:date});scope.$apply();}
function handleOtherMonthClick(){if(!$(this).hasClass('ui-state-hover')){return;}
var $row=$(this).parent(),$tbody=$row.parent();if($row.is(':first-child')){$tbody.find('a').first().click();}else{$tbody.find('a').last().click();}}
function onCalendarHoverLeave(){if(!scope.cellHoverLeave){return;}
scope.cellHoverLeave();$timeout();}
function onCalendarViewChange(){enableDisableMonthDropdown();setDatePickerCellColors();}
function setDatePickerCellColors(){var $calendarTable=element.find('.ui-datepicker-calendar');var monthYear=getMonthYearDisplayed();var $cells=$calendarTable.find('td');var $firstDateCell=$cells.first();var currentDate=getCellDate($firstDateCell,monthYear[0],monthYear[1]);$cells.each(function(){setDateCellColor($(this),currentDate);currentDate.setDate(currentDate.getDate()+1);});}
function getMonthYearDisplayed(){var $firstCellWithMonth=element.find('td[data-month]');var month=parseInt($firstCellWithMonth.attr('data-month'));var year=parseInt($firstCellWithMonth.attr('data-year'));return[month,year];}
function setDateCellColor($dateCell,dateValue){var $dateCellLink=$dateCell.children('a');if(scope.selectedDateStart&&scope.selectedDateEnd&&dateValue>=scope.selectedDateStart&&dateValue<=scope.selectedDateEnd){$dateCell.addClass('ui-datepicker-current-period');}else{$dateCell.removeClass('ui-datepicker-current-period');}
if(scope.highlightedDateStart&&scope.highlightedDateEnd&&dateValue>=scope.highlightedDateStart&&dateValue<=scope.highlightedDateEnd){var elementToAddClassTo=$dateCellLink.length?$dateCellLink:$dateCell;elementToAddClassTo.addClass('ui-state-hover');}else{$dateCell.removeClass('ui-state-hover');$dateCellLink.removeClass('ui-state-hover');}}
function getCellDate($dateCell,month,year){if($dateCell.hasClass('ui-datepicker-other-month')){return getOtherMonthDate($dateCell,month,year);}
var day=parseInt($dateCell.children('a,span').text());return new Date(year,month,day);}
function getOtherMonthDate($dateCell,month,year){var date;var $row=$dateCell.parent();var $rowCells=$row.children('td');if($row.is(':first-child')){var $firstDateInMonth=$row.children('td:not(.ui-datepicker-other-month)').first();date=getCellDate($firstDateInMonth,month,year);date.setDate($rowCells.index($dateCell)-$rowCells.index($firstDateInMonth)+1);return date;}
var $lastDateInMonth=$row.children('td:not(.ui-datepicker-other-month)').last();date=getCellDate($lastDateInMonth,month,year);date.setDate(date.getDate()+$rowCells.index($dateCell)-$rowCells.index($lastDateInMonth));return date;}
function enableDisableMonthDropdown(){element.find('.ui-datepicker-month').attr('disabled',scope.disableMonthDropdown);}}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').component('piwikDateRangePicker',{templateUrl:'plugins/CoreHome/angularjs/date-range-picker/date-range-picker.component.html?cb='+piwik.cacheBuster,bindings:{startDate:'<',endDate:'<',rangeChange:'&',submit:'&'},controller:DateRangePickerController});DateRangePickerController.$inject=['piwikPeriods'];function DateRangePickerController(piwikPeriods){var vm=this;vm.fromPickerSelectedDates=null;vm.toPickerSelectedDates=null;vm.fromPickerHighlightedDates=null;vm.toPickerHighlightedDates=null;vm.startDateInvalid=false;vm.endDateInvalid=false;vm.$onChanges=$onChanges;vm.setStartRangeDate=setStartRangeDate;vm.setEndRangeDate=setEndRangeDate;vm.onRangeInputChanged=onRangeInputChanged;vm.getNewHighlightedDates=getNewHighlightedDates;vm.handleEnterPress=handleEnterPress;function $onChanges(changes){if(changes.startDate){setStartRangeDateFromStr(vm.startDate);}
if(changes.endDate){setEndRangeDateFromStr(vm.endDate);}}
function onRangeInputChanged(source){if(source==='from'){setStartRangeDateFromStr(vm.startDate);}else{setEndRangeDateFromStr(vm.endDate);}}
function setStartRangeDateFromStr(dateStr){vm.startDateInvalid=true;var startDateParsed;try{startDateParsed=$.datepicker.parseDate('yy-mm-dd',dateStr);}catch(e){}
if(startDateParsed){vm.fromPickerSelectedDates=[startDateParsed,startDateParsed];vm.startDateInvalid=false;}
rangeChanged();}
function setEndRangeDateFromStr(dateStr){vm.endDateInvalid=true;var endDateParsed;try{endDateParsed=$.datepicker.parseDate('yy-mm-dd',dateStr);}catch(e){}
if(endDateParsed){vm.toPickerSelectedDates=[endDateParsed,endDateParsed];vm.endDateInvalid=false;}
rangeChanged();}
function handleEnterPress($event){if($event.keyCode!==13||!vm.submit){return;}
vm.submit({start:vm.startDate,end:vm.endDate});}
function setStartRangeDate(date){vm.startDateInvalid=false;vm.startDate=piwikPeriods.format(date);vm.fromPickerSelectedDates=[date,date];rangeChanged();}
function setEndRangeDate(date){vm.endDateInvalid=false;vm.endDate=piwikPeriods.format(date);vm.toPickerSelectedDates=[date,date];rangeChanged();}
function rangeChanged(){if(!vm.rangeChange){return;}
vm.rangeChange({start:vm.startDateInvalid?null:vm.startDate,end:vm.endDateInvalid?null:vm.endDate});}
function getNewHighlightedDates(date,$cell){if($cell.hasClass('ui-datepicker-unselectable')){return null;}
return[date,date];}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').component('piwikPeriodDatePicker',{templateUrl:'plugins/CoreHome/angularjs/period-date-picker/period-date-picker.component.html?cb='+piwik.cacheBuster,bindings:{period:'<',date:'<',select:'&'},controller:PeriodDatePickerController});PeriodDatePickerController.$inject=['piwikPeriods','piwik'];function PeriodDatePickerController(piwikPeriods,piwik){var piwikMinDate=new Date(piwik.minDateYear,piwik.minDateMonth-1,piwik.minDateDay),piwikMaxDate=new Date(piwik.maxDateYear,piwik.maxDateMonth-1,piwik.maxDateDay);var vm=this;vm.selectedDates=[null,null];vm.highlightedDates=[null,null];vm.viewDate=null;vm.onHoverNormalCell=onHoverNormalCell;vm.onHoverLeaveNormalCells=onHoverLeaveNormalCells;vm.onDateSelected=onDateSelected;vm.$onChanges=$onChanges;vm.$onInit=$onInit;function onHoverNormalCell(cellDate,$cell){var isOutOfMinMaxDateRange=cellDate<piwikMinDate||cellDate>piwikMaxDate;var shouldNotHighlightFromWhitespace=$cell.hasClass('ui-datepicker-other-month')&&(vm.period==='month'||vm.period==='day');if(isOutOfMinMaxDateRange||shouldNotHighlightFromWhitespace){vm.highlightedDates=[null,null];return;}
vm.highlightedDates=getBoundedDateRange(cellDate);}
function onHoverLeaveNormalCells(){vm.highlightedDates=[null,null];}
function $onInit(){vm.viewDate=vm.date;}
function $onChanges(){if(!vm.period||!vm.date){vm.selectedDates=[null,null];return;}
vm.selectedDates=getBoundedDateRange(vm.date);}
function onDateSelected(date){if(!vm.select){return;}
vm.select({date:date});}
function getBoundedDateRange(date){var periodClass=piwikPeriods.get(vm.period);var dates=(new periodClass(date)).getDateRange();dates[0]=piwikMinDate<dates[0]?dates[0]:piwikMinDate;dates[1]=piwikMaxDate>dates[1]?dates[1]:piwikMaxDate;return dates;}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikPeriodSelector',piwikPeriodSelector);piwikPeriodSelector.$inject=['piwik','$rootScope'];function piwikPeriodSelector(piwik,$rootScope){return{restrict:'A',scope:{periods:'<'},templateUrl:'plugins/CoreHome/angularjs/period-selector/period-selector.directive.html?cb='+piwik.cacheBuster,controller:'PeriodSelectorController',controllerAs:'periodSelector',bindToController:true,link:function(scope,element){scope.periodSelector.closePeriodSelector=closePeriodSelector;scope.$on('$locationChangeSuccess',scope.periodSelector.updateSelectedValuesFromHash);$rootScope.$on('hidePeriodSelector',function(){element.hide();});$rootScope.$on('piwikPageChange',function(){element.show();});function closePeriodSelector(){element.find('.periodSelector').removeClass('expanded');}}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('PeriodSelectorController',PeriodSelectorController);PeriodSelectorController.$inject=['piwik','$location','piwikPeriods','piwikComparisonsService','$rootScope','piwikUrl','$element','$timeout'];function PeriodSelectorController(piwik,$location,piwikPeriods,piwikComparisonsService,$rootScope,piwikUrl,$element,$timeout){var piwikMinDate=new Date(piwik.minDateYear,piwik.minDateMonth-1,piwik.minDateDay),piwikMaxDate=new Date(piwik.maxDateYear,piwik.maxDateMonth-1,piwik.maxDateDay);var vm=this;vm.periodValue=null;vm.dateValue=null;vm.selectedPeriod=null;vm.startRangeDate=null;vm.endRangeDate=null;vm.isRangeValid=null;vm.isLoadingNewPage=false;vm.isComparing=false;vm.comparePeriodType='previousPeriod';vm.compareStartDate='';vm.compareEndDate='';vm.getCurrentlyViewingText=getCurrentlyViewingText;vm.changeViewedPeriod=changeViewedPeriod;vm.setPiwikPeriodAndDate=setPiwikPeriodAndDate;vm.onApplyClicked=onApplyClicked;vm.updateSelectedValuesFromHash=updateSelectedValuesFromHash;vm.getPeriodDisplayText=getPeriodDisplayText;vm.$onChanges=$onChanges;vm.onRangeChange=onRangeChange;vm.isApplyEnabled=isApplyEnabled;vm.$onInit=init;vm.isComparisonEnabled=isComparisonEnabled;$rootScope.$on('$locationChangeSuccess',setIsComparing);function init(){vm.updateSelectedValuesFromHash();setIsComparing();initTopControls();handleZIndexPositionRelativeCompareDropdownIssue();}
function handleZIndexPositionRelativeCompareDropdownIssue(){$element.on('focus','#comparePeriodToDropdown .select-dropdown',function(){$element.addClass('compare-dropdown-open');}).on('blur','#comparePeriodToDropdown .select-dropdown',function(){$element.removeClass('compare-dropdown-open');});}
function setIsComparing(){vm.isComparing=piwikComparisonsService.isComparingPeriods();}
function $onChanges(changesObj){if(changesObj.periods){removeUnrecognizedPeriods();}}
function onRangeChange(start,end){if(!start||!end){vm.isRangeValid=false;return;}
vm.isRangeValid=true;vm.startRangeDate=start;vm.endRangeDate=end;}
function isApplyEnabled(){if(vm.selectedPeriod==='range'&&!vm.isRangeValid){return false;}
if(vm.isComparing&&vm.comparePeriodType==='custom'&&!isCompareRangeValid()){return false;}
return true;}
function isCompareRangeValid(){try{piwikPeriods.parseDate(vm.compareStartDate);}catch(e){return false;}
try{piwikPeriods.parseDate(vm.compareEndDate);}catch(e){return false;}
return true;}
function removeUnrecognizedPeriods(){vm.periods=vm.periods.filter(function(periodLabel){return piwikPeriods.isRecognizedPeriod(periodLabel);});}
function updateSelectedValuesFromHash(){var strDate=piwikUrl.getSearchParam('date');var strPeriod=piwikUrl.getSearchParam('period');vm.periodValue=strPeriod;vm.selectedPeriod=strPeriod;vm.dateValue=vm.startRangeDate=vm.endRangeDate=null;if(strPeriod==='range'){var period=piwikPeriods.get(strPeriod).parse(strDate);vm.dateValue=period.startDate;vm.startRangeDate=formatDate(period.startDate);vm.endRangeDate=formatDate(period.endDate);}else{vm.dateValue=piwikPeriods.parseDate(strDate);setRangeStartEndFromPeriod(strPeriod,strDate);}}
function getPeriodDisplayText(periodLabel){return piwikPeriods.get(periodLabel).getDisplayText();}
function getCurrentlyViewingText(){var date;if(vm.periodValue==='range'){date=vm.startRangeDate+','+vm.endRangeDate;}else{date=formatDate(vm.dateValue);}
try{return piwikPeriods.parse(vm.periodValue,date).getPrettyString();}catch(e){return _pk_translate('General_Error');}}
function changeViewedPeriod(period){if(period===vm.periodValue){return;}
if(period==='range'){return;}
setPiwikPeriodAndDate(period,vm.dateValue);}
function onApplyClicked(){if(vm.selectedPeriod==='range'){var dateString=getSelectedDateString();if(!dateString){return;}
vm.periodValue='range';propagateNewUrlParams(dateString,'range');return;}
setPiwikPeriodAndDate(vm.selectedPeriod,vm.dateValue);}
function getSelectedDateString(){if(vm.selectedPeriod==='range'){var dateFrom=vm.startRangeDate,dateTo=vm.endRangeDate,oDateFrom=piwikPeriods.parseDate(dateFrom),oDateTo=piwikPeriods.parseDate(dateTo);if(!isValidDate(oDateFrom)||!isValidDate(oDateTo)||oDateFrom>oDateTo){$('#alert').find('h2').text(_pk_translate('General_InvalidDateRange'));piwik.helper.modalConfirm('#alert',{});return null;}
return dateFrom+','+dateTo;}else{return formatDate(vm.dateValue);}}
function setPiwikPeriodAndDate(period,date){vm.periodValue=period;vm.selectedPeriod=period;vm.dateValue=date;var currentDateString=formatDate(date);setRangeStartEndFromPeriod(period,currentDateString);propagateNewUrlParams(currentDateString,vm.selectedPeriod);initTopControls();}
function setRangeStartEndFromPeriod(period,dateStr){var dateRange=piwikPeriods.parse(period,dateStr).getDateRange();vm.startRangeDate=formatDate(dateRange[0]<piwikMinDate?piwikMinDate:dateRange[0]);vm.endRangeDate=formatDate(dateRange[1]>piwikMaxDate?piwikMaxDate:dateRange[1]);}
function getSelectedComparisonParams(){var previousDate;if(!vm.isComparing){return{};}
if(vm.comparePeriodType==='custom'){return{comparePeriods:['range'],compareDates:[vm.compareStartDate+','+vm.compareEndDate],};}else if(vm.comparePeriodType==='previousPeriod'){previousDate=getPreviousPeriodDateToSelectedPeriod();return{comparePeriods:[vm.selectedPeriod],compareDates:[previousDate],};}else if(vm.comparePeriodType==='previousYear'){var dateStr=vm.selectedPeriod==='range'?(vm.startRangeDate+','+vm.endRangeDate):vm.dateValue;var currentDateRange=piwikPeriods.parse(vm.selectedPeriod,dateStr).getDateRange();currentDateRange[0].setFullYear(currentDateRange[0].getFullYear()-1);currentDateRange[1].setFullYear(currentDateRange[1].getFullYear()-1);return{comparePeriods:['range'],compareDates:[piwikPeriods.format(currentDateRange[0])+','+piwikPeriods.format(currentDateRange[1])],};}else{console.warn("Unknown compare period type: "+vm.comparePeriodType);return{};}}
function getPreviousPeriodDateToSelectedPeriod(){if(vm.selectedPeriod==='range'){var currentStartRange=piwikPeriods.parseDate(vm.startRangeDate);var currentEndRange=piwikPeriods.parseDate(vm.endRangeDate);var newEndDate=piwikPeriods.RangePeriod.getLastNRange('day',2,currentStartRange).startDate;var rangeSize=Math.floor((currentEndRange-currentStartRange)/ 86400000);var newRange=piwikPeriods.RangePeriod.getLastNRange('day',1+rangeSize,newEndDate);return piwikPeriods.format(newRange.startDate)+','+piwikPeriods.format(newRange.endDate);}
var newStartDate=piwikPeriods.RangePeriod.getLastNRange(vm.selectedPeriod,2,vm.dateValue).startDate;return piwikPeriods.format(newStartDate);}
function propagateNewUrlParams(date,period){var compareParams=getSelectedComparisonParams();if(piwik.helper.isAngularRenderingThePage()){vm.closePeriodSelector();var $search=$location.search();var isCurrentlyComparing=piwikUrl.getSearchParam('compareSegments')||piwikUrl.getSearchParam('comparePeriods');if(date!==$search.date||period!==$search.period||vm.isComparing||isCurrentlyComparing){$search.date=date;$search.period=period;$search.compareSegments=piwikUrl.getSearchParam('compareSegments')||[];$.extend($search,compareParams);delete $search['compareSegments[]'];delete $search['comparePeriods[]'];delete $search['compareDates[]'];$location.search($.param($search));}
return;}
vm.isLoadingNewPage=true;var url=$.param($.extend({date:date,period:period},compareParams));broadcast.propagateNewPage(url);}
function isValidDate(d){if(Object.prototype.toString.call(d)!=="[object Date]"){return false;}
return!isNaN(d.getTime());}
function formatDate(date){return piwikPeriods.format(date);}
function isComparisonEnabled(){return piwikComparisonsService.isComparisonEnabled();}}})();
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('matomoMultiPairField',matomoMultiPairField);matomoMultiPairField.$inject=['$document','piwik','$filter'];function matomoMultiPairField($document,piwik,$filter){return{restrict:'A',scope:{field1:'=',field2:'='},require:"?ngModel",templateUrl:'plugins/CoreHome/angularjs/multipairfield/multipairfield.directive.html?cb='+piwik.cacheBuster,controller:'MultiPairFieldController',controllerAs:'multiPairField',compile:function(element,attrs){return function(scope,element,attrs,ngModel){if(ngModel){ngModel.$setViewValue(scope.formValue);}
scope.$watch('formValue',function(newValue,oldValue){if(newValue!=oldValue){element.trigger('change',newValue);}},true);if(ngModel){ngModel.$render=function(){if(angular.isString(ngModel.$viewValue)){scope.formValue=JSON.parse(ngModel.$viewValue);}else{scope.formValue=ngModel.$viewValue;}};}
scope.$watch('formValue',function(newValue,oldValue){if(ngModel){ngModel.$setViewValue(newValue);}},true);};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('MultiPairFieldController',MultiPairFieldController);MultiPairFieldController.$inject=['$scope'];function MultiPairFieldController($scope){function getTemplate(field){var control=field.uiControl;if(control==='password'||control==='url'||control==='search'||control==='email'){control='text';}
var file='field-'+control;var fieldsSupportingArrays=['textarea','checkbox','text'];if(field.type==='array'&&fieldsSupportingArrays.indexOf(control)!==-1){file+='-array';}
return'plugins/CorePluginsAdmin/angularjs/form-field/'+file+'.html?cb='+piwik.cacheBuster;}
if($scope.field1&&!$scope.field1.templateFile){$scope.field1.templateFile=getTemplate($scope.field1);}
if($scope.field2&&!$scope.field2.templateFile){$scope.field2.templateFile=getTemplate($scope.field2);}
var self=this;$scope.$watch('formValue',function(){if(!$scope.formValue||!$scope.formValue.length){self.addEntry();}else{self.onEntryChange();}},true);this.onEntryChange=function(){var hasAny=true;angular.forEach($scope.formValue,function(table){if(!table){hasAny=false;return;}
if($scope.field1&&$scope.field2){if(!table[$scope.field1.key]&&!table[$scope.field2.key]){hasAny=false;}}else if($scope.field1){if(!table[$scope.field1.key]){hasAny=false;}}else if($scope.field2){if(!table[$scope.field2.key]){hasAny=false;}}});if(hasAny){this.addEntry();}};this.addEntry=function(){if(angular.isArray($scope.formValue)){var obj={};if($scope.field1&&$scope.field1.key){obj[$scope.field1.key]='';}
if($scope.field2&&$scope.field2.key){obj[$scope.field2.key]='';}
$scope.formValue.push(obj);}};this.removeEntry=function(index){if(index>-1){$scope.formValue.splice(index,1);}};if(!$scope.formValue||!$scope.formValue.length){this.addEntry();}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikDropdownMenu',piwikDropdownMenu);piwikDropdownMenu.$inject=['$timeout'];function piwikDropdownMenu($timeout){return{restrict:'A',link:function(scope,element,attrs){var options={};var isSubmenu=!!element.parent().closest('.dropdown-content').length;if(isSubmenu){options={hover:true};element.addClass('submenu');angular.element('#'+attrs.activates).addClass('submenu-dropdown-content');element.parents('.dropdown-content').addClass('submenu-container');}
$timeout(function(){element.dropdown(options);});}};}})();
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('matomoFieldArray',matomoFieldArray);matomoFieldArray.$inject=['$document','piwik','$filter'];function matomoFieldArray($document,piwik,$filter){return{restrict:'A',scope:{field:'='},require:"?ngModel",templateUrl:'plugins/CoreHome/angularjs/field-array/field-array.directive.html?cb='+piwik.cacheBuster,controller:'FieldArrayController',controllerAs:'fieldArray',compile:function(element,attrs){return function(scope,element,attrs,ngModel){if(ngModel){ngModel.$setViewValue(scope.formValue);}
scope.$watch('formValue',function(newValue,oldValue){if(newValue!=oldValue){element.trigger('change',newValue);}},true);if(ngModel){ngModel.$render=function(){if(angular.isString(ngModel.$viewValue)){scope.formValue=JSON.parse(ngModel.$viewValue);}else{scope.formValue=ngModel.$viewValue;}};}
scope.$watch('formValue',function(newValue,oldValue){if(ngModel){ngModel.$setViewValue(newValue);}},true);};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('FieldArrayController',FieldArrayController);FieldArrayController.$inject=['$scope'];function FieldArrayController($scope){function getTemplate(field){var control=field.uiControl;if(control==='password'||control==='url'||control==='search'||control==='email'){control='text';}
var file='field-'+control;var fieldsSupportingArrays=['textarea','checkbox','text'];if(field.type==='array'&&fieldsSupportingArrays.indexOf(control)!==-1){file+='-array';}
return'plugins/CorePluginsAdmin/angularjs/form-field/'+file+'.html?cb='+piwik.cacheBuster;}
if($scope.field&&!$scope.field.templateFile){$scope.field.templateFile=getTemplate($scope.field);}
var self=this;$scope.$watch('formValue',function(){if(!$scope.formValue||!$scope.formValue.length){self.addEntry();}else{self.onEntryChange();}},true);this.onEntryChange=function(){var hasAny=true;angular.forEach($scope.formValue,function(entry){if(!entry){hasAny=false;}});if(hasAny){this.addEntry();}};this.addEntry=function(){if(angular.isArray($scope.formValue)){$scope.formValue.push('');}};this.removeEntry=function(index){if(index>-1){$scope.formValue.splice(index,1);}};if(!$scope.formValue||!$scope.formValue.length){this.addEntry();}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.service').factory('piwikComparisonsService',ComparisonFactory);ComparisonFactory.$inject=['$location','$rootScope','piwikPeriods','piwikApi','piwikUrl'];function ComparisonFactory($location,$rootScope,piwikPeriods,piwikApi,piwikUrl){var segmentComparisons=[];var periodComparisons=[];var comparisonsDisabledFor=[];var isEnabled=null;var SERIES_COLOR_COUNT=8;var SERIES_SHADE_COUNT=3;var colors=getAllSeriesColors();$rootScope.$on('$locationChangeSuccess',updateComparisonsFromQueryParams);$rootScope.$on('piwikSegmentationInited',updateComparisonsFromQueryParams);if(!piwikHelper.isAngularRenderingThePage()){updateComparisonsFromQueryParams();}
loadComparisonsDisabledFor();return{getComparisons:getComparisons,removeSegmentComparison:removeSegmentComparison,addSegmentComparison:addSegmentComparison,isComparisonEnabled:isComparisonEnabled,getSegmentComparisons:getSegmentComparisons,getPeriodComparisons:getPeriodComparisons,getSeriesColor:getSeriesColor,getAllComparisonSeries:getAllComparisonSeries,isComparing:isComparing,isComparingPeriods:isComparingPeriods,getIndividualComparisonRowIndices:getIndividualComparisonRowIndices,getComparisonSeriesIndex:getComparisonSeriesIndex,getSeriesColorName:getSeriesColorName};function getComparisons(){return getSegmentComparisons().concat(getPeriodComparisons());}
function isComparing(){return isComparisonEnabled()&&(segmentComparisons.length>1||periodComparisons.length>1);}
function isComparingPeriods(){return getPeriodComparisons().length>1;}
function getSegmentComparisons(){if(!isComparisonEnabled()){return[];}
return segmentComparisons;}
function getPeriodComparisons(){if(!isComparisonEnabled()){return[];}
return periodComparisons;}
function getSeriesColor(segmentComparison,periodComparison,metricIndex){metricIndex=metricIndex||0;var seriesIndex=getComparisonSeriesIndex(periodComparison.index,segmentComparison.index)%SERIES_COLOR_COUNT;if(metricIndex===0){return colors['series'+seriesIndex];}else{var shadeIndex=metricIndex%SERIES_SHADE_COUNT;return colors['series'+seriesIndex+'-shade'+shadeIndex];}}
function getSeriesColorName(seriesIndex,metricIndex){var colorName='series'+(seriesIndex%SERIES_COLOR_COUNT);if(metricIndex>0){colorName+='-shade'+(metricIndex%SERIES_SHADE_COUNT);}
return colorName;}
function isComparisonEnabled(){return isEnabled;}
function getIndividualComparisonRowIndices(seriesIndex){var segmentCount=getSegmentComparisons().length;var segmentIndex=seriesIndex%segmentCount;var periodIndex=Math.floor(seriesIndex / segmentCount);return{segmentIndex:segmentIndex,periodIndex:periodIndex,};}
function getComparisonSeriesIndex(periodIndex,segmentIndex){var segmentCount=getSegmentComparisons().length;return periodIndex*segmentCount+segmentIndex;}
function getAllComparisonSeries(){var seriesInfo=[];var seriesIndex=0;getPeriodComparisons().forEach(function(periodComp){getSegmentComparisons().forEach(function(segmentComp){seriesInfo.push({index:seriesIndex,params:$.extend({},segmentComp.params,periodComp.params),color:colors['series'+seriesIndex],});++seriesIndex;});});return seriesInfo;}
function removeSegmentComparison(index){if(!isComparisonEnabled()){throw new Error('Comparison disabled.');}
var newComparisons=[].concat(segmentComparisons);newComparisons.splice(index,1);var extraParams={};if(index===0){extraParams.segment=newComparisons[0].params.segment;}
updateQueryParamsFromComparisons(newComparisons,periodComparisons,extraParams);}
function addSegmentComparison(params){if(!isComparisonEnabled()){throw new Error('Comparison disabled.');}
var newComparisons=segmentComparisons.concat([{params:params}]);updateQueryParamsFromComparisons(newComparisons,periodComparisons);}
function updateQueryParamsFromComparisons(segmentComparisons,periodComparisons,extraParams){extraParams=extraParams||{};var compareSegments={};var comparePeriodDatePairs={};var firstSegment=false;var firstPeriod=false;segmentComparisons.forEach(function(comparison){if(firstSegment){compareSegments[comparison.params.segment]=true;}else{firstSegment=true;}});periodComparisons.forEach(function(comparison){if(firstPeriod){comparePeriodDatePairs[comparison.params.period+'|'+comparison.params.date]=true;}else{firstPeriod=true;}});var comparePeriods=[];var compareDates=[];Object.keys(comparePeriodDatePairs).forEach(function(pair){var parts=pair.split('|');comparePeriods.push(parts[0]);compareDates.push(parts[1]);});var compareParams={compareSegments:Object.keys(compareSegments),comparePeriods:comparePeriods,compareDates:compareDates,};if(piwik.helper.isAngularRenderingThePage()){var search=$location.search();var newSearch=$.extend({},search,compareParams,extraParams);delete newSearch['compareSegments[]'];delete newSearch['comparePeriods[]'];delete newSearch['compareDates[]'];if(JSON.stringify(newSearch)!==JSON.stringify(search)){$location.search($.param(newSearch));}
return;}
var paramsToRemove=[];['compareSegments','comparePeriods','compareDates'].forEach(function(name){if(!compareParams[name].length){paramsToRemove.push(name);}});var url=$.param($.extend({},extraParams));var strHash=$.param($.extend({},compareParams));broadcast.propagateNewPage(url,undefined,strHash,paramsToRemove);}
function updateComparisonsFromQueryParams(){var title;var availableSegments=[];try{availableSegments=$('.segmentEditorPanel').data('uiControlObject').impl.availableSegments||[];}catch(e){}
var compareSegments=piwikUrl.getSearchParam('compareSegments')||[];compareSegments=compareSegments instanceof Array?compareSegments:[compareSegments];var comparePeriods=piwikUrl.getSearchParam('comparePeriods')||[];comparePeriods=comparePeriods instanceof Array?comparePeriods:[comparePeriods];var compareDates=piwikUrl.getSearchParam('compareDates')||[];compareDates=compareDates instanceof Array?compareDates:[compareDates];compareSegments.unshift(piwikUrl.getSearchParam('segment'));comparePeriods.unshift(piwikUrl.getSearchParam('period'));compareDates.unshift(piwikUrl.getSearchParam('date'));var newSegmentComparisons=[];compareSegments.forEach(function(segment,idx){var storedSegment=null;availableSegments.forEach(function(s){if(s.definition===segment||s.definition===decodeURIComponent(segment)||decodeURIComponent(s.definition)===segment){storedSegment=s;}});var segmentTitle=storedSegment?storedSegment.name:_pk_translate('General_Unknown');if(segment.trim()===''){segmentTitle=_pk_translate('SegmentEditor_DefaultAllVisits');}
newSegmentComparisons.push({params:{segment:segment},title:piwikHelper.htmlDecode(segmentTitle),index:idx});});var newPeriodComparisons=[];for(var i=0;i<Math.min(compareDates.length,comparePeriods.length);++i){try{title=piwikPeriods.parse(comparePeriods[i],compareDates[i]).getPrettyString();}catch(e){title=_pk_translate('General_Error');}
newPeriodComparisons.push({params:{date:compareDates[i],period:comparePeriods[i]},title:title,index:i});}
checkEnabledForCurrentPage();setComparisons(newSegmentComparisons,newPeriodComparisons);}
function setComparisons(newSegmentComparisons,newPeriodComparisons){var oldSegmentComparisons=segmentComparisons;var oldPeriodComparisons=periodComparisons;segmentComparisons=newSegmentComparisons;Object.freeze(segmentComparisons);periodComparisons=newPeriodComparisons;Object.freeze(periodComparisons);if(JSON.stringify(oldPeriodComparisons)!==JSON.stringify(periodComparisons)||JSON.stringify(oldSegmentComparisons)!==JSON.stringify(segmentComparisons)){$rootScope.$emit('piwikComparisonsChanged');}}
function checkEnabledForCurrentPage(){var category=piwikUrl.getSearchParam('category')||piwikUrl.getSearchParam('module');var subcategory=piwikUrl.getSearchParam('subcategory')||piwikUrl.getSearchParam('action');var id=category+"."+subcategory;isEnabled=comparisonsDisabledFor.indexOf(id)===-1&&comparisonsDisabledFor.indexOf(category+".*")===-1;$('html').toggleClass('comparisonsDisabled',!isEnabled);}
function loadComparisonsDisabledFor(){piwikApi.fetch({module:'API',method:'API.getPagesComparisonsDisabledFor',}).then(function(result){comparisonsDisabledFor=result;checkEnabledForCurrentPage();});}
function getAllSeriesColors(){var colorManager=piwik.ColorManager,seriesColorNames=[];for(var i=0;i<SERIES_COLOR_COUNT;++i){seriesColorNames.push('series'+i);for(var j=0;j<SERIES_SHADE_COUNT;++j){seriesColorNames.push('series'+i+'-shade'+j);}}
return colorManager.getColors('comparison-series-color',seriesColorNames);}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').component('piwikComparisons',{templateUrl:'plugins/CoreHome/angularjs/comparisons/comparisons.component.html?cb='+piwik.cacheBuster,bindings:{},controller:ComparisonsController});ComparisonsController.$inject=['piwikComparisonsService','$rootScope','piwikApi','$element','piwikUrl'];function ComparisonsController(comparisonsService,$rootScope,piwikApi,$element,piwikUrl){var vm=this;var comparisonTooltips=null;vm.comparisonsService=comparisonsService;vm.$onInit=$onInit;vm.$onDestroy=$onDestroy;vm.comparisonHasSegment=comparisonHasSegment;vm.getComparisonPeriodType=getComparisonPeriodType;vm.getComparisonTooltip=getComparisonTooltip;function $onInit(){$rootScope.$on('piwikComparisonsChanged',onComparisonsChanged);onComparisonsChanged();setUpTooltips();}
function $onDestroy(){try{$element.tooltip('destroy');}catch(e){}}
function setUpTooltips(){$element.tooltip({track:true,content:function(){var title=$(this).attr('title');return piwikHelper.escape(title.replace(/\n/g,'<br />'));},show:{delay:200,duration:200},hide:false});}
function comparisonHasSegment(comparison){return typeof comparison.params.segment!=='undefined';}
function getComparisonPeriodType(comparison){var period=comparison.params.period;if(period==='range'){return _pk_translate('CoreHome_PeriodRange');}
var periodStr=_pk_translate('Intl_Period'+period.substring(0,1).toUpperCase()+period.substring(1));return periodStr.substring(0,1).toUpperCase()+periodStr.substring(1);}
function getComparisonTooltip(segmentComparison,periodComparison){if(!comparisonTooltips||!Object.keys(comparisonTooltips).length){return undefined;}
return comparisonTooltips[periodComparison.index][segmentComparison.index];}
function onComparisonsChanged(){comparisonTooltips=null;if(!vm.comparisonsService.isComparing()){return;}
var periodComparisons=comparisonsService.getPeriodComparisons();var segmentComparisons=comparisonsService.getSegmentComparisons();piwikApi.fetch({method:'API.getProcessedReport',apiModule:'VisitsSummary',apiAction:'get',compare:'1',compareSegments:piwikUrl.getSearchParam('compareSegments'),comparePeriods:piwikUrl.getSearchParam('comparePeriods'),compareDates:piwikUrl.getSearchParam('compareDates'),format_metrics:'1',}).then(function(report){comparisonTooltips={};periodComparisons.forEach(function(periodComp){comparisonTooltips[periodComp.index]={};segmentComparisons.forEach(function(segmentComp){comparisonTooltips[periodComp.index][segmentComp.index]=generateComparisonTooltip(report,periodComp,segmentComp);});});});}
function generateComparisonTooltip(visitsSummary,periodComp,segmentComp){if(!visitsSummary.reportData.comparisons){return'';}
var firstRowIndex=comparisonsService.getComparisonSeriesIndex(periodComp.index,0);var firstRow=visitsSummary.reportData.comparisons[firstRowIndex];var comparisonRowIndex=comparisonsService.getComparisonSeriesIndex(periodComp.index,segmentComp.index);var comparisonRow=visitsSummary.reportData.comparisons[comparisonRowIndex];var firstPeriodRow=visitsSummary.reportData.comparisons[segmentComp.index];var tooltip='<div class="comparison-card-tooltip">';var visitsPercent=((comparisonRow.nb_visits / firstRow.nb_visits)*100).toFixed(2)+'%';tooltip+=_pk_translate('General_ComparisonCardTooltip1',["'"+comparisonRow.compareSegmentPretty+"'",comparisonRow.comparePeriodPretty,visitsPercent,comparisonRow.nb_visits,firstRow.nb_visits]);if(periodComp.index>0){tooltip+='<br/><br/>';tooltip+=_pk_translate('General_ComparisonCardTooltip2',[comparisonRow.nb_visits_change,firstPeriodRow.compareSegmentPretty,firstPeriodRow.comparePeriodPretty]);}
tooltip+='</div>';return tooltip;}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('MailSmtpController',MailSmtpController);MailSmtpController.$inject=['$scope','piwikApi'];function MailSmtpController($scope,piwikApi){var self=this;this.isLoading=false;this.passwordChanged=false;this.save=function(){this.isLoading=true;var mailSettings={mailUseSmtp:this.enabled?'1':'0',mailPort:this.mailPort,mailHost:this.mailHost,mailType:this.mailType,mailUsername:this.mailUsername,mailFromAddress:this.mailFromAddress,mailFromName:this.mailFromName,mailEncryption:this.mailEncryption};if(this.passwordChanged){mailSettings.mailPassword=this.mailPassword;}
piwikApi.withTokenInUrl();piwikApi.post({module:'CoreAdminHome',action:'setMailSettings'},mailSettings).then(function(success){self.isLoading=false;var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(_pk_translate('CoreAdminHome_SettingsSaveSuccess'),{id:'generalSettings',context:'success'});notification.scrollToNotification();},function(){self.isLoading=false;});};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('BrandingController',BrandingController);BrandingController.$inject=['$scope','piwikApi'];function BrandingController($scope,piwikApi){var self=this;this.isLoading=false;function refreshCustomLogo(){var selectors=['#currentLogo','#currentFavicon'];var index;for(index=0;index<selectors.length;index++){var imageDiv=$(selectors[index]);if(imageDiv&&imageDiv.data("src")&&imageDiv.data("srcExists")){var logoUrl=imageDiv.data("src");imageDiv.attr("src",logoUrl+"?"+(new Date()).getTime());imageDiv.show();}else{imageDiv.hide();}}}
this.updateLogo=function(){var isSubmittingLogo=(this.customLogo!=undefined&&this.customLogo!='');var isSubmittingFavicon=(this.customFavicon!=undefined&&this.customFavicon!='');if(!isSubmittingLogo&&!isSubmittingFavicon){return;}
var $uploadError=$('.uploaderror');$uploadError.fadeOut();var frameName="upload"+(new Date()).getTime();var uploadFrame=$("<iframe name=\""+frameName+"\" />");uploadFrame.css("display","none");uploadFrame.load(function(data){setTimeout(function(){var frameContent=$(uploadFrame.contents()).find('body').html();frameContent=$.trim(frameContent);if('0'===frameContent){$uploadError.show();}else{if(isSubmittingLogo){$('#currentLogo').data("srcExists",true);}
if(isSubmittingFavicon){$('#currentFavicon').data("srcExists",true);}
refreshCustomLogo();}
if('1'===frameContent||'0'===frameContent){uploadFrame.remove();}},1000);});$("body:first").append(uploadFrame);var submittingForm=$('#logoUploadForm');submittingForm.attr("target",frameName);submittingForm.submit();this.customLogo='';this.customFavicon='';};refreshCustomLogo();this.toggleCustomLogo=function(){refreshCustomLogo();};this.save=function(){this.isLoading=true;piwikApi.post({module:'API',method:'CoreAdminHome.setBrandingSettings'},{useCustomLogo:this.enabled?'1':'0'}).then(function(success){self.isLoading=false;var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(_pk_translate('CoreAdminHome_SettingsSaveSuccess'),{id:'generalSettings',context:'success'});notification.scrollToNotification();},function(){self.isLoading=false;});};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){function getCustomVariables(customVars){var result=[];angular.forEach(customVars,function(customVar){result.push([customVar.name,customVar.value]);});return result;}
function getHostNameFromUrl(url){var element=$('<a></a>')[0];element.href=url;return element.hostname;}
angular.module('piwikApp').controller('JsTrackingCodeController',JsTrackingCodeController);JsTrackingCodeController.$inject=['$scope','$filter','piwikApi'];function JsTrackingCodeController($scope,$filter,piwikApi){var translate=$filter('translate');this.showAdvanced=false;this.isLoading=false;this.customVars=[];this.siteUrls={};this.hasManySiteUrls=false;this.maxCustomVariables=parseInt(angular.element('[name=numMaxCustomVariables]').val(),10);this.canAddMoreCustomVariables=this.maxCustomVariables&&this.maxCustomVariables>0;var piwikHost=window.location.host,piwikPath=location.pathname.substring(0,location.pathname.lastIndexOf('/')),self=this;var getSiteData=function(idSite,sectionSelect,callback){if(self.siteUrls[idSite]){callback();return;}
self.isLoading=true;piwikApi.fetch({module:'API',method:'SitesManager.getSiteUrlsFromId',idSite:idSite,filter_limit:'-1'}).then(function(data){self.siteUrls[idSite]=data||[];self.isLoading=false;callback();});};var generateJsCodeAjax=null;var generateJsCode=function(trackingCodeChangedManually){var params={piwikUrl:piwikHost+piwikPath,groupPageTitlesByDomain:self.groupByDomain?1:0,mergeSubdomains:self.trackAllSubdomains?1:0,mergeAliasUrls:self.trackAllAliases?1:0,visitorCustomVariables:self.trackCustomVars?getCustomVariables(self.customVars):0,customCampaignNameQueryParam:null,customCampaignKeywordParam:null,doNotTrack:self.doNotTrack?1:0,disableCookies:self.disableCookies?1:0,crossDomain:self.crossDomain?1:0,trackNoScript:self.trackNoScript?1:0,forceMatomoEndpoint:1};if(self.useCustomCampaignParams){params.customCampaignNameQueryParam=self.customCampaignName;params.customCampaignKeywordParam=self.customCampaignKeyword;}
if(generateJsCodeAjax){generateJsCodeAjax.abort();}
generateJsCodeAjax=piwikApi.post({module:'API',format:'json',method:'SitesManager.getJavascriptTag',idSite:self.site.id},params).then(function(response){generateJsCodeAjax=null;self.trackingCode=response.value;if(trackingCodeChangedManually){var jsCodeTextarea=$('#javascript-text .codeblock');jsCodeTextarea.effect("highlight",{},1500);}});return generateJsCodeAjax;};this.onCrossDomainToggle=function(){if(this.crossDomain){this.trackAllAliases=true;}};this.addCustomVar=function(){if(this.canAddMoreCustomVariables){this.customVars.push({name:'',value:''});}
this.canAddMoreCustomVariables=this.maxCustomVariables>this.customVars.length;};this.addCustomVar();this.updateTrackingCode=function(){generateJsCode(true);};this.sendEmail=function(){var subjectLine=translate('SitesManager_EmailInstructionsSubject');var trackingCode=self.trackingCode;trackingCode=trackingCode.replace(/<[^>]+>/g,'');var bodyText=translate('SitesManager_JsTrackingTagHelp')+'. '
+translate('CoreAdminHome_JSTracking_CodeNoteBeforeClosingHeadEmail',"'head")
+"\n"+trackingCode;var linkText='mailto:?subject='+encodeURIComponent(subjectLine)+'&body='+encodeURIComponent(bodyText);window.location.href=linkText;};this.changeSite=function(trackingCodeChangedManually){getSiteData(this.site.id,'#js-code-options',function(){$('.current-site-name').text(self.site.name);self.hasManySiteUrls=self.siteUrls[self.site.id]&&self.siteUrls[self.site.id].length>1;if(!self.hasManySiteUrls){self.crossDomain=false;}
var siteHost=getHostNameFromUrl(self.siteUrls[self.site.id][0]);$('.current-site-host').text(siteHost);var defaultAliasUrl='x.'+siteHost;$('.current-site-alias').text(self.siteUrls[self.site.id][1]||defaultAliasUrl);generateJsCode(true);});};if(this.site&&this.site.id){this.changeSite(false);}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){var sitePromises={},goalPromises={};angular.module('piwikApp').controller('ImageTrackingCodeController',ImageTrackingCodeController);ImageTrackingCodeController.$inject=['piwikApi','$q'];function ImageTrackingCodeController(piwikApi,$q){this.allGoals={};this.isLoading=false;var piwikHost=window.location.host,piwikPath=location.pathname.substring(0,location.pathname.lastIndexOf('/')),self=this;var currencyPromise=piwikApi.fetch({method:'SitesManager.getCurrencySymbols',filter_limit:'-1'});function requestSiteData(idSite){if(!sitePromises[idSite]){sitePromises[idSite]=piwikApi.fetch({module:'API',method:'SitesManager.getSiteFromId',idSite:idSite});}
return sitePromises[idSite];}
function requestGoalData(idSite){if(!goalPromises[idSite]){goalPromises[idSite]=piwikApi.fetch({module:'API',method:'Goals.getGoals',filter_limit:'-1',idSite:idSite});}
return goalPromises[idSite];}
var generateImageTrackingAjax=null,generateImageTrackerLink=function(trackingCodeChangedManually){var postParams={piwikUrl:piwikHost+piwikPath,actionName:self.pageName,forceMatomoEndpoint:1};if(self.trackGoal&&self.trackIdGoal){postParams.idGoal=self.trackIdGoal;postParams.revenue=self.revenue;}
if(generateImageTrackingAjax){generateImageTrackingAjax.abort();}
generateImageTrackingAjax=piwikApi.post({module:'API',format:'json',method:'SitesManager.getImageTrackingCode',idSite:self.site.id},postParams).then(function(response){generateImageTrackingAjax=null;self.trackingCode=response.value;if(trackingCodeChangedManually){var jsCodeTextarea=$('#image-tracking-text .codeblock');jsCodeTextarea.effect("highlight",{},1500);}});};this.updateTrackingCode=function(){generateImageTrackerLink(true);};this.changeSite=function(changedManually){self.isLoading=true;var sitePromise=requestSiteData(this.site.id);var goalPromise=requestGoalData(this.site.id);return $q.all([currencyPromise,sitePromise,goalPromise]).then(function(data){self.isLoading=false;var currencySymbols=data[0]||{};var currency=data[1].currency||'';var goals=data[2]||[];var goalsList=[{key:'',value:_pk_translate('UserCountryMap_None')}];for(var key in goals){goalsList.push({key:goals[key].idgoal,value:goals[key].name});}
self.allGoals=goalsList;$('[name=image-revenue] .site-currency').text(currencySymbols[currency.toUpperCase()]);generateImageTrackerLink(changedManually);});};if(this.site&&this.site.id){this.changeSite(false);}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('ArchivingController',ArchivingController);ArchivingController.$inject=['$scope','piwikApi'];function ArchivingController($scope,piwikApi){var self=this;this.isLoading=false;this.save=function(){this.isLoading=true;var enableBrowserTriggerArchiving=$('input[name=enableBrowserTriggerArchiving]:checked').val();var todayArchiveTimeToLive=$('#todayArchiveTimeToLive').val();piwikApi.post({module:'API',method:'CoreAdminHome.setArchiveSettings'},{enableBrowserTriggerArchiving:enableBrowserTriggerArchiving,todayArchiveTimeToLive:todayArchiveTimeToLive}).then(function(success){self.isLoading=false;var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(_pk_translate('CoreAdminHome_SettingsSaveSuccess'),{id:'generalSettings',context:'success'});notification.scrollToNotification();},function(){self.isLoading=false;});};}})();
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('TrackingFailuresController',TrackingFailuresController);TrackingFailuresController.$inject=['piwikApi','piwik'];function TrackingFailuresController(piwikApi,piwik){var self=this;this.failures=[];this.sortColumn='idsite';this.sortReverse=false;this.isLoading=false;this.changeSortOrder=function(columnToSort){if(this.sortColumn===columnToSort){this.sortReverse=!this.sortReverse;}else{this.sortColumn=columnToSort;}};this.fetchAll=function(){this.failures=[];this.isLoading=true;piwikApi.fetch({method:'CoreAdminHome.getTrackingFailures',filter_limit:'-1'}).then(function(failures){self.failures=failures;self.isLoading=false;},function(){self.isLoading=false;});};this.deleteAll=function(){piwik.helper.modalConfirm('#confirmDeleteAllTrackingFailures',{yes:function(){self.failures=[];piwikApi.fetch({method:'CoreAdminHome.deleteAllTrackingFailures'}).then(function(){self.fetchAll();});}});};this.deleteFailure=function(idSite,idFailure){piwik.helper.modalConfirm('#confirmDeleteThisTrackingFailure',{yes:function(){self.failures=[];piwikApi.fetch({method:'CoreAdminHome.deleteTrackingFailure',idSite:idSite,idFailure:idFailure}).then(function(){self.fetchAll();});}});};this.fetchAll();}})();
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('matomoTrackingFailures',matomoTrackingFailures);matomoTrackingFailures.$inject=['piwik'];function matomoTrackingFailures(piwik){return{restrict:'A',templateUrl:'plugins/CoreAdminHome/angularjs/trackingfailures/trackingfailures.directive.html?cb='+piwik.cacheBuster,controller:'TrackingFailuresController',controllerAs:'trackingFailures'};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('PluginSettingsController',PluginSettingsController);PluginSettingsController.$inject=['$scope','piwikApi'];function PluginSettingsController($scope,piwikApi){var self=this;this.isLoading=true;this.isSaving={};var apiMethod='CorePluginsAdmin.getUserSettings';if($scope.mode==='admin'){apiMethod='CorePluginsAdmin.getSystemSettings';}
piwikApi.fetch({method:apiMethod}).then(function(settings){self.isLoading=false;self.settingsPerPlugin=settings;},function(){self.isLoading=false;});this.save=function(settings){var apiMethod='CorePluginsAdmin.setUserSettings';if($scope.mode==='admin'){apiMethod='CorePluginsAdmin.setSystemSettings';}
this.isSaving[settings.pluginName]=true;var values={};if(!values[settings.pluginName]){values[settings.pluginName]=[];}
angular.forEach(settings.settings,function(setting){var value=setting.value;if(value===false){value='0';}else if(value===true){value='1';}
values[settings.pluginName].push({name:setting.name,value:value});});piwikApi.post({method:apiMethod},{settingValues:values}).then(function(success){self.isSaving[settings.pluginName]=false;var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(_pk_translate('CoreAdminHome_PluginSettingsSaveSuccess'),{id:'generalSettings',context:'success'});notification.scrollToNotification();},function(){self.isSaving[settings.pluginName]=false;});};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikPluginSettings',piwikPluginSettings);piwikPluginSettings.$inject=['piwik'];function piwikPluginSettings(piwik){var defaults={mode:''};return{restrict:'A',scope:{mode:'@'},templateUrl:'plugins/CorePluginsAdmin/angularjs/plugin-settings/plugin-settings.directive.html?cb='+piwik.cacheBuster,controller:'PluginSettingsController',controllerAs:'pluginSettings',compile:function(element,attrs){for(var index in defaults){if(defaults.hasOwnProperty(index)&&attrs[index]===undefined){attrs[index]=defaults[index];}}
return function(scope,element,attrs){};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikForm',piwikForm);piwikForm.$inject=['piwik','$timeout'];function piwikForm(piwik,$timeout){return{restrict:'A',priority:'10',compile:function(element,attrs){return function(scope,element,attrs){$timeout(function(){element.find('input[type=text]').keypress(function(e){var key=e.keyCode||e.which;if(key==13){element.find('[piwik-save-button] input').triggerHandler('click');}});});};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikFormField',piwikFormField);piwikFormField.$inject=['piwik','$timeout'];function piwikFormField(piwik,$timeout){function initMaterialSelect($select,placeholder){$select.material_select();$select.closest('.select-wrapper').find('input.select-dropdown').focus(function(){$('.select-wrapper').css('z-index','');$(this).closest('.select-wrapper').css('z-index',999);}).blur(function(){var self=this;setTimeout(function(){$(self).closest('.select-wrapper').css('z-index','');},250);});if(placeholder){var $materialInput=$select.closest('.select-wrapper').find('input');$materialInput.attr('placeholder',placeholder);}}
function syncMultiCheckboxKeysWithFieldValue(field){angular.forEach(field.availableOptions,function(option,index){if(option&&field.value.indexOf(option.key)!==-1){field.checkboxkeys[index]=true;}else{field.checkboxkeys[index]=false;}});}
function hasUiControl(field,uiControlType){return field.uiControl===uiControlType;}
function isSelectControl(field){return hasUiControl(field,'select')||hasUiControl(field,'multiselect');}
function isArrayCheckboxControl(field){return field.type==='array'&&hasUiControl(field,'checkbox');}
function hasGroupedValues(availableValues){if(!angular.isObject(availableValues)||angular.isArray(availableValues)){return false;}
var key;for(key in availableValues){if(Object.prototype.hasOwnProperty.call(availableValues,key)){if(angular.isObject(availableValues[key])){return true;}else{return false;}}}
return false;}
function whenRendered(scope,element,inlineHelpNode){return function(){var field=scope.formField;if(inlineHelpNode){angular.element(inlineHelpNode).appendTo(element.find('.inline-help'));}
if(isSelectControl(field)){var $select=element.find('select');initMaterialSelect($select,field.uiControlAttributes.placeholder);scope.$watch('formField.value',function(val,oldVal){if(val!==oldVal){$timeout(function(){initMaterialSelect($select,field.uiControlAttributes.placeholder);});}});scope.$watch('formField.uiControlAttributes.disabled',function(val,oldVal){if(val!==oldVal){$timeout(function(){initMaterialSelect($select,field.uiControlAttributes.placeholder);});}});}else if(hasUiControl(field,'textarea')){element.find('textarea').trigger('autoresize');scope.$watch('formField.value',function(val,oldVal){if(val!==oldVal){$timeout(function(){element.find('textarea').trigger('autoresize');});}});}else if(hasUiControl(field,'file')){var $file=element.find('[type=file]');$file.on('change',function(){scope.formField.value=$(this).val();});scope.$watch('formField.value',function(val,oldVal){if(val!==oldVal&&val===''){$file.val('');}});}else if(isArrayCheckboxControl(field)){Materialize.updateTextFields();scope.$watch('formField.value',function(val,oldVal){if(val!==oldVal&&val&&!oldVal&&angular.isArray(val)){syncMultiCheckboxKeysWithFieldValue(field);}});}else if(hasUiControl(field,'text')||hasUiControl(field,'textarea')||hasUiControl(field,'password')||hasUiControl(field,'email')||hasUiControl(field,'number')||hasUiControl(field,'url')||hasUiControl(field,'search')){Materialize.updateTextFields();scope.$watch('formField.value',function(val,oldVal){if(val!==oldVal){$timeout(function(){Materialize.updateTextFields();});}});}}}
function getTemplate(field){var control=field.uiControl;if(control==='password'||control==='url'||control==='search'||control==='email'){control='text';}
var file='field-'+control;var fieldsSupportingArrays=['textarea','checkbox','text'];if(field.type==='array'&&fieldsSupportingArrays.indexOf(control)!==-1){file+='-array';}
return'plugins/CorePluginsAdmin/angularjs/form-field/'+file+'.html?cb='+piwik.cacheBuster;};return{restrict:'A',scope:{piwikFormField:'=',allSettings:'='},templateUrl:'plugins/CorePluginsAdmin/angularjs/form-field/form-field.directive.html?cb='+piwik.cacheBuster,compile:function(element,attrs){function evaluateConditionalExpression(scope,field){if(!field.condition){return;}
var values={};angular.forEach(scope.allSettings,function(setting){if(setting.value==='0'){values[setting.name]=0;}else{values[setting.name]=setting.value;}});field.showField=scope.$eval(field.condition,values);}
function formatAvailableValues(field){if(!field.availableValues){return;}
var flatValues=[];if(hasUiControl(field,'radio')||hasUiControl(field,'checkbox')){angular.forEach(field.availableValues,function(value,key){if(angular.isObject(value)&&typeof value.key!=='undefined'){flatValues.push(value);return;}
if(field.type==='integer'&&angular.isString(key)){key=parseInt(key,10);}
flatValues.push({key:key,value:value});});return flatValues;}
if(hasUiControl(field,'expandable-select')){var availableValues=field.availableValues;var flatValues=[];var groups={};angular.forEach(availableValues,function(value){if(!value.group){value.group='';}
if(!(value.group in groups)||!groups[value.group]){groups[value.group]={values:[],group:value.group}}
var formatted={key:value.key,value:value.value};if('tooltip'in value&&value.tooltip){formatted.tooltip=value.tooltip;}
groups[value.group].values.push(formatted);});angular.forEach(groups,function(group){if(group.values.length){flatValues.push(group);}});return flatValues;}
if(isSelectControl(field)){var availableValues=field.availableValues;if(!hasGroupedValues(availableValues)){availableValues={'':availableValues};}
var flatValues=[];angular.forEach(availableValues,function(values,group){angular.forEach(values,function(value,key){if(angular.isObject(value)&&typeof value.key!=='undefined'){flatValues.push(value);return;}
if(field.type==='integer'&&angular.isString(key)){key=parseInt(key,10);}
flatValues.push({group:group,key:key,value:value});});});return flatValues;}
return field.availableValues;}
function formatPrettyDefaultValue(defaultValue,availableOptions){if(angular.isString(defaultValue)&&defaultValue){var defaultParsed=null;try{defaultParsed=JSON.parse(defaultValue);}catch(e){}
if(angular.isObject(defaultParsed)){return null;}}
if(!angular.isArray(availableOptions)){if(angular.isArray(defaultValue)){return null;}
return defaultValue;}
var prettyValues=[];if(!angular.isArray(defaultValue)){defaultValue=[defaultValue];}
angular.forEach(availableOptions,function(value,key){if(defaultValue.indexOf(value.key)!==-1&&typeof value.value!=='undefined'){prettyValues.push(value.value);}});return prettyValues.join(', ');}
return function(scope,element,attrs){var field=scope.piwikFormField;var defaultValue=field.defaultValue;if(angular.isArray(field.defaultValue)){field.defaultValue=defaultValue.join(',');}
if(field.type==='boolean'){var valueIsTruthy=field.value&&field.value>0&&field.value!=='0';if(field.uiControl==='checkbox'){field.value=valueIsTruthy;}else if(field.uiControl==='radio'){field.value=valueIsTruthy?'1':'0';}}
field.availableOptions=formatAvailableValues(field);if(field.uiControl==='select'&&field.uiControlAttributes.placeholder&&!hasOption('')){field.availableOptions.splice(0,0,{key:'',value:''});}
field.defaultValuePretty=formatPrettyDefaultValue(defaultValue,field.availableOptions);field.showField=true;var inlineHelpNode;if(field.inlineHelp&&field.inlineHelp.indexOf('#')===0){inlineHelpNode=field.inlineHelp;field.inlineHelp=' ';}
if(isArrayCheckboxControl(field)){field.updateCheckboxArrayValue=function(){var values=[];for(var x in field.checkboxkeys){if(field.checkboxkeys[x]){values.push(field.availableOptions[x].key);}}
field.value=values;}
field.checkboxkeys=new Array(field.availableOptions.length);if(field.value&&angular.isArray(field.value)){syncMultiCheckboxKeysWithFieldValue(field);}}
if(field.condition&&scope.allSettings){evaluateConditionalExpression(scope,field);for(var key in scope.allSettings){if(scope.allSettings.hasOwnProperty(key)){scope.$watchCollection('allSettings['+key+'].value',function(val,oldVal){if(val!==oldVal){evaluateConditionalExpression(scope,field);}});}}}
if(!field.templateFile){field.templateFile=getTemplate(field);}
scope.formField=field;scope.$watch('formField.availableValues',function(val,oldVal){if(val!==oldVal){scope.formField.availableOptions=formatAvailableValues(scope.formField);if(isSelectControl(scope.formField)){$timeout(function(){initMaterialSelect(element.find('select'),field.uiControlAttributes.placeholder);});}}});scope.templateLoaded=function(){$timeout(whenRendered(scope,element,inlineHelpNode));};function hasOption(key){for(var i=0;i!==field.availableOptions.length;++i){if(field.availableOptions[i].key===key){return true;}}
return false;}};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikField',piwikField);piwikField.$inject=['piwik','$compile'];function piwikField(piwik,$compile){return{restrict:'A',require:'?ngModel',scope:{uicontrol:'@',name:'@',value:'@',default:'@',options:'=',description:'@',introduction:'@',title:'@',inlineHelp:'@',disabled:'=',uiControlAttributes:'=',autocomplete:'@',condition:'@',varType:'@',autofocus:'@',tabindex:'@',templateFile:'@',fullWidth:'@',maxlength:'@',required:'@',placeholder:'@',rows:'@',min:'@',max:'@'},template:'<div piwik-form-field="field"></div>',link:function(scope,elm,attrs,ctrl){if(!ctrl){return;}
if(scope.field.value!==undefined&&scope.field.value!==null){ctrl.$setViewValue(scope.field.value);}else if(ctrl.$viewValue){scope.field.value=ctrl.$viewValue;}
scope.$watch('field.value',function(val,oldVal){if(val!==oldVal&&val!==ctrl.$viewValue){ctrl.$setViewValue(val);}});ctrl.$render=function(){scope.field.value=ctrl.$viewValue;};},controller:function($scope){var field={};field.uiControl=$scope.uicontrol;if($scope.varType){field.type=$scope.varType;}else if(field.uiControl==='multiselect'){field.type='array';}else if(field.uiControl==='checkbox'){field.type='boolean';}else if(field.uiControl==='site'){field.type='object';}else if(field.uiControl==='number'){field.type='integer';}else{field.type='string';}
field.name=$scope.name;field.value=$scope.value;field.defaultValue=$scope.default;field.availableValues=$scope.options;field.description=$scope.description;field.introduction=$scope.introduction;field.inlineHelp=$scope.inlineHelp;field.templateFile=$scope.templateFile;field.title=$scope.title;field.uiControlAttributes=$scope.uiControlAttributes||{};field.fullWidth=!!$scope.fullWidth;if(field.type==='array'&&angular.isString(field.value)&&field.value){field.value=JSON.parse(field.value);}
var i=0,attribute;var attributes=['disabled','autocomplete','tabindex','autofocus','rows','required','maxlength','placeholder','min','max'];for(i;i<attributes.length;i++){attribute=attributes[i];if(!!$scope[attribute]){field.uiControlAttributes[attribute]=$scope[attribute];}}
$scope.field=field;$scope.$watch('options',function(val,oldVal){if(val!==oldVal){$scope.field.availableValues=val;}});$scope.$watch('title',function(val,oldVal){if(val!==oldVal){$scope.field.title=val;}});$scope.$watch('inlineHelp',function(val,oldVal){if(val!==oldVal){$scope.field.inlineHelp=val;}});if('undefined'!==typeof $scope.placeholder&&$scope.placeholder!==null){$scope.$watch('placeholder',function(val,oldVal){if(val!==oldVal){$scope.field.uiControlAttributes.placeholder=val;}});}
$scope.$watch('disabled',function(val,oldVal){if(val!==oldVal){$scope.field.uiControlAttributes.disabled=val;}});}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikSaveButton',piwikSaveButton);piwikSaveButton.$inject=['piwik'];function piwikSaveButton(piwik){return{restrict:'A',replace:true,scope:{saving:'=?',value:'@?',disabled:'=?',onconfirm:'&?'},templateUrl:'plugins/CorePluginsAdmin/angularjs/save-button/save-button.directive.html?cb='+piwik.cacheBuster};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikPluginFilter',piwikPluginFilter);piwikPluginFilter.$inject=['piwik'];function piwikPluginFilter(piwik){return{restrict:'A',compile:function(element,attrs){return function(scope,element,attrs){updateAllNumbersOfMatchingPluginsInFilter();function filterPlugins(){var filterOrigin=getCurrentFilterOrigin();var filterStatus=getCurrentFilterStatus();var $nodesToEnable=getMatchingNodes(filterOrigin,filterStatus);$('#plugins tr[data-filter-origin][data-filter-status]').css('display','none');$nodesToEnable.css('display','table-row');updateAllNumbersOfMatchingPluginsInFilter();}
function updateAllNumbersOfMatchingPluginsInFilter(){var filterOrigin=getCurrentFilterOrigin();var filterStatus=getCurrentFilterStatus();updateNumberOfMatchingPluginsInFilter('[data-filter-status="all"]',filterOrigin,'all');updateNumberOfMatchingPluginsInFilter('[data-filter-status="active"]',filterOrigin,'active');updateNumberOfMatchingPluginsInFilter('[data-filter-status="inactive"]',filterOrigin,'inactive');updateNumberOfMatchingPluginsInFilter('[data-filter-origin="all"]','all',filterStatus);updateNumberOfMatchingPluginsInFilter('[data-filter-origin="core"]','core',filterStatus);updateNumberOfMatchingPluginsInFilter('[data-filter-origin="official"]','official',filterStatus);updateNumberOfMatchingPluginsInFilter('[data-filter-origin="thirdparty"]','thirdparty',filterStatus);}
function updateNumberOfMatchingPluginsInFilter(selectorFilterToUpdate,filterOrigin,filterStatus){var numMatchingNodes=getMatchingNodes(filterOrigin,filterStatus).length;var updatedCounterText=' ('+numMatchingNodes+')';element.find(selectorFilterToUpdate+' .counter').text(updatedCounterText);}
function getCurrentFilterOrigin(){return element.find('.origin a.active').data('filter-origin');}
function getCurrentFilterStatus(){return element.find('.status a.active').data('filter-status');}
function getMatchingNodes(filterOrigin,filterStatus){var query='#plugins tr';if('all'==filterOrigin){query+='[data-filter-origin]';}else{query+='[data-filter-origin='+filterOrigin+']';}
if('all'==filterStatus){query+='[data-filter-status]';}else{query+='[data-filter-status='+filterStatus+']';}
return $(query);}
element.find('.status').on('click','a',function(event){event.preventDefault();$(this).siblings().removeClass('active');$(this).addClass('active');filterPlugins();});element.find('.origin').on('click','a',function(event){event.preventDefault();$(this).siblings().removeClass('active');$(this).addClass('active');filterPlugins();});};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikPluginManagement',piwikPluginManagement);piwikPluginManagement.$inject=['piwik'];function piwikPluginManagement(piwik){return{restrict:'A',compile:function(element,attrs){return function(scope,element,attrs){var uninstallConfirmMessage='';element.find('.uninstall').click(function(event){event.preventDefault();var link=$(this).attr('href');var pluginName=$(this).attr('data-plugin-name');if(!link||!pluginName){return;}
if(!uninstallConfirmMessage){uninstallConfirmMessage=$('#uninstallPluginConfirm').text();}
var messageToDisplay=uninstallConfirmMessage.replace('%s',pluginName);$('#uninstallPluginConfirm').text(messageToDisplay);piwikHelper.modalConfirm('#confirmUninstallPlugin',{yes:function(){window.location=link;}});});element.find('.plugin-donation-link').click(function(event){event.preventDefault();var overlayId=$(this).data('overlay-id');piwikHelper.modalConfirm('#'+overlayId,{});});};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikPluginUpload',piwikPluginUpload);piwikPluginUpload.$inject=['piwik'];function piwikPluginUpload(piwik){return{restrict:'A',compile:function(element,attrs){return function(scope,element,attrs){$('.uploadPlugin').click(function(event){event.preventDefault();piwikHelper.modalConfirm('#installPluginByUpload',{});});$('#uploadPluginForm').submit(function(event){var $zipFile=$('[name=pluginZip]');var fileName=$zipFile.val();if(!fileName||'.zip'!=fileName.slice(-4)){event.preventDefault();alert(_pk_translate('CorePluginsAdmin_NoZipFileSelected'));}});};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').component('piwikSeriesPicker',{templateUrl:'plugins/CoreVisualizations/angularjs/series-picker/series-picker.component.html?cb='+piwik.cacheBuster,bindings:{multiselect:'<',selectableColumns:'<',selectableRows:'<',selectedColumns:'<',selectedRows:'<',onSelect:'&'},controller:SeriesPickerController});SeriesPickerController.$inject=[];function SeriesPickerController(){var vm=this;vm.isPopupVisible=false;vm.columnStates={};vm.rowStates={};vm.optionSelected=optionSelected;vm.onLeavePopup=onLeavePopup;vm.$onInit=$onInit;function $onInit(){vm.columnStates=getInitialOptionStates(vm.selectableColumns,vm.selectedColumns);vm.rowStates=getInitialOptionStates(vm.selectableRows,vm.selectedRows);}
function getInitialOptionStates(allOptions,selectedOptions){var states={};allOptions.forEach(function(columnConfig){states[columnConfig.column||columnConfig.matcher]=false;});selectedOptions.forEach(function(column){states[column]=true;});return states;}
function optionSelected(optionValue,optionStates){if(!vm.multiselect){unselectOptions(vm.columnStates);unselectOptions(vm.rowStates);}
optionStates[optionValue]=!optionStates[optionValue];if(optionStates[optionValue]){triggerOnSelectAndClose();}}
function onLeavePopup(){vm.isPopupVisible=false;if(optionsChanged()){triggerOnSelectAndClose();}}
function triggerOnSelectAndClose(){if(!vm.onSelect){return;}
vm.isPopupVisible=false;vm.onSelect({columns:getSelected(vm.columnStates),rows:getSelected(vm.rowStates)});}
function optionsChanged(){return!arrayEqual(getSelected(vm.columnStates),vm.selectedColumns)||!arrayEqual(getSelected(vm.rowStates),vm.selectedRows);}
function arrayEqual(lhs,rhs){if(lhs.length!==rhs.length){return false;}
return lhs.filter(function(element){return rhs.indexOf(element)===-1;}).length===0;}
function unselectOptions(optionStates){Object.keys(optionStates).forEach(function(optionName){optionStates[optionName]=false;});}
function getSelected(optionStates){return Object.keys(optionStates).filter(function(optionName){return!!optionStates[optionName];});}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').component('piwikSingleMetricView',{templateUrl:'plugins/CoreVisualizations/angularjs/single-metric-view/single-metric-view.component.html?cb='+piwik.cacheBuster,bindings:{metric:'<',idGoal:'<',metricTranslations:'<',metricDocumentations:'<',goals:'<',goalMetrics:'<'},controller:SingleMetricViewController});SingleMetricViewController.$inject=['piwik','piwikApi','$element','$httpParamSerializer','$compile','$scope','piwikPeriods','$q'];function SingleMetricViewController(piwik,piwikApi,$element,$httpParamSerializer,$compile,$scope,piwikPeriods,$q){var seriesPickerScope;var vm=this;vm.metricValue=null;vm.isLoading=false;vm.metricTranslation=null;vm.metricDocumentation=null;vm.selectableColumns=[];vm.responses=null;vm.sparklineParams={};vm.$onInit=$onInit;vm.$onChanges=$onChanges;vm.$onDestroy=$onDestroy;vm.getCurrentPeriod=getCurrentPeriod;vm.getMetricTranslation=getMetricTranslation;vm.setMetric=setMetric;function setSparklineParams(){var params={module:'API',action:'get',columns:vm.metric};if(isIdGoalSet()){params.idGoal=vm.idGoal;params.module='Goals';}
vm.sparklineParams=params;}
function $onInit(){vm.selectedColumns=[vm.metric];if(piwik.period!=='range'){vm.pastPeriod=getPastPeriodStr();}
setSelectableColumns();createSeriesPicker();$element.closest('.widgetContent').on('widget:destroy',function(){$scope.$parent.$destroy();}).on('widget:reload',function(){$scope.$parent.$destroy();});setSparklineParams();}
function $onChanges(changes){if(changes.metric&&changes.metric.previousValue!==changes.metric.currentValue){onMetricChanged();}}
function $onDestroy(){$element.closest('.widgetContent').off('widget:destroy').off('widget:reload');destroySeriesPicker();}
function fetchData(){vm.isLoading=true;var promises=[];var apiModule='API';var apiAction='get';var extraParams={};if(isIdGoalSet()){extraParams.idGoal=vm.idGoal;extraParams.filter_add_columns_when_show_all_columns=0;apiModule='Goals';apiAction='get';}
promises.push(piwikApi.fetch($.extend({method:apiModule+'.'+apiAction,format_metrics:'all'},extraParams)));if(piwik.period!=='range'){promises.push(piwikApi.fetch($.extend({method:apiModule+'.'+apiAction,format_metrics:'0'},extraParams)));promises.push(piwikApi.fetch($.extend({method:apiModule+'.'+apiAction,date:getLastPeriodDate(),format_metrics:'0',},extraParams)));promises.push(piwikApi.fetch($.extend({method:apiModule+'.'+apiAction,date:getLastPeriodDate(),format_metrics:'all',},extraParams)));}
return $q.all(promises).then(function(responses){vm.responses=responses;vm.isLoading=false;});}
function recalculateValues(){setWidgetTitle();vm.metricDocumentation=getMetricDocumentation();var currentData=vm.responses[0];vm.metricValue=currentData[vm.metric]||0;if(vm.responses[1]){vm.metricValueUnformatted=vm.responses[1][vm.metric];var pastData=vm.responses[2];vm.pastValueUnformatted=pastData[vm.metric]||0;var evolution=piwik.helper.calculateEvolution(vm.metricValueUnformatted,vm.pastValueUnformatted);vm.metricChangePercent=(evolution*100).toFixed(2)+' %';var pastDataFormatted=vm.responses[3];vm.pastValue=pastDataFormatted[vm.metric]||0;}else{vm.pastValue=null;vm.metricChangePercent=null;}
vm.metricTranslation=getMetricTranslation();}
function getLastPeriodDate(){var RangePeriod=piwikPeriods.get('range');var result=RangePeriod.getLastNRange(piwik.period,2,piwik.currentDateString).startDate;return piwikPeriods.format(result);}
function setWidgetTitle(){var title=vm.getMetricTranslation();if(isIdGoalSet()){var goalName=vm.goals[vm.idGoal].name;title=goalName+' - '+title;}
$element.closest('div.widget').find('.widgetTop > .widgetName > span').text(title);}
function getCurrentPeriod(){if(piwik.startDateString===piwik.endDateString){return piwik.endDateString;}
return piwik.startDateString+', '+piwik.endDateString;}
function createSeriesPicker(){vm.selectedColumns=[vm.idGoal?('goal'+vm.idGoal+'_'+vm.metric):vm.metric];var $widgetName=$element.closest('div.widget').find('.widgetTop > .widgetName');var $seriesPicker=$('<piwik-series-picker class="single-metric-view-picker" multiselect="false" '+'selectable-columns="$ctrl.selectableColumns" selectable-rows="[]" selected-columns="$ctrl.selectedColumns" '+'selected-rows="[]" on-select="$ctrl.setMetric(columns[0])" />');seriesPickerScope=$scope.$new();$compile($seriesPicker)(seriesPickerScope);$widgetName.append($seriesPicker);}
function destroySeriesPicker(){$element.closest('div.widget').find('.single-metric-view-picker').remove();seriesPickerScope.$destroy();seriesPickerScope=null;}
function getMetricDocumentation(){if(!vm.metricDocumentations||!vm.metricDocumentations[vm.metric]){return'';}
return vm.metricDocumentations[vm.metric];}
function getMetricTranslation(){if(!vm.metricTranslations||!vm.metricTranslations[vm.metric]){return'';}
return vm.metricTranslations[vm.metric];}
function setSelectableColumns(){var result=[];Object.keys(vm.metricTranslations).forEach(function(column){result.push({column:column,translation:vm.metricTranslations[column]});});Object.keys(vm.goals).forEach(function(idgoal){var goal=vm.goals[idgoal];vm.goalMetrics.forEach(function(column){result.push({column:'goal'+goal.idgoal+'_'+column,translation:goal.name+' - '+vm.metricTranslations[column]});});});vm.selectableColumns=result;}
function onMetricChanged(){setSparklineParams();fetchData().then(recalculateValues);$element.closest('[widgetId]').trigger('setParameters',{column:vm.metric,idGoal:vm.idGoal});}
function setMetric(newColumn){var idGoal;var m=newColumn.match(/^goal([0-9]+)_(.*)/);if(m){idGoal=+m[1];newColumn=m[2];}
if(vm.metric!==newColumn||idGoal!==vm.idGoal){vm.metric=newColumn;vm.idGoal=idGoal;onMetricChanged();}}
function getPastPeriodStr(){var startDate=piwikPeriods.get('range').getLastNRange(piwik.period,2,piwik.currentDateString).startDate;var dateRange=piwikPeriods.get(piwik.period).parse(startDate).getDateRange();return piwikPeriods.format(dateRange[0])+','+piwikPeriods.format(dateRange[1]);}
function isIdGoalSet(){return vm.idGoal||vm.idGoal===0;}}})();
(function($,require){var SeriesPicker=function(dataTable){this.domElem=null;this.dataTableId=dataTable.workingDivId;this.selectableColumns=dataTable.props.selectable_columns;this.selectableRows=dataTable.props.selectable_rows;this.show=!!dataTable.props.show_series_picker&&(this.selectableColumns||this.selectableRows);this.multiSelect=!!dataTable.props.allow_multi_select_series_picker;};SeriesPicker.prototype={init:function(){if(!this.show){return;}
var self=this;var selectedColumns=this.selectableColumns.filter(isItemDisplayed).map(function(columnConfig){return columnConfig.column;});var selectedRows=this.selectableRows.filter(isItemDisplayed).map(function(rowConfig){return rowConfig.matcher;});var seriesPicker='<piwik-series-picker'
+' multiselect="'+(this.multiSelect?'true':'false')+'"'
+' selectable-columns="selectableColumns"'
+' selectable-rows="selectableRows"'
+' selected-columns="selectedColumns"'
+' selected-rows="selectedRows"'
+' on-select="selectionChanged(columns, rows)"/>';this.domElem=$(seriesPicker);$(this).trigger('placeSeriesPicker');piwikHelper.compileAngularComponents(this.domElem,{params:{selectableColumns:this.selectableColumns,selectableRows:this.selectableRows,selectedColumns:selectedColumns,selectedRows:selectedRows,selectionChanged:function selectionChanged(columns,rows){if(columns.length===0&&rows.length===0){return;}
rows=rows.map(encodeURIComponent);$(self).trigger('seriesPicked',[columns,rows]);var UI=require('piwik/UI');var params={columns:columns,columns_to_display:columns,rows:rows,rows_to_display:rows};var tableNode=$('#'+self.dataTableId);UI.DataTable.prototype.notifyWidgetParametersChange(tableNode,params);}}});function isItemDisplayed(columnOrRowConfig){return columnOrRowConfig.displayed;}},getMetricTranslation:function(metric){for(var i=0;i!==this.selectableColumns.length;++i){if(this.selectableColumns[i].column===metric){return this.selectableColumns[i].translation;}}
return metric;}};var exports=require('piwik/DataTableVisualizations/Widgets');exports.SeriesPicker=SeriesPicker;})(jQuery,require);
function rowEvolutionGetMetricNameFromRow(tr){return $(tr).find('td [data-name]').text().trim();}
(function($,require){var exports=require('piwik/UI'),DataTable=exports.DataTable,dataTablePrototype=DataTable.prototype,getLabelFontFamily=function(){if(!window.piwik.jqplotLabelFont){window.piwik.jqplotLabelFont=$('<p/>').hide().appendTo('body').css('font-family');}
return window.piwik.jqplotLabelFont||'Arial';};exports.getLabelFontFamily=getLabelFontFamily;exports.JqplotGraphDataTable=function(element){DataTable.call(this,element);};$.extend(exports.JqplotGraphDataTable.prototype,dataTablePrototype,{init:function(){dataTablePrototype.init.call(this);var graphElement=$('.piwik-graph',this.$element);if(!graphElement.length){return;}
this._lang={noData:_pk_translate('General_NoDataForGraph'),exportTitle:_pk_translate('General_ExportAsImage'),exportText:_pk_translate('General_SaveImageOnYourComputer'),metricsToPlot:_pk_translate('General_MetricsToPlot'),metricToPlot:_pk_translate('General_MetricToPlot'),recordsToPlot:_pk_translate('General_RecordsToPlot')};this.targetDivId=this.workingDivId+'Chart';graphElement.attr('id',this.targetDivId);try{var graphData=JSON.parse(graphElement.attr('data-data'));}catch(e){console.error('JSON.parse Error: "'+e+"\" in:\n"+graphElement.attr('data-data'));return;}
this.data=graphData.data;this._setJqplotParameters(graphData.params);if(this.props.display_percentage_in_tooltip){this._setTooltipPercentages();}
this._bindEvents();if(this.props.external_series_toggle){this.addExternalSeriesToggle(window[this.props.external_series_toggle],this.props.external_series_toggle_show_all==1);}
var self=this;setTimeout(function(){self.render();},1);},_setJqplotParameters:function(params){defaultParams={grid:{drawGridLines:false,borderWidth:0,shadow:false},title:{show:false},axesDefaults:{pad:1.0,tickRenderer:$.jqplot.CanvasAxisTickRenderer,tickOptions:{showMark:false,fontSize:'11px',fontFamily:getLabelFontFamily()},rendererOptions:{drawBaseline:false}},axes:{yaxis:{tickOptions:{formatString:'%s',formatter:$.jqplot.NumberFormatter}}}};this.jqplotParams=$.extend(true,{},defaultParams,params);this._setColors();},_setTooltipPercentages:function(){this.tooltip={percentages:[]};for(var seriesIdx=0;seriesIdx!=this.data.length;++seriesIdx){var series=this.data[seriesIdx];var sum=0;$.each(series,function(index,value){if($.isArray(value)&&value[1]){sum=sum+value[1];}else if(!$.isArray(value)){sum=sum+value;}});var percentages=this.tooltip.percentages[seriesIdx]=[];for(var valueIdx=0;valueIdx!=series.length;++valueIdx){var value=series[valueIdx];if($.isArray(value)&&value[1]){value=value[1];}
percentages[valueIdx]=sum>0?Math.round(100*value / sum):0;}}},_bindEvents:function(){var self=this;var target=$('#'+this.targetDivId);target.on('jqplotDataHighlight',function(e,seriesIndex,valueIndex){self._showDataPointTooltip(this,seriesIndex,valueIndex);}).on('jqplotDataUnhighlight',function(){self._destroyDataPointTooltip($(this));});this._plotWidth=target.innerWidth();target.on('resizeGraph',function(){self._resizeGraph();});target.on('piwikExportAsImage',function(){self.exportAsImage(target,self._lang);});target.on('piwikDestroyPlot',function(){if(self._resizeListener){$(window).off('resize',self._resizeListener);}
self._plot.destroy();for(var i=0;i<$.jqplot.visiblePlots.length;i++){if($.jqplot.visiblePlots[i]===self){$.jqplot.visiblePlots[i]=null;}}});this.$element.closest('.widgetContent').on('widget:resize',function(){self._resizeGraph();});},_resizeGraph:function(){var width=$('#'+this.targetDivId).innerWidth();if(width>0&&Math.abs(this._plotWidth-width)>=5){this._plotWidth=width;this.render();}},_setWindowResizeListener:function(){var self=this;var timeout=false;this._resizeListener=function(){if(timeout){window.clearTimeout(timeout);}
timeout=window.setTimeout(function(){$('#'+self.targetDivId).trigger('resizeGraph');},300);};$(window).on('resize',this._resizeListener);},_destroyDataPointTooltip:function($element){if($element.is(":data('ui-tooltip')")){$element.tooltip('destroy');}},_showDataPointTooltip:function(element,seriesIndex,valueIndex){},changeSeries:function(columns,rows){this.showLoading();columns=columns||[];if(typeof columns=='string'){columns=columns.split(',');}
rows=rows||[];if(typeof rows=='string'){rows=rows.split(',');}
var dataTable=$('#'+this.workingDivId).data('uiControlObject');dataTable.param.columns=columns.join(',');dataTable.param.rows=rows.join(',');delete dataTable.param.filter_limit;delete dataTable.param.totalRows;if(dataTable.param.filter_sort_column!='label'){dataTable.param.filter_sort_column=columns[0];}
dataTable.param.disable_generic_filters='0';dataTable.reloadAjaxDataTable(false);},destroyPlot:function(){var target=$('#'+this.targetDivId);target.trigger('piwikDestroyPlot');if(target.data('oldHeight')>0){target.height(target.data('oldHeight'));target.data('oldHeight',0);target.innerHTML='';}},showLoading:function(){var target=$('#'+this.targetDivId);var loading=$(document.createElement('div')).addClass('jqplot-loading');loading.css({width:target.innerWidth()+'px',height:target.innerHeight()+'px',opacity:0});target.prepend(loading);loading.css({opacity:.7});},_checkTicksWidth:function($targetDiv){if(typeof this.jqplotParams.axes.xaxis.ticksOriginal==='undefined'||this.jqplotParams.axes.xaxis.ticksOriginal==={}){this.jqplotParams.axes.xaxis.ticksOriginal=this.jqplotParams.axes.xaxis.ticks.slice();}
var ticks=this.jqplotParams.axes.xaxis.ticks=this.jqplotParams.axes.xaxis.ticksOriginal.slice();var divWidth=$targetDiv.width();var tickOptions=$.extend(true,{},this.jqplotParams.axesDefaults.tickOptions,this.jqplotParams.axes.xaxis.tickOptions);var gutter=tickOptions.gutter||5;var sumWidthOfTicks=Number.MAX_VALUE;var $labelTestChamber={};var tick="";var $body=$("body");var maxRunsFailsafe=20;var ticksCount=0;var key=0;while(sumWidthOfTicks>divWidth&&maxRunsFailsafe>0){sumWidthOfTicks=0;for(key=0;key<ticks.length;key++){tick=ticks[key];if(tick!==" "&&tick!==""){$labelTestChamber=$("<span/>",{style:'font-size: '+(tickOptions.fontSize||'11px')+'; font-family: '+(tickOptions.fontFamily||'Arial, Helvetica, sans-serif')+';'+(tickOptions.fontWeight||'normal')+';'+'clear: both; float: none;',text:tick}).appendTo($body);sumWidthOfTicks+=($labelTestChamber.width()+gutter*2);$labelTestChamber.remove();}}
ticksCount=0;if(sumWidthOfTicks>divWidth){for(key=0;key<ticks.length;key++){tick=ticks[key];if(tick!==" "&&tick!==""){if(ticksCount%2==1){ticks[key]=" ";}
ticksCount++;}}}
maxRunsFailsafe--;}},render:function(){if(this.data.length==0){return;}
var targetDivId=this.workingDivId+'Chart';var lang=this._lang;var dataTableDiv=$('#'+this.workingDivId);var target=$('#'+targetDivId);if(target.find('canvas').length>0){this.destroyPlot();}
var self=this;if(this.param.viewDataTable==="graphBar"||this.param.viewDataTable==="graphVerticalBar"||this.param.viewDataTable==="graphEvolution"){self._checkTicksWidth(target);}
try{var plot=self._plot=$.jqplot(targetDivId,this.data,this.jqplotParams);}catch(e){if(e!="No plot target specified"){throw e;}}
self._setWindowResizeListener();var self=this;if(typeof $.jqplot.visiblePlots=='undefined'){$.jqplot.visiblePlots=[];var $rootScope=piwikHelper.getAngularDependency('$rootScope');$rootScope.$on('piwikPageChange',function(){for(var i=0;i<$.jqplot.visiblePlots.length;i++){if($.jqplot.visiblePlots[i]==null){continue;}
$.jqplot.visiblePlots[i].destroyPlot();}
$.jqplot.visiblePlots=[];});}
if(typeof plot!='undefined'){$.jqplot.visiblePlots.push(self);}},exportAsImage:function(container,lang){var pixelRatio=window.devicePixelRatio||1;var exportCanvas=document.createElement('canvas');exportCanvas.width=Math.round(container.width()*pixelRatio);exportCanvas.height=Math.round(container.height()*pixelRatio);if(!exportCanvas.getContext){alert("Sorry, not supported in your browser. Please upgrade your browser :)");return;}
var exportCtx=exportCanvas.getContext('2d');var canvases=container.find('canvas');for(var i=0;i<canvases.length;i++){var canvas=canvases.eq(i);var position=canvas.position();var parent=canvas.parent();if(parent.hasClass('jqplot-axis')){var addPosition=parent.position();position.left+=addPosition.left;position.top+=addPosition.top+parseInt(parent.css('marginTop'),10);}
exportCtx.drawImage(canvas[0],Math.round(position.left*pixelRatio),Math.round(position.top*pixelRatio));}
var exported=exportCanvas.toDataURL("image/png");var img=document.createElement('img');img.src=exported;img=$(img).css({width:Math.round(exportCanvas.width / pixelRatio)+'px',height:Math.round(exportCanvas.height / pixelRatio)+'px'});var popover=$(document.createElement('div'));popover.append('<div style="font-size: 13px; margin-bottom: 10px;">'
+lang.exportText+'</div>').append($(img));popover.dialog({title:lang.exportTitle,modal:true,width:'auto',position:['center','center'],resizable:false,autoOpen:true,open:function(event,ui){$('.ui-widget-overlay').on('click.popover',function(){popover.dialog('close');});},close:function(event,ui){$(this).dialog("destroy").remove();}});},setYTicks:function(){var $tempAxisElement=$('<div>').attr('class','jqplot-axis jqplot-y2axis').css({'visibility':'hidden','display':'inline-block'});$('<span>').css('font-size',this.jqplotParams.axesDefaults.fontSize).css('font-family',this.jqplotParams.axesDefaults.fontFamily).appendTo($tempAxisElement);$('body').append($tempAxisElement);this.setYTicksForAxis('yaxis',this.jqplotParams.axes.yaxis);var axisLength=10;for(var i=2;typeof this.jqplotParams.axes['y'+i+'axis']!='undefined';i++){this.setYTicksForAxis('y'+i+'axis',this.jqplotParams.axes['y'+i+'axis']);axisLength+=getAxisWidth(this.jqplotParams.axes['y'+i+'axis']);}
var axesShown={};this.jqplotParams.series.forEach(function(series){axesShown[series.yaxis]=true;});var hasMultipleAxes=Object.keys(axesShown).length>1;if(hasMultipleAxes){$('.piwik-graph',this.$element).css('width','calc(100% - '+axisLength+'px)');}else{$('.piwik-graph',this.$element).css('width','');}
$tempAxisElement.remove();function getAxisWidth(axis){var maxWidth=0;axis.ticks.forEach(function(tick){var tickFormatted=$.jqplot.NumberFormatter(axis.tickOptions.formatString||'%s',tick);$tempAxisElement.find('span').text(tickFormatted);maxWidth=Math.max(maxWidth,$tempAxisElement.width());});return maxWidth;}},setYTicksForAxis:function(axisName,axis){var maxCrossDataSets=0;for(var i=0;i<this.data.length;i++){if(this.jqplotParams.series[i].yaxis==axisName){var maxValue=Math.max.apply(Math,this.data[i]);if(maxValue>maxCrossDataSets){maxCrossDataSets=maxValue;}
maxCrossDataSets=parseFloat(maxCrossDataSets);}}
maxCrossDataSets+=Math.max(1,Math.round(maxCrossDataSets*.03));if(maxCrossDataSets>15){maxCrossDataSets=maxCrossDataSets+10-maxCrossDataSets%10;}
if(maxCrossDataSets==0){maxCrossDataSets=1;}
if(axis.tickOptions.formatString.substring(2,3)=='%'&&maxCrossDataSets>100){maxCrossDataSets=100;}
var ticks=[];var numberOfTicks=2;var tickDistance=Math.ceil(maxCrossDataSets / numberOfTicks);for(var i=0;i<=numberOfTicks;i++){ticks.push(i*tickDistance);}
axis.ticks=ticks;},formatY:function(value,seriesIndex){var floatVal=parseFloat(value);var intVal=parseInt(value,10);if(Math.abs(floatVal-intVal)>=0.005){value=Math.round(floatVal*100)/ 100;}else if(parseFloat(intVal)==floatVal){value=intVal;}else{value=floatVal;}
var axisId=this.jqplotParams.series[seriesIndex].yaxis;var formatString=this.jqplotParams.axes[axisId].tickOptions.formatString;return $.jqplot.NumberFormatter(formatString,value);},addExternalSeriesToggle:function(seriesPickerClass,initiallyShowAll){new seriesPickerClass(this.targetDivId,this,initiallyShowAll);if(!initiallyShowAll){var initialMetrics=0;var $rowEvolution=$('#'+this.targetDivId).closest('.rowevolution');var newData=[];var newSeries=[];if($rowEvolution.data('initialMetrics')){initialMetrics=$rowEvolution.data('initialMetrics');if(angular.isArray(initialMetrics)){for(var j=0;j<initialMetrics.length;j++){for(var k=0;k<this.jqplotParams.series.length;k++){if(this.jqplotParams.series[k]&&this.jqplotParams.series[k].label&&this.jqplotParams.series[k].label===initialMetrics[j]){newData.push(this.data[k]);newSeries.push(this.jqplotParams.series[k]);break;}}}}}
if(newData.length){this.data=newData;this.jqplotParams.series=newSeries;}else{this.data=[this.data[0]];this.jqplotParams.series=[this.jqplotParams.series[0]];}
this.setYTicks();}},_setColors:function(){var colorManager=piwik.ColorManager;var viewDataTable=$('#'+this.workingDivId).data('uiControlObject').param['viewDataTable'];var graphType;if(viewDataTable=='graphEvolution'){graphType='evolution';}else if(viewDataTable=='graphPie'){graphType='pie';}else if(viewDataTable=='graphVerticalBar'){graphType='bar';}
var namespace=graphType+'-graph-colors';this._setSeriesColors(namespace);this.jqplotParams.grid.background=colorManager.getColor(namespace,'grid-background');this.jqplotParams.grid.borderColor=colorManager.getColor(namespace,'grid-border');this.tickColor=colorManager.getColor(namespace,'ticks');this.singleMetricColor=colorManager.getColor(namespace,'single-metric-label')},_setSeriesColors:function(namespace){var colorManager=piwik.ColorManager,seriesColorNames=['series0','series1','series2','series3','series4','series5','series6','series7','series8','series9','series10'];var comparisonService=piwikHelper.getAngularDependency('piwikComparisonsService');if(comparisonService.isComparing()&&typeof this.jqplotParams.series[0].seriesIndex!=='undefined'){namespace='comparison-series-color';seriesColorNames=[];this.jqplotParams.series.forEach(function(s){var seriesColorName=comparisonService.getSeriesColorName(s.seriesIndex,s.metricIndex);seriesColorNames.push(seriesColorName);});}
this.jqplotParams.seriesColors=colorManager.getColors(namespace,seriesColorNames,true);}});DataTable.registerFooterIconHandler('graphPie',DataTable.switchToGraph);DataTable.registerFooterIconHandler('graphVerticalBar',DataTable.switchToGraph);DataTable.registerFooterIconHandler('graphEvolution',DataTable.switchToGraph);})(jQuery,require);function JQPlotExternalSeriesToggle(targetDivId,jqplotObject,initiallyShowAll){this.init(targetDivId,originalConfig,initiallyShowAll);}
JQPlotExternalSeriesToggle.prototype={init:function(targetDivId,jqplotObject,initiallyShowAll){this.targetDivId=targetDivId;this.jqplotObject=jqplotObject;this.originalData=jqplotObject.data;this.originalSeries=jqplotObject.jqplotParams.series;this.originalAxes=jqplotObject.jqplotParams.axes;this.originalParams=jqplotObject.jqplotParams;this.originalSeriesColors=jqplotObject.jqplotParams.seriesColors;this.initiallyShowAll=initiallyShowAll;this.activated=[];this.target=$('#'+targetDivId);this.attachEvents();},attachEvents:function(){},showSeries:function(i){this.activated=[i];this.replot();},toggleSeries:function(i){if(this.activated.indexOf(i)>-1){if(this.activated.length>1){this.activated.splice(this.activated.indexOf(i),1);}}else{this.activated.push(i);}
this.replot();},replot:function(){this.beforeReplot();var usedAxes=[];var config={data:this.originalData,params:this.originalParams};config.data=[];config.params.series=[];config.params.axes={xaxis:this.originalAxes.xaxis};config.params.seriesColors=[];for(var j=0;j<this.activated.length;j++){for(var k=0;k<this.originalSeries.length;k++){if(this.originalSeries[k]&&this.originalSeries[k].label&&this.originalSeries[k].label===this.activated[j]){config.data.push(this.originalData[k]);config.params.seriesColors.push(this.originalSeriesColors[k]);config.params.series.push($.extend(true,{},this.originalSeries[k]));var axis=this.originalSeries[k].yaxis;if($.inArray(axis,usedAxes)==-1){usedAxes.push(axis);}
break;}}}
var replaceAxes={};for(j=0;j<usedAxes.length;j++){var originalAxisName=usedAxes[j];var newAxisName=(j==0?'yaxis':'y'+(j+1)+'axis');replaceAxes[originalAxisName]=newAxisName;config.params.axes[newAxisName]=this.originalAxes[originalAxisName];}
for(j=0;j<config.params.series.length;j++){var series=config.params.series[j];series.yaxis=replaceAxes[series.yaxis];}
this.jqplotObject.data=config.data;this.jqplotObject.jqplotParams=config.params;this.jqplotObject.setYTicks();this.jqplotObject.render();},beforeReplot:function(){}};function RowEvolutionSeriesToggle(targetDivId,jqplotData,initiallyShowAll){this.init(targetDivId,jqplotData,initiallyShowAll);}
RowEvolutionSeriesToggle.prototype=JQPlotExternalSeriesToggle.prototype;RowEvolutionSeriesToggle.prototype.attachEvents=function(){var self=this;var $rowEvolution=this.target.closest('.rowevolution');this.seriesPickers=$rowEvolution.find('table.metrics tr');var initialMetrics=[];if($rowEvolution.data('initialMetrics')){initialMetrics=[];var savedMetrics=$rowEvolution.data('initialMetrics');var existingMetricsInSeries=[];var m=0;for(m=0;m<this.originalSeries.length;m++){existingMetricsInSeries.push(this.originalSeries[m].label);}
for(m=0;m<savedMetrics.length;m++){if(existingMetricsInSeries.indexOf(savedMetrics[m])>-1){initialMetrics.push(savedMetrics[m]);}}}
this.seriesPickers.each(function(i){var el=$(this);el.off('click').on('click',function(e){var metricName=rowEvolutionGetMetricNameFromRow(this);if(e.shiftKey){self.toggleSeries(metricName);document.getSelection().removeAllRanges();}else{self.showSeries(metricName);}
$rowEvolution.data('initialMetrics',self.activated);return false;});var label=rowEvolutionGetMetricNameFromRow(el);var metricExists=false;for(var k=0;k<self.originalSeries.length;k++){if(self.originalSeries[k]&&labelMatches(self.originalSeries[k].label,label)){metricExists=true;}}
if(!metricExists){el.hide();}else if((initialMetrics.length===0&&i==0)||(initialMetrics.length>0&&initialMetrics.indexOf(label)>-1)||self.initiallyShowAll){if(!el.hasClass('hiddenByDefault')){el.show();}
el.find('td').css('opacity','');self.activated.push(rowEvolutionGetMetricNameFromRow(el));}else{if(!el.hasClass('hiddenByDefault')){el.show();}
el.find('td').css('opacity',.5);}
if($.browser.msie){this.ondrag=function(){return false;};this.onselectstart=function(){return false;};}else if($.browser.opera){$(this).attr('unselectable','on');}
function labelMatches(lhs,rhs){return lhs===rhs||piwikHelper.htmlDecode(lhs)===rhs||lhs===piwikHelper.htmlDecode(rhs);}});};RowEvolutionSeriesToggle.prototype.beforeReplot=function(){var self=this;this.seriesPickers.find('td').css('opacity',.5);this.seriesPickers.each(function(i){var name=rowEvolutionGetMetricNameFromRow(this);if(self.activated.indexOf(name)>-1){$(this).find('td').css('opacity',1);}});};(function($){$.jqplot.NumberFormatter=function(format,value){if(!$.isNumeric(value)){return format.replace(/%s/,value);}
return format.replace(/%s/,NumberFormatter.formatNumber(value));}})(jQuery);(function($){$.jqplot.PiwikTicks=function(options){this.piwikTicksCanvas=null;this.piwikHighlightCanvas=null;this.markerRenderer=new $.jqplot.MarkerRenderer({shadow:false});this.currentXTick=false;this.showHighlight=false;this.showGrid=false;this.showTicks=false;$.extend(true,this,options);};$.jqplot.PiwikTicks.init=function(target,data,opts){var options=opts||{};this.plugins.piwikTicks=new $.jqplot.PiwikTicks(options.piwikTicks);if(typeof $.jqplot.PiwikTicks.init.eventsBound=='undefined'){$.jqplot.PiwikTicks.init.eventsBound=true;$.jqplot.eventListenerHooks.push(['jqplotMouseMove',handleMouseMove]);$.jqplot.eventListenerHooks.push(['jqplotMouseLeave',handleMouseLeave]);}};$.jqplot.PiwikTicks.postDraw=function(){var c=this.plugins.piwikTicks;if(c.showHighlight){c.piwikHighlightCanvas=new $.jqplot.GenericCanvas();this.eventCanvas._elem.before(c.piwikHighlightCanvas.createElement(this._gridPadding,'jqplot-piwik-highlight-canvas',this._plotDimensions,this));c.piwikHighlightCanvas.setContext();}
if(c.showTicks){var dimensions=this._plotDimensions;dimensions.height+=6;c.piwikTicksCanvas=new $.jqplot.GenericCanvas();this.series[0].shadowCanvas._elem.before(c.piwikTicksCanvas.createElement(this._gridPadding,'jqplot-piwik-ticks-canvas',dimensions,this));c.piwikTicksCanvas.setContext();var ctx=c.piwikTicksCanvas._ctx;var ticks=this.data[0];var totalWidth=ctx.canvas.width;var tickWidth=totalWidth / ticks.length;var xaxisLabels=this.axes.xaxis.ticks;for(var i=0;i<ticks.length;i++){var pos=Math.round(i*tickWidth+tickWidth / 2);var full=xaxisLabels[i]&&xaxisLabels[i]!=' ';drawLine(ctx,pos,full,c.showGrid,c.tickColor);}}};$.jqplot.preInitHooks.push($.jqplot.PiwikTicks.init);$.jqplot.postDrawHooks.push($.jqplot.PiwikTicks.postDraw);function drawLine(ctx,x,full,showGrid,color){ctx.save();ctx.strokeStyle=color;ctx.beginPath();ctx.lineWidth=2;var top=0;if((full&&!showGrid)||!full){top=ctx.canvas.height-5;}
ctx.moveTo(x,top);ctx.lineTo(x,full?ctx.canvas.height:ctx.canvas.height-2);ctx.stroke();ctx.clearRect(x,0,x+1,ctx.canvas.height);ctx.restore();}
function handleMouseMove(ev,gridpos,datapos,neighbor,plot){var c=plot.plugins.piwikTicks;var tick=Math.floor(datapos.xaxis+0.5)-1;if(tick!==c.currentXTick){c.currentXTick=tick;plot.target.trigger('jqplotPiwikTickOver',[tick]);highlight(plot,tick);}}
function handleMouseLeave(ev,gridpos,datapos,neighbor,plot){unHighlight(plot);plot.plugins.piwikTicks.currentXTick=false;}
function highlight(plot,tick){var c=plot.plugins.piwikTicks;if(!c.showHighlight){return;}
unHighlight(plot);for(var i=0;i<plot.series.length;i++){var series=plot.series[i];var seriesMarkerRenderer=series.markerRenderer;c.markerRenderer.style=seriesMarkerRenderer.style;c.markerRenderer.size=seriesMarkerRenderer.size+5;var rgba=$.jqplot.getColorComponents(seriesMarkerRenderer.color);var newrgb=[rgba[0],rgba[1],rgba[2]];var alpha=rgba[3]*.4;c.markerRenderer.color='rgba('+newrgb[0]+','+newrgb[1]+','+newrgb[2]+','+alpha+')';c.markerRenderer.init();var position=series.gridData[tick];if(typeof position!=='undefined'){c.markerRenderer.draw(position[0],position[1],c.piwikHighlightCanvas._ctx);}}}
function unHighlight(plot){var canvas=plot.plugins.piwikTicks.piwikHighlightCanvas;if(canvas!==null){var ctx=canvas._ctx;ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);}}})(jQuery);(function($){$.jqplot.CanvasLegendRenderer=function(options){this.legendCanvas=null;this.singleMetric=false;this.show=false;$.extend(true,this,options);};$.jqplot.CanvasLegendRenderer.init=function(target,data,opts){var options=opts||{};this.plugins.canvasLegend=new $.jqplot.CanvasLegendRenderer(options.canvasLegend);if(this.plugins.canvasLegend.show){options.gridPadding={top:21,right:0};}};$.jqplot.CanvasLegendRenderer.postDraw=function(){var plot=this;var legend=plot.plugins.canvasLegend;if(!legend.show){return;}
var padding={top:0,right:this._gridPadding.right,bottom:0,left:this._gridPadding.left};var dimensions={width:this._plotDimensions.width,height:this._gridPadding.top};var width=this._plotDimensions.width-this._gridPadding.left-this._gridPadding.right;legend.legendCanvas=new $.jqplot.GenericCanvas();this.eventCanvas._elem.before(legend.legendCanvas.createElement(padding,'jqplot-legend-canvas',dimensions,plot));legend.legendCanvas.setContext();var ctx=legend.legendCanvas._ctx;ctx.save();ctx.font='11px '+require('piwik/UI').getLabelFontFamily()
var x=0;var series=plot.legend._series;for(var i=0;i<series.length;i++){var s=series[i];var label;if(legend.labels&&legend.labels[i]){label=legend.labels[i];}else{label=s.label.toString();}
ctx.fillStyle=s.color;if(legend.singleMetric){ctx.fillStyle=legend.singleMetricColor;}
ctx.fillRect(x,10,10,2);x+=15;var nextX=x+ctx.measureText(label).width+20;if(nextX+70>width){ctx.fillText("[...]",x,15);x+=ctx.measureText("[...]").width+20;break;}
ctx.fillText(label,x,15);x=nextX;}
legend.width=x;ctx.restore();};$.jqplot.preInitHooks.push($.jqplot.CanvasLegendRenderer.init);$.jqplot.postDrawHooks.push($.jqplot.CanvasLegendRenderer.postDraw);})(jQuery);(function($,require){$.jqplot.preInitHooks.push(function(target,data,options){var dataTable=$('#'+target).closest('.dataTable').data('uiControlObject');if(!dataTable){return;}
var SeriesPicker=require('piwik/DataTableVisualizations/Widgets').SeriesPicker;var seriesPicker=new SeriesPicker(dataTable);var plot=this;$(seriesPicker).bind('placeSeriesPicker',function(){this.domElem.css('margin-left',plot._gridPadding.left+'px');$('.jqplot-legend-canvas').css({paddingLeft:'34px'});plot.baseCanvas._elem.before(this.domElem);});$(seriesPicker).bind('seriesPicked',function(e,columns,rows){dataTable.changeSeries(columns,rows);});this.plugins.seriesPicker=seriesPicker;});$.jqplot.postDrawHooks.push(function(){this.plugins.seriesPicker.init();});})(jQuery,require);(function($){$.jqplot.PieLegend=function(options){this.pieLegendCanvas=null;this.show=false;$.extend(true,this,options);};$.jqplot.PieLegend.init=function(target,data,opts){var options=opts||{};this.plugins.pieLegend=new $.jqplot.PieLegend(options.pieLegend);};$.jqplot.PieLegend.postDraw=function(){var plot=this;var legend=plot.plugins.pieLegend;if(!legend.show){return;}
var series=plot.series[0];var angles=series._sliceAngles;var radius=series._diameter / 2;var center=series._center;var colors=this.seriesColors;var lineAngles=[];for(var i=0;i<angles.length;i++){lineAngles.push((angles[i][0]+angles[i][1])/ 2+Math.PI / 2);}
var labels=[];var data=series._plotData;for(i=0;i<data.length;i++){labels.push(data[i][0]);}
legend.pieLegendCanvas=new $.jqplot.GenericCanvas();plot.series[0].canvas._elem.before(legend.pieLegendCanvas.createElement(plot._gridPadding,'jqplot-pie-legend-canvas',plot._plotDimensions,plot));legend.pieLegendCanvas.setContext();var ctx=legend.pieLegendCanvas._ctx;ctx.save();ctx.font='11px '+require('piwik/UI').getLabelFontFamily()
var height=legend.pieLegendCanvas._elem.height();var x1,x2,y1,y2,lastY2=false,right,lastRight=false;for(i=0;i<labels.length;i++){var label=labels[i];ctx.strokeStyle=colors[i%colors.length];ctx.lineCap='round';ctx.lineWidth=1;x1=center[0]+Math.sin(lineAngles[i])*(radius);y1=center[1]-Math.cos(lineAngles[i])*(radius);x2=center[0]+Math.sin(lineAngles[i])*(radius+7);y2=center[1]-Math.cos(lineAngles[i])*(radius+7);right=x2>center[0];if(lastY2!==false&&lastRight==right&&((right&&y2-lastY2<13)||(!right&&lastY2-y2<13))){if(x1>center[0]){y2=lastY2+13;}else{y2=lastY2-13;}}
if(y2<4||y2+4>height){continue;}
ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.closePath();ctx.stroke();ctx.beginPath();ctx.moveTo(x2,y2);if(right){ctx.lineTo(x2+5,y2);}else{ctx.lineTo(x2-5,y2);}
ctx.closePath();ctx.stroke();lastY2=y2;lastRight=right;if(right){var x=x2+9;}else{var x=x2-9-ctx.measureText(label).width;}
ctx.fillStyle=legend.labelColor;ctx.fillText(label,x,y2+3);}
ctx.restore();};$.jqplot.preInitHooks.push($.jqplot.PieLegend.init);$.jqplot.postDrawHooks.push($.jqplot.PieLegend.postDraw);})(jQuery,require);
(function($,require){var exports=require('piwik/UI'),JqplotGraphDataTable=exports.JqplotGraphDataTable;exports.JqplotBarGraphDataTable=function(element){JqplotGraphDataTable.call(this,element);};$.extend(exports.JqplotBarGraphDataTable.prototype,JqplotGraphDataTable.prototype,{_setJqplotParameters:function(params){JqplotGraphDataTable.prototype._setJqplotParameters.call(this,params);var barMargin=this.data[0].length>10?2:10;var minBarWidth=10;this.jqplotParams.seriesDefaults={renderer:$.jqplot.BarRenderer,rendererOptions:{shadowOffset:1,shadowDepth:2,shadowAlpha:.2,fillToZero:true,barMargin:barMargin}};this.jqplotParams.piwikTicks={showTicks:true,showGrid:false,showHighlight:false,tickColor:this.tickColor};this.jqplotParams.axes.xaxis.renderer=$.jqplot.CategoryAxisRenderer;this.jqplotParams.axes.xaxis.tickOptions={showGridline:false};this.jqplotParams.canvasLegend={show:true};var comparisonService=piwikHelper.getAngularDependency('piwikComparisonsService');if(comparisonService.isComparing()){var seriesCount=this.jqplotParams.series.length;var dataCount=this.data[0].length;var totalBars=seriesCount*dataCount;var totalMinWidth=(minBarWidth+barMargin)*totalBars+50;this.$element.find('.piwik-graph').css('min-width',totalMinWidth+'px');this.$element.css('overflow-x','scroll');}},_bindEvents:function(){this.setYTicks();JqplotGraphDataTable.prototype._bindEvents.call(this);},_showDataPointTooltip:function(element,seriesIndex,valueIndex){var value=this.formatY(this.data[seriesIndex][valueIndex],seriesIndex);var series=this.jqplotParams.series[seriesIndex].label;var percentage='';if(typeof this.tooltip.percentages!='undefined'){percentage=this.tooltip.percentages[seriesIndex][valueIndex];percentage=' ('+NumberFormatter.formatPercent(percentage)+')';}
var label=this.jqplotParams.axes.xaxis.labels[valueIndex];var text='<strong>'+value+'</strong> '+series+percentage;$(element).tooltip({track:true,items:'*',content:'<h3>'+label+'</h3>'+text,show:false,hide:false}).trigger('mouseover');}});})(jQuery,require);
(function($,require){var exports=require('piwik/UI'),JqplotGraphDataTable=exports.JqplotGraphDataTable;exports.JqplotPieGraphDataTable=function(element){JqplotGraphDataTable.call(this,element);};$.extend(exports.JqplotPieGraphDataTable.prototype,JqplotGraphDataTable.prototype,{_setJqplotParameters:function(params){JqplotGraphDataTable.prototype._setJqplotParameters.call(this,params);this.jqplotParams.seriesDefaults={renderer:$.jqplot.PieRenderer,rendererOptions:{shadow:false,showDataLabels:false,sliceMargin:1,startAngle:35}};this.jqplotParams.piwikTicks={showTicks:false,showGrid:false,showHighlight:false,tickColor:this.tickColor};this.jqplotParams.legend={show:false};this.jqplotParams.pieLegend={show:true,labelColor:this.singleMetricColor};this.jqplotParams.canvasLegend={show:true,singleMetric:true,singleMetricColor:this.singleMetricColor};if(!(this.data[0][0]instanceof Array)){for(var i=0;i<this.data[0].length;i++){this.data[0][i]=[this.jqplotParams.axes.xaxis.ticks[i],this.data[0][i]];}}},_showDataPointTooltip:function(element,seriesIndex,valueIndex){var value=this.formatY(this.data[0][valueIndex][1],0);var series=this.jqplotParams.series[0].label;var percentage=this.tooltip.percentages[0][valueIndex];var label=this.data[0][valueIndex][0];var text='<strong>'+NumberFormatter.formatPercent(percentage)+'</strong> ('+value+' '+series+')';$(element).tooltip({track:true,items:'*',content:'<h3>'+label+'</h3>'+text,show:false,hide:false}).trigger('mouseover');}});})(jQuery,require);
(function($,require){var exports=require('piwik/UI'),JqplotGraphDataTable=exports.JqplotGraphDataTable,JqplotGraphDataTablePrototype=JqplotGraphDataTable.prototype;exports.JqplotEvolutionGraphDataTable=function(element){JqplotGraphDataTable.call(this,element);};$.extend(exports.JqplotEvolutionGraphDataTable.prototype,JqplotGraphDataTablePrototype,{_setJqplotParameters:function(params){JqplotGraphDataTablePrototype._setJqplotParameters.call(this,params);var defaultParams={axes:{xaxis:{pad:1.0,renderer:$.jqplot.CategoryAxisRenderer,tickOptions:{showGridline:false}}},piwikTicks:{showTicks:true,showGrid:true,showHighlight:true,tickColor:this.tickColor}};if(this.props.show_line_graph){defaultParams.seriesDefaults={lineWidth:1,markerOptions:{style:"filledCircle",size:6,shadow:false}};}else{defaultParams.seriesDefaults={renderer:$.jqplot.BarRenderer,rendererOptions:{shadowOffset:1,shadowDepth:2,shadowAlpha:.2,fillToZero:true,barMargin:this.data[0].length>10?2:10}};}
var overrideParams={legend:{show:false},canvasLegend:{show:true}};this.jqplotParams=$.extend(true,{},defaultParams,this.jqplotParams,overrideParams);},_bindEvents:function(){JqplotGraphDataTablePrototype._bindEvents.call(this);var self=this;var lastTick=false;$('#'+this.targetDivId).on('jqplotMouseLeave',function(e,s,i,d){$(this).css('cursor','default');JqplotGraphDataTablePrototype._destroyDataPointTooltip.call(this,$(this));}).on('jqplotClick',function(e,s,i,d){if(lastTick!==false&&typeof self.jqplotParams.axes.xaxis.onclick!='undefined'&&typeof self.jqplotParams.axes.xaxis.onclick[lastTick]=='string'){var url=self.jqplotParams.axes.xaxis.onclick[lastTick];broadcast.propagateNewPage(url);}}).on('jqplotPiwikTickOver',function(e,tick){lastTick=tick;var label;var dataByAxis={};for(var d=0;d<self.data.length;++d){var valueUnformatted=self.data[d][tick];if(typeof valueUnformatted==='undefined'||valueUnformatted===null){continue;}
var axis=self.jqplotParams.series[d]._xaxis||'xaxis';if(!dataByAxis[axis]){dataByAxis[axis]=[];}
var value=self.formatY(valueUnformatted,d);var series=self.jqplotParams.series[d].label;var seriesColor=self.jqplotParams.seriesColors[d];dataByAxis[axis].push('<span class="tooltip-series-color" style="background-color: '+seriesColor+';"/>'+'<strong>'+value+'</strong> '+piwikHelper.htmlEntities(series));}
var xAxisCount=0;Object.keys(self.jqplotParams.axes).forEach(function(axis){if(axis.substring(0,1)==='x'){++xAxisCount;}});var content='';for(var i=0;i<xAxisCount;++i){var axisName=i===0?'xaxis':'x'+(i+1)+'axis';if(!dataByAxis[axisName]||!dataByAxis[axisName].length){continue;}
if(typeof self.jqplotParams.axes[axisName].labels!='undefined'){label=self.jqplotParams.axes[axisName].labels[tick];}else{label=self.jqplotParams.axes[axisName].ticks[tick];}
if(typeof label==='undefined'){continue;}
content+='<h3 class="evolution-tooltip-header">'+piwikHelper.htmlEntities(label)+'</h3>'+dataByAxis[axisName].join('<br />');}
$(this).tooltip({track:true,items:'div',content:content,show:false,hide:false}).trigger('mouseover');if(typeof self.jqplotParams.axes.xaxis.onclick!='undefined'&&typeof self.jqplotParams.axes.xaxis.onclick[lastTick]=='string'){$(this).css('cursor','pointer');}});this.setYTicks();},_destroyDataPointTooltip:function(){},render:function(){JqplotGraphDataTablePrototype.render.call(this);if(initializeSparklines){initializeSparklines();}}});})(jQuery,require);
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
function DataTable_RowActions_Transitions(dataTable){this.dataTable=dataTable;this.transitions=null;}
DataTable_RowActions_Transitions.prototype=new DataTable_RowAction;DataTable_RowActions_Transitions.launchForUrl=function(url,segment){var value='Transitions:url:'+url;if(segment){value+=':segment:'+segment;}
broadcast.propagateNewPopoverParameter('RowAction',value);};DataTable_RowActions_Transitions.isPageUrlReport=function(module,action){return module=='Actions'&&(action=='getPageUrls'||action=='getEntryPageUrls'||action=='getExitPageUrls'||action=='getPageUrlsFollowingSiteSearch');};DataTable_RowActions_Transitions.isPageTitleReport=function(module,action){return module=='Actions'&&(action=='getPageTitles'||action=='getPageTitlesFollowingSiteSearch');};DataTable_RowActions_Transitions.registeredReports=[];DataTable_RowActions_Transitions.registerReport=function(handler){DataTable_RowActions_Transitions.registeredReports.push(handler);}
DataTable_RowActions_Transitions.prototype.trigger=function(tr,e,subTableLabel){var i=0;for(i;i<DataTable_RowActions_Transitions.registeredReports.length;i++){var report=DataTable_RowActions_Transitions.registeredReports[i];if(report&&report.trigger&&report.isAvailableOnReport&&report.isAvailableOnReport(this.dataTable.param)){report.trigger.apply(this,arguments);return;}}
alert('Transitions can\'t be used on this report.');};DataTable_RowActions_Transitions.prototype.performAction=function(label,tr,e){var separator=' > ';var labelParts=label.split(separator);for(var i=0;i<labelParts.length;i++){var labelPart=labelParts[i].replace('@','');labelParts[i]=$.trim(decodeURIComponent(labelPart));}
var delimiter=piwik.config.action_url_category_delimiter;if(this.dataTable.param.action.indexOf('PageTitles')!==false){delimiter=piwik.config.action_title_category_delimiter;}
label=labelParts.join(delimiter);this.openPopover('title:'+label);};DataTable_RowActions_Transitions.prototype.doOpenPopover=function(link){var ALLOWED_OVERRIDE_PARAMS=['segment','date','period','idSite'];var parts=link.split(':');var overrideParams={};var i=0;while(i<parts.length){var paramName=decodeURIComponent(parts[i]);if(ALLOWED_OVERRIDE_PARAMS.indexOf(paramName)===-1){i+=1;continue;}
overrideParams[paramName]=decodeURIComponent(parts[i+1]);parts.splice(i,2);}
if(parts.length<2){return;}
var actionType=parts[0];parts.shift();var actionName=parts.join(':');if(this.transitions===null){this.transitions=new Piwik_Transitions(actionType,actionName,this,overrideParams);}else{this.transitions.reset(actionType,actionName,segment);}
this.transitions.showPopover();};DataTable_RowActions_Registry.register({name:'Transitions',dataTableIcon:'icon-transition',order:20,dataTableIconTooltip:[_pk_translate('General_TransitionsRowActionTooltipTitle'),_pk_translate('General_TransitionsRowActionTooltip')],createInstance:function(dataTable){return new DataTable_RowActions_Transitions(dataTable);},isAvailableOnReport:function(dataTableParams){var i=0;for(i;i<DataTable_RowActions_Transitions.registeredReports.length;i++){var report=DataTable_RowActions_Transitions.registeredReports[i];if(report&&report.isAvailableOnReport&&report.isAvailableOnReport(dataTableParams)){return true;}}
return false;},isAvailableOnRow:function(dataTableParams,tr){if(tr.hasClass('subDataTable')||tr.hasClass('totalsRow')){return false;}
var i=0;for(i;i<DataTable_RowActions_Transitions.registeredReports.length;i++){var report=DataTable_RowActions_Transitions.registeredReports[i];if(report&&report.isAvailableOnRow&&report.isAvailableOnReport&&report.isAvailableOnReport(dataTableParams)){return report.isAvailableOnRow(dataTableParams,tr);}}
return true;}});function Piwik_Transitions(actionType,actionName,rowAction,overrideParams){this.reset(actionType,actionName,overrideParams);this.rowAction=rowAction;this.ajax=new Piwik_Transitions_Ajax();this.model=new Piwik_Transitions_Model(this.ajax);this.leftGroups=['previousPages','previousSiteSearches','searchEngines','socialNetworks','websites','campaigns'];this.rightGroups=['followingPages','followingSiteSearches','downloads','outlinks'];}
Piwik_Transitions.prototype.reset=function(actionType,actionName,overrideParams){this.actionType=actionType;this.actionName=actionName;this.overrideParams=overrideParams;this.popover=null;this.canvas=null;this.centerBox=null;this.leftOpenGroup='previousPages';this.rightOpenGroup='followingPages';this.highlightedGroup=false;this.highlightedGroupSide=false;this.highlightedGroupCenterEl=false;};Piwik_Transitions.prototype.showPopover=function(showEmbeddedInReport){var self=this;this.showEmbeddedInReport=showEmbeddedInReport;$('#transitions_report .popoverContainer').hide();if(showEmbeddedInReport){this.popover=$('#transitions_report');$('#Transitions_Error_Container').hide();$('#transitions_inline_loading').show();}else{this.popover=Piwik_Popover.showLoading('Transitions',self.actionName,550);Piwik_Popover.addHelpButton('https://matomo.org/docs/transitions');}
var bothLoaded=function(){if(!showEmbeddedInReport){Piwik_Popover.setContent(Piwik_Transitions.popoverHtml);}else{$('#transitions_inline_loading').hide();$('#transitions_report .popoverContainer').html(Piwik_Transitions.popoverHtml);$('#transitions_report .popoverContainer').show();}
self.preparePopover();self.model.htmlLoaded();if(self.model.searchEnginesNbTransitions>0&&self.model.websitesNbTransitions>0&&self.model.socialNetworksNbTransitions>0&&self.model.campaignsNbTransitions>0){self.canvas.narrowMode();}
self.render();self.canvas.truncateVisibleBoxTexts();};var callbackForHtml=false;if(typeof Piwik_Transitions.popoverHtml=='undefined'){this.ajax.callTransitionsController('renderPopover',function(html){Piwik_Transitions.popoverHtml=html;if(callbackForHtml!==false){callbackForHtml();}});}
self.model.loadData(self.actionType,self.actionName,self.overrideParams,function(){if(typeof Piwik_Transitions.popoverHtml=='undefined'){callbackForHtml=bothLoaded;}else{bothLoaded();}});};Piwik_Transitions.prototype.preparePopover=function(){var self=this;var width=900;var height=550;var canvasBgLeft=self.prepareCanvas('Background_Left',width,height);var canvasBgRight=self.prepareCanvas('Background_Right',width,height);var canvasLeft=self.prepareCanvas('Left',width,height);var canvasRight=self.prepareCanvas('Right',width,height);var canvasLoops=self.prepareCanvas('Loops',width,height);self.canvas=new Piwik_Transitions_Canvas(canvasBgLeft,canvasBgRight,canvasLeft,canvasRight,canvasLoops,width,height);self.centerBox=self.popover.find('#Transitions_CenterBox');var title=self.actionName;if(self.actionType=='url'){title=Piwik_Transitions_Util.shortenUrl(title,true);}
var h2=self.centerBox.find('h2');var textContainer=h2;if(self.actionType=='url'){var a=$(document.createElement('a'));a.attr('href',self.actionName);a.attr('rel','noreferrer noopener');a.attr('target','_blank');h2.append(a);textContainer=a;}
textContainer.addClass('Transitions_ApplyTextAndTruncate').data('text',title).data('maxLines',3);var element=textContainer.add(self.popover.find('p.Transitions_Pageviews'));element.tooltip({track:true,content:function(){var totalNbPageviews=self.model.getTotalNbPageviews();if(totalNbPageviews>0){var share=NumberFormatter.formatPercent(Math.round(self.model.pageviews / totalNbPageviews*1000)/ 10);var text=Piwik_Transitions_Translations.ShareOfAllPageviews;text=sprintf(text,NumberFormatter.formatNumber(self.model.pageviews),share);text+='<br /><em>'+Piwik_Transitions_Translations.DateRange+' '+self.model.date+'</em>';var title='<h3>'+piwikHelper.addBreakpointsToUrl(self.actionName)+'</h3>';return title+text;}
return false;},items:'*',tooltipClass:'Transitions_Tooltip_Small',show:false,hide:false});};Piwik_Transitions.prototype.prepareCanvas=function(canvasId,width,height){canvasId='Transitions_Canvas_'+canvasId;var div=$('#'+canvasId).width(width).height(height);var canvas;if(typeof Piwik_Transitions.canvasCache=='undefined'||typeof window.G_vmlCanvasManager!="undefined"){Piwik_Transitions.canvasCache={};}
if(typeof Piwik_Transitions.canvasCache[canvasId]=='undefined'){Piwik_Transitions.canvasCache[canvasId]=document.createElement('canvas');canvas=Piwik_Transitions.canvasCache[canvasId];canvas.width=width;canvas.height=height;}else{canvas=Piwik_Transitions.canvasCache[canvasId];canvas.getContext('2d').clearRect(0,0,width,height);}
div.append(canvas);return canvas;};Piwik_Transitions.prototype.render=function(){this.renderCenterBox();this.renderLeftSide();this.renderRightSide();this.renderLoops();};Piwik_Transitions.prototype.renderLeftSide=function(onlyBg){this.renderGroups(this.leftGroups,this.leftOpenGroup,'left',onlyBg);this.renderEntries(onlyBg);this.reRenderIfNeededToCenter('left',onlyBg);};Piwik_Transitions.prototype.renderRightSide=function(onlyBg){this.renderGroups(this.rightGroups,this.rightOpenGroup,'right',onlyBg);this.renderExits(onlyBg);this.reRenderIfNeededToCenter('right',onlyBg);};Piwik_Transitions.prototype.renderGroups=function(groups,openGroup,side,onlyBg){for(var i=0;i<groups.length;i++){var groupName=groups[i];if(groupName==openGroup){if(i!=0){var spacing=this.canvas.isNarrowMode()?7:13;this.canvas.addBoxSpacing(spacing,side);}
this.renderOpenGroup(groupName,side,onlyBg);}else{this.renderClosedGroup(groupName,side,onlyBg);}}
this.canvas.addBoxSpacing(13,side);};Piwik_Transitions.prototype.reRenderIfNeededToCenter=function(side,onlyBg){var height=(side=='left'?this.canvas.leftBoxPositionY:this.canvas.rightBoxPositionY)-20;if(height<460&&!this.reRendering){var yOffset=(460-height)/ 2;this.canvas.clearSide(side,onlyBg);this.canvas.addBoxSpacing(yOffset,side);this.reRendering=true;side=='left'?this.renderLeftSide(onlyBg):this.renderRightSide(onlyBg);this.reRendering=false;}};Piwik_Transitions.prototype.renderCenterBox=function(){var box=this.centerBox;Piwik_Transitions_Util.replacePlaceholderInHtml(box.find('.Transitions_Pageviews'),NumberFormatter.formatNumber(this.model.pageviews));var self=this;var showMetric=function(cssClass,modelProperty,highlightCurveOnSide,groupCanBeExpanded){var el=box.find('.Transitions_'+cssClass);Piwik_Transitions_Util.replacePlaceholderInHtml(el,NumberFormatter.formatNumber(self.model[modelProperty]));if(self.model[modelProperty]==0){el.addClass('Transitions_Value0');}else{self.addTooltipShowingPercentageOfAllPageviews(el,modelProperty);var groupName=cssClass.charAt(0).toLowerCase()+cssClass.substr(1);el.hover(function(){self.highlightGroup(groupName,highlightCurveOnSide);},function(){self.unHighlightGroup(groupName,highlightCurveOnSide);});if(groupCanBeExpanded){el.click(function(){self.openGroup(highlightCurveOnSide,groupName);}).css('cursor','pointer');}}};showMetric('DirectEntries','directEntries','left',false);showMetric('PreviousSiteSearches','previousSiteSearchesNbTransitions','left',true);showMetric('PreviousPages','previousPagesNbTransitions','left',true);showMetric('SearchEngines','searchEnginesNbTransitions','left',true);showMetric('SocialNetworks','socialNetworksNbTransitions','left',true);showMetric('Websites','websitesNbTransitions','left',true);showMetric('Campaigns','campaignsNbTransitions','left',true);showMetric('FollowingPages','followingPagesNbTransitions','right',true);showMetric('FollowingSiteSearches','followingSiteSearchesNbTransitions','right',true);showMetric('Outlinks','outlinksNbTransitions','right',true);showMetric('Downloads','downloadsNbTransitions','right',true);showMetric('Exits','exits','right',false);box.find('.Transitions_CenterBoxMetrics').show();};Piwik_Transitions.prototype.addTooltipShowingPercentageOfAllPageviews=function(element,metric){var tip=Piwik_Transitions_Translations.XOfAllPageviews;var percentage=this.model.getPercentage(metric,true);tip=sprintf(tip,'<strong>'+percentage+'</strong>');element.tooltip({track:true,content:tip,items:'*',tooltipClass:'Transitions_Tooltip_Small',show:false,hide:false});};Piwik_Transitions.prototype.renderLoops=function(){if(this.model.loops==0){return;}
var loops=this.popover.find('#Transitions_Loops').show();Piwik_Transitions_Util.replacePlaceholderInHtml(loops,NumberFormatter.formatNumber(this.model.loops));this.addTooltipShowingPercentageOfAllPageviews(loops,'loops');this.canvas.renderLoops(this.model.getPercentage('loops'));};Piwik_Transitions.prototype.renderEntries=function(onlyBg){if(this.model.directEntries>0){var self=this;var isHighlighted=this.highlightedGroup=='directEntries';var gradient=this.canvas.createHorizontalGradient('entries','left',isHighlighted);this.canvas.renderBox({side:'left',onlyBg:onlyBg,share:this.model.getPercentage('directEntries'),gradient:gradient,boxText:Piwik_Transitions_Translations.directEntries,boxTextNumLines:1,boxTextCssClass:'SingleLine',smallBox:true,onMouseOver:function(){self.highlightGroup('directEntries','left');},onMouseOut:function(){self.unHighlightGroup('directEntries','left');}});this.canvas.addBoxSpacing(20,'left');}};Piwik_Transitions.prototype.renderExits=function(onlyBg){if(this.model.exits>0){var self=this;var isHighlighted=this.highlightedGroup=='exits';var gradient=this.canvas.createHorizontalGradient('exits','right',isHighlighted);this.canvas.renderBox({side:'right',onlyBg:onlyBg,share:this.model.getPercentage('exits'),gradient:gradient,boxText:Piwik_Transitions_Translations.exits,boxTextNumLines:1,boxTextCssClass:'SingleLine',smallBox:true,onMouseOver:function(){self.highlightGroup('exits','right');},onMouseOut:function(){self.unHighlightGroup('exits','right');}});this.canvas.addBoxSpacing(20,'right');}};Piwik_Transitions.prototype.renderOpenGroup=function(groupName,side,onlyBg){var self=this;var nbTransitionsVarName=groupName+'NbTransitions';var nbTransitions=self.model[nbTransitionsVarName];if(nbTransitions==0){return;}
var totalShare=this.model.getPercentage(nbTransitionsVarName);var details=self.model.getDetailsForGroup(groupName);var gradientItems=this.canvas.createHorizontalGradient('items',side);var gradientOthers=this.canvas.createHorizontalGradient('others',side);var gradientBackground=this.canvas.createHorizontalGradient('background',side,groupName==this.highlightedGroup);var boxPositionBefore,curvePositionBefore;if(side=='left'){boxPositionBefore=this.canvas.leftBoxPositionY;curvePositionBefore=this.canvas.leftCurvePositionY;}else{boxPositionBefore=this.canvas.rightBoxPositionY;curvePositionBefore=this.canvas.rightCurvePositionY;}
var titleX,titleClass;if(side=='left'){titleX=this.canvas.leftBoxBeginX+10;titleClass='BoxTextLeft';}else{titleX=this.canvas.rightBoxBeginX-1;titleClass='BoxTextRight';}
if(!onlyBg){var groupTitle=self.model.getGroupTitle(groupName);var titleEl=this.canvas.renderText(groupTitle,titleX,boxPositionBefore+11,[titleClass,'TitleOfOpenGroup']);titleEl.hover(function(){self.highlightGroup(groupName,side);},function(){self.unHighlightGroup(groupName,side);});}
this.canvas.addBoxSpacing(34,side);for(var i=0;i<details.length;i++){var data=details[i];var label=(typeof data.url!='undefined'?data.url:data.label);label=(typeof label!='undefined'&&label!==null?label:'');var isOthers=(label=='Others');var onClick=false;if(!isOthers&&(groupName=='previousPages'||groupName=='followingPages')){if(this.showEmbeddedInReport){onClick=(function(url){return function(){var $rootScope=piwikHelper.getAngularDependency('$rootScope');if($rootScope){$rootScope.$emit('Transitions.switchTransitionsUrl',{url:url});}};})(label);}else{onClick=(function(url){return function(){self.reloadPopover(url.replace(/^(?!http)/,'http://'));};})(label);}}else if(!isOthers&&(groupName=='outlinks'||groupName=='websites'||groupName=='downloads')){onClick=label}
var tooltip=Piwik_Transitions_Translations.XOfY;tooltip='<strong>'+sprintf(tooltip,data.referrals,nbTransitions)+'</strong>';tooltip=this.model.getShareInGroupTooltip(tooltip,groupName);var fullLabel=label;var shortened=false;if((this.actionType=='url'&&(groupName=='previousPages'||groupName=='followingPages'))||groupName=='downloads'){label=Piwik_Transitions_Util.shortenUrl(label,true);shortened=true;}else if(groupName=='outlinks'||groupName=='websites'){label=Piwik_Transitions_Util.shortenUrl(label);shortened=true;}
this.canvas.renderBox({side:side,onlyBg:onlyBg,share:data.percentage / 100*totalShare,gradient:isOthers?gradientOthers:gradientItems,boxText:label,boxTextTooltip:isOthers||!shortened?false:fullLabel,boxTextNumLines:3,curveText:NumberFormatter.formatPercent(data.percentage),curveTextTooltip:tooltip,onClick:onClick});}
var boxPositionAfter,curvePositionAfter;if(side=='left'){boxPositionAfter=this.canvas.leftBoxPositionY;curvePositionAfter=this.canvas.leftCurvePositionY;this.canvas.leftBoxPositionY=boxPositionBefore;this.canvas.leftCurvePositionY=curvePositionBefore;}else{boxPositionAfter=this.canvas.rightBoxPositionY;curvePositionAfter=this.canvas.rightCurvePositionY;this.canvas.rightBoxPositionY=boxPositionBefore;this.canvas.rightCurvePositionY=curvePositionBefore;}
this.canvas.renderBox({side:side,boxHeight:boxPositionAfter-boxPositionBefore-this.canvas.boxSpacing-2,curveHeight:curvePositionAfter-curvePositionBefore-this.canvas.curveSpacing,gradient:gradientBackground,bgCanvas:true});var spacing=this.canvas.isNarrowMode()?8:15;this.canvas.addBoxSpacing(spacing,side);};Piwik_Transitions.prototype.renderClosedGroup=function(groupName,side,onlyBg){var self=this;var isHighlighted=groupName==this.highlightedGroup;var gradient=this.canvas.createHorizontalGradient('closed-group',side,isHighlighted);var nbTransitionsVarName=groupName+'NbTransitions';if(self.model[nbTransitionsVarName]==0){return;}
self.canvas.renderBox({side:side,onlyBg:onlyBg,share:self.model.getPercentage(nbTransitionsVarName),gradient:gradient,boxText:self.model.getGroupTitle(groupName),boxTextNumLines:1,boxTextCssClass:'SingleLine',boxIcon:'plugins/Morpheus/images/plus_blue.png',smallBox:true,onClick:function(){self.unHighlightGroup(groupName,side);self.openGroup(side,groupName);},onMouseOver:function(){self.highlightGroup(groupName,side);},onMouseOut:function(){self.unHighlightGroup(groupName,side);}});};Piwik_Transitions.prototype.reloadPopover=function(url){if(this.rowAction){this.rowAction.openPopover(this.actionType+':'+url);}else{this.reset(this.actionType,url);this.showPopover();}};Piwik_Transitions.prototype.openGroup=function(side,groupName){this.canvas.clearSide(side);if(side=='left'){this.leftOpenGroup=groupName;this.renderLeftSide();}else{this.rightOpenGroup=groupName;this.renderRightSide();}
this.renderLoops();this.canvas.truncateVisibleBoxTexts();};Piwik_Transitions.prototype.highlightGroup=function(groupName,side){if(this.highlightedGroup==groupName){return;}
if(this.highlightedGroup!==false){this.unHighlightGroup(this.highlightedGroup,this.highlightedGroupSide);}
this.highlightedGroup=groupName;this.highlightedGroupSide=side;var cssClass='Transitions_'+groupName.charAt(0).toUpperCase()+groupName.substr(1);this.highlightedGroupCenterEl=this.canvas.container.find('.'+cssClass);this.highlightedGroupCenterEl.addClass('Transitions_Highlighted');this.canvas.clearSide(side,true);if(side=='left'){this.renderLeftSide(true);}else{this.renderRightSide(true);}
this.renderLoops();};Piwik_Transitions.prototype.unHighlightGroup=function(groupName,side){if(this.highlightedGroup===false){return;}
this.highlightedGroupCenterEl.removeClass('Transitions_Highlighted');this.highlightedGroup=false;this.highlightedGroupSide=false;this.highlightedGroupCenterEl=false;this.canvas.clearSide(side,true);if(side=='left'){this.renderLeftSide(true);}else{this.renderRightSide(true);}
this.renderLoops();};function Piwik_Transitions_Canvas(canvasBgLeft,canvasBgRight,canvasLeft,canvasRight,canvasLoops,width,height){if(typeof window.G_vmlCanvasManager!="undefined"){window.G_vmlCanvasManager.initElement(canvasBgLeft);window.G_vmlCanvasManager.initElement(canvasBgRight);window.G_vmlCanvasManager.initElement(canvasLeft);window.G_vmlCanvasManager.initElement(canvasRight);window.G_vmlCanvasManager.initElement(canvasLoops);}
if(!canvasBgLeft.getContext){alert('Your browser is not supported.');return;}
this.container=$(canvasBgLeft).parent().parent();this.contextBgLeft=canvasBgLeft.getContext('2d');this.contextBgRight=canvasBgRight.getContext('2d');this.contextLeft=canvasLeft.getContext('2d');this.contextRight=canvasRight.getContext('2d');this.contextLoops=canvasLoops.getContext('2d');this.width=width;this.height=height;this.leftBoxPositionY=this.originalBoxPositionY=0;this.leftCurvePositionY=this.originalCurvePositionY=110;this.rightBoxPositionY=this.originalBoxPositionY;this.rightCurvePositionY=this.originalCurvePositionY;this.boxWidth=175;this.boxHeight=53;this.smallBoxHeight=30;this.curveWidth=170;this.lineHeight=14;this.boxSpacing=7;this.curveSpacing=1.5;this.totalHeightOfConnections=205;this.leftBoxBeginX=0;this.leftCurveBeginX=this.leftBoxBeginX+this.boxWidth;this.leftCurveEndX=this.leftCurveBeginX+this.curveWidth;this.rightBoxEndX=this.width;this.rightBoxBeginX=this.rightCurveEndX=this.rightBoxEndX-this.boxWidth;this.rightCurveBeginX=this.rightCurveEndX-this.curveWidth;this.colors={};var transitionsColorNamespaces=['entries','exits','background','closed-group','items','others','loops'];var gradientColorNames=['light','dark','light-highlighted','dark-highlighted'];for(var i=0;i!=transitionsColorNamespaces.length;++i){var namespace='transition-'+transitionsColorNamespaces[i];this.colors[namespace]=piwik.ColorManager.getColors(namespace,gradientColorNames);}}
Piwik_Transitions_Canvas.prototype.narrowMode=function(){this.smallBoxHeight=26;this.boxSpacing=4;this.narrowMode=true;};Piwik_Transitions_Canvas.prototype.isNarrowMode=function(){return typeof this.narrowMode!='undefined';};Piwik_Transitions_Canvas.prototype.createHorizontalGradient=function(colorGroup,position,isHighlighted){var fromX,toX,fromColor,toColor,lightColor,darkColor;colorGroup='transition-'+colorGroup;if(isHighlighted){lightColor=this.colors[colorGroup]['light-highlighted'];darkColor=this.colors[colorGroup]['dark-highlighted'];}else{lightColor=this.colors[colorGroup]['light'];darkColor=this.colors[colorGroup]['dark'];}
if(position=='left'){fromX=this.leftBoxBeginX+50;toX=this.leftCurveEndX-20;fromColor=lightColor;toColor=darkColor;}else{fromX=this.rightCurveBeginX+20;toX=this.rightBoxEndX-50;fromColor=darkColor;toColor=lightColor;}
var gradient=this.contextBgLeft.createLinearGradient(fromX,0,toX,0);gradient.addColorStop(0,fromColor);gradient.addColorStop(1,toColor);return gradient;};Piwik_Transitions_Canvas.prototype.renderText=function(text,x,y,cssClass,onClick,icon,maxLines){var div=this.addDomElement('div','Text');div.css({left:x+'px',top:y+'px'});if(icon){div.addClass('Transitions_HasBackground');div.css({backgroundImage:'url('+icon+')'});}
if(cssClass){if(typeof cssClass=='object'){for(var i=0;i<cssClass.length;i++){div.addClass('Transitions_'+cssClass[i]);}}else{div.addClass('Transitions_'+cssClass);}}
var textContainer=div;if(onClick){if(typeof onClick=='function'){div.css('cursor','pointer').hover(function(){$(this).addClass('Transitions_Hover');},function(){$(this).removeClass('Transitions_Hover');}).click(onClick);}else{var a=$(document.createElement('a'));a.attr('href',onClick);a.attr('rel','noreferrer noopener');a.attr('target','_blank');div.append(a);textContainer=a;}}
if(maxLines){textContainer.addClass('Transitions_ApplyTextAndTruncate').data('text',text);}else{textContainer.html(text);}
return div;};Piwik_Transitions_Canvas.prototype.addDomElement=function(tagName,cssClass){var el=$(document.createElement('div')).addClass('Transitions_'+cssClass);this.container.append(el);return el;};Piwik_Transitions_Canvas.prototype.truncateVisibleBoxTexts=function(){this.container.find('.Transitions_ApplyTextAndTruncate').each(function(){var container=$(this).html('<span>');var span=container.find('span');var text=container.data('text');span.html(piwikHelper.addBreakpointsToUrl(text));var divHeight=container.innerHeight();if(container.data('maxLines')){divHeight=container.data('maxLines')*(parseInt(container.css('lineHeight'),10)+.2);}
var leftPart=false;var rightPart=false;while(divHeight<span.outerHeight()){if(leftPart===false){var middle=Math.round(text.length / 2);leftPart=text.substring(0,middle);rightPart=text.substring(middle,text.length);}
leftPart=leftPart.substring(0,leftPart.length-2);rightPart=rightPart.substring(2,rightPart.length);text=leftPart+'...'+rightPart;span.html(piwikHelper.addBreakpointsToUrl(text));}
span.removeClass('Transitions_Truncate');});};Piwik_Transitions_Canvas.prototype.renderBox=function(params){var curveHeight=params.curveHeight?params.curveHeight:Math.round(this.totalHeightOfConnections*params.share);curveHeight=Math.max(curveHeight,1);var boxHeight=this.boxHeight;if(params.smallBox){boxHeight=this.smallBoxHeight;}
if(params.boxHeight){boxHeight=params.boxHeight;}
var context;if(params.bgCanvas){context=params.side=='left'?this.contextBgLeft:this.contextBgRight;}else{context=params.side=='left'?this.contextLeft:this.contextRight;}
context.fillStyle=params.gradient;context.beginPath();if(params.side=='left'){this.renderLeftBoxBg(context,boxHeight,curveHeight);}else{this.renderRightBoxBg(context,boxHeight,curveHeight);}
if(typeof context.endPath=='function'){context.endPath();}
if(params.boxText&&!params.onlyBg){var onClick=params.onClick;var boxTextLeft,boxTextTop,el;if(params.side=='left'){boxTextLeft=this.leftBoxBeginX+10;boxTextTop=this.leftBoxPositionY+boxHeight / 2-params.boxTextNumLines*this.lineHeight / 2;el=this.renderText(params.boxText,boxTextLeft,boxTextTop,'BoxTextLeft',onClick,params.boxIcon,params.boxTextNumLines);}else{boxTextLeft=this.rightBoxBeginX;boxTextTop=this.rightBoxPositionY+boxHeight / 2-params.boxTextNumLines*this.lineHeight / 2;el=this.renderText(params.boxText,boxTextLeft,boxTextTop,'BoxTextRight',onClick,params.boxIcon,params.boxTextNumLines);}
if(params.boxTextCssClass){el.addClass('Transitions_'+params.boxTextCssClass);}
if(params.boxTextTooltip){var tip=piwikHelper.addBreakpointsToUrl(params.boxTextTooltip);el.tooltip({track:true,content:tip,items:'*',tooltipClass:'Transitions_Tooltip_Small',show:false,hide:false});}
if(typeof params.onMouseOver=='function'){el.mouseenter(params.onMouseOver);}
if(typeof params.onMouseOut=='function'){el.mouseleave(params.onMouseOut);}}
if(params.curveText&&!params.onlyBg){var curveTextLeft,curveTextTop;if(params.side=='left'){curveTextLeft=this.leftBoxBeginX+this.boxWidth+3;curveTextTop=this.leftBoxPositionY+boxHeight / 2-this.lineHeight / 2;}else{curveTextLeft=this.rightBoxBeginX-37;curveTextTop=this.rightBoxPositionY+boxHeight / 2-this.lineHeight / 2;}
var textDiv=this.renderText(params.curveText,curveTextLeft,curveTextTop,params.side=='left'?'CurveTextLeft':'CurveTextRight');if(params.curveTextTooltip){textDiv.tooltip({track:true,content:params.curveTextTooltip,items:'*',tooltipClass:'Transitions_Tooltip_Small',show:false,hide:false});}}
if(params.side=='left'){this.leftBoxPositionY+=boxHeight+this.boxSpacing;this.leftCurvePositionY+=curveHeight+this.curveSpacing;}else{this.rightBoxPositionY+=boxHeight+this.boxSpacing;this.rightCurvePositionY+=curveHeight+this.curveSpacing;}};Piwik_Transitions_Canvas.prototype.renderLeftBoxBg=function(context,boxHeight,curveHeight){var leftUpper={x:this.leftCurveBeginX,y:this.leftBoxPositionY};var leftLower={x:this.leftCurveBeginX,y:this.leftBoxPositionY+boxHeight};var rightUpper={x:this.leftCurveEndX,y:this.leftCurvePositionY};var rightLower={x:this.leftCurveEndX,y:this.leftCurvePositionY+curveHeight};var center=(this.leftCurveBeginX+this.leftCurveEndX)/ 2;var cp1Upper={x:center,y:leftUpper.y};var cp2Upper={x:center,y:rightUpper.y};var cp1Lower={x:center,y:rightLower.y};var cp2Lower={x:center,y:leftLower.y};context.moveTo(leftUpper.x,leftUpper.y);context.bezierCurveTo(cp1Upper.x,cp1Upper.y,cp2Upper.x,cp2Upper.y,rightUpper.x,rightUpper.y);context.lineTo(rightLower.x,rightLower.y);context.bezierCurveTo(cp1Lower.x,cp1Lower.y,cp2Lower.x,cp2Lower.y,leftLower.x,leftLower.y);context.lineTo(leftLower.x-this.boxWidth+2,leftLower.y);context.lineTo(leftLower.x-this.boxWidth,leftUpper.y);context.lineTo(leftUpper.x,leftUpper.y);context.fill();};Piwik_Transitions_Canvas.prototype.renderRightBoxBg=function(context,boxHeight,curveHeight){var leftUpper={x:this.rightCurveBeginX,y:this.rightCurvePositionY};var leftLower={x:this.rightCurveBeginX,y:this.rightCurvePositionY+curveHeight};var rightUpper={x:this.rightCurveEndX,y:this.rightBoxPositionY};var rightLower={x:this.rightCurveEndX,y:this.rightBoxPositionY+boxHeight};var center=(this.rightCurveBeginX+this.rightCurveEndX)/ 2;var cp1Upper={x:center,y:leftUpper.y};var cp2Upper={x:center,y:rightUpper.y};var cp1Lower={x:center,y:rightLower.y};var cp2Lower={x:center,y:leftLower.y};context.moveTo(leftUpper.x,leftUpper.y);context.bezierCurveTo(cp1Upper.x,cp1Upper.y,cp2Upper.x,cp2Upper.y,rightUpper.x,rightUpper.y);context.lineTo(rightUpper.x+this.boxWidth,rightUpper.y);context.lineTo(rightLower.x+this.boxWidth-2,rightLower.y);context.lineTo(rightLower.x,rightLower.y);context.bezierCurveTo(cp1Lower.x,cp1Lower.y,cp2Lower.x,cp2Lower.y,leftLower.x,leftLower.y);context.lineTo(leftUpper.x,leftUpper.y);context.fill();};Piwik_Transitions_Canvas.prototype.addBoxSpacing=function(spacing,side){if(side=='left'){this.leftBoxPositionY+=spacing;}else{this.rightBoxPositionY+=spacing;}};Piwik_Transitions_Canvas.prototype.renderLoops=function(share){var curveHeight=Math.round(this.totalHeightOfConnections*share);curveHeight=Math.max(curveHeight,1);var gradient=this.contextLoops.createLinearGradient(this.leftCurveEndX-50,0,this.rightCurveBeginX+50,0);var light=this.colors['transition-loops']['light'];var dark=this.colors['transition-loops']['dark'];gradient.addColorStop(0,dark);gradient.addColorStop(.5,light);gradient.addColorStop(1,dark);this.contextLoops.fillStyle=gradient;this.contextLoops.beginPath();var point1={x:this.leftCurveEndX,y:this.leftCurvePositionY};var point2={x:this.leftCurveEndX,y:470};var cpLeftX=(this.leftCurveBeginX+this.leftCurveEndX)/ 2+30;var cp1={x:cpLeftX,y:point1.y};var cp2={x:cpLeftX,y:point2.y};this.contextLoops.moveTo(point1.x,point1.y);this.contextLoops.bezierCurveTo(cp1.x,cp1.y,cp2.x,cp2.y,point2.x,point2.y);var point3={x:this.rightCurveBeginX,y:point2.y};this.contextLoops.lineTo(point3.x,point3.y);var point4={x:this.rightCurveBeginX,y:this.rightCurvePositionY};var cpRightX=(this.rightCurveBeginX+this.rightCurveEndX)/ 2-30;var cp3={x:cpRightX,y:point3.y};var cp4={x:cpRightX,y:point4.y};this.contextLoops.bezierCurveTo(cp3.x,cp3.y,cp4.x,cp4.y,point4.x,point4.y);var point5={x:point4.x,y:point4.y+curveHeight};this.contextLoops.lineTo(point5.x,point5.y);var point6={x:point5.x,y:point2.y-25};cpRightX-=30;var cp5={x:cpRightX,y:point5.y};var cp6={x:cpRightX,y:point6.y};this.contextLoops.bezierCurveTo(cp5.x,cp5.y,cp6.x,cp6.y,point6.x,point6.y);var point7={x:point1.x,y:point6.y};this.contextLoops.lineTo(point7.x,point7.y);var point8={x:point1.x,y:point1.y+curveHeight};cpLeftX+=30;var cp7={x:cpLeftX,y:point7.y};var cp8={x:cpLeftX,y:point8.y};this.contextLoops.bezierCurveTo(cp7.x,cp7.y,cp8.x,cp8.y,point8.x,point8.y);this.contextLoops.fill();if(typeof this.contextLoops.endPath=='function'){this.contextLoops.endPath();}};Piwik_Transitions_Canvas.prototype.clearSide=function(side,onlyBg){if(side=='left'){this.contextBgLeft.clearRect(0,0,this.width,this.height);this.contextLeft.clearRect(0,0,this.width,this.height);}else{this.contextBgRight.clearRect(0,0,this.width,this.height);this.contextRight.clearRect(0,0,this.width,this.height);}
this.contextLoops.clearRect(0,0,this.width,this.height);if(side=='left'){if(!onlyBg){this.container.find('.Transitions_BoxTextLeft').remove();this.container.find('.Transitions_CurveTextLeft').remove();}
this.leftBoxPositionY=this.originalBoxPositionY;this.leftCurvePositionY=this.originalCurvePositionY;}else{if(!onlyBg){this.container.find('.Transitions_BoxTextRight').remove();this.container.find('.Transitions_CurveTextRight').remove();}
this.rightBoxPositionY=this.originalBoxPositionY;this.rightCurvePositionY=this.originalCurvePositionY;}};function Piwik_Transitions_Model(ajax){this.ajax=ajax;this.groupTitles={};}
Piwik_Transitions_Model.prototype.htmlLoaded=function(){this.groupTitles.previousPages=Piwik_Transitions_Translations.fromPreviousPages;this.groupTitles.previousSiteSearches=Piwik_Transitions_Translations.fromPreviousSiteSearches;this.groupTitles.followingPages=Piwik_Transitions_Translations.toFollowingPages;this.groupTitles.followingSiteSearches=Piwik_Transitions_Translations.toFollowingSiteSearches;this.groupTitles.outlinks=Piwik_Transitions_Translations.outlinks;this.groupTitles.downloads=Piwik_Transitions_Translations.downloads;this.shareInGroupTexts={previousPages:Piwik_Transitions_Translations.fromPreviousPagesInline,previousSiteSearches:Piwik_Transitions_Translations.fromPreviousSiteSearchesInline,followingPages:Piwik_Transitions_Translations.toFollowingPagesInline,followingSiteSearches:Piwik_Transitions_Translations.toFollowingSiteSearchesInline,searchEngines:Piwik_Transitions_Translations.fromSearchEnginesInline,socialNetworks:Piwik_Transitions_Translations.fromSocialNetworksInline,websites:Piwik_Transitions_Translations.fromWebsitesInline,campaigns:Piwik_Transitions_Translations.fromCampaignsInline,outlinks:Piwik_Transitions_Translations.outlinksInline,downloads:Piwik_Transitions_Translations.downloadsInline};};Piwik_Transitions_Model.prototype.loadData=function(actionType,actionName,overrideParams,callback){var self=this;this.pageviews=0;this.exits=0;this.loops=0;this.directEntries=0;this.searchEnginesNbTransitions=0;this.searchEngines=[];this.socialNetworksNbTransitions=0;this.socialNetworks=[];this.websitesNbTransitions=0;this.websites=[];this.campaignsNbTransitions=0;this.campaigns=[];this.previousPagesNbTransitions=0;this.previousPages=[];this.followingPagesNbTransitions=0;this.followingPages=[];this.downloadsNbTransitions=0;this.downloads=[];this.outlinksNbTransitions=0;this.outlinks=[];this.previousSiteSearchesNbTransitions=0;this.previousSiteSearches=[];this.followingSiteSearchesNbTransitions=0;this.followingSiteSearches=[];this.date='';var params={actionType:actionType,actionName:actionName,expanded:1};if(overrideParams){$.extend(params,overrideParams);}
this.ajax.callApi('Transitions.getTransitionsForAction',params,function(report){self.date=report.date;self.pageviews=report.pageMetrics.pageviews;self.loops=report.pageMetrics.loops;self.exits=report.pageMetrics.exits;for(var i=0;i<report.referrers.length;i++){var referrer=report.referrers[i];if(referrer.shortName=='direct'){self.directEntries=referrer.visits;}else if(referrer.shortName=='search'){self.searchEnginesNbTransitions=referrer.visits;self.searchEngines=referrer.details;self.groupTitles.searchEngines=referrer.label;}else if(referrer.shortName=='social'){self.socialNetworksNbTransitions=referrer.visits;self.socialNetworks=referrer.details;self.groupTitles.socialNetworks=referrer.label;}else if(referrer.shortName=='website'){self.websitesNbTransitions=referrer.visits;self.websites=referrer.details;self.groupTitles.websites=referrer.label;}else if(referrer.shortName=='campaign'){self.campaignsNbTransitions=referrer.visits;self.campaigns=referrer.details;self.groupTitles.campaigns=referrer.label;}}
self.loadAndSumReport(report,'previousPages');self.loadAndSumReport(report,'previousSiteSearches');self.loadAndSumReport(report,'followingPages');self.loadAndSumReport(report,'followingSiteSearches');self.loadAndSumReport(report,'downloads');self.loadAndSumReport(report,'outlinks');if(typeof Piwik_Transitions_Model.totalNbPageviews=='undefined'){Piwik_Transitions_Model.totalNbPageviews=false;self.ajax.loadTotalNbPageviews(function(nbPageviews){Piwik_Transitions_Model.totalNbPageviews=nbPageviews;});}
callback();});};Piwik_Transitions_Model.prototype.loadAndSumReport=function(apiData,reportName){var data=this[reportName]=apiData[reportName];var sumVarName=reportName+'NbTransitions';this[sumVarName]=0;for(var i=0;i<data.length;i++){this[sumVarName]+=data[i].referrals;}};Piwik_Transitions_Model.prototype.getTotalNbPageviews=function(){if(typeof Piwik_Transitions_Model.totalNbPageviews=='undefined'){return false;}
return Piwik_Transitions_Model.totalNbPageviews;};Piwik_Transitions_Model.prototype.getGroupTitle=function(groupName){if(typeof this.groupTitles[groupName]!='undefined'){return this.groupTitles[groupName];}
return groupName;};Piwik_Transitions_Model.prototype.getShareInGroupTooltip=function(share,groupName){var tip=this.shareInGroupTexts[groupName];return sprintf(tip,share);};Piwik_Transitions_Model.prototype.getDetailsForGroup=function(groupName){return this.addPercentagesToData(this[groupName]);};Piwik_Transitions_Model.prototype.getPercentage=function(metric,formatted){var percentage=(this.pageviews==0?0:this[metric]/ this.pageviews);if(formatted){percentage=this.roundPercentage(percentage);return NumberFormatter.formatPercent(percentage);}
return percentage;};Piwik_Transitions_Model.prototype.addPercentagesToData=function(data){var total=0;for(var i=0;i<data.length;i++){total+=parseInt(data[i].referrals,10);}
for(i=0;i<data.length;i++){data[i].percentage=this.roundPercentage(data[i].referrals / total);}
return data;};Piwik_Transitions_Model.prototype.roundPercentage=function(value){if(value<.1){return Math.round(value*1000)/ 10.0;}else{return Math.round(value*100);}};function Piwik_Transitions_Ajax(){}
Piwik_Transitions_Ajax.prototype.loadTotalNbPageviews=function(callback){this.callApi('Actions.get',{columns:'nb_pageviews'},function(response){var value=typeof response.value!='undefined'?response.value:false;callback(value);});};Piwik_Transitions_Ajax.prototype.callTransitionsController=function(action,callback){var ajaxRequest=new ajaxHelper();ajaxRequest.addParams({module:'Transitions',action:action},'get');ajaxRequest.setCallback(callback);ajaxRequest.setFormat('html');ajaxRequest.send();};Piwik_Transitions_Ajax.prototype.callApi=function(method,params,callback){var self=this;params.format='JSON';params.module='API';params.method=method;params.filter_limit='-1';var ajaxRequest=new ajaxHelper();ajaxRequest.addParams(params,'get');ajaxRequest.useCallbackInCaseOfError();ajaxRequest.setCallback(function(result){if(typeof result.result!='undefined'&&result.result=='error'){var errorName=result.message;var showError=function(){var errorTitle,errorMessage,errorBack;if(typeof Piwik_Transitions_Translations[errorName]=='undefined'){errorTitle='Exception';errorMessage=errorName;errorBack='<<<';}else{errorTitle=Piwik_Transitions_Translations[errorName];errorMessage=Piwik_Transitions_Translations[errorName+'Details'];errorBack=Piwik_Transitions_Translations[errorName+'Back'];}
if(typeof params.actionName!='undefined'){var url=params.actionName;url=piwikHelper.addBreakpointsToUrl(url);errorTitle=sprintf(errorTitle,'<span>'+url+'</span>');}
errorMessage=sprintf(errorMessage,'<br />');var inlineErrorNode=$('#Transitions_Error_Container');if(inlineErrorNode.length){inlineErrorNode.html('');var theContentNode=$(document.createElement('div')).addClass('Piwik_Popover_Error');var p=$(document.createElement('p')).addClass('Piwik_Popover_Error_Title');theContentNode.append(p.html(errorTitle));if(errorMessage){p=$(document.createElement('p')).addClass('Piwik_Popover_Error_Message');theContentNode.append(p.html(errorMessage));}
inlineErrorNode.append(theContentNode);inlineErrorNode.show();$('#transitions_report .popoverContainer').hide();}else{Piwik_Popover.showError(errorTitle,errorMessage,errorBack);}
$('#transitions_inline_loading').hide();};if(typeof Piwik_Transitions_Translations=='undefined'){self.callApi('Transitions.getTranslations',{},function(response){if(typeof response[0]=='object'){Piwik_Transitions_Translations=response[0];}else{Piwik_Transitions_Translations={};}
showError();});}else{showError();}}
else{callback(result);}});ajaxRequest.send();};Piwik_Transitions_Util={shortenUrl:function(url,removeDomain){if(url=='Others'){return url;}
var urlBackup=url;url=url.replace(/http(s)?:\/\/(www\.)?/,'');if(urlBackup==url){return url;}
if(removeDomain){url=url.replace(/[^\/]*/,'');if(url=='/'){url=urlBackup;}}
url=url.replace(/\/$/,'');return url;},replacePlaceholderInHtml:function(container,value,spanClass){var span=container.find('span');if(!span.length){var html=container.html().replace(/%s/,'<span></span>');span=container.html(html).find('span');if(!spanClass){spanClass='Transitions_Metric';}
span.addClass(spanClass);}
if($.browser.msie&&parseFloat($.browser.version)<8){value+='&nbsp;';}
span.html(value);}};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('TransitionSwitcherController',TransitionSwitcherController);TransitionSwitcherController.$inject=['piwikApi','$filter','$rootScope'];function TransitionSwitcherController(piwikApi,$filter,$rootScope){var translate=$filter('translate');var self=this;this.actionType='Actions.getPageUrls';this.actionNameOptions=[];this.actionTypeOptions=[{key:'Actions.getPageUrls',value:translate('Actions_PageUrls')},{key:'Actions.getPageTitles',value:translate('Actions_WidgetPageTitles')}];this.isLoading=false;this.transitions=null;this.actionName=null;this.isEnabled=true;var noDataKey='_____ignore_____';this.detectActionName=function(reports){var othersLabel=translate('General_Others');var label,report;for(var i=0;i<reports.length;i++){if(!reports[i]){continue;}
report=reports[i];if(report.label===othersLabel){continue;}
var key=null;if(self.isUrlReport()){key=report.url}else{key=report.label;}
if(key){label=report.label+' ('+translate('Transitions_NumPageviews',report.nb_hits)+')';self.actionNameOptions.push({key:key,value:label,url:report.url});if(!self.actionName){self.actionName=key}}}}
this.isUrlReport=function(){return this.actionType==='Actions.getPageUrls';}
this.fetch=function(type){this.isLoading=true;this.actionNameOptions=[];this.actionName=null;piwikApi.fetch({method:type,flat:1,filter_limit:100,filter_sort_order:'desc',filter_sort_column:'nb_hits',showColumns:'label,nb_hits,url'}).then(function(report){self.isLoading=false;self.actionNameOptions=[];self.actionName=null;if(report&&report.length){self.isEnabled=true;self.detectActionName(report);self.onActionNameChange(self.actionName);}
if(null===self.actionName||self.actionNameOptions.length===0){self.isEnabled=false;self.actionName=noDataKey;self.actionNameOptions.push({key:noDataKey,value:translate('CoreHome_ThereIsNoDataForThisReport')});}},function(){self.isLoading=false;self.isEnabled=false;});}
this.onActionTypeChange=function(actionName){this.fetch(actionName);};this.onActionNameChange=function(actionName){if(actionName===null||actionName===noDataKey){return;}
var type='url';if(!this.isUrlReport()){type='title';}
if(!this.transitions){this.transitions=new Piwik_Transitions(type,actionName,null,'');}else{this.transitions.reset(type,actionName,'');}
this.transitions.showPopover(true);};$rootScope.$on('Transitions.switchTransitionsUrl',function(event,params){if(params&&params.url){if(self.isUrlReport()){params.url=params.url.replace('https://','').replace('http://','');}
var found=false,option,optionUrl;for(var i=0;i<self.actionNameOptions.length;i++){option=self.actionNameOptions[i];optionUrl=option.url;if(optionUrl&&self.isUrlReport()){optionUrl=String(optionUrl).replace('https://','').replace('http://','');}else{optionUrl=null;}
if(!found&&(option.key===params.url||(params.url===optionUrl&&optionUrl))){found=true;self.actionName=option.key;}}
if(!found){var options=angular.copy(self.actionNameOptions);options.push({key:params.url,value:params.url});self.actionNameOptions=options;self.actionName=params.url;}
self.onActionNameChange(self.actionName);}});this.fetch(this.actionType);}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('languageSelection',languageSelection);function languageSelection(){return{restrict:'C',link:function(scope,element,attr,ctrl){function postLanguageChange(){var value=$(this).attr('value');if(value){element.find('#language').val(value).parents('form').submit();}}
element.on('click','a[value]',postLanguageChange);scope.$on('$destroy',function(){element.off('click','a[value]',postLanguageChange);});}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('TranslationSearchController',TranslationSearchController);TranslationSearchController.$inject=['piwikApi'];function TranslationSearchController(piwikApi){function fetchTranslations(languageCode){piwikApi.fetch({method:'LanguagesManager.getTranslationsForLanguage',filter_limit:-1,languageCode:languageCode}).then(function(response){if(response){if(languageCode==='en'){vm.existingTranslations=response;}else{vm.compareTranslations={};angular.forEach(response,function(translation){vm.compareTranslations[translation.label]=translation.value;});}}});}
function fetchLanguages(){piwikApi.fetch({method:'LanguagesManager.getAvailableLanguagesInfo',filter_limit:-1}).then(function(languages){vm.languages=[{key:'',value:'None'}];if(languages){angular.forEach(languages,function(language){if(language.code==='en'){return;}
vm.languages.push({key:language.code,value:language.name});});}});}
var vm=this;vm.compareTranslations=null;vm.existingTranslations=[];vm.languages=[];vm.compareLanguage='';this.doCompareLanguage=function(){if(vm.compareLanguage){vm.compareTranslations=null;fetchTranslations(vm.compareLanguage);}};fetchTranslations('en');fetchLanguages();}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikTranslationSearch',piwikTranslationSearch);piwikTranslationSearch.$inject=['piwik'];function piwikTranslationSearch(piwik){return{restrict:'A',scope:{},templateUrl:'plugins/LanguagesManager/angularjs/translationsearch/translationsearch.directive.html?cb='+piwik.cacheBuster,controller:'TranslationSearchController',controllerAs:'translationSearch'};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($,require){var exports=require('piwik/UI'),DataTable=exports.DataTable,dataTablePrototype=DataTable.prototype;function getLevelFromClass(style){if(!style||typeof style=="undefined")return 0;var currentLevel=0;var currentLevelIndex=style.indexOf('level');if(currentLevelIndex>=0){currentLevel=Number(style.substr(currentLevelIndex+5,1));}
return currentLevel;}
function setImageMinus(domElem){$('img.plusMinus',domElem).attr('src','plugins/Morpheus/images/minus.png');}
function setImagePlus(domElem){$('img.plusMinus',domElem).attr('src','plugins/Morpheus/images/plus.png');}
exports.ActionsDataTable=function(element){this.parentAttributeParent='';this.parentId='';this.disabledRowDom={};DataTable.call(this,element);};$.extend(exports.ActionsDataTable.prototype,dataTablePrototype,{bindEventsAndApplyStyle:function(domElem,rows){var self=this;self.cleanParams();self.preBindEventsAndApplyStyleHook(domElem,rows);if(!rows){rows=$('tr',domElem);}
if(!self.param.filter_pattern_recursive){self.numberOfSubtables=rows.filter('.subDataTable').click(function(){self.onClickActionSubDataTable(this)}).length;}
self.applyCosmetics(domElem,rows);self.handleColumnHighlighting(domElem);self.handleRowActions(domElem,rows);self.handleLimit(domElem);self.handlePeriod(domElem);self.handleAnnotationsButton(domElem);self.handleExportBox(domElem);self.handleSort(domElem);self.handleOffsetInformation(domElem);if(self.workingDivId!=undefined){var dataTableLoadedProxy=function(response){self.dataTableLoaded(response,self.workingDivId);};self.handleConfigurationBox(domElem,dataTableLoadedProxy);self.handleSearchBox(domElem,dataTableLoadedProxy);}
self.handleColumnDocumentation(domElem);self.handleRelatedReports(domElem);self.handleTriggeredEvents(domElem);self.handleCellTooltips(domElem);self.setFixWidthToMakeEllipsisWork(domElem);self.handleSummaryRow(domElem);self.openSubtableFromLevel0IfOnlyOneSubtableGiven(domElem);self.postBindEventsAndApplyStyleHook(domElem,rows);},openSubtableFromLevel0IfOnlyOneSubtableGiven:function(domElem){var $subtables=domElem.find('.subDataTable');var hasOnlyOneSubtable=$subtables.length===1;if(hasOnlyOneSubtable){var hasOnlyOneRow=domElem.find('tbody tr.level0').length===1;if(hasOnlyOneRow){var $labels=$subtables.find('.label');if($labels.length){$labels.first().click();}}}},openSubtableFromSubtableIfOnlyOneSubtableGiven:function(domElem){var hasOnlyOneRow=domElem.length===1;var hasOnlyOneSubtable=domElem.hasClass('subDataTable');if(hasOnlyOneRow&&hasOnlyOneSubtable){var $labels=domElem.find('.label');if($labels.length){$labels.first().click();}}},applyCosmetics:function(domElem,rows){var self=this;var rowsWithSubtables=rows.filter('.subDataTable');rowsWithSubtables.css('font-weight','bold');$("th:first-child",domElem).addClass('label');var imagePlusMinusWidth=12;var imagePlusMinusHeight=12;$('td:first-child',rowsWithSubtables).each(function(){$('<img width="'+imagePlusMinusWidth+'" height="'+imagePlusMinusHeight+'" class="plusMinus" src="" />').insertBefore($(this).children('.label'));if(self.param.filter_pattern_recursive){setImageMinus(this);}
else{setImagePlus(this);}});var rootRow=rows.first().prev();var level=rootRow.length?getLevelFromClass(rootRow.attr('class'))+1:0;rows.each(function(){var currentStyle=$(this).attr('class')||'';if(currentStyle.indexOf('level')==-1){$(this).addClass('level'+level);}
$(this).prop('parent',function(){return self.parentAttributeParent+' '+self.parentId;});});self.addOddAndEvenClasses(domElem);},addOddAndEvenClasses:function(domElem){},handleRowActions:function(domElem,rows){this.doHandleRowActions(rows);},onClickActionSubDataTable:function(domElem){var self=this;var idSubTable=$(domElem).attr('id');var divIdToReplaceWithSubTable='subDataTable_'+idSubTable;var $insertAfter=$(domElem).nextUntil(':not(.comparePeriod):not(.comparisonRow)').last();if(!$insertAfter.length){$insertAfter=$(domElem);}
var NextStyle=$insertAfter.next().attr('class');var CurrentStyle=$(domElem).attr('class');var currentRowLevel=getLevelFromClass(CurrentStyle);var nextRowLevel=getLevelFromClass(NextStyle);if(currentRowLevel>=nextRowLevel){$(domElem).off('click');self.disabledRowDom=$(domElem);var numberOfColumns=$(domElem).children().length;$insertAfter.after('                <tr id="'+divIdToReplaceWithSubTable+'" class="cellSubDataTable">                    <td colspan="'+numberOfColumns+'">                            <span class="loadingPiwik" style="display:inline"><img src="plugins/Morpheus/images/loading-blue.gif" /> Loading...</span>                    </td>                </tr>                ');var savedActionVariable=self.param.action;var filtersToRestore=self.resetAllFilters();this.param['filter_sort_column']=filtersToRestore['filter_sort_column'];this.param['filter_sort_order']=filtersToRestore['filter_sort_order'];this.param['enable_filter_excludelowpop']=filtersToRestore['enable_filter_excludelowpop'];self.param.idSubtable=idSubTable;self.param.action=self.props.subtable_controller_action;var extraParams={};extraParams.comparisonIdSubtables=self.getComparisonIdSubtables($(domElem));self.reloadAjaxDataTable(false,function(resp){self.actionsSubDataTableLoaded(resp,idSubTable);self.repositionRowActions($(domElem));},extraParams);self.param.action=savedActionVariable;self.restoreAllFilters(filtersToRestore);delete self.param.idSubtable;}
else{var plusDetected=$('td img.plusMinus',domElem).attr('src').indexOf('plus')>=0;$(domElem).siblings().each(function(){var parents=$(this).prop('parent').split(' ');if(parents){if(parents.indexOf(idSubTable)>=0||parents.indexOf('subDataTable_'+idSubTable)>=0){if(plusDetected){$(this).css('display','').removeClass('hidden');var NextStyle=$(this).next().attr('class');var CurrentStyle=$(this).attr('class');var currentRowLevel=getLevelFromClass(CurrentStyle);var nextRowLevel=getLevelFromClass(NextStyle);if(currentRowLevel<nextRowLevel)
setImageMinus(this);}
else{$(this).css('display','none').addClass('hidden');}
self.repositionRowActions($(domElem));}}});var table=$(domElem);if(!table.hasClass('dataTable')){table=table.closest('.dataTable');}
self.$element.trigger('piwik:actionsSubTableToggled');}
var plusDetected=$('td img.plusMinus',domElem).attr('src').indexOf('plus')>=0;if(plusDetected){setImageMinus(domElem);}
else{setImagePlus(domElem);}},dataTableLoaded:function(response,workingDivId){var content=$(response);var idToReplace=workingDivId||$(content).attr('id');self.parentAttributeParent='';self.parentId='';var dataTableSel=$('#'+idToReplace);var oldReportsElem=$('.datatableRelatedReports',dataTableSel);$('.datatableRelatedReports',content).replaceWith(oldReportsElem);dataTableSel.replaceWith(content);content.trigger('piwik:dataTableLoaded');piwikHelper.compileAngularComponents(content);piwikHelper.lazyScrollTo(content[0],400);return content;},actionsSubDataTableLoaded:function(response,idSubTable){var self=this;var idToReplace='subDataTable_'+idSubTable;var root=$('#'+self.workingDivId);var response=$(response);self.parentAttributeParent=$('tr#'+idToReplace).prev().prop('parent');self.parentId=idToReplace;$('tr#'+idToReplace,root).after(response).remove();var requiredColumnCount=0,availableColumnCount=0;response.prev().find('td').each(function(){requiredColumnCount+=$(this).attr('colspan')||1;});response.find('td').each(function(){availableColumnCount+=$(this).attr('colspan')||1;});var missingColumns=requiredColumnCount-availableColumnCount;for(var i=0;i<missingColumns;i++){response.append('<td>-</td>');}
var re=/subDataTable_(\d+)/;var ok=re.exec(self.parentId);if(ok){self.parentId=ok[1];}
self.bindEventsAndApplyStyle($('#'+self.workingDivId),response);self.$element.trigger('piwik:actionsSubDataTableLoaded');self.disabledRowDom.click(function(){self.onClickActionSubDataTable(this)});self.openSubtableFromSubtableIfOnlyOneSubtableGiven(response);}});})(jQuery,require);
$(function(){function isActionsModule(params){return params.module=='Actions';}
function isPageUrlReport(params){var action=params.action;return isActionsModule(params)&&(action=='getPageUrls'||action=='getEntryPageUrls'||action=='getExitPageUrls'||action=='getPageUrlsFollowingSiteSearch');};function isPageTitleReport(params){var action=params.action;return isActionsModule(params)&&(action=='getPageTitles'||action=='getPageTitlesFollowingSiteSearch');};function getLinkForTransitionAndOverlayPopover(tr){tr=getRealRowIfComparisonRow(tr);var link=tr.find('> td:first > a').attr('href');link=$('<textarea>').html(link).val();return link;}
if(window.DataTable_RowActions_Transitions){DataTable_RowActions_Transitions.registerReport({isAvailableOnReport:function(dataTableParams){return isPageUrlReport(dataTableParams);},isAvailableOnRow:function(dataTableParams,tr){tr=getRealRowIfComparisonRow(tr);return isPageUrlReport(dataTableParams)&&tr.find('> td:first span.label').parent().is('a')},trigger:function(tr,e,subTableLabel,originalRow){var overrideParams=$.extend({},$(originalRow||tr).data('param-override'));if(typeof overrideParams!=='object'){overrideParams={};}
tr=getRealRowIfComparisonRow(tr);var link=getLinkForTransitionAndOverlayPopover(tr);var popoverUrl='url:'+link;Object.keys(overrideParams).forEach(function(paramName){if(!overrideParams[paramName]){return;}
popoverUrl+=':'+encodeURIComponent(paramName)+':'+encodeURIComponent(overrideParams[paramName]);});this.openPopover(popoverUrl);}});DataTable_RowActions_Transitions.registerReport({isAvailableOnReport:function(dataTableParams){return isPageTitleReport(dataTableParams);},isAvailableOnRow:function(dataTableParams,tr){return isPageTitleReport(dataTableParams);},trigger:function(tr,e,subTableLabel){DataTable_RowAction.prototype.trigger.apply(this,[tr,e,subTableLabel]);}});}
if(window.DataTable_RowActions_Overlay){DataTable_RowActions_Overlay.registerReport({isAvailableOnReport:function(dataTableParams){return isPageUrlReport(dataTableParams);},onClick:function(actionA,tr,e){return{link:getLinkForTransitionAndOverlayPopover(tr),segment:null}}});}
function getRealRowIfComparisonRow(tr){if(tr.is('.comparisonRow')){var prevUntil=tr.prevUntil('.parentComparisonRow').prev();return prevUntil.length?prevUntil:tr.prev();}
return tr;}});
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.service').factory('dashboardsModel',dashboardsModel);dashboardsModel.$inject=['piwikApi'];function dashboardsModel(piwikApi){var dashboardsPromise=null;var model={dashboards:[],getAllDashboards:getAllDashboards,reloadAllDashboards:reloadAllDashboards,getDashboard:getDashboard,getDashboardLayout:getDashboardLayout};return model;function getDashboard(dashboardId){return getAllDashboards().then(function(dashboards){var dashboard=null;angular.forEach(dashboards,function(board){if(parseInt(board.id,10)===parseInt(dashboardId,10)){dashboard=board;}});return dashboard;});}
function getDashboardLayout(dashboardId){piwikApi.withTokenInUrl();return piwikApi.fetch({module:'Dashboard',action:'getDashboardLayout',idDashboard:dashboardId});}
function reloadAllDashboards(){if(dashboardsPromise){dashboardsPromise=null;}
return getAllDashboards();}
function getAllDashboards(){if(!dashboardsPromise){dashboardsPromise=piwikApi.fetch({method:'Dashboard.getDashboards',filter_limit:'-1'}).then(function(response){if(response){model.dashboards=response;}
return response;});}
return dashboardsPromise;}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
function widgetsHelper(){}
widgetsHelper.getAvailableWidgets=function(callback){function mergeCategoriesAndSubCategories(availableWidgets){var categorized={};$.each(availableWidgets,function(index,widget){var category=widget.category.name;if(!categorized[category]){categorized[category]={'-':[]};}
var subcategory='-';if(widget.subcategory&&widget.subcategory.name){subcategory=widget.subcategory.name;}
if(!categorized[category][subcategory]){categorized[category][subcategory]=[];}
categorized[category][subcategory].push(widget);});var moved={};$.each(categorized,function(category,widgets){$.each(widgets,function(subcategory,subwidgets){var categoryToUse=category;if(subwidgets.length>=3&&subcategory!=='-'){categoryToUse=category+' - '+subcategory;}
if(!moved[categoryToUse]){moved[categoryToUse]=[];}
$.each(subwidgets,function(index,widget){moved[categoryToUse].push(widget);});});});return moved;}
if(!widgetsHelper.availableWidgets){var ajaxRequest=new ajaxHelper();ajaxRequest._mixinDefaultGetParams=function(params){return params;};ajaxRequest.addParams({module:'API',method:'API.getWidgetMetadata',filter_limit:'-1',format:'JSON',deep:'1',idSite:piwik.idSite||broadcast.getValueFromUrl('idSite')},'get');ajaxRequest.setCallback(function(data){widgetsHelper.availableWidgets=mergeCategoriesAndSubCategories(data);if(callback){callback(widgetsHelper.availableWidgets);}});ajaxRequest.setErrorCallback(function(deferred,status){if(status=='abort'||!deferred||deferred.status<400||deferred.status>=600){return;}
$('#loadingError').show();});ajaxRequest.send();return;}
if(callback){callback(widgetsHelper.availableWidgets);}};widgetsHelper.getWidgetObjectFromUniqueId=function(uniqueId,callback){widgetsHelper.getAvailableWidgets(function(widgets){for(var widgetCategory in widgets){var widgetInCategory=widgets[widgetCategory];for(var i in widgetInCategory){if(widgetInCategory[i]["uniqueId"]==uniqueId){callback(widgetInCategory[i]);return;}}}
callback(false);});};widgetsHelper.getWidgetNameFromUniqueId=function(uniqueId,callback){this.getWidgetObjectFromUniqueId(uniqueId,function(widget){if(widget==false){callback(false);}
callback(widget["name"]);});};widgetsHelper.loadWidgetAjax=function(widgetUniqueId,widgetParameters,onWidgetLoadedCallback,onWidgetErrorCallback){var disableLink=broadcast.getValueFromUrl('disableLink');widgetParameters['disableLink']=disableLink.length||$('body#standalone').length;widgetParameters['widget']=1;var ajaxRequest=new ajaxHelper();ajaxRequest.addParams(widgetParameters,'get');ajaxRequest.setCallback(onWidgetLoadedCallback);if(onWidgetErrorCallback){ajaxRequest.setErrorCallback(onWidgetErrorCallback);}
ajaxRequest.setFormat('html');ajaxRequest.send();return ajaxRequest;};(function($,require){var exports=require('piwik/UI/Dashboard');var WidgetFactory=function(){};WidgetFactory.prototype.make=function(uniqueId,widgetName){var $result=this.getWidgetTemplate().clone();$result.attr('id',uniqueId).find('.widgetName').append(widgetName);return $result;};WidgetFactory.prototype.getWidgetTemplate=function(){if(!this.widgetTemplate){this.widgetTemplate=$('#widgetTemplate').find('>.widget').detach();}
return this.widgetTemplate;};exports.WidgetFactory=new WidgetFactory();})(jQuery,require);(function($){$.extend({widgetPreview:new function(){var defaultSettings={onPreviewLoaded:function(){},onSelect:function(){},isWidgetAvailable:function(widgetUniqueId){return true;},resetOnSelect:false,baseClass:'widgetpreview-base',categorylistClass:'widgetpreview-categorylist',widgetlistClass:'widgetpreview-widgetlist',widgetpreviewClass:'widgetpreview-preview',choosenClass:'widgetpreview-choosen',unavailableClass:'widgetpreview-unavailable'};function createWidgetCategoryList(widgetPreview,availableWidgets){var settings=widgetPreview.settings;if(!$('.'+settings.categorylistClass,widgetPreview).length){$(widgetPreview).append('<ul class="'+settings.categorylistClass+'"></ul>');}else{$('.'+settings.categorylistClass,widgetPreview).empty();}
for(var widgetCategory in availableWidgets){$('.'+settings.categorylistClass,widgetPreview).append($('<li>').text(widgetCategory));}
return $('.'+settings.categorylistClass,widgetPreview);}
function createWidgetList(widgetPreview){var settings=widgetPreview.settings;if(!$('.'+settings.widgetlistClass,widgetPreview).length){$(widgetPreview).append('<ul class="'+settings.widgetlistClass+'"></ul>');}else{$('.'+settings.widgetlistClass+' li',widgetPreview).off('mouseover');$('.'+settings.widgetlistClass+' li',widgetPreview).off('click');$('.'+settings.widgetlistClass,widgetPreview).empty();}
if($('.'+settings.categorylistClass+' .'+settings.choosenClass,widgetPreview).length){var position=$('.'+settings.categorylistClass+' .'+settings.choosenClass,widgetPreview).position().top-
$('.'+settings.categorylistClass,widgetPreview).position().top+
$('.dashboard-manager .addWidget').outerHeight();if(!$('#content.admin').length){position+=5;}
$('.'+settings.widgetlistClass,widgetPreview).css('top',position);$('.'+settings.widgetlistClass,widgetPreview).css('marginBottom',position);}
return $('.'+settings.widgetlistClass,widgetPreview);}
function showWidgetList(widgets,widgetPreview){var settings=widgetPreview.settings;var widgetList=createWidgetList(widgetPreview),widgetPreviewTimer;for(var j=0;j<widgets.length;j++){var widgetName=widgets[j]["name"];var widgetUniqueId=widgets[j]["uniqueId"];var widgetCategoryId=widgets[j].category?widgets[j].category.id:null;var widgetClass='';if(!settings.isWidgetAvailable(widgetUniqueId)&&widgetCategoryId!=='General_KpiMetric'){widgetClass+=' '+settings.unavailableClass;}
widgetName=piwikHelper.escape(piwikHelper.htmlEntities(widgetName));widgetList.append('<li class="'+widgetClass+'" uniqueid="'+widgetUniqueId+'">'+widgetName+'</li>');}
$('li',widgetList).on('mouseenter',function(){var that=this,widgetUniqueId=$(this).attr('uniqueid');clearTimeout(widgetPreview);widgetPreviewTimer=setTimeout(function(){$('li',widgetList).removeClass(settings.choosenClass);$(that).addClass(settings.choosenClass);showPreview(widgetUniqueId,widgetPreview);},400);});$('li:not(.'+settings.unavailableClass+')',widgetList).on('mouseleave',function(){clearTimeout(widgetPreview);});$('li',widgetList).on('click',function(){if(!$('.widgetLoading',widgetPreview).length){settings.onSelect($(this).attr('uniqueid'));$(widgetPreview).closest('.dashboard-manager').removeClass('expanded');if(settings.resetOnSelect){resetWidgetPreview(widgetPreview);}}
return false;});}
function createPreviewElement(widgetPreview){var settings=widgetPreview.settings;if(!$('.'+settings.widgetpreviewClass,widgetPreview).length){$(widgetPreview).append('<div class="'+settings.widgetpreviewClass+'"></div>');}else{$('.'+settings.widgetpreviewClass+' .widgetTop',widgetPreview).off('click');$('.'+settings.widgetpreviewClass,widgetPreview).empty();}
return $('.'+settings.widgetpreviewClass,widgetPreview);}
function showPreview(widgetUniqueId,widgetPreview){if($('[id="'+widgetUniqueId+'"]',widgetPreview).length)return;var settings=widgetPreview.settings;var previewElement=createPreviewElement(widgetPreview);widgetsHelper.getWidgetObjectFromUniqueId(widgetUniqueId,function(widget){var widgetParameters=widget['parameters'];var emptyWidgetHtml=require('piwik/UI/Dashboard').WidgetFactory.make(widgetUniqueId,$('<span/>').attr('title',_pk_translate("Dashboard_AddPreviewedWidget")).text(_pk_translate('Dashboard_WidgetPreview')));previewElement.html(emptyWidgetHtml);var onWidgetLoadedCallback=function(response){var widgetElement=$(document.getElementById(widgetUniqueId));$('.widgetContent',widgetElement).html($(response));piwikHelper.compileAngularComponents($('.widgetContent',widgetElement),{forceNewScope:true});$('.widgetContent',widgetElement).trigger('widget:create');settings.onPreviewLoaded(widgetUniqueId,widgetElement);$('.'+settings.widgetpreviewClass+' .widgetTop',widgetPreview).on('click',function(){settings.onSelect(widgetUniqueId);$(widgetPreview).closest('.dashboard-manager').removeClass('expanded');if(settings.resetOnSelect){resetWidgetPreview(widgetPreview);}
return false;});};if(widgetPreview.widgetAjaxRequest){widgetPreview.widgetAjaxRequest.abort();}
widgetPreview.widgetAjaxRequest=widgetsHelper.loadWidgetAjax(widgetUniqueId,widgetParameters,onWidgetLoadedCallback);});}
function resetWidgetPreview(widgetPreview){var settings=widgetPreview.settings;$('.'+settings.categorylistClass+' li',widgetPreview).removeClass(settings.choosenClass);createWidgetList(widgetPreview);createPreviewElement(widgetPreview);}
this.construct=function(userSettings){if(userSettings=='reset'){resetWidgetPreview(this);return;}
this.widgetAjaxRequest=null;$(this).addClass('widgetpreview-base');this.settings=jQuery.extend({},defaultSettings,userSettings);if(typeof this.settings.onSelect=='function'){this.onSelect=this.settings.onSelect;}
if(typeof this.settings.onPreviewLoaded=='function'){this.onPreviewLoaded=this.settings.onPreviewLoaded;}
var self=this;widgetsHelper.getAvailableWidgets(function(availableWidgets){var categoryList=createWidgetCategoryList(self,availableWidgets);$('li',categoryList).on('mouseover',function(){var category=$(this).text();var widgets=availableWidgets[category];$('li',categoryList).removeClass(self.settings.choosenClass);$(this).addClass(self.settings.choosenClass);showWidgetList(widgets,self);createPreviewElement(self);});});};}});$.fn.extend({widgetPreview:$.widgetPreview.construct})})(jQuery);
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($){var layoutColumnSelector='#dashboardWidgetsArea > .col';var dashboardLayout={};var dashboardId=1;var dashboardName='';var dashboardElement=null;var dashboardChanged=false;var methods={init:function(options){dashboardElement=this;if(options.idDashboard){dashboardId=options.idDashboard;}
if(options.name){dashboardName=options.name;}
if(options.layout){generateLayout(options.layout);}
return this;},destroy:function(){$(dashboardElement).remove();dashboardElement=null;destroyWidgets();},destroyWidgets:destroyWidgets,loadDashboard:function(dashboardIdToLoad,forceReload){$(dashboardElement).empty();dashboardName='';dashboardLayout=null;dashboardId=dashboardIdToLoad;if(!forceReload&&piwikHelper.isAngularRenderingThePage()){angular.element(document).injector().invoke(function($location){$location.search('subcategory',''+dashboardIdToLoad);});}else{var element=$('[piwik-dashboard]');var scope=angular.element(element).scope();scope.fetchDashboard(dashboardIdToLoad);}
return this;},setColumnLayout:function(newLayout){adjustDashboardColumns(newLayout);},getColumnLayout:function(){return dashboardLayout.config.layout;},getDashboardName:function(){return dashboardName;},getDashboardId:function(){return dashboardId;},setDashboardName:function(newName){dashboardName=newName;dashboardChanged=true;saveLayout();},addWidget:function(uniqueId,columnNumber,widgetParameters,addWidgetOnTop,isHidden){addWidgetTemplate(uniqueId,columnNumber,widgetParameters,addWidgetOnTop,isHidden);saveLayout();},resetLayout:function(){var ajaxRequest=new ajaxHelper();ajaxRequest.addParams({module:'Dashboard',action:'resetLayout',idDashboard:dashboardId},'get');ajaxRequest.withTokenInUrl();ajaxRequest.setCallback(function(){methods.loadDashboard.apply(this,[dashboardId,true])});ajaxRequest.setLoadingElement();ajaxRequest.setFormat('html');ajaxRequest.send();},rebuildMenu:rebuildMenu,removeDashboard:function(){if(dashboardId==1){return;}
var ajaxRequest=new ajaxHelper();ajaxRequest.setLoadingElement();ajaxRequest.addParams({module:'API',method:'Dashboard.removeDashboard',idDashboard:dashboardId,login:piwik.userLogin,format:'json'},'get');ajaxRequest.setCallback(function(){methods.loadDashboard.apply(this,[1]);rebuildMenu();});ajaxRequest.withTokenInUrl();ajaxRequest.setFormat('html');ajaxRequest.send();},saveLayoutAsDefaultWidgetLayout:function(){saveLayout('saveLayoutAsDefault');},isDefaultDashboard:function(){return(dashboardId==1);}};function destroyWidgets(){var widgets=$('[widgetId]');for(var i=0;i<widgets.length;i++){$(widgets[i]).dashboardWidget('destroy');}}
function removeNonExistingWidgets(availableWidgets,layout){var existingModuleAction={};$.each(availableWidgets,function(category,widgets){$.each(widgets,function(index,widget){existingModuleAction[widget.module+'.'+widget.action]=true;});});var columns=[];$.each(layout.columns,function(i,column){var widgets=[];$.each(column,function(j,widget){if(!widget.parameters||!widget.parameters.module){return;}
var method=widget.parameters.module+'.'+widget.parameters.action
if(existingModuleAction[method]){widgets.push(widget);}});columns[i]=widgets;});layout.columns=columns;return layout;}
function generateLayout(layout){dashboardLayout=parseLayout(layout);widgetsHelper.getAvailableWidgets(function(availableWidgets){dashboardLayout=removeNonExistingWidgets(availableWidgets,dashboardLayout);piwikHelper.hideAjaxLoading();adjustDashboardColumns(dashboardLayout.config.layout);var dashboardContainsWidgets=false;for(var column=0;column<dashboardLayout.columns.length;column++){for(var i in dashboardLayout.columns[column]){if(typeof dashboardLayout.columns[column][i]!='object'){continue;}
var widget=dashboardLayout.columns[column][i];dashboardContainsWidgets=true;addWidgetTemplate(widget.uniqueId,column+1,widget.parameters,false,widget.isHidden)}}
if(!dashboardContainsWidgets){$(dashboardElement).trigger('dashboardempty');}
makeWidgetsSortable();});}
function adjustDashboardColumns(layout){var columnWidth=layout.split('-');var columnCount=columnWidth.length;var currentCount=$('> .col',dashboardElement).length;if(currentCount<columnCount){$('.menuClear',dashboardElement).remove();for(var i=currentCount;i<columnCount;i++){if(dashboardLayout.columns.length<i){dashboardLayout.columns.push({});}
$(dashboardElement).append('<div class="col"> </div>');}
$(dashboardElement).append('<div class="menuClear"> </div>');}else if(currentCount>columnCount){for(var i=columnCount;i<currentCount;i++){if(dashboardLayout.columns.length>=i){dashboardLayout.columns.pop();}
$('[widgetId]',$(layoutColumnSelector+':last')).each(function(id,elem){var cols=$(layoutColumnSelector).slice(0,columnCount);var smallestColumn=$(cols[0]);var smallestColumnHeight=null;cols.each(function(colId,col){if(smallestColumnHeight==null||smallestColumnHeight>$(col).height()){smallestColumnHeight=$(col).height();smallestColumn=$(col);}});$(elem).appendTo(smallestColumn);});$(layoutColumnSelector+':last').remove();}}
var $dashboardElement=$(' > .col',dashboardElement);if(!$dashboardElement.length){return;}
switch(layout){case'100':$dashboardElement.removeClass().addClass('col s12');break;case'50-50':$dashboardElement.removeClass().addClass('col s12 m6');break;case'67-33':$dashboardElement[0].className='col s12 m8';$dashboardElement[1].className='col s12 m4';break;case'33-67':$dashboardElement[0].className='col s12 m4';$dashboardElement[1].className='col s12 m8';break;case'33-33-33':$dashboardElement[0].className='col s12 m4';$dashboardElement[1].className='col s12 m4';$dashboardElement[2].className='col s12 m4';break;case'40-30-30':$dashboardElement[0].className='col s12 m6';$dashboardElement[1].className='col s12 m3';$dashboardElement[2].className='col s12 m3';break;case'30-40-30':$dashboardElement[0].className='col s12 m3';$dashboardElement[1].className='col s12 m6';$dashboardElement[2].className='col s12 m3';break;case'30-30-40':$dashboardElement[0].className='col s12 m3';$dashboardElement[1].className='col s12 m3';$dashboardElement[2].className='col s12 m6';break;case'25-25-25-25':$dashboardElement[0].className='col s12 m3';$dashboardElement[1].className='col s12 m3';$dashboardElement[2].className='col s12 m3';$dashboardElement[3].className='col s12 m3';break;}
makeWidgetsSortable();if(currentCount>0&&dashboardLayout.config.layout!=layout){dashboardChanged=true;dashboardLayout.config.layout=layout;saveLayout();}
$('.widgetContent').each(function(){$(this).trigger('widget:resize');});}
function parseLayout(layout){if($.isArray(layout)){layout={config:{layout:'33-33-33'},columns:layout};}
if(!layout.config.layout){layout.config.layout='33-33-33';}
return layout;}
function reloadWidget($widget){if(typeof $widget==='string'){$widget=$('[widgetid="'+$widget+'"]',dashboardElement);}
$widget.dashboardWidget('reload',false,true);}
function addWidgetTemplate(uniqueId,columnNumber,widgetParameters,addWidgetOnTop,isHidden){if(!columnNumber){columnNumber=1;}
if(columnNumber>$('> .col',dashboardElement).length){return;}
var $widgetContent=$('<div class="sortable" widgetId="'+uniqueId+'"></div>');if(addWidgetOnTop){$('> .col:nth-child('+columnNumber+')',dashboardElement).prepend($widgetContent);}else{$('> .col:nth-child('+columnNumber+')',dashboardElement).append($widgetContent);}
return $widgetContent.dashboardWidget({uniqueId:uniqueId,widgetParameters:widgetParameters,onChange:function(){saveLayout();},isHidden:isHidden});}
function makeWidgetsSortable(){function onStart(event,ui){if(!jQuery.support.noCloneEvent){$('object',this).hide();}}
function onStop(event,ui){$('object',this).show();$('.widgetHover',this).removeClass('widgetHover');$('.widgetTopHover',this).removeClass('widgetTopHover');if($('.widget:has(".piwik-graph")',ui.item).length){reloadWidget($('.widget',ui.item).attr('id'));}
saveLayout();}
$(layoutColumnSelector+":data('ui-sortable')",dashboardElement).sortable('destroy');$('> .col',dashboardElement).sortable({items:'div.sortable',opacity:0.6,forceHelperSize:true,forcePlaceholderSize:true,placeholder:'hover',handle:'.widgetTop',helper:'clone',start:onStart,stop:onStop,connectWith:layoutColumnSelector});}
function rebuildMenu(){if(piwikHelper.isAngularRenderingThePage()){angular.element(document).injector().invoke(function(reportingMenuModel){reportingMenuModel.reloadMenuItems();});return;}
var _self=this;var success=function(dashboards){var dashboardMenuList=$('#Dashboard_embeddedIndex_1').closest('ul');var dashboardMenuListItems=dashboardMenuList.find('>li');dashboardMenuListItems.filter(function(){return $(this).attr('id').indexOf('Dashboard_embeddedIndex')==0;}).remove();if(dashboards.length===0){dashboards=[{iddashboard:1,name:_pk_translate('Dashboard_Dashboard')}];}
if(dashboards.length>1||dashboardMenuListItems.length>=1){var items=[];for(var i=0;i<dashboards.length;i++){var $link=$('<a/>').attr('data-iddashboard',dashboards[i].iddashboard).text(dashboards[i].name).addClass('item');var $li=$('<li/>').attr('id','Dashboard_embeddedIndex_'+dashboards[i].iddashboard).addClass('dashboardMenuItem').attr('role','menuitem').append($link);items.push($li);if(dashboards[i].iddashboard==dashboardId){dashboardName=dashboards[i].name;$li.addClass('active');}}
dashboardMenuList.prepend(items);}
dashboardMenuList.find('a[data-iddashboard]').click(function(e){e.preventDefault();var idDashboard=$(this).attr('data-iddashboard');$('#Dashboard ul li').removeClass('active');methods.loadDashboard.apply(_self,[idDashboard]);$(this).closest('li').addClass('active');});};var ajaxRequest=new ajaxHelper();ajaxRequest.addParams({module:'Dashboard',action:'getAllDashboards',filter_limit:'-1'},'get');ajaxRequest.withTokenInUrl();ajaxRequest.setCallback(success);ajaxRequest.send();}
function saveLayout(action){var columns=[];var columnNumber=0;$(layoutColumnSelector).each(function(){columns[columnNumber]=[];var items=$('[widgetId]',this);for(var j=0;j<items.length;j++){columns[columnNumber][j]=$(items[j]).dashboardWidget('getWidgetObject');delete columns[columnNumber][j].parameters.segment;}
columnNumber++;});if(JSON.stringify(dashboardLayout.columns)!=JSON.stringify(columns)||dashboardChanged||action){dashboardLayout.columns=JSON.parse(JSON.stringify(columns));columns=null;if(!action){action='saveLayout';}
var ajaxRequest=new ajaxHelper();ajaxRequest.addParams({module:'Dashboard',action:action,idDashboard:dashboardId},'get');ajaxRequest.addParams({layout:JSON.stringify(dashboardLayout),name:dashboardName},'post');ajaxRequest.setCallback(function(){if(dashboardChanged){dashboardChanged=false;rebuildMenu();}});ajaxRequest.withTokenInUrl();ajaxRequest.setFormat('html');ajaxRequest.send();}}
$.fn.dashboard=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments);}else{$.error('Method '+method+' does not exist on jQuery.dashboard');}}})(jQuery);
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($){$.widget('piwik.dashboardWidget',{isMaximised:false,uniqueId:null,widgetParameters:{},options:{uniqueId:null,isHidden:false,onChange:null,widgetParameters:{},title:null,onRemove:null,onRefresh:null,onMaximise:null,onMinimise:null,autoMaximiseVisualizations:['tableAllColumns','tableGoals']},_create:function(){if(!this.options.uniqueId){piwikHelper.error('widgets can\'t be created without an uniqueId');return;}else{this.uniqueId=this.options.uniqueId;}
if(this.options.widgetParameters){this.widgetParameters=this.options.widgetParameters;}
this._createDashboardWidget(this.uniqueId);var self=this;this.element.on('setParameters.dashboardWidget',function(e,params){self.setParameters(params);});this.reload(true,true);},destroy:function(){if(this.isMaximised){$('[widgetId="'+this.uniqueId+'"]').dialog('destroy');}
$('*',this.element).off('.dashboardWidget');$('.widgetContent',this.element).trigger('widget:destroy');require('piwik/UI').UIControl.cleanupUnusedControls();return this;},getWidgetObject:function(){return{uniqueId:this.uniqueId,parameters:this.widgetParameters,isHidden:this.options.isHidden};},maximise:function(){this.isMaximised=true;if(this.options.onMaximise){this.options.onMaximise(this.element);}else{this._maximiseImpl();}
$('.widgetContent',this.element).trigger('widget:maximise');return this;},reload:function(hideLoading,notJQueryUI,overrideParams){if(!notJQueryUI){piwikHelper.log('widget.reload() was called by jquery.ui, ignoring',arguments.callee.caller);return;}
var self=this,currentWidget=this.element;$('.widgetContent',currentWidget).trigger('widget:reload');function onWidgetLoadedReplaceElementWithContent(loadedContent){var $widgetContent=$('.widgetContent',currentWidget);$widgetContent.html(loadedContent);if(currentWidget.parents('body').length){piwikHelper.compileAngularComponents($widgetContent,{forceNewScope:true});}
$widgetContent.removeClass('loading');$widgetContent.trigger('widget:create',[self]);angular.element(document).injector().invoke(['notifications',function(notifications){notifications.parseNotificationDivs();}]);}
['segment'].forEach(function(paramName){var value=broadcast.getValueFromHash(paramName)||broadcast.getValueFromUrl(paramName);if(value.length){self.widgetParameters[paramName]=value;}});['compareSegments','comparePeriods','compareDates'].forEach(function(paramName){var value=broadcast.getValueFromHash(paramName)||broadcast.getValueFromUrl(paramName);if(value.length){self.widgetParameters[paramName]=value;}else{delete self.widgetParameters[paramName];}});if(!hideLoading){$('.widgetContent',currentWidget).addClass('loading');}
var params=$.extend(this.widgetParameters,overrideParams||{});widgetsHelper.loadWidgetAjax(this.uniqueId,params,onWidgetLoadedReplaceElementWithContent,function(deferred,status){if(status=='abort'||!deferred||deferred.status<400||deferred.status>=600){return;}
$('.widgetContent',currentWidget).removeClass('loading');var errorMessage=_pk_translate('General_ErrorRequest',['','']);if($('#loadingError').html()){errorMessage=$('#loadingError').html();}
$('.widgetContent',currentWidget).html('<div class="widgetLoadingError">'+errorMessage+'</div>');});return this;},setParameters:function(parameters){if(!this.isMaximised&&this.options.autoMaximiseVisualizations.indexOf(parameters.viewDataTable)!==-1){this.maximise();}
for(var name in parameters){this.widgetParameters[name]=parameters[name];}
if(!this.isMaximised){this.options.onChange();}
return this;},getParameters:function(){return $.extend({},this.widgetParameters);},_createDashboardWidget:function(uniqueId){var self=this;widgetsHelper.getWidgetNameFromUniqueId(uniqueId,function(widgetName){if(!widgetName){widgetName=_pk_translate('Dashboard_WidgetNotFound');}
var title=self.options.title===null?$('<span/>').text(widgetName):self.options.title;var emptyWidgetContent=require('piwik/UI/Dashboard').WidgetFactory.make(uniqueId,title);self.element.html(emptyWidgetContent);var widgetElement=$('[id="'+uniqueId+'"]',self.element);widgetElement.on('mouseenter.dashboardWidget',function(){if(!self.isMaximised){$(this).addClass('widgetHover');$('.widgetTop',this).addClass('widgetTopHover');}}).on('mouseleave.dashboardWidget',function(){if(!self.isMaximised){$(this).removeClass('widgetHover');$('.widgetTop',this).removeClass('widgetTopHover');}});if(self.options.isHidden){$('.widgetContent',widgetElement).toggleClass('hidden').closest('.widget').toggleClass('hiddenContent');}
$('.button#close',widgetElement).on('click.dashboardWidget',function(ev){piwikHelper.modalConfirm('#confirm',{yes:function(){if(self.options.onRemove){self.options.onRemove(self.element);}else{self.element.remove();self.options.onChange();}}});});$('.button#maximise',widgetElement).on('click.dashboardWidget',function(ev){if(self.options.onMaximise){self.options.onMaximise(self.element);}else{if($('.widgetContent',$(this).parents('.widget')).hasClass('hidden')){self.showContent();}else{self.maximise();}}});$('.button#minimise',widgetElement).on('click.dashboardWidget',function(ev){if(self.options.onMinimise){self.options.onMinimise(self.element);}else{if(!self.isMaximised){self.hideContent();}else{self.element.dialog("close");}}});$('.button#refresh',widgetElement).on('click.dashboardWidget',function(ev){if(self.options.onRefresh){self.options.onRefresh(self.element);}else{self.reload(false,true);}});});},hideContent:function(){$('.widgetContent',this.element.find('.widget').addClass('hiddenContent')).addClass('hidden');this.options.isHidden=true;this.options.onChange();},showContent:function(){this.isMaximised=false;this.options.isHidden=false;this.element.find('.widget').removeClass('hiddenContent').find('.widgetContent').removeClass('hidden');this.element.find('.widget').find('div.piwik-graph').trigger('resizeGraph');this.options.onChange();$('.widgetContent',this.element).trigger('widget:minimise');},_maximiseImpl:function(){this.detachWidget();var width=Math.floor($('body').width()*0.7);var self=this;this.element.dialog({title:'',dialogClass:'widgetoverlay',modal:true,width:width,position:['center','center'],resizable:true,autoOpen:true,close:function(event,ui){self.isMaximised=false;$('body').off('.dashboardWidget');$(this).dialog("destroy");$('[id="'+self.uniqueId+'-placeholder"]').replaceWith(this);$(this).removeAttr('style');self.options.onChange();$(this).find('div.piwik-graph').trigger('resizeGraph');$('.widgetContent',self.element).trigger('widget:minimise');}});this.element.find('div.piwik-graph').trigger('resizeGraph');var currentWidget=this.element;$('body').on('click.dashboardWidget',function(ev){if(/ui-widget-overlay/.test(ev.target.className)){$(currentWidget).dialog("close");}});},detachWidget:function(){this.element.before('<div id="'+this.uniqueId+'-placeholder" class="widgetPlaceholder widget"> </div>');var placeholder=$('[id="'+self.uniqueId+'-placeholder"]');$('#'+this.uniqueId+'-placeholder').height(this.element.height());$('#'+this.uniqueId+'-placeholder').width(this.element.width()-16);return this.element.detach();}});})(jQuery);
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
function createDashboard(){$(makeSelectorLastId('createDashboardName')).val('');piwikHelper.modalConfirm(makeSelectorLastId('createDashboardConfirm'),{yes:function(){var dashboardName=$(makeSelectorLastId('createDashboardName')).val();var addDefaultWidgets=($('[id=dashboard_type_empty]:last:checked').length>0)?0:1;var ajaxRequest=new ajaxHelper();ajaxRequest.setLoadingElement();ajaxRequest.withTokenInUrl();ajaxRequest.addParams({module:'API',method:'Dashboard.createNewDashboardForUser',format:'json'},'get');ajaxRequest.addParams({dashboardName:dashboardName,addDefaultWidgets:addDefaultWidgets,login:piwik.userLogin},'post');ajaxRequest.setCallback(function(response){var id=response.value;angular.element(document).injector().invoke(function($location,reportingMenuModel,dashboardsModel){dashboardsModel.reloadAllDashboards().then(function(){$('#dashboardWidgetsArea').dashboard('loadDashboard',id);$('#dashboardWidgetsArea').dashboard('rebuildMenu');});});});ajaxRequest.send();}});}
function makeSelectorLastId(domElementId){return'[id='+domElementId+']:last';}
function resetDashboard(){piwikHelper.modalConfirm(makeSelectorLastId('resetDashboardConfirm'),{yes:function(){$('#dashboardWidgetsArea').dashboard('resetLayout');}});}
function renameDashboard(){$(makeSelectorLastId('newDashboardName')).val($('#dashboardWidgetsArea').dashboard('getDashboardName'));piwikHelper.modalConfirm(makeSelectorLastId('renameDashboardConfirm'),{yes:function(){var newDashboardName=$(makeSelectorLastId('newDashboardName')).val();$('#dashboardWidgetsArea').dashboard('setDashboardName',newDashboardName);}});}
function removeDashboard(){$(makeSelectorLastId('removeDashboardConfirm')).find('h2 span').text($('#dashboardWidgetsArea').dashboard('getDashboardName'));piwikHelper.modalConfirm(makeSelectorLastId('removeDashboardConfirm'),{yes:function(){$('#dashboardWidgetsArea').dashboard('removeDashboard');}});}
function showChangeDashboardLayoutDialog(){$('#columnPreview').find('>div').removeClass('choosen');$('#columnPreview').find('>div[layout='+$('#dashboardWidgetsArea').dashboard('getColumnLayout')+']').addClass('choosen');var id=makeSelectorLastId('changeDashboardLayout');piwikHelper.modalConfirm(id,{yes:function(){var layout=$(id).find('.choosen').attr('layout');$('#dashboardWidgetsArea').dashboard('setColumnLayout',layout);}},{fixedFooter:true});}
function showEmptyDashboardNotification(){piwikHelper.modalConfirm(makeSelectorLastId('dashboardEmptyNotification'),{resetDashboard:function(){$('#dashboardWidgetsArea').dashboard('resetLayout');},addWidget:function(){$('.dashboardSettings > a').trigger('click');}});}
function setAsDefaultWidgets(){piwikHelper.modalConfirm(makeSelectorLastId('setAsDefaultWidgetsConfirm'),{yes:function(){$('#dashboardWidgetsArea').dashboard('saveLayoutAsDefaultWidgetLayout');}});}
function copyDashboardToUser(){$(makeSelectorLastId('copyDashboardName')).val($('#dashboardWidgetsArea').dashboard('getDashboardName'));var ajaxRequest=new ajaxHelper();ajaxRequest.addParams({module:'API',method:'UsersManager.getUsers',format:'json',filter_limit:'-1'},'get');ajaxRequest.setCallback(function(availableUsers){$(makeSelectorLastId('copyDashboardUser')).empty();$(makeSelectorLastId('copyDashboardUser')).append($('<option></option>').val(piwik.userLogin).text(piwik.userLogin));$.each(availableUsers,function(index,user){if(user.login!='anonymous'&&user.login!=piwik.userLogin){$(makeSelectorLastId('copyDashboardUser')).append($('<option></option>').val(user.login).text(user.login+' ('+user.alias+')'));}});});ajaxRequest.send();piwikHelper.modalConfirm(makeSelectorLastId('copyDashboardToUserConfirm'),{yes:function(){var copyDashboardName=$(makeSelectorLastId('copyDashboardName')).val();var copyDashboardUser=$(makeSelectorLastId('copyDashboardUser')).val();var ajaxRequest=new ajaxHelper();ajaxRequest.addParams({module:'API',method:'Dashboard.copyDashboardToUser',format:'json'},'get');ajaxRequest.addParams({dashboardName:encodeURIComponent(copyDashboardName),idDashboard:$('#dashboardWidgetsArea').dashboard('getDashboardId'),copyToUser:copyDashboardUser},'post');ajaxRequest.setCallback(function(response){$('#alert').find('h2').text(_pk_translate('Dashboard_DashboardCopied'));piwikHelper.modalConfirm('#alert',{});});ajaxRequest.withTokenInUrl();ajaxRequest.send();}});}
(function(){var exports=window.require('piwik/UI');var UIControl=exports.UIControl;var DashboardSettingsControlBase=function(element){UIControl.call(this,element);var self=this;this.$element.on('click','ul.submenu li[data-action]',function(e){if(!$(this).attr('disabled')){self.$element.removeClass('expanded');$(self).trigger($(this).attr('data-action'));}});this.$element.on('click',function(e){if($(e.target).is('.dashboardSettings')||$(e.target).closest('.dashboardSettings').length){self.onOpen();}});this.onBodyMouseUp=function(e){if(!$(e.target).closest('.dashboardSettings').length&&!$(e.target).is('.dashboardSettings')){self.$element.widgetPreview('reset');self.$element.removeClass('expanded');}};$('body').on('mouseup',this.onBodyMouseUp);this.$element.widgetPreview({isWidgetAvailable:function(widgetUniqueId){return self.isWidgetAvailable(widgetUniqueId);},onSelect:function(widgetUniqueId){widgetsHelper.getWidgetObjectFromUniqueId(widgetUniqueId,function(widget){self.$element.removeClass('expanded');self.widgetSelected(widget);});},resetOnSelect:true});this.$element.on('mouseenter','.submenu > li',function(event){if(!$('.widgetpreview-categorylist',event.target).length){self.$element.widgetPreview('reset');}});};$.extend(DashboardSettingsControlBase.prototype,UIControl.prototype,{_destroy:function(){UIControl.prototype._destroy.call(this);$('body').off('mouseup',null,this.onBodyMouseUp);}});exports.DashboardSettingsControlBase=DashboardSettingsControlBase;var DashboardManagerControl=function(element){DashboardSettingsControlBase.call(this,element);$(this).on('resetDashboard',function(){this.hide();resetDashboard();});$(this).on('showChangeDashboardLayoutDialog',function(){this.hide();showChangeDashboardLayoutDialog();});$(this).on('renameDashboard',function(){this.hide();renameDashboard();});$(this).on('removeDashboard',function(){this.hide();removeDashboard();});$(this).on('setAsDefaultWidgets',function(){this.hide();setAsDefaultWidgets();});$(this).on('copyDashboardToUser',function(){this.hide();copyDashboardToUser();});$(this).on('createDashboard',function(){this.hide();createDashboard();});};$.extend(DashboardManagerControl.prototype,DashboardSettingsControlBase.prototype,{onOpen:function(){if($('#dashboardWidgetsArea').dashboard('isDefaultDashboard')){$('[data-action=removeDashboard]',this.$element).attr('disabled','disabled');$(this.$element).tooltip({items:'[data-action=removeDashboard]',show:false,hide:false,track:true,content:function(){return _pk_translate('Dashboard_RemoveDefaultDashboardNotPossible')},tooltipClass:'small'});}else{$('[data-action=removeDashboard]',this.$element).removeAttr('disabled');try{$(this.$element).tooltip('destroy');}catch(e){}}},hide:function(){this.$element.removeClass('expanded');},isWidgetAvailable:function(widgetUniqueId){return!$('#dashboardWidgetsArea').find('[widgetId="'+widgetUniqueId+'"]').length;},widgetSelected:function(widget){$('#dashboardWidgetsArea').dashboard('addWidget',widget.uniqueId,1,widget.parameters,true,false);}});DashboardManagerControl.initElements=function(){UIControl.initElements(this,'.dashboard-manager');$('.top_controls .dashboard-manager').hide();};exports.DashboardManagerControl=DashboardManagerControl;}());
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikDashboard',piwikDashboard);piwikDashboard.$inject=['dashboardsModel','$rootScope','$q'];function piwikDashboard(dashboardsModel,$rootScope,$q){function renderDashboard(dashboardId,dashboard,layout){$('.dashboardSettings').show();initTopControls();if(!$('#topBars').length){$('.dashboardSettings').after($('#Dashboard'));$('#Dashboard ul li').removeClass('active');$('#Dashboard_embeddedIndex_'+dashboardId).addClass('active');}
widgetsHelper.getAvailableWidgets();$('#dashboardWidgetsArea').off('dashboardempty',showEmptyDashboardNotification);$('#dashboardWidgetsArea').on('dashboardempty',showEmptyDashboardNotification).dashboard({idDashboard:dashboardId,layout:layout,name:dashboard?dashboard.name:''});var divElements=$('#columnPreview').find('>div');divElements.each(function(){var width=[];$('div',this).each(function(){width.push(this.className.replace(/width-/,''));});$(this).attr('layout',width.join('-'));});divElements.off('click.renderDashboard');divElements.on('click.renderDashboard',function(){divElements.removeClass('choosen');$(this).addClass('choosen');});}
function fetchDashboard(dashboardId){var dashboardElement=$('#dashboardWidgetsArea');dashboardElement.dashboard('destroyWidgets');dashboardElement.empty();globalAjaxQueue.abort();var getDashboard=dashboardsModel.getDashboard(dashboardId);var getLayout=dashboardsModel.getDashboardLayout(dashboardId);return $q.all([getDashboard,getLayout]).then(function(response){var dashboard=response[0];var layout=response[1];$(function(){renderDashboard(dashboardId,dashboard,layout);});});}
function clearDashboard(){$('.top_controls .dashboard-manager').hide();$('#dashboardWidgetsArea').dashboard('destroy');}
return{restrict:'A',scope:{dashboardid:'=',layout:'='},link:function(scope,element,attrs){scope.$parent.fetchDashboard=function(dashboardId){scope.dashboardId=dashboardId;return fetchDashboard(dashboardId)};fetchDashboard(scope.dashboardid);function onLocationChange(event,newUrl,oldUrl){if(broadcast.getValueFromUrl('module')!='Widgetize'&&newUrl!==oldUrl&&newUrl.indexOf('category=Dashboard_Dashboard')===-1){clearDashboard();}}
var unbind=$rootScope.$on('$locationChangeSuccess',onLocationChange);scope.$on('$destroy',onLocationChange);scope.$on('$destroy',unbind);}};}})();
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('CampaignBuilderController',CampaignBuilderController);CampaignBuilderController.$inject=['$scope'];function CampaignBuilderController($scope){this.hasExtraPlugin=$scope.hasExtraPlugin;this.reset=function(){this.websiteUrl='';this.campaignName='';this.campaignKeyword='';this.campaignSource='';this.campaignMedium='';this.campaignContent='';this.generatedUrl='';};this.generateUrl=function(){this.generatedUrl=String(this.websiteUrl);if(this.generatedUrl.indexOf('http')!==0){this.generatedUrl='https://'+this.generatedUrl.trim();}
var urlHashPos=this.generatedUrl.indexOf('#');var urlHash='';if(urlHashPos>=0){urlHash=this.generatedUrl.substr(urlHashPos);this.generatedUrl=this.generatedUrl.substr(0,urlHashPos);}
if(this.generatedUrl.indexOf('/',10)<0&&this.generatedUrl.indexOf("?")<0){this.generatedUrl+='/';}
var campaignName=encodeURIComponent(this.campaignName.trim());if(this.generatedUrl.indexOf('?')>0||this.generatedUrl.indexOf('#')>0){this.generatedUrl+='&';}else{this.generatedUrl+='?';}
this.generatedUrl+='pk_campaign='+campaignName;if(this.campaignKeyword){this.generatedUrl+='&pk_kwd='+encodeURIComponent(this.campaignKeyword.trim());}
if(this.campaignSource){this.generatedUrl+='&pk_source='+encodeURIComponent(this.campaignSource.trim());}
if(this.campaignMedium){this.generatedUrl+='&pk_medium='+encodeURIComponent(this.campaignMedium.trim());}
if(this.campaignContent){this.generatedUrl+='&pk_content='+encodeURIComponent(this.campaignContent.trim());}
this.generatedUrl+=urlHash;$('#urlCampaignBuilderResult').effect("highlight",{},1500);};this.reset();}})();
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('matomoCampaignBuilder',matomoCampaignBuilder);matomoCampaignBuilder.$inject=['piwik'];function matomoCampaignBuilder(piwik){var defaults={hasExtraPlugin:true};return{restrict:'A',scope:{hasExtraPlugin:'<'},templateUrl:'plugins/Referrers/angularjs/campaign-builder/campaign-builder.directive.html?cb='+piwik.cacheBuster,controller:'CampaignBuilderController',controllerAs:'campaignBuilder',compile:function(element,attrs){for(var index in defaults){if(defaults.hasOwnProperty(index)&&attrs[index]===undefined){attrs[index]=defaults[index];}}
return function(scope,element,attrs){};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.directive').directive('piwikGoalPageLink',piwikGoalPageLink);piwikGoalPageLink.$inject=['$location','piwik'];function piwikGoalPageLink($location,piwik){return{restrict:'A',compile:function(element,attrs){if(attrs.piwikGoalPageLink&&piwik.helper.isAngularRenderingThePage()){var title=element.text();element.html('<a></a>');var link=element.find('a');link.text(title);link.attr('href','javascript:void(0)');link.bind('click',function(){var $search=$location.search();$search.category='Goals_Goals';$search.subcategory=encodeURIComponent(attrs.piwikGoalPageLink);$location.search($search);});}
return function(scope,element,attrs){};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('ManageGoalsController',ManageGoalsController);ManageGoalsController.$inject=['piwik','piwikApi','$timeout','$location','reportingMenuModel','$rootScope'];function ManageGoalsController(piwik,piwikApi,$timeout,$location,reportingMenuModel,$rootScope){var self=this;if(!this.goal){this.goal={};}
this.showEditGoal=false;this.showGoalList=true;function scrollToTop(){$timeout(function(){piwik.helper.lazyScrollTo(".pageWrap",200);});}
function initGoalForm(goalMethodAPI,submitText,goalName,description,matchAttribute,pattern,patternType,caseSensitive,revenue,allowMultiple,useEventValueAsRevenue,goalId){$rootScope.$emit('Goals.beforeInitGoalForm',goalMethodAPI,goalId);self.goal={};self.goal.name=goalName;self.goal.description=description;if(matchAttribute=='manually'){self.goal.triggerType='manually';matchAttribute='url';}else{self.goal.triggerType='visitors';}
if(0===matchAttribute.indexOf('event')){self.goal.eventType=matchAttribute;matchAttribute='event';}else{self.goal.eventType='event_category';}
self.goal.matchAttribute=matchAttribute;self.goal.allowMultiple=allowMultiple;self.goal.patternType=patternType;self.goal.pattern=pattern;self.goal.caseSensitive=caseSensitive;self.goal.revenue=revenue;self.goal.apiMethod=goalMethodAPI;self.goal.useEventValueAsRevenue=useEventValueAsRevenue;self.goal.submitText=submitText;self.goal.goalId=goalId;$timeout(function(){var text=_pk_translate('Goals_AddNewGoal');if(goalId){text=_pk_translate('Goals_UpdateGoal')}
$('.addEditGoal .card-title').text(text);});}
this.isManuallyTriggered=function(){return this.goal.triggerType=='manually';}
this.save=function(){var parameters={};parameters.name=encodeURIComponent(this.goal.name);parameters.description=encodeURIComponent(this.goal.description);if(this.isManuallyTriggered()){parameters.matchAttribute='manually';parameters.patternType='regex';parameters.pattern='.*';parameters.caseSensitive=0;}else{parameters.matchAttribute=this.goal.matchAttribute;if(parameters.matchAttribute==='event'){parameters.matchAttribute=this.goal.eventType;}
parameters.patternType=this.goal.patternType;parameters.pattern=encodeURIComponent(this.goal.pattern);parameters.caseSensitive=this.goal.caseSensitive==true?1:0;}
parameters.revenue=this.goal.revenue||0;parameters.allowMultipleConversionsPerVisit=this.goal.allowMultiple==true?1:0;parameters.useEventValueAsRevenue=this.goal.useEventValueAsRevenue==true?1:0;parameters.idGoal=this.goal.goalId;parameters.method=this.goal.apiMethod;var isCreate=parameters.method==='Goals.addGoal';var isUpdate=parameters.method==='Goals.updateGoal';if(isUpdate){$rootScope.$emit('Goals.beforeUpdateGoal',parameters,piwikApi);}else if(isCreate){$rootScope.$emit('Goals.beforeAddGoal',parameters,piwikApi);}
if(parameters&&'undefined'!==typeof parameters.cancelRequest&&parameters.cancelRequest){return;}
this.isLoading=true;piwikApi.fetch(parameters).then(function(){var search=$location.search();if(search&&search.subcategory&&search.subcategory=='Goals_AddNewGoal'&&piwik.helper.isAngularRenderingThePage()){reportingMenuModel.reloadMenuItems().then(function(){$location.search('subcategory','Goals_ManageGoals');self.isLoading=false;});}else{location.reload();}},function(){scrollToTop();self.isLoading=false;});};this.changedTriggerType=function(){if(!this.isManuallyTriggered()&&!this.goal.patternType){this.goal.patternType='contains';}}
this.showListOfReports=function(shouldScrollToTop){$rootScope.$emit('Goals.cancelForm');this.showGoalList=true;this.showEditGoal=false;scrollToTop();};this.showAddEditForm=function(){this.showGoalList=false;this.showEditGoal=true;};this.createGoal=function(){var parameters={isAllowed:true};$rootScope.$emit('Goals.initAddGoal',parameters);if(parameters&&!parameters.isAllowed){return;}
this.showAddEditForm();initGoalForm('Goals.addGoal',_pk_translate('Goals_AddGoal'),'','','url','','contains',false,'',false,false,'0');scrollToTop();};this.editGoal=function(goalId){this.showAddEditForm();var goal=piwik.goals[goalId];initGoalForm("Goals.updateGoal",_pk_translate('Goals_UpdateGoal'),goal.name,goal.description,goal.match_attribute,goal.pattern,goal.pattern_type,(goal.case_sensitive!='0'),goal.revenue,goal.allow_multiple,(goal.event_value_as_revenue!='0'),goalId);scrollToTop();};this.deleteGoal=function(goalId){var goal=piwik.goals[goalId];$('#confirm').find('h2').text(sprintf(_pk_translate('Goals_DeleteGoalConfirm'),'"'+goal.name+'"'));piwikHelper.modalConfirm('#confirm',{yes:function(){self.isLoading=true;piwikApi.fetch({idGoal:goalId,method:'Goals.deleteGoal'}).then(function(){location.reload();},function(){self.isLoading=false;});}});};this.isMatchAttributeNumeric=function(){return['visit_duration'].indexOf(this.goal.matchAttribute)>-1;};this.initPatternType=function(){if(this.isMatchAttributeNumeric()){this.goal.patternType='greater_than';}else{this.goal.patternType='contains';}};this.getPatternFieldLabel=function(){return this.goal.matchAttribute==='visit_duration'?_pk_translate('Goals_TimeInMinutes'):_pk_translate('Goals_Pattern');};this.showListOfReports(false);}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikManageGoals',piwikManageGoals);piwikManageGoals.$inject=['piwik'];function piwikManageGoals(piwik){return{restrict:'A',priority:10,controller:'ManageGoalsController',controllerAs:'manageGoals',compile:function(element,attrs){return function(scope,element,attrs,controller){if(attrs.showAddGoal){controller.createGoal();}else if(attrs.showGoal){controller.editGoal(attrs.showGoal);}};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
window.SEOWidget={getRank:function(){var ajaxRequest=new ajaxHelper();ajaxRequest.setLoadingElement('#ajaxLoadingSEO');ajaxRequest.addParams({module:'SEO',action:'getRank',url:encodeURIComponent($('#seoUrl').val())},'get');ajaxRequest.setCallback(function(response){$('#SeoRanks').html(response);});ajaxRequest.setFormat('html');ajaxRequest.send();}};
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('LocationProviderSelectionController',LocationProviderSelectionController);LocationProviderSelectionController.$inject=['piwikApi'];function LocationProviderSelectionController(piwikApi){var self=this;this.isLoading=false;this.updateLoading={};this.refreshProviderInfo=function(providerId){this.updateLoading[providerId]=true;var $locationNode=$('.provider'+providerId+' .location');$locationNode.css('visibility','hidden');piwikApi.fetch({module:'UserCountry',action:'getLocationUsingProvider',id:providerId,format:'html'}).then(function(response){self.updateLoading[providerId]=false;$locationNode.html('<strong>'+response+'</strong>').css('visibility','visible');},function(){self.updateLoading[providerId]=false;});};this.save=function(){if(!this.selectedProvider){return;}
this.isLoading=true;var parent=$(this).closest('p'),loading=$('.loadingPiwik',parent),ajaxSuccess=$('.success',parent);piwikApi.withTokenInUrl();piwikApi.fetch({method:'UserCountry.setLocationProvider',providerId:this.selectedProvider}).then(function(){self.isLoading=false;var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(_pk_translate('General_Done'),{context:'success',noclear:true,type:'toast',id:'userCountryLocationProvider'});notification.scrollToNotification();},function(){self.isLoading=false;});};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikLocationProviderSelection',piwikLocationProviderSelection);piwikLocationProviderSelection.$inject=['piwik'];function piwikLocationProviderSelection(piwik){return{restrict:'A',transclude:true,controller:'LocationProviderSelectionController',controllerAs:'locationSelector',template:'<div ng-transclude></div>',compile:function(element,attrs){return function(scope,element,attrs,controller){controller.selectedProvider=attrs.piwikLocationProviderSelection;};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('LocationProviderUpdaterController',LocationProviderUpdaterController);LocationProviderUpdaterController.$inject=['piwikApi','$window'];function LocationProviderUpdaterController(piwikApi,$window){var self=this;this.buttonUpdateSaveText=_pk_translate('General_Save');this.progressUpdateLabel='';var downloadNextChunk=function(action,thisId,progressBarId,cont,extraData,callback){var data={};for(var k in extraData){data[k]=extraData[k];}
piwikApi.withTokenInUrl();piwikApi.post({module:'UserCountry',action:action,'continue':cont?1:0},data).then(function(response){if(!response||response.error){callback(response);}else{var newProgressVal=Math.floor((response.current_size / response.expected_file_size)*100);self[progressBarId]=Math.min(newProgressVal,100);if(newProgressVal<100){downloadNextChunk(action,thisId,progressBarId,true,extraData,callback);}else{callback(response);}}},function(){callback({error:_pk_translate('UserCountry_FatalErrorDuringDownload')});});};this.startDownloadFreeGeoIp=function(){this.showFreeDownload=true;this.showPiwikNotManagingInfo=false;this.progressFreeDownload=0;downloadNextChunk('downloadFreeGeoIPDB','geoipdb-screen2-download','progressFreeDownload',false,{},function(response){if(response.error){$('#geoipdb-update-info').html(response.error);self.geoipDatabaseInstalled=true;}else{$window.location.reload();}});};this.startAutomaticUpdateGeoIp=function(){this.buttonUpdateSaveText=_pk_translate('General_Continue');this.showGeoIpUpdateInfo();};this.showGeoIpUpdateInfo=function(){this.geoipDatabaseInstalled=true;$('#geoip-db-mangement .card-title').text(_pk_translate('UserCountry_SetupAutomaticUpdatesOfGeoIP'));}
this.saveGeoIpLinks=function(){var currentDownloading=null;var updateGeoIPSuccess=function(response){if(response&&response.error){self.isUpdatingGeoIpDatabase=false;var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(response.error,{placeat:'#geoipdb-update-info-error',context:'error',style:{display:'inline-block'},id:'userCountryGeoIpUpdate'});}else if(response&&response.to_download){var continuing=currentDownloading==response.to_download;currentDownloading=response.to_download;self.progressUpdateDownload=0;self.progressUpdateLabel=response.to_download_label;self.isUpdatingGeoIpDatabase=true;downloadNextChunk('downloadMissingGeoIpDb','geoipdb-update-info','progressUpdateDownload',continuing,{key:response.to_download},updateGeoIPSuccess);}else{self.progressUpdateLabel='';self.isUpdatingGeoIpDatabase=false;var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(_pk_translate('General_Done'),{placeat:'#done-updating-updater',context:'success',noclear:true,type:'toast',style:{display:'inline-block'},id:'userCountryGeoIpUpdate'});$('#geoip-updater-next-run-time').html(response.nextRunTime).parent().effect('highlight',{color:'#FFFFCB'},2000);}};piwikApi.withTokenInUrl();piwikApi.post({period:this.updatePeriod,module:'UserCountry',action:'updateGeoIPLinks'},{loc_db:this.locationDbUrl,isp_db:this.ispDbUrl,org_db:this.orgDbUrl}).then(updateGeoIPSuccess);};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikLocationProviderUpdater',piwikLocationProviderUpdater);piwikLocationProviderUpdater.$inject=['piwik'];function piwikLocationProviderUpdater(piwik){return{restrict:'A',transclude:true,controller:'LocationProviderUpdaterController',controllerAs:'locationUpdater',template:'<div ng-transclude></div>',compile:function(element,attrs){return function(scope,element,attrs,controller){controller.geoipDatabaseInstalled='0'!==attrs.geoipDatabaseInstalled;controller.showFreeDownload=false;controller.showPiwikNotManagingInfo=true;controller.progressFreeDownload=0;controller.progressUpdateDownload=0;};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($){$(function(){var switchForm=function(fromFormId,toFormId){var fromFormSelector='#'+fromFormId;var toFormSelector='#'+toFormId;var fromLoginInputId=fromFormSelector+'_login',toLoginInputId=toFormSelector+'_login',toPasswordInputId=toFormSelector+'_password';if($(toLoginInputId).val()===''){$(toLoginInputId).val($(fromLoginInputId).val());}
var contentFrom=$(fromFormSelector).parents('.contentForm').first();var contentTo=$(toFormSelector).parents('.contentForm').first();$(contentFrom).fadeOut(500,function(){Materialize.updateTextFields();$(contentTo).fadeIn(500,function(){if($(toLoginInputId).val()===''){$(toLoginInputId).focus();}else{$(toPasswordInputId).focus();}});});};$('#login_form_redirect').val(window.location.href);$('#login_form_nav').click(function(e){e.preventDefault();switchForm('login_form','reset_form');return false;});$('#reset_form_nav,#alternate_reset_nav').click(function(e){e.preventDefault();switchForm('reset_form','login_form');return false;});$('#reset_form_submit').click(function(e){e.preventDefault();var ajaxDone=function(response){$('.loadingPiwik').hide();var isSuccess=response.indexOf('piwik-notification')===-1,fadeOutIds='.resetForm .message_container';if(isSuccess){fadeOutIds+=',#reset_form,#reset_form_nav';}
$(fadeOutIds).fadeOut(300,function(){if(isSuccess){$('#alternate_reset_nav').show();}
$('.resetForm .message_container').html(response).fadeIn(300);piwikHelper.compileAngularComponents('.resetForm .message_container');});};$('.loadingPiwik').show();$.ajax({type:'POST',url:'index.php',dataType:'html',async:true,error:function(){ajaxDone('<div id="login_error"><strong>HTTP Error</strong></div>');},success:ajaxDone,data:$('#reset_form').serialize()});return false;});$('#login_form_login').focus();Materialize.updateTextFields();});}(jQuery));
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($){window.bruteForceLog={unblockAllIps:function(){piwikHelper.modalConfirm('#confirmUnblockAllIps',{yes:function(){var ajaxRequest=new ajaxHelper();ajaxRequest.addParams({module:'API',method:'Login.unblockBruteForceIPs',},'get');ajaxRequest.setCallback(function(response){piwikHelper.reload();});ajaxRequest.send();}});}};}(jQuery));
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').component('piwikUsersManager',{templateUrl:'plugins/UsersManager/angularjs/users-manager/users-manager.component.html?cb='+piwik.cacheBuster,bindings:{currentUserRole:'<',initialSiteName:'@',initialSiteId:'@',accessLevels:'<',filterAccessLevels:'<'},controller:UsersManagerController});UsersManagerController.$inject=['$element','piwik','piwikApi','$q','$timeout'];function UsersManagerController($element,piwik,piwikApi,$q,$timeout){var vm=this;var search=String(window.location.search);vm.isEditing=!!piwik.helper.getArrayFromQueryString(search).showadduser;vm.isCurrentUserSuperUser=true;vm.users=[];vm.totalEntries=null;vm.searchParams={};vm.isLoadingUsers=false;vm.$onInit=$onInit;vm.$onChanges=$onChanges;vm.$onDestroy=$onDestroy;vm.onEditUser=onEditUser;vm.onDoneEditing=onDoneEditing;vm.showAddExistingUserModal=showAddExistingUserModal;vm.onChangeUserRole=onChangeUserRole;vm.onDeleteUser=onDeleteUser;vm.fetchUsers=fetchUsers;vm.addExistingUser=addExistingUser;function onChangeUserRole(users,role){vm.isLoadingUsers=true;$q.resolve().then(function(){if(users==='all'){return getAllUsersInSearch();}
return users;}).then(function(users){return users.filter(function(user){return user.role!=='superuser';}).map(function(user){return user.login;});}).then(function(userLogins){var requests=userLogins.map(function(login){return{method:'UsersManager.setUserAccess',userLogin:login,access:role,idSites:vm.searchParams.idSite,ignoreSuperusers:1};});return piwikApi.bulkFetch(requests,{createErrorNotification:true});}).catch(function(e){}).then(function(){return fetchUsers();});}
function onDeleteUser(users){vm.isLoadingUsers=true;$q.resolve().then(function(){if(users==='all'){return getAllUsersInSearch();}
return users;}).then(function(users){return users.map(function(user){return user.login;});}).then(function(userLogins){var requests=userLogins.map(function(login){return{method:'UsersManager.deleteUser',userLogin:login};});return piwikApi.bulkFetch(requests,{createErrorNotification:true});}).catch(function(){}).then(function(){return fetchUsers();});}
function $onInit(){$element.tooltip({track:true,content:function(){var title=$(this).attr('title');return piwikHelper.escape(title.replace(/\n/g,'<br />'));},show:false,hide:false});if(vm.currentUserRole==='superuser'){vm.filterAccessLevels.push({key:'superuser',value:'Superuser'});}
vm.searchParams={offset:0,limit:20,filter_search:'',filter_access:'',idSite:vm.initialSiteId};fetchUsers();}
function $onChanges(changes){if(changes.limit){fetchUsers();}}
function $onDestroy(){try{$element.tooltip('destroy');}catch(e){}}
function fetchUsers(){vm.isLoadingUsers=true;return piwikApi.fetch($.extend({},vm.searchParams,{method:'UsersManager.getUsersPlusRole'}),{includeHeaders:true}).then(function(result){vm.totalEntries=parseInt(result.headers('x-matomo-total-results'))||0;vm.users=result.response;vm.isLoadingUsers=false;}).catch(function(){vm.isLoadingUsers=false;});}
function getAllUsersInSearch(){return piwikApi.fetch({method:'UsersManager.getUsersPlusRole',filter_search:vm.searchParams.filter_search,filter_access:vm.searchParams.filter_access,idSite:vm.searchParams.idSite,filter_limit:'-1'});}
function onEditUser(user){piwik.helper.lazyScrollToContent();vm.isEditing=true;vm.userBeingEdited=user;}
function onDoneEditing(isUserModified){vm.isEditing=false;if(isUserModified){fetchUsers();}}
function showAddExistingUserModal(){$element.find('.add-existing-user-modal').openModal({dismissible:false});}
function addExistingUser(){vm.isLoadingUsers=true;return piwikApi.fetch({method:'UsersManager.userExists',userLogin:vm.addNewUserLoginEmail}).then(function(response){if(response&&response.value){return vm.addNewUserLoginEmail;}
return piwikApi.fetch({method:'UsersManager.getUserLoginFromUserEmail',userEmail:vm.addNewUserLoginEmail}).then(function(response){return response.value;});}).then(function(login){return piwikApi.post({method:'UsersManager.setUserAccess'},{userLogin:login,access:'view',idSites:vm.searchParams.idSite});}).catch(function(error){vm.isLoadingUsers=false;throw error;}).then(function(){return fetchUsers();});}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').component('piwikPagedUsersList',{templateUrl:'plugins/UsersManager/angularjs/paged-users-list/paged-users-list.component.html?cb='+piwik.cacheBuster,bindings:{onEditUser:'&',onChangeUserRole:'&',onDeleteUser:'&',onSearchChange:'&',initialSiteId:'<',initialSiteName:'<',currentUserRole:'<',isLoadingUsers:'<',accessLevels:'<',filterAccessLevels:'<',totalEntries:'<',users:'<',searchParams:'<'},controller:PagedUsersListController});PagedUsersListController.$inject=['$element'];function PagedUsersListController($element){var vm=this;vm.bulkActionAccessLevels=null;vm.areAllResultsSelected=false;vm.selectedRows={};vm.isAllCheckboxSelected=false;vm.isBulkActionsDisabled=true;vm.userToChange=null;vm.roleToChangeTo=null;vm.previousRole=null;vm.accessLevelFilter=null;vm.isRoleHelpToggled=false;vm.$onInit=$onInit;vm.$onChanges=$onChanges;vm.onAllCheckboxChange=onAllCheckboxChange;vm.changeUserRole=changeUserRole;vm.onRowSelected=onRowSelected;vm.deleteRequestedUsers=deleteRequestedUsers;vm.getPaginationLowerBound=getPaginationLowerBound;vm.getPaginationUpperBound=getPaginationUpperBound;vm.showDeleteConfirm=showDeleteConfirm;vm.getAffectedUsersCount=getAffectedUsersCount;vm.showAccessChangeConfirm=showAccessChangeConfirm;vm.getRoleDisplay=getRoleDisplay;vm.changeSearch=changeSearch;vm.gotoPreviousPage=gotoPreviousPage;vm.gotoNextPage=gotoNextPage;function changeSearch(changes){var newParams=$.extend({},vm.searchParams,changes);vm.onSearchChange({params:newParams});}
function $onInit(){vm.permissionsForSite={id:vm.initialSiteId,name:vm.initialSiteName};vm.bulkActionAccessLevels=[];vm.anonymousAccessLevels=[];vm.accessLevels.forEach(function(entry){if(entry.key!=='noaccess'&&entry.key!=='superuser'){vm.bulkActionAccessLevels.push(entry);}
if(entry.key==='noaccess'||entry.key==='view'){vm.anonymousAccessLevels.push(entry);}});}
function $onChanges(changes){if(changes.users){clearSelection();}}
function onAllCheckboxChange(){if(!vm.isAllCheckboxSelected){clearSelection();}else{for(var i=0;i!==vm.users.length;++i){vm.selectedRows[i]=true;}
vm.isBulkActionsDisabled=false;}}
function clearSelection(){vm.selectedRows={};vm.areAllResultsSelected=false;vm.isBulkActionsDisabled=true;vm.isAllCheckboxSelected=false;vm.userToChange=null;}
function changeUserRole(){vm.onChangeUserRole({users:getUserOperationSubject(),role:vm.roleToChangeTo});}
function deleteRequestedUsers(){vm.onDeleteUser({users:getUserOperationSubject(),});}
function getUserOperationSubject(){if(vm.userToChange){return[vm.userToChange];}else if(vm.areAllResultsSelected){return'all';}else{return getSelectedUsers();}}
function showAccessChangeConfirm(){$element.find('.change-user-role-confirm-modal').openModal({dismissible:false});}
function getAffectedUsersCount(){if(vm.areAllResultsSelected){return vm.totalEntries;}
return getSelectedCount();}
function onRowSelected(){var selectedRowKeyCount=getSelectedCount();vm.isBulkActionsDisabled=selectedRowKeyCount===0;vm.isAllCheckboxSelected=selectedRowKeyCount===vm.users.length;}
function getSelectedCount(){var selectedRowKeyCount=0;Object.keys(vm.selectedRows).forEach(function(key){if(vm.selectedRows[key]){++selectedRowKeyCount;}});return selectedRowKeyCount;}
function getSelectedUsers(){var result=[];Object.keys(vm.selectedRows).forEach(function(index){if(vm.selectedRows[index]&&vm.users[index]){result.push(vm.users[index]);}});return result;}
function getPaginationLowerBound(){return vm.searchParams.offset+1;}
function getPaginationUpperBound(){return Math.min(vm.searchParams.offset+vm.searchParams.limit,vm.totalEntries);}
function showDeleteConfirm(){$element.find('.delete-user-confirm-modal').openModal({dismissible:false});}
function getRoleDisplay(role){var result=null;vm.accessLevels.forEach(function(entry){if(entry.key===role){result=entry.value;}});return result;}
function gotoPreviousPage(){changeSearch({offset:Math.max(0,vm.searchParams.offset-vm.searchParams.limit)});}
function gotoNextPage(){var newOffset=vm.searchParams.offset+vm.searchParams.limit;if(newOffset>=vm.totalEntries){return;}
changeSearch({offset:newOffset,});}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').component('piwikUserEditForm',{templateUrl:'plugins/UsersManager/angularjs/user-edit-form/user-edit-form.component.html?cb='+piwik.cacheBuster,bindings:{user:'<',onDoneEditing:'&',currentUserRole:'<',accessLevels:'<',filterAccessLevels:'<',initialSiteId:'<',initialSiteName:'<'},controller:UserEditFormController});UserEditFormController.$inject=['$element','piwikApi','$q'];function UserEditFormController($element,piwikApi,$q){var vm=this;vm.activeTab='basic';vm.permissionsForIdSite=1;vm.isSavingUserInfo=false;vm.userHasAccess=true;vm.firstSiteAccess=null;vm.isUserModified=false;vm.passwordConfirmation='';vm.isPasswordModified=false;vm.$onInit=$onInit;vm.$onChanges=$onChanges;vm.confirmSuperUserChange=confirmSuperUserChange;vm.confirmReset2FA=confirmReset2FA;vm.getFormTitle=getFormTitle;vm.getSaveButtonLabel=getSaveButtonLabel;vm.toggleSuperuserAccess=toggleSuperuserAccess;vm.saveUserInfo=saveUserInfo;vm.reset2FA=reset2FA;vm.updateUser=updateUser;vm.setSuperUserAccessChecked=setSuperUserAccessChecked;function $onInit(){vm.firstSiteAccess={id:vm.initialSiteId,name:vm.initialSiteName};}
function $onChanges(){if(vm.user){vm.isAdd=false;}else{vm.isAdd=true;vm.user={};}
if(!vm.isAdd){vm.user.password='XXXXXXXX';}
setSuperUserAccessChecked();}
function getFormTitle(){return vm.isAdd?_pk_translate('UsersManager_AddNewUser'):_pk_translate('UsersManager_EditUser');}
function getSaveButtonLabel(){return vm.isAdd?_pk_translate('UsersManager_CreateUser'):_pk_translate('UsersManager_SaveBasicInfo');}
function confirmSuperUserChange(){$element.find('.superuser-confirm-modal').openModal({dismissible:false});}
function confirmReset2FA(){$element.find('.twofa-confirm-modal').openModal({dismissible:false});}
function confirmUserChange(){vm.passwordConfirmation='';function onEnter(event){var keycode=(event.keyCode?event.keyCode:event.which);if(keycode=='13'){$element.find('.change-password-modal').closeModal();vm.updateUser();}}
$element.find('.change-password-modal').openModal({dismissible:false,ready:function(){$('.modal.open #currentUserPassword').focus();$('.modal.open #currentUserPassword').off('keypress').keypress(onEnter);}});}
function toggleSuperuserAccess(){vm.isSavingUserInfo=true;piwikApi.post({method:'UsersManager.setSuperUserAccess'},{userLogin:vm.user.login,hasSuperUserAccess:vm.user.superuser_access?'0':'1',passwordConfirmation:vm.passwordConfirmationForSuperUser,}).then(function(){vm.user.superuser_access=!vm.user.superuser_access;}).catch(function(){}).then(function(){vm.isSavingUserInfo=false;vm.isUserModified=true;vm.passwordConfirmationForSuperUser=null;setSuperUserAccessChecked();});}
function setSuperUserAccessChecked(){vm.superUserAccessChecked=!!vm.user.superuser_access;}
function saveUserInfo(){if(vm.isAdd){createUser();}else{confirmUserChange();}}
function reset2FA(){vm.isResetting2FA=true;return piwikApi.post({method:'TwoFactorAuth.resetTwoFactorAuth',userLogin:vm.user.login}).catch(function(e){vm.isResetting2FA=false;throw e;}).then(function(){vm.isResetting2FA=false;vm.user.uses_2fa=false;vm.activeTab='basic';showUserSavedNotification();});}
function showUserSavedNotification(){var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(_pk_translate('General_YourChangesHaveBeenSaved'),{context:'success',type:'toast'});}
function createUser(){vm.isSavingUserInfo=true;return piwikApi.post({method:'UsersManager.addUser'},{userLogin:vm.user.login,password:vm.user.password,email:vm.user.email,alias:vm.user.alias,initialIdSite:vm.firstSiteAccess?vm.firstSiteAccess.id:undefined}).catch(function(e){vm.isSavingUserInfo=false;throw e;}).then(function(){vm.firstSiteAccess=null;vm.isSavingUserInfo=false;vm.isAdd=false;vm.isEmailChanged=false;vm.isUserModified=true;showUserSavedNotification();});}
function updateUser(){vm.isSavingUserInfo=true;return piwikApi.post({method:'UsersManager.updateUser'},{userLogin:vm.user.login,password:(vm.isPasswordModified&&vm.user.password)?vm.user.password:undefined,passwordConfirmation:vm.passwordConfirmation?vm.passwordConfirmation:undefined,email:vm.user.email,alias:vm.user.alias}).catch(function(e){vm.isSavingUserInfo=false;vm.passwordConfirmation=false;throw e;}).then(function(){vm.isSavingUserInfo=false;vm.passwordConfirmation=false;vm.isUserModified=true;vm.isPasswordModified=false;showUserSavedNotification();});}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').component('piwikUserPermissionsEdit',{templateUrl:'plugins/UsersManager/angularjs/user-permissions-edit/user-permissions-edit.component.html?cb='+piwik.cacheBuster,bindings:{userLogin:'<',limit:'<',onUserHasAccessDetected:'&',onAccessChange:'&',accessLevels:'<',filterAccessLevels:'<'},controller:UserPermissionsEditController});UserPermissionsEditController.$inject=['piwikApi','$element','$q'];function UserPermissionsEditController(piwikApi,$element,$q){var vm=this;vm.siteAccess=[];vm.offset=0;vm.totalEntries=null;vm.accessLevelFilter='';vm.siteNameFilter='';vm.isLoadingAccess=false;vm.allWebsitesAccssLevelSet='view';vm.isAllCheckboxSelected=false;vm.selectedRows={};vm.isBulkActionsDisabled=true;vm.areAllResultsSelected=false;vm.previousRole=null;vm.hasAccessToAtLeastOneSite=true;vm.isRoleHelpToggled=false;vm.isCapabilitiesHelpToggled=false;vm.isGivingAccessToAllSites=false;vm.roleToChangeTo=null;vm.siteAccessToChange=null;vm.$onInit=$onInit;vm.$onChanges=$onChanges;vm.onAllCheckboxChange=onAllCheckboxChange;vm.onRowSelected=onRowSelected;vm.getPaginationLowerBound=getPaginationLowerBound;vm.getPaginationUpperBound=getPaginationUpperBound;vm.fetchAccess=fetchAccess;vm.gotoPreviousPage=gotoPreviousPage;vm.gotoNextPage=gotoNextPage;vm.showRemoveAccessConfirm=showRemoveAccessConfirm;vm.getSelectedRowsCount=getSelectedRowsCount;vm.getAffectedSitesCount=getAffectedSitesCount;vm.changeUserRole=changeUserRole;vm.showChangeAccessConfirm=showChangeAccessConfirm;vm.getRoleDisplay=getRoleDisplay;vm.showAddExistingUserModal=showAddExistingUserModal;vm.giveAccessToAllSites=giveAccessToAllSites;vm.showChangeAccessAllSitesModal=showChangeAccessAllSitesModal;function giveAccessToAllSites(){vm.isGivingAccessToAllSites=true;piwikApi.fetch({method:'SitesManager.getSitesWithAdminAccess',}).then(function(allSites){var idSites=allSites.map(function(s){return s.idsite;});return piwikApi.post({method:'UsersManager.setUserAccess'},{userLogin:vm.userLogin,access:vm.allWebsitesAccssLevelSet,'idSites[]':idSites,});}).then(function(){return vm.fetchAccess();})['finally'](function(){vm.isGivingAccessToAllSites=false;});}
function showChangeAccessAllSitesModal(){$element.find('.confirm-give-access-all-sites').openModal({dismissible:false});}
function $onInit(){vm.limit=vm.limit||10;resetSiteToAdd();fetchAccess();}
function $onChanges(){vm.accessLevels=vm.accessLevels.filter(shouldShowAccessLevel);vm.filterAccessLevels=vm.filterAccessLevels.filter(shouldShowAccessLevel);if(vm.limit){fetchAccess();}
function shouldShowAccessLevel(entry){return entry.key!=='superuser';}}
function fetchAccess(){vm.isLoadingAccess=true;piwikApi.fetch({method:'UsersManager.getSitesAccessForUser',limit:vm.limit,offset:vm.offset,filter_search:vm.siteNameFilter,filter_access:vm.accessLevelFilter,userLogin:vm.userLogin},{includeHeaders:true}).then(function(result){vm.isLoadingAccess=false;vm.siteAccess=result.response;vm.totalEntries=parseInt(result.headers('x-matomo-total-results'))||0;vm.hasAccessToAtLeastOneSite=!!result.headers('x-matomo-has-some');if(vm.onUserHasAccessDetected){vm.onUserHasAccessDetected({hasAccess:vm.hasAccessToAtLeastOneSite});}
clearSelection();}).catch(function(){vm.isLoadingAccess=false;clearSelection();});}
function getAllSitesInSearch(){return piwikApi.fetch({method:'UsersManager.getSitesAccessForUser',filter_search:vm.siteNameFilter,filter_access:vm.accessLevelFilter,userLogin:vm.userLogin,filter_limit:'-1'}).then(function(access){return access.map(function(a){return a.idsite;});});}
function clearSelection(){vm.selectedRows={};vm.areAllResultsSelected=false;vm.isBulkActionsDisabled=true;vm.isAllCheckboxSelected=false;vm.siteAccessToChange=null;}
function onAllCheckboxChange(){if(!vm.isAllCheckboxSelected){clearSelection();}else{for(var i=0;i!==vm.siteAccess.length;++i){vm.selectedRows[i]=true;}
vm.isBulkActionsDisabled=false;}}
function onRowSelected(){var selectedRowKeyCount=getSelectedRowsCount();vm.isBulkActionsDisabled=selectedRowKeyCount===0;vm.isAllCheckboxSelected=selectedRowKeyCount===vm.siteAccess.length;}
function getPaginationLowerBound(){return vm.offset+1;}
function getPaginationUpperBound(){return Math.min(vm.offset+vm.limit,vm.totalEntries);}
function resetSiteToAdd(){vm.siteToAdd={id:null,name:''};}
function changeUserRole(){vm.isLoadingAccess=true;return $q.resolve().then(function(){if(vm.siteAccessToChange){return[vm.siteAccessToChange.idsite];}
if(vm.areAllResultsSelected){return getAllSitesInSearch();}
return getSelectedSites();}).then(function(idSites){return piwikApi.post({method:'UsersManager.setUserAccess'},{userLogin:vm.userLogin,access:vm.roleToChangeTo,'idSites[]':idSites});}).catch(function(){}).then(function(){vm.onAccessChange();return fetchAccess();});}
function getSelectedSites(){var result=[];Object.keys(vm.selectedRows).forEach(function(index){if(vm.selectedRows[index]&&vm.siteAccess[index]){result.push(vm.siteAccess[index].idsite);}});return result;}
function gotoPreviousPage(){vm.offset=Math.max(0,vm.offset-vm.limit);fetchAccess();}
function gotoNextPage(){var newOffset=vm.offset+vm.limit;if(newOffset>=vm.totalEntries){return;}
vm.offset=newOffset;fetchAccess();}
function showRemoveAccessConfirm(){$element.find('.delete-access-confirm-modal').openModal({dismissible:false});}
function showChangeAccessConfirm(){$element.find('.change-access-confirm-modal').openModal({dismissible:false});}
function showAddExistingUserModal(){$element.find('.add-existing-user-modal').openModal({dismissible:false});}
function getSelectedRowsCount(){var selectedRowKeyCount=0;Object.keys(vm.selectedRows).forEach(function(key){if(vm.selectedRows[key]){++selectedRowKeyCount;}});return selectedRowKeyCount;}
function getAffectedSitesCount(){if(vm.areAllResultsSelected){return vm.totalEntries;}
return getSelectedRowsCount();}
function getRoleDisplay(role){var result=null;vm.accessLevels.forEach(function(entry){if(entry.key===role){result=entry.value;}});return result;}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('PersonalSettingsController',PersonalSettingsController);PersonalSettingsController.$inject=['piwikApi','$filter','$window','piwik'];function PersonalSettingsController(piwikApi,$filter,$window,piwik){var translate=$filter('translate');var self=this;this.newsletterSignupButtonTitle=translate('General_Save');this.doesRequirePasswordConfirmation=false;this.showNewsletterSignup=true;function updateSettings(postParams){self.loading=true;piwikApi.withTokenInUrl();piwikApi.post({module:'UsersManager',action:'recordUserSettings',format:'json'},postParams).then(function(success){var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(_pk_translate('CoreAdminHome_SettingsSaveSuccess'),{id:'PersonalSettingsSuccess',context:'success'});notification.scrollToNotification();self.doesRequirePasswordConfirmation=!!self.password;self.passwordCurrent='';self.loading=false;},function(errorMessage){self.loading=false;self.passwordCurrent='';});}
this.requirePasswordConfirmation=function(){this.doesRequirePasswordConfirmation=true;};this.signupForNewsletter=function(){var signupBtn=$('#newsletterSignupBtn');signupBtn.html(translate('General_Loading'));this.isProcessingNewsletterSignup=true;piwikApi.withTokenInUrl();piwikApi.fetch({module:'API',method:'UsersManager.newsletterSignup'}).then(function(){self.isProcessingNewsletterSignup=false;self.showNewsletterSignup=false;var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(translate('UsersManager_NewsletterSignupSuccessMessage'),{id:'newslettersignup',context:'success'});notification.scrollToNotification();},function(){self.isProcessingNewsletterSignup=false;var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(translate('UsersManager_NewsletterSignupFailureMessage'),{id:'newslettersignup',context:'error'});notification.scrollToNotification();self.newsletterSignupButtonTitle=translate('General_PleaseTryAgain');});};this.regenerateTokenAuth=function(){var parameters={userLogin:piwik.userLogin};self.loading=true;piwikHelper.modalConfirm('#confirmTokenRegenerate',{yes:function(){piwikApi.withTokenInUrl();piwikApi.post({module:'API',method:'UsersManager.regenerateTokenAuth'},parameters).then(function(success){$window.location.reload();self.loading=false;},function(errorMessage){self.loading=false;});}});};this.cancelSave=function(){this.passwordCurrent='';};this.save=function(){if(this.doesRequirePasswordConfirmation&&!this.passwordCurrent){angular.element('#confirmChangesWithPassword').openModal({dismissible:false,ready:function(){$('.modal.open #currentPassword').focus();}});return;}
angular.element('#confirmChangesWithPassword').closeModal();var postParams={email:this.email,defaultReport:this.defaultReport=='MultiSites'?this.defaultReport:this.site.id,defaultDate:this.defaultDate,language:this.language,timeformat:this.timeformat,};if(this.password){postParams.password=this.password;}
if(this.passwordBis){postParams.passwordBis=this.passwordBis;}
if(this.passwordCurrent){postParams.passwordConfirmation=this.passwordCurrent;}
updateSettings(postParams);};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('AnonymousSettingsController',AnonymousSettingsController);AnonymousSettingsController.$inject=['piwikApi'];function AnonymousSettingsController(piwikApi){var self=this;function updateSettings(postParams){self.loading=true;piwikApi.withTokenInUrl();piwikApi.post({module:'UsersManager',action:'recordAnonymousUserSettings',format:'json'},postParams).then(function(success){var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(_pk_translate('CoreAdminHome_SettingsSaveSuccess'),{id:'anonymousUserSettings',context:'success'});notification.scrollToNotification();self.loading=false;},function(errorMessage){self.loading=false;});}
this.save=function(){var postParams={anonymousDefaultReport:this.defaultReport=='1'?this.defaultReportWebsite:this.defaultReport,anonymousDefaultDate:this.defaultDate};updateSettings(postParams);};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').factory('permissionsMetadataService',PermissionsMetadataService);PermissionsMetadataService.$inject=['piwikApi','$q'];function PermissionsMetadataService(piwikApi,$q){var allCapabilities;return{getAllCapabilities:function(){if(allCapabilities){return $q.when(allCapabilities);}
return piwikApi.fetch({method:'UsersManager.getAvailableCapabilities',}).then(function(capabilities){allCapabilities=capabilities;return allCapabilities;});},};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').component('piwikCapabilitiesEdit',{templateUrl:'plugins/UsersManager/angularjs/capabilities-edit/capabilities-edit.component.html?cb='+piwik.cacheBuster,bindings:{idsite:'<',siteName:'<',userLogin:'<',userRole:'<',capabilities:'<',onCapabilitiesChange:'&',},controller:CapabilitiesEditController});CapabilitiesEditController.$inject=['piwikApi','permissionsMetadataService','piwik','$element'];function CapabilitiesEditController(piwikApi,permissionsMetadataService,piwik,$element){var vm=this;vm.isBusy=false;vm.availableCapabilities=[];vm.availableCapabilitiesGrouped=[];vm.capabilitiesSet={};vm.isAddingCapability=false;vm.capabilityToAddOrRemoveId=null;vm.capabilityToAddOrRemove=null;vm.$onInit=$onInit;vm.$onChanges=$onChanges;vm.onToggleCapability=onToggleCapability;vm.toggleCapability=toggleCapability;vm.isIncludedInRole=isIncludedInRole;function $onInit(){fetchAvailableCapabilities();if(typeof vm.capabilities==='undefined'){fetchCapabilities();}}
function $onChanges(){setCapabilitiesSet();}
function isIncludedInRole(capability){return capability.includedInRoles.indexOf(vm.userRole)!==-1;}
function fetchAvailableCapabilities(){permissionsMetadataService.getAllCapabilities().then(function(capabilities){vm.availableCapabilities=capabilities;setCapabilitiesSet();setAvailableCapabilitiesDropdown();});}
function fetchCapabilities(){vm.isBusy=true;piwikApi.fetch({method:'UsersManager.getUsersPlusRole',limit:'1',filter_search:vm.userLogin,}).then(function(user){if(!user||!user.capabilities){return[];}
return user.capabilities;}).then(function(capabilities){vm.capabilities=capabilities;setCapabilitiesSet();setAvailableCapabilitiesDropdown();})['finally'](function(){vm.isBusy=false;});}
function setCapabilitiesSet(){vm.capabilitiesSet={};(vm.capabilities||[]).forEach(function(capability){vm.capabilitiesSet[capability]=true;});(vm.availableCapabilities||[]).forEach(function(capability){if(vm.isIncludedInRole(capability)){vm.capabilitiesSet[capability.id]=true;}});}
function setAvailableCapabilitiesDropdown(){var availableCapabilitiesGrouped=[];vm.availableCapabilities.forEach(function(capability){if(vm.capabilitiesSet[capability.id]){return;}
availableCapabilitiesGrouped.push({group:capability.category,key:capability.id,value:capability.name,tooltip:capability.description,});});vm.availableCapabilitiesGrouped=availableCapabilitiesGrouped;vm.availableCapabilitiesGrouped.sort(function(lhs,rhs){if(lhs.group===rhs.group){if(lhs.value===rhs.value){return 0;}
return lhs.value<rhs.value?-1:1;}
return lhs.group<rhs.group?-1:1;});}
function onToggleCapability(isAdd){vm.isAddingCapability=isAdd;vm.capabilityToAddOrRemove=null;vm.availableCapabilities.forEach(function(capability){if(capability.id===vm.capabilityToAddOrRemoveId){vm.capabilityToAddOrRemove=capability;}});$element.find('.confirmCapabilityToggle').openModal({dismissible:false,yes:function(){},});}
function toggleCapability(){if(vm.isAddingCapability){addCapability(vm.capabilityToAddOrRemove);}else{removeCapability(vm.capabilityToAddOrRemove);}}
function addCapability(capability){vm.isBusy=true;piwikApi.post({method:'UsersManager.addCapabilities',},{userLogin:vm.userLogin,capabilities:capability.id,idSites:vm.idsite}).then(function(){vm.onCapabilitiesChange.call({capabilities:getCapabilitiesList(),});setCapabilitiesSet();setAvailableCapabilitiesDropdown();})['finally'](function(){vm.isBusy=false;vm.capabilityToAddOrRemove=null;vm.capabilityToAddOrRemoveId=null;});}
function removeCapability(capability){vm.isBusy=true;piwikApi.post({method:'UsersManager.removeCapabilities',},{userLogin:vm.userLogin,capabilities:capability.id,idSites:vm.idsite}).then(function(){vm.onCapabilitiesChange.call({capabilities:getCapabilitiesList(),});setCapabilitiesSet();setAvailableCapabilitiesDropdown();})['finally'](function(){vm.isBusy=false;vm.capabilityToAddOrRemove=null;vm.capabilityToAddOrRemoveId=null;});}
function getCapabilitiesList(){var result=[];vm.availableCapabilities.forEach(function(capability){if(vm.isIncludedInRole(capability)){return;}
if(vm.capabilitiesSet[capability.id]){result.push(capability.id);}});return result;}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').factory('sitesManagerApiHelper',SitesManagerAPIHelperFactory);SitesManagerAPIHelperFactory.$inject=['piwikApi'];function SitesManagerAPIHelperFactory(piwikApi){return{fetch:fetch,commaDelimitedFieldToArray:commaDelimitedFieldToArray,fetchApi:fetchApi,fetchAction:fetchAction,singleObjectAdaptor:singleObjectAdaptor,valueAdaptor:valueAdaptor,noop:noop};function fetch(endpoint,jsonResponseAdaptor,params){return function(clientHandover,additionalParams){params=angular.extend(params||{},additionalParams||{});var requestDefinition=angular.extend(endpoint,params);var responseHandler=function(response){response=jsonResponseAdaptor(response);clientHandover(response);};piwikApi.fetch(requestDefinition).then(responseHandler);};}
function commaDelimitedFieldToArray(value){if(!value)
return[];return value.split(',');}
function fetchApi(apiMethod,jsonResponseAdaptor,params){return fetch({method:apiMethod},jsonResponseAdaptor,params);}
function fetchAction(module,action,jsonResponseAdaptor,params){return fetch({module:module,action:action},jsonResponseAdaptor,params);}
function singleObjectAdaptor(response){return response[0];}
function valueAdaptor(response){return response.value;}
function noop(response){return response;}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').factory('sitesManagerAPI',SitesManagerAPIFactory);SitesManagerAPIFactory.$inject=['sitesManagerApiHelper'];function SitesManagerAPIFactory(api){return{getCurrencyList:getCurrencyList(),getTimezonesList:getTimezonesList(),isTimezoneSupportEnabled:isTimezoneSupportEnabled(),getGlobalSettings:getGlobalSettings(),getSitesIdWithAdminAccess:getSitesIdWithAdminAccess()};function getSitesIdWithAdminAccess(){return api.fetchApi('SitesManager.getSitesIdWithAdminAccess',api.noop,{filter_limit:'-1',});}
function getCurrencyList(){return api.fetchApi('SitesManager.getCurrencyList',api.noop);}
function getTimezonesList(){return api.fetchApi('SitesManager.getTimezonesList',api.noop);}
function isTimezoneSupportEnabled(){return api.fetchApi('SitesManager.isTimezoneSupportEnabled',api.valueAdaptor);}
function getGlobalSettings(){return api.fetchAction('SitesManager','getGlobalSettings',api.noop);}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').factory('coreAPI',CoreAPIFactory);CoreAPIFactory.$inject=['sitesManagerApiHelper'];function CoreAPIFactory(api){return{getIpFromHeader:getIpFromHeader(),isPluginActivated:isPluginActivated()};function getIpFromHeader(){return api.fetchApi('API.getIpFromHeader',api.valueAdaptor);}
function isPluginActivated(){return api.fetchApi('API.isPluginActivated',api.valueAdaptor);}}})();
(function(){angular.module('piwikApp').factory('sitesManagerTypeModel',sitesManagerTypeModel);sitesManagerTypeModel.$inject=['piwikApi'];function sitesManagerTypeModel(piwikApi){var typesPromise=null;var model={typesById:{},fetchTypeById:fetchTypeById,fetchAvailableTypes:fetchAvailableTypes,hasMultipleTypes:hasMultipleTypes};return model;function hasMultipleTypes(typeId){return fetchAvailableTypes().then(function(types){return types&&types.length>1;});}
function fetchTypeById(typeId){return fetchAvailableTypes().then(function(){return model.typesById[typeId];});}
function fetchAvailableTypes(){if(!typesPromise){typesPromise=piwikApi.fetch({method:'API.getAvailableMeasurableTypes',filter_limit:'-1'}).then(function(types){angular.forEach(types,function(type){model.typesById[type.id]=type;});return types;});}
return typesPromise;}}})();
(function(){angular.module('piwikApp').factory('sitesManagerAdminSitesModel',sitesManagerAdminSitesModel);sitesManagerAdminSitesModel.$inject=['piwikApi'];function sitesManagerAdminSitesModel(piwikApi){var model={sites:[],searchTerm:'',isLoading:false,pageSize:10,currentPage:0,offsetStart:0,offsetEnd:10,hasPrev:false,hasNext:false,previousPage:previousPage,nextPage:nextPage,searchSite:searchSite,fetchLimitedSitesWithAdminAccess:fetchLimitedSitesWithAdminAccess};return model;function onError(){setSites([]);}
function setSites(sites){model.sites=sites;var numSites=sites.length;model.offsetStart=model.currentPage*model.pageSize+1;model.offsetEnd=model.offsetStart+numSites-1;model.hasPrev=model.currentPage>=1;model.hasNext=numSites===model.pageSize;}
function setCurrentPage(page){if(page<0){page=0;}
model.currentPage=page;}
function previousPage(){setCurrentPage(model.currentPage-1);fetchLimitedSitesWithAdminAccess();}
function nextPage(){setCurrentPage(model.currentPage+1);fetchLimitedSitesWithAdminAccess();}
function searchSite(term){model.searchTerm=term;setCurrentPage(0);fetchLimitedSitesWithAdminAccess();}
function fetchLimitedSitesWithAdminAccess(callback){if(model.isLoading){piwikApi.abort();}
model.isLoading=true;var limit=model.pageSize;var offset=model.currentPage*model.pageSize;var params={method:'SitesManager.getSitesWithAdminAccess',fetchAliasUrls:true,limit:limit+offset,filter_offset:offset,filter_limit:limit};if(model.searchTerm){params.pattern=model.searchTerm;}
return piwikApi.fetch(params).then(function(sites){if(!sites){onError();return;}
setSites(sites);},onError).finally(function(){if(callback){callback();}
model.isLoading=false;});}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('sitesManagerMultilineField',sitesManagerMultilineField);function sitesManagerMultilineField(){return{restrict:'A',replace:true,scope:{managedValue:'=field',rows:'@?',cols:'@?'},templateUrl:'plugins/SitesManager/angularjs/sites-manager/multiline-field.directive.html?cb='+piwik.cacheBuster,link:function(scope){var separator='\n';var init=function(){scope.field={};scope.onChange=updateManagedScopeValue;scope.$watch('managedValue',updateInputValue);};var updateManagedScopeValue=function(){scope.managedValue=scope.field.value.trim().split(separator);};var updateInputValue=function(){if(angular.isUndefined(scope.managedValue))
return;scope.field.value=scope.managedValue.join(separator);};init();}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('sitesManagerEditTrigger',sitesManagerEditTrigger);function sitesManagerEditTrigger(){return{restrict:'A',link:function(scope,element){element.bind('click',function(){if(!scope.site.editMode)
scope.$apply(scope.editSite());});scope.$watch('site.editMode',function(){element.toggleClass('editable-site-field',!scope.site.editMode);});}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('SitesManagerController',SitesManagerController);SitesManagerController.$inject=['$scope','$filter','coreAPI','sitesManagerAPI','piwikApi','sitesManagerAdminSitesModel','piwik','sitesManagerApiHelper','sitesManagerTypeModel','$rootScope','$window'];function SitesManagerController($scope,$filter,coreAPI,sitesManagerAPI,piwikApi,adminSites,piwik,sitesManagerApiHelper,sitesManagerTypeModel,$rootScope,$window){var translate=$filter('translate');$scope.globalSettings={};$rootScope.$on('$locationChangeSuccess',function(){if(piwik.hasSuperUserAccess){if($window.location.hash==='#globalSettings'||$window.location.hash==='#/globalSettings'){broadcast.propagateNewPage('action=globalSettings');}}});var init=function(){$scope.period=piwik.broadcast.getValueFromUrl('period');$scope.date=piwik.broadcast.getValueFromUrl('date');$scope.adminSites=adminSites;$scope.hasSuperUserAccess=piwik.hasSuperUserAccess;$scope.redirectParams={showaddsite:false};$scope.cacheBuster=piwik.cacheBuster;$scope.totalNumberOfSites='?';initSelectLists();initUtcTime();initUserIP();initCustomVariablesActivated();initIsTimezoneSupportEnabled();initGlobalParams();initActions();};var initActions=function(){$scope.cancelEditSite=cancelEditSite;$scope.addSite=addSite;$scope.addNewEntity=addNewEntity;$scope.saveGlobalSettings=saveGlobalSettings;$scope.lookupCurrentEditSite=lookupCurrentEditSite;};var initAvailableTypes=function(){return sitesManagerTypeModel.fetchAvailableTypes().then(function(types){$scope.availableTypes=types;$scope.typeForNewEntity='website';return types;});};var initSelectLists=function(){initCurrencyList();initTimezones();};var initGlobalParams=function(){showLoading();var availableTypesPromise=initAvailableTypes();sitesManagerAPI.getGlobalSettings(function(globalSettings){$scope.globalSettings=globalSettings;$scope.globalSettings.searchKeywordParametersGlobal=sitesManagerApiHelper.commaDelimitedFieldToArray($scope.globalSettings.searchKeywordParametersGlobal);$scope.globalSettings.searchCategoryParametersGlobal=sitesManagerApiHelper.commaDelimitedFieldToArray($scope.globalSettings.searchCategoryParametersGlobal);$scope.globalSettings.excludedIpsGlobal=sitesManagerApiHelper.commaDelimitedFieldToArray($scope.globalSettings.excludedIpsGlobal);$scope.globalSettings.excludedQueryParametersGlobal=sitesManagerApiHelper.commaDelimitedFieldToArray($scope.globalSettings.excludedQueryParametersGlobal);$scope.globalSettings.excludedUserAgentsGlobal=sitesManagerApiHelper.commaDelimitedFieldToArray($scope.globalSettings.excludedUserAgentsGlobal);hideLoading();initKeepURLFragmentsList();adminSites.fetchLimitedSitesWithAdminAccess(function(){availableTypesPromise.then(function(){triggerAddSiteIfRequested();});});sitesManagerAPI.getSitesIdWithAdminAccess(function(siteIds){if(siteIds&&siteIds.length){$scope.totalNumberOfSites=siteIds.length;}});});};var triggerAddSiteIfRequested=function(){var search=String(window.location.search);if(piwik.helper.getArrayFromQueryString(search).showaddsite==1)
addNewEntity();};var initUtcTime=function(){var currentDate=new Date();$scope.utcTime=new Date(currentDate.getUTCFullYear(),currentDate.getUTCMonth(),currentDate.getUTCDate(),currentDate.getUTCHours(),currentDate.getUTCMinutes(),currentDate.getUTCSeconds());};var initIsTimezoneSupportEnabled=function(){sitesManagerAPI.isTimezoneSupportEnabled(function(timezoneSupportEnabled){$scope.timezoneSupportEnabled=timezoneSupportEnabled;});};var initTimezones=function(){sitesManagerAPI.getTimezonesList(function(timezones){var scopeTimezones=[];$scope.timezones=[];angular.forEach(timezones,function(groupTimezones,timezoneGroup){angular.forEach(groupTimezones,function(label,code){scopeTimezones.push({group:timezoneGroup,key:code,value:label});});});$scope.timezones=scopeTimezones;});};var initCustomVariablesActivated=function(){coreAPI.isPluginActivated(function(customVariablesActivated){$scope.customVariablesActivated=customVariablesActivated;},{pluginName:'CustomVariables'});};var initUserIP=function(){coreAPI.getIpFromHeader(function(ip){$scope.currentIpAddress=ip;});};var initKeepURLFragmentsList=function(){$scope.keepURLFragmentsOptions=[{key:0,value:($scope.globalSettings.keepURLFragmentsGlobal?translate('General_Yes'):translate('General_No'))+' ('+translate('General_Default')+')'},{key:1,value:translate('General_Yes')},{key:2,value:translate('General_No')}];};var addNewEntity=function(){sitesManagerTypeModel.hasMultipleTypes().then(function(hasMultipleTypes){if(hasMultipleTypes){$scope.showAddSiteDialog=true;}else if($scope.availableTypes.length===1){var type=$scope.availableTypes[0].id;addSite(type);}});};var addSite=function(type){var parameters={isAllowed:true,measurableType:type};$rootScope.$emit('SitesManager.initAddSite',parameters);if(parameters&&!parameters.isAllowed){return;}
if(!type){type='website';}
$scope.adminSites.sites.unshift({type:type});};var saveGlobalSettings=function(){var ajaxHandler=new ajaxHelper();ajaxHandler.addParams({module:'SitesManager',format:'json',action:'setGlobalSettings'},'GET');ajaxHandler.addParams({timezone:$scope.globalSettings.defaultTimezone,currency:$scope.globalSettings.defaultCurrency,excludedIps:$scope.globalSettings.excludedIpsGlobal.join(','),excludedQueryParameters:$scope.globalSettings.excludedQueryParametersGlobal.join(','),excludedUserAgents:$scope.globalSettings.excludedUserAgentsGlobal.join(','),keepURLFragments:$scope.globalSettings.keepURLFragmentsGlobal?1:0,enableSiteUserAgentExclude:$scope.globalSettings.siteSpecificUserAgentExcludeEnabled?1:0,searchKeywordParameters:$scope.globalSettings.searchKeywordParametersGlobal.join(','),searchCategoryParameters:$scope.globalSettings.searchCategoryParametersGlobal.join(',')},'POST');ajaxHandler.withTokenInUrl();ajaxHandler.redirectOnSuccess($scope.redirectParams);ajaxHandler.setLoadingElement();ajaxHandler.send();};var cancelEditSite=function(site){site.editMode=false;var idSite=site.idsite;if(idSite){var siteElement=$('.site[idsite='+idSite+']');if(siteElement[0]){siteElement[0].scrollIntoView();}}};var lookupCurrentEditSite=function(){var sitesInEditMode=$scope.adminSites.sites.filter(function(site){return site.editMode;});return sitesInEditMode[0];};var initCurrencyList=function(){sitesManagerAPI.getCurrencyList(function(currencies){$scope.currencies=currencies;});};var showLoading=function(){$scope.loading=true;};var hideLoading=function(){$scope.loading=false;};init();}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('SitesManagerSiteController',SitesManagerSiteController);SitesManagerSiteController.$inject=['$scope','$filter','sitesManagerApiHelper','sitesManagerTypeModel','piwikApi','$timeout'];function SitesManagerSiteController($scope,$filter,sitesManagerApiHelper,sitesManagerTypeModel,piwikApi,$timeout){var translate=$filter('translate');var updateView=function(){$timeout(function(){$('.editingSite').find('select').material_select();Materialize.updateTextFields();});}
var init=function(){initModel();initActions();$scope.site.isLoading=true;sitesManagerTypeModel.fetchTypeById($scope.site.type).then(function(type){$scope.site.isLoading=false;if(type){$scope.currentType=type;$scope.howToSetupUrl=type.howToSetupUrl;$scope.isInternalSetupUrl='?'===(''+type.howToSetupUrl).substr(0,1);$scope.typeSettings=type.settings;if(isSiteNew()){$scope.measurableSettings=angular.copy(type.settings);}}else{$scope.currentType={name:$scope.site.type};}});};var initActions=function(){$scope.editSite=editSite;$scope.saveSite=saveSite;$scope.openDeleteDialog=openDeleteDialog;$scope.site['delete']=deleteSite;};var initModel=function(){if(isSiteNew()){initNewSite();}else{$scope.site.excluded_ips=sitesManagerApiHelper.commaDelimitedFieldToArray($scope.site.excluded_ips);$scope.site.excluded_parameters=sitesManagerApiHelper.commaDelimitedFieldToArray($scope.site.excluded_parameters);$scope.site.excluded_user_agents=sitesManagerApiHelper.commaDelimitedFieldToArray($scope.site.excluded_user_agents);$scope.site.sitesearch_keyword_parameters=sitesManagerApiHelper.commaDelimitedFieldToArray($scope.site.sitesearch_keyword_parameters);$scope.site.sitesearch_category_parameters=sitesManagerApiHelper.commaDelimitedFieldToArray($scope.site.sitesearch_category_parameters);}
$scope.site.removeDialog={};updateView();};var editSite=function(){$scope.site.editMode=true;$scope.measurableSettings=[];$scope.site.isLoading=true;piwikApi.fetch({method:'SitesManager.getSiteSettings',idSite:$scope.site.idsite}).then(function(settings){$scope.measurableSettings=settings;$scope.site.isLoading=false;},function(){$scope.site.isLoading=false;});updateView();};var saveSite=function(){var sendSiteSearchKeywordParams=$scope.site.sitesearch=='1'&&!$scope.site.useDefaultSiteSearchParams;var sendSearchCategoryParameters=sendSiteSearchKeywordParams&&$scope.customVariablesActivated;var values={siteName:$scope.site.name,timezone:$scope.site.timezone,currency:$scope.site.currency,type:$scope.site.type,settingValues:{}};var isNewSite=isSiteNew();var apiMethod='SitesManager.addSite';if(!isNewSite){apiMethod='SitesManager.updateSite';values.idSite=$scope.site.idsite;}
angular.forEach($scope.measurableSettings,function(settings){if(!values['settingValues'][settings.pluginName]){values['settingValues'][settings.pluginName]=[];}
angular.forEach(settings.settings,function(setting){var value=setting.value;if(value===false){value='0';}else if(value===true){value='1';}
if(angular.isArray(value)&&setting.uiControl=='textarea'){var newValue=[];angular.forEach(value,function(val){if(val){newValue.push(val);}});value=newValue;}
values['settingValues'][settings.pluginName].push({name:setting.name,value:value});});});piwikApi.post({method:apiMethod},values).then(function(response){$scope.site.editMode=false;var UI=require('piwik/UI');var notification=new UI.Notification();var message='Website updated';if(isNewSite){message='Website created';}
notification.show(message,{context:'success',id:'websitecreated'});notification.scrollToNotification();if(!$scope.site.idsite&&response&&response.value){$scope.site.idsite=response.value;}
angular.forEach(values.settingValues,function(settings,pluginName){angular.forEach(settings,function(setting){if(setting.name==='urls'){$scope.site.alias_urls=setting.value;}else{$scope.site[setting.name]=setting.value;}});});});};var isSiteNew=function(){return angular.isUndefined($scope.site.idsite);};var initNewSite=function(){$scope.site.editMode=true;$scope.site.timezone=$scope.globalSettings.defaultTimezone;$scope.site.currency=$scope.globalSettings.defaultCurrency;if($scope.typeSettings){$scope.measurableSettings=angular.copy($scope.typeSettings);}};var openDeleteDialog=function(){$scope.site.removeDialog.title=translate('SitesManager_DeleteConfirm','"'+$scope.site.name+'" (idSite = '+$scope.site.idsite+')');$scope.site.removeDialog.show=true;};var deleteSite=function(){var redirectParams=$scope.redirectParams;if(broadcast.getValueFromUrl('idSite')==$scope.site.idsite){var sites=$scope.adminSites.sites;var otherSite;for(var i=0;i!==sites.length;++i){if(sites[i].idsite!=$scope.site.idsite){otherSite=sites[i];break;}}
if(otherSite){redirectParams=$.extend({},redirectParams,{idSite:otherSite.idsite});}}
var ajaxHandler=new ajaxHelper();ajaxHandler.addParams({idSite:$scope.site.idsite,module:'API',format:'json',method:'SitesManager.deleteSite'},'GET');ajaxHandler.redirectOnSuccess(redirectParams);ajaxHandler.setLoadingElement();ajaxHandler.send();};init();}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('ManageScheduledReportController',ManageScheduledReportController);ManageScheduledReportController.$inject=['piwik'];function ManageScheduledReportController(piwik){var self=this;function getTimeZoneDifferenceInHours(){return piwik.timezoneOffset / 3600;}
this.reportHours=[];for(var i=0;i<24;i++){if((getTimeZoneDifferenceInHours()*2)%2!=0){this.reportHours.push({key:i+'.5',value:i+':30'});}else{this.reportHours.push({key:i+'',value:i+''});}}
function scrollToTop(){piwikHelper.lazyScrollTo(".emailReports",200);}
function updateParameters(reportType,report){if(updateReportParametersFunctions&&updateReportParametersFunctions[reportType]){updateReportParametersFunctions[reportType](report);}}
function resetParameters(reportType,report){if(resetReportParametersFunctions&&resetReportParametersFunctions[reportType]){resetReportParametersFunctions[reportType](report)}}
function adjustHourToTimezone(hour,difference){return''+((24+parseFloat(hour)+difference)%24);}
function updateReportHourUtc(report){var reportHour=adjustHourToTimezone(report.hour,-getTimeZoneDifferenceInHours());report.hourUtc=_pk_translate('ScheduledReports_ReportHourWithUTC',[reportHour]);}
function formSetEditReport(idReport){var report={'type':ReportPlugin.defaultReportType,'format':ReportPlugin.defaultReportFormat,'description':'','period':ReportPlugin.defaultPeriod,'hour':ReportPlugin.defaultHour,'reports':[],'evolutionPeriodFor':'prev','evolutionPeriodN':ReportPlugin.defaultEvolutionPeriodN,'periodParam':ReportPlugin.defaultPeriod,};if(idReport>0){report=ReportPlugin.reportList[idReport];updateParameters(report.type,report);self.saveButtonTitle=ReportPlugin.updateReportString;}else{self.saveButtonTitle=ReportPlugin.createReportString;resetParameters(report.type,report);}
report.hour=adjustHourToTimezone(report.hour,getTimeZoneDifferenceInHours());updateReportHourUtc(report);setTimeout(function(){$('[name=reportsList] input').prop('checked',false);var key;for(key in report.reports){$('.'+report.type+' [report-unique-id='+report.reports[key]+']').prop('checked','checked');}});report['format'+report.type]=report.format;self.report=report;self.report.description=piwik.helper.htmlDecode(self.report.description);self.editingReportId=idReport;}
function getReportAjaxRequest(idReport,defaultApiMethod){scrollToTop();var ajaxHandler=new ajaxHelper();var parameters={module:'API',method:defaultApiMethod,format:'json'};if(idReport==0){parameters.method='ScheduledReports.addReport';}
ajaxHandler.addParams(parameters,'GET');return ajaxHandler;}
function fadeInOutSuccessMessage(selector,message){var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(message,{placeat:selector,context:'success',noclear:true,type:'toast',style:{display:'inline-block',marginTop:'10px'},id:'scheduledReportSuccess'});piwikHelper.refreshAfter(2);}
this.updateReportHourUtc=function(){updateReportHourUtc(this.report);};this.submitReport=function(){var idReport=this.editingReportId;var apiParameters={};apiParameters.idReport=idReport;apiParameters.description=this.report.description;apiParameters.idSegment=this.report.idsegment;apiParameters.reportType=this.report.type;apiParameters.reportFormat=this.report['format'+this.report.type];apiParameters.periodParam=this.report.periodParam;apiParameters.evolutionPeriodFor=this.report.evolutionPeriodFor;if(apiParameters.evolutionPeriodFor!=='each'){apiParameters.evolutionPeriodN=this.report.evolutionPeriodN;}
var period=self.report.period;var hour=adjustHourToTimezone(this.report.hour,-getTimeZoneDifferenceInHours());var reports=[];$('[name=reportsList].'+apiParameters.reportType+' input:checked').each(function(){reports.push($(this).attr('report-unique-id'));});if(reports.length>0){apiParameters.reports=reports;}
apiParameters.parameters=getReportParametersFunctions[this.report.type](this.report);var ajaxHandler=getReportAjaxRequest(idReport,'ScheduledReports.updateReport');ajaxHandler.addParams(apiParameters,'POST');ajaxHandler.addParams({period:period},'GET');ajaxHandler.addParams({hour:hour},'GET');ajaxHandler.redirectOnSuccess();ajaxHandler.setLoadingElement();if(idReport){ajaxHandler.setCallback(function(response){fadeInOutSuccessMessage('#reportUpdatedSuccess',_pk_translate('ScheduledReports_ReportUpdated'));});}
ajaxHandler.send();return false;};this.changedReportType=function(){resetParameters(this.report.type,this.report);};this.displayReport=function(reportId){$('#downloadReportForm_'+reportId).submit();};this.sendReportNow=function(idReport){var ajaxHandler=getReportAjaxRequest(idReport,'ScheduledReports.sendReport');ajaxHandler.addParams({idReport:idReport,force:true},'POST');ajaxHandler.setLoadingElement();ajaxHandler.setCallback(function(response){fadeInOutSuccessMessage('#reportSentSuccess',_pk_translate('ScheduledReports_ReportSent'));});ajaxHandler.send();};this.deleteReport=function(idReport){function onDelete(){var ajaxHandler=getReportAjaxRequest(idReport,'ScheduledReports.deleteReport');ajaxHandler.addParams({idReport:idReport},'POST');ajaxHandler.redirectOnSuccess();ajaxHandler.setLoadingElement();ajaxHandler.send();}
piwikHelper.modalConfirm('#confirm',{yes:onDelete});};this.showListOfReports=function(shouldScrollToTop){this.showReportsList=true;this.showReportForm=false;piwik.helper.hideAjaxError();if(typeof shouldScrollToTop==='undefined'||!shouldScrollToTop){scrollToTop();}};this.showAddEditForm=function(){this.showReportsList=false;this.showReportForm=true;};this.createReport=function(){this.showAddEditForm();formSetEditReport(0);}
this.editReport=function(reportId){this.showAddEditForm();formSetEditReport(reportId);};this.getFrequencyPeriodSingle=function(){if(!this.report||!this.report.period){return'';}
var translation=ReportPlugin.periodTranslations[this.report.period];if(!translation){translation=ReportPlugin.periodTranslations.day;}
return translation.single;};this.getFrequencyPeriodPlural=function(){if(!this.report||!this.report.period){return'';}
var translation=ReportPlugin.periodTranslations[this.report.period];if(!translation){translation=ReportPlugin.periodTranslations.day;}
return translation.plural;};this.showListOfReports(false);}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
var getReportParametersFunctions=Object();var updateReportParametersFunctions=Object();var resetReportParametersFunctions=Object();(function(){angular.module('piwikApp').directive('piwikManageScheduledReport',piwikManageScheduledReport);piwikManageScheduledReport.$inject=['piwik'];function piwikManageScheduledReport(piwik){return{restrict:'A',priority:10,controller:'ManageScheduledReportController',controllerAs:'manageScheduledReport'};}})();
// ┌───────────────────────────────────────────────────────────────────────────────────────────────────────┐ \\
// │ Raphaël 2.2.7 - JavaScript Vector Library                                                             │ \\
// ├───────────────────────────────────────────────────────────────────────────────────────────────────────┤ \\
// │ Copyright © 2008-2016 Dmitry Baranovskiy (http://raphaeljs.com)                                       │ \\
// │ Copyright © 2008-2016 Sencha Labs (http://sencha.com)                                                 │ \\
// ├───────────────────────────────────────────────────────────────────────────────────────────────────────┤ \\
// │ Licensed under the MIT (https://github.com/DmitryBaranovskiy/raphael/blob/master/license.txt) license.│ \\
// └───────────────────────────────────────────────────────────────────────────────────────────────────────┘ \\
!function t(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.Raphael=r():e.Raphael=r()}(this,function(){return function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){var i,n;i=[r(1),r(3),r(4)],n=function(t){return t}.apply(e,i),!(void 0!==n&&(t.exports=n))},function(t,e,r){var i,n;i=[r(2)],n=function(t){function e(r){if(e.is(r,"function"))return w?r():t.on("raphael.DOMload",r);if(e.is(r,Q))return e._engine.create[z](e,r.splice(0,3+e.is(r[0],$))).add(r);var i=Array.prototype.slice.call(arguments,0);if(e.is(i[i.length-1],"function")){var n=i.pop();return w?n.call(e._engine.create[z](e,i)):t.on("raphael.DOMload",function(){n.call(e._engine.create[z](e,i))})}return e._engine.create[z](e,arguments)}function r(t){if("function"==typeof t||Object(t)!==t)return t;var e=new t.constructor;for(var i in t)t[A](i)&&(e[i]=r(t[i]));return e}function i(t,e){for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return t.push(t.splice(r,1)[0])}function n(t,e,r){function n(){var a=Array.prototype.slice.call(arguments,0),s=a.join("␀"),o=n.cache=n.cache||{},l=n.count=n.count||[];return o[A](s)?(i(l,s),r?r(o[s]):o[s]):(l.length>=1e3&&delete o[l.shift()],l.push(s),o[s]=t[z](e,a),r?r(o[s]):o[s])}return n}function a(){return this.hex}function s(t,e){for(var r=[],i=0,n=t.length;n-2*!e>i;i+=2){var a=[{x:+t[i-2],y:+t[i-1]},{x:+t[i],y:+t[i+1]},{x:+t[i+2],y:+t[i+3]},{x:+t[i+4],y:+t[i+5]}];e?i?n-4==i?a[3]={x:+t[0],y:+t[1]}:n-2==i&&(a[2]={x:+t[0],y:+t[1]},a[3]={x:+t[2],y:+t[3]}):a[0]={x:+t[n-2],y:+t[n-1]}:n-4==i?a[3]=a[2]:i||(a[0]={x:+t[i],y:+t[i+1]}),r.push(["C",(-a[0].x+6*a[1].x+a[2].x)/6,(-a[0].y+6*a[1].y+a[2].y)/6,(a[1].x+6*a[2].x-a[3].x)/6,(a[1].y+6*a[2].y-a[3].y)/6,a[2].x,a[2].y])}return r}function o(t,e,r,i,n){var a=-3*e+9*r-9*i+3*n,s=t*a+6*e-12*r+6*i;return t*s-3*e+3*r}function l(t,e,r,i,n,a,s,l,h){null==h&&(h=1),h=h>1?1:h<0?0:h;for(var u=h/2,c=12,f=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],p=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],d=0,g=0;g<c;g++){var v=u*f[g]+u,x=o(v,t,r,n,s),y=o(v,e,i,a,l),m=x*x+y*y;d+=p[g]*Y.sqrt(m)}return u*d}function h(t,e,r,i,n,a,s,o,h){if(!(h<0||l(t,e,r,i,n,a,s,o)<h)){var u=1,c=u/2,f=u-c,p,d=.01;for(p=l(t,e,r,i,n,a,s,o,f);H(p-h)>d;)c/=2,f+=(p<h?1:-1)*c,p=l(t,e,r,i,n,a,s,o,f);return f}}function u(t,e,r,i,n,a,s,o){if(!(W(t,r)<G(n,s)||G(t,r)>W(n,s)||W(e,i)<G(a,o)||G(e,i)>W(a,o))){var l=(t*i-e*r)*(n-s)-(t-r)*(n*o-a*s),h=(t*i-e*r)*(a-o)-(e-i)*(n*o-a*s),u=(t-r)*(a-o)-(e-i)*(n-s);if(u){var c=l/u,f=h/u,p=+c.toFixed(2),d=+f.toFixed(2);if(!(p<+G(t,r).toFixed(2)||p>+W(t,r).toFixed(2)||p<+G(n,s).toFixed(2)||p>+W(n,s).toFixed(2)||d<+G(e,i).toFixed(2)||d>+W(e,i).toFixed(2)||d<+G(a,o).toFixed(2)||d>+W(a,o).toFixed(2)))return{x:c,y:f}}}}function c(t,e){return p(t,e)}function f(t,e){return p(t,e,1)}function p(t,r,i){var n=e.bezierBBox(t),a=e.bezierBBox(r);if(!e.isBBoxIntersect(n,a))return i?0:[];for(var s=l.apply(0,t),o=l.apply(0,r),h=W(~~(s/5),1),c=W(~~(o/5),1),f=[],p=[],d={},g=i?0:[],v=0;v<h+1;v++){var x=e.findDotsAtSegment.apply(e,t.concat(v/h));f.push({x:x.x,y:x.y,t:v/h})}for(v=0;v<c+1;v++)x=e.findDotsAtSegment.apply(e,r.concat(v/c)),p.push({x:x.x,y:x.y,t:v/c});for(v=0;v<h;v++)for(var y=0;y<c;y++){var m=f[v],b=f[v+1],_=p[y],w=p[y+1],k=H(b.x-m.x)<.001?"y":"x",B=H(w.x-_.x)<.001?"y":"x",C=u(m.x,m.y,b.x,b.y,_.x,_.y,w.x,w.y);if(C){if(d[C.x.toFixed(4)]==C.y.toFixed(4))continue;d[C.x.toFixed(4)]=C.y.toFixed(4);var S=m.t+H((C[k]-m[k])/(b[k]-m[k]))*(b.t-m.t),A=_.t+H((C[B]-_[B])/(w[B]-_[B]))*(w.t-_.t);S>=0&&S<=1.001&&A>=0&&A<=1.001&&(i?g++:g.push({x:C.x,y:C.y,t1:G(S,1),t2:G(A,1)}))}}return g}function d(t,r,i){t=e._path2curve(t),r=e._path2curve(r);for(var n,a,s,o,l,h,u,c,f,d,g=i?0:[],v=0,x=t.length;v<x;v++){var y=t[v];if("M"==y[0])n=l=y[1],a=h=y[2];else{"C"==y[0]?(f=[n,a].concat(y.slice(1)),n=f[6],a=f[7]):(f=[n,a,n,a,l,h,l,h],n=l,a=h);for(var m=0,b=r.length;m<b;m++){var _=r[m];if("M"==_[0])s=u=_[1],o=c=_[2];else{"C"==_[0]?(d=[s,o].concat(_.slice(1)),s=d[6],o=d[7]):(d=[s,o,s,o,u,c,u,c],s=u,o=c);var w=p(f,d,i);if(i)g+=w;else{for(var k=0,B=w.length;k<B;k++)w[k].segment1=v,w[k].segment2=m,w[k].bez1=f,w[k].bez2=d;g=g.concat(w)}}}}}return g}function g(t,e,r,i,n,a){null!=t?(this.a=+t,this.b=+e,this.c=+r,this.d=+i,this.e=+n,this.f=+a):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function v(){return this.x+j+this.y}function x(){return this.x+j+this.y+j+this.width+" × "+this.height}function y(t,e,r,i,n,a){function s(t){return((c*t+u)*t+h)*t}function o(t,e){var r=l(t,e);return((d*r+p)*r+f)*r}function l(t,e){var r,i,n,a,o,l;for(n=t,l=0;l<8;l++){if(a=s(n)-t,H(a)<e)return n;if(o=(3*c*n+2*u)*n+h,H(o)<1e-6)break;n-=a/o}if(r=0,i=1,n=t,n<r)return r;if(n>i)return i;for(;r<i;){if(a=s(n),H(a-t)<e)return n;t>a?r=n:i=n,n=(i-r)/2+r}return n}var h=3*e,u=3*(i-e)-h,c=1-h-u,f=3*r,p=3*(n-r)-f,d=1-f-p;return o(t,1/(200*a))}function m(t,e){var r=[],i={};if(this.ms=e,this.times=1,t){for(var n in t)t[A](n)&&(i[ht(n)]=t[n],r.push(ht(n)));r.sort(Bt)}this.anim=i,this.top=r[r.length-1],this.percents=r}function b(r,i,n,a,s,o){n=ht(n);var l,h,u,c=[],f,p,d,v=r.ms,x={},m={},b={};if(a)for(w=0,B=Ee.length;w<B;w++){var _=Ee[w];if(_.el.id==i.id&&_.anim==r){_.percent!=n?(Ee.splice(w,1),u=1):h=_,i.attr(_.totalOrigin);break}}else a=+m;for(var w=0,B=r.percents.length;w<B;w++){if(r.percents[w]==n||r.percents[w]>a*r.top){n=r.percents[w],p=r.percents[w-1]||0,v=v/r.top*(n-p),f=r.percents[w+1],l=r.anim[n];break}a&&i.attr(r.anim[r.percents[w]])}if(l){if(h)h.initstatus=a,h.start=new Date-h.ms*a;else{for(var C in l)if(l[A](C)&&(pt[A](C)||i.paper.customAttributes[A](C)))switch(x[C]=i.attr(C),null==x[C]&&(x[C]=ft[C]),m[C]=l[C],pt[C]){case $:b[C]=(m[C]-x[C])/v;break;case"colour":x[C]=e.getRGB(x[C]);var S=e.getRGB(m[C]);b[C]={r:(S.r-x[C].r)/v,g:(S.g-x[C].g)/v,b:(S.b-x[C].b)/v};break;case"path":var T=Qt(x[C],m[C]),E=T[1];for(x[C]=T[0],b[C]=[],w=0,B=x[C].length;w<B;w++){b[C][w]=[0];for(var M=1,N=x[C][w].length;M<N;M++)b[C][w][M]=(E[w][M]-x[C][w][M])/v}break;case"transform":var L=i._,z=le(L[C],m[C]);if(z)for(x[C]=z.from,m[C]=z.to,b[C]=[],b[C].real=!0,w=0,B=x[C].length;w<B;w++)for(b[C][w]=[x[C][w][0]],M=1,N=x[C][w].length;M<N;M++)b[C][w][M]=(m[C][w][M]-x[C][w][M])/v;else{var F=i.matrix||new g,R={_:{transform:L.transform},getBBox:function(){return i.getBBox(1)}};x[C]=[F.a,F.b,F.c,F.d,F.e,F.f],se(R,m[C]),m[C]=R._.transform,b[C]=[(R.matrix.a-F.a)/v,(R.matrix.b-F.b)/v,(R.matrix.c-F.c)/v,(R.matrix.d-F.d)/v,(R.matrix.e-F.e)/v,(R.matrix.f-F.f)/v]}break;case"csv":var j=I(l[C])[q](k),D=I(x[C])[q](k);if("clip-rect"==C)for(x[C]=D,b[C]=[],w=D.length;w--;)b[C][w]=(j[w]-x[C][w])/v;m[C]=j;break;default:for(j=[][P](l[C]),D=[][P](x[C]),b[C]=[],w=i.paper.customAttributes[C].length;w--;)b[C][w]=((j[w]||0)-(D[w]||0))/v}var V=l.easing,O=e.easing_formulas[V];if(!O)if(O=I(V).match(st),O&&5==O.length){var Y=O;O=function(t){return y(t,+Y[1],+Y[2],+Y[3],+Y[4],v)}}else O=St;if(d=l.start||r.start||+new Date,_={anim:r,percent:n,timestamp:d,start:d+(r.del||0),status:0,initstatus:a||0,stop:!1,ms:v,easing:O,from:x,diff:b,to:m,el:i,callback:l.callback,prev:p,next:f,repeat:o||r.times,origin:i.attr(),totalOrigin:s},Ee.push(_),a&&!h&&!u&&(_.stop=!0,_.start=new Date-v*a,1==Ee.length))return Ne();u&&(_.start=new Date-_.ms*a),1==Ee.length&&Me(Ne)}t("raphael.anim.start."+i.id,i,r)}}function _(t){for(var e=0;e<Ee.length;e++)Ee[e].el.paper==t&&Ee.splice(e--,1)}e.version="2.2.0",e.eve=t;var w,k=/[, ]+/,B={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},C=/\{(\d+)\}/g,S="prototype",A="hasOwnProperty",T={doc:document,win:window},E={was:Object.prototype[A].call(T.win,"Raphael"),is:T.win.Raphael},M=function(){this.ca=this.customAttributes={}},N,L="appendChild",z="apply",P="concat",F="ontouchstart"in T.win||T.win.DocumentTouch&&T.doc instanceof DocumentTouch,R="",j=" ",I=String,q="split",D="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[q](j),V={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},O=I.prototype.toLowerCase,Y=Math,W=Y.max,G=Y.min,H=Y.abs,X=Y.pow,U=Y.PI,$="number",Z="string",Q="array",J="toString",K="fill",tt=Object.prototype.toString,et={},rt="push",it=e._ISURL=/^url\(['"]?(.+?)['"]?\)$/i,nt=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,at={NaN:1,Infinity:1,"-Infinity":1},st=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,ot=Y.round,lt="setAttribute",ht=parseFloat,ut=parseInt,ct=I.prototype.toUpperCase,ft=e._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0,"class":""},pt=e._availableAnimAttrs={blur:$,"clip-rect":"csv",cx:$,cy:$,fill:"colour","fill-opacity":$,"font-size":$,height:$,opacity:$,path:"path",r:$,rx:$,ry:$,stroke:"colour","stroke-opacity":$,"stroke-width":$,transform:"transform",width:$,x:$,y:$},dt=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]/g,gt=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,vt={hs:1,rg:1},xt=/,?([achlmqrstvxz]),?/gi,yt=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,mt=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,bt=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,_t=e._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,wt={},kt=function(t,e){return t.key-e.key},Bt=function(t,e){return ht(t)-ht(e)},Ct=function(){},St=function(t){return t},At=e._rectPath=function(t,e,r,i,n){return n?[["M",t+n,e],["l",r-2*n,0],["a",n,n,0,0,1,n,n],["l",0,i-2*n],["a",n,n,0,0,1,-n,n],["l",2*n-r,0],["a",n,n,0,0,1,-n,-n],["l",0,2*n-i],["a",n,n,0,0,1,n,-n],["z"]]:[["M",t,e],["l",r,0],["l",0,i],["l",-r,0],["z"]]},Tt=function(t,e,r,i){return null==i&&(i=r),[["M",t,e],["m",0,-i],["a",r,i,0,1,1,0,2*i],["a",r,i,0,1,1,0,-2*i],["z"]]},Et=e._getPath={path:function(t){return t.attr("path")},circle:function(t){var e=t.attrs;return Tt(e.cx,e.cy,e.r)},ellipse:function(t){var e=t.attrs;return Tt(e.cx,e.cy,e.rx,e.ry)},rect:function(t){var e=t.attrs;return At(e.x,e.y,e.width,e.height,e.r)},image:function(t){var e=t.attrs;return At(e.x,e.y,e.width,e.height)},text:function(t){var e=t._getBBox();return At(e.x,e.y,e.width,e.height)},set:function(t){var e=t._getBBox();return At(e.x,e.y,e.width,e.height)}},Mt=e.mapPath=function(t,e){if(!e)return t;var r,i,n,a,s,o,l;for(t=Qt(t),n=0,s=t.length;n<s;n++)for(l=t[n],a=1,o=l.length;a<o;a+=2)r=e.x(l[a],l[a+1]),i=e.y(l[a],l[a+1]),l[a]=r,l[a+1]=i;return t};if(e._g=T,e.type=T.win.SVGAngle||T.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==e.type){var Nt=T.doc.createElement("div"),Lt;if(Nt.innerHTML='<v:shape adj="1"/>',Lt=Nt.firstChild,Lt.style.behavior="url(#default#VML)",!Lt||"object"!=typeof Lt.adj)return e.type=R;Nt=null}e.svg=!(e.vml="VML"==e.type),e._Paper=M,e.fn=N=M.prototype=e.prototype,e._id=0,e.is=function(t,e){return e=O.call(e),"finite"==e?!at[A](+t):"array"==e?t instanceof Array:"null"==e&&null===t||e==typeof t&&null!==t||"object"==e&&t===Object(t)||"array"==e&&Array.isArray&&Array.isArray(t)||tt.call(t).slice(8,-1).toLowerCase()==e},e.angle=function(t,r,i,n,a,s){if(null==a){var o=t-i,l=r-n;return o||l?(180+180*Y.atan2(-l,-o)/U+360)%360:0}return e.angle(t,r,a,s)-e.angle(i,n,a,s)},e.rad=function(t){return t%360*U/180},e.deg=function(t){return Math.round(180*t/U%360*1e3)/1e3},e.snapTo=function(t,r,i){if(i=e.is(i,"finite")?i:10,e.is(t,Q)){for(var n=t.length;n--;)if(H(t[n]-r)<=i)return t[n]}else{t=+t;var a=r%t;if(a<i)return r-a;if(a>t-i)return r-a+t}return r};var zt=e.createUUID=function(t,e){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(t,e).toUpperCase()}}(/[xy]/g,function(t){var e=16*Y.random()|0,r="x"==t?e:3&e|8;return r.toString(16)});e.setWindow=function(r){t("raphael.setWindow",e,T.win,r),T.win=r,T.doc=T.win.document,e._engine.initWin&&e._engine.initWin(T.win)};var Pt=function(t){if(e.vml){var r=/^\s+|\s+$/g,i;try{var a=new ActiveXObject("htmlfile");a.write("<body>"),a.close(),i=a.body}catch(s){i=createPopup().document.body}var o=i.createTextRange();Pt=n(function(t){try{i.style.color=I(t).replace(r,R);var e=o.queryCommandValue("ForeColor");return e=(255&e)<<16|65280&e|(16711680&e)>>>16,"#"+("000000"+e.toString(16)).slice(-6)}catch(n){return"none"}})}else{var l=T.doc.createElement("i");l.title="Raphaël Colour Picker",l.style.display="none",T.doc.body.appendChild(l),Pt=n(function(t){return l.style.color=t,T.doc.defaultView.getComputedStyle(l,R).getPropertyValue("color")})}return Pt(t)},Ft=function(){return"hsb("+[this.h,this.s,this.b]+")"},Rt=function(){return"hsl("+[this.h,this.s,this.l]+")"},jt=function(){return this.hex},It=function(t,r,i){if(null==r&&e.is(t,"object")&&"r"in t&&"g"in t&&"b"in t&&(i=t.b,r=t.g,t=t.r),null==r&&e.is(t,Z)){var n=e.getRGB(t);t=n.r,r=n.g,i=n.b}return(t>1||r>1||i>1)&&(t/=255,r/=255,i/=255),[t,r,i]},qt=function(t,r,i,n){t*=255,r*=255,i*=255;var a={r:t,g:r,b:i,hex:e.rgb(t,r,i),toString:jt};return e.is(n,"finite")&&(a.opacity=n),a};e.color=function(t){var r;return e.is(t,"object")&&"h"in t&&"s"in t&&"b"in t?(r=e.hsb2rgb(t),t.r=r.r,t.g=r.g,t.b=r.b,t.hex=r.hex):e.is(t,"object")&&"h"in t&&"s"in t&&"l"in t?(r=e.hsl2rgb(t),t.r=r.r,t.g=r.g,t.b=r.b,t.hex=r.hex):(e.is(t,"string")&&(t=e.getRGB(t)),e.is(t,"object")&&"r"in t&&"g"in t&&"b"in t?(r=e.rgb2hsl(t),t.h=r.h,t.s=r.s,t.l=r.l,r=e.rgb2hsb(t),t.v=r.b):(t={hex:"none"},t.r=t.g=t.b=t.h=t.s=t.v=t.l=-1)),t.toString=jt,t},e.hsb2rgb=function(t,e,r,i){this.is(t,"object")&&"h"in t&&"s"in t&&"b"in t&&(r=t.b,e=t.s,i=t.o,t=t.h),t*=360;var n,a,s,o,l;return t=t%360/60,l=r*e,o=l*(1-H(t%2-1)),n=a=s=r-l,t=~~t,n+=[l,o,0,0,o,l][t],a+=[o,l,l,o,0,0][t],s+=[0,0,o,l,l,o][t],qt(n,a,s,i)},e.hsl2rgb=function(t,e,r,i){this.is(t,"object")&&"h"in t&&"s"in t&&"l"in t&&(r=t.l,e=t.s,t=t.h),(t>1||e>1||r>1)&&(t/=360,e/=100,r/=100),t*=360;var n,a,s,o,l;return t=t%360/60,l=2*e*(r<.5?r:1-r),o=l*(1-H(t%2-1)),n=a=s=r-l/2,t=~~t,n+=[l,o,0,0,o,l][t],a+=[o,l,l,o,0,0][t],s+=[0,0,o,l,l,o][t],qt(n,a,s,i)},e.rgb2hsb=function(t,e,r){r=It(t,e,r),t=r[0],e=r[1],r=r[2];var i,n,a,s;return a=W(t,e,r),s=a-G(t,e,r),i=0==s?null:a==t?(e-r)/s:a==e?(r-t)/s+2:(t-e)/s+4,i=(i+360)%6*60/360,n=0==s?0:s/a,{h:i,s:n,b:a,toString:Ft}},e.rgb2hsl=function(t,e,r){r=It(t,e,r),t=r[0],e=r[1],r=r[2];var i,n,a,s,o,l;return s=W(t,e,r),o=G(t,e,r),l=s-o,i=0==l?null:s==t?(e-r)/l:s==e?(r-t)/l+2:(t-e)/l+4,i=(i+360)%6*60/360,a=(s+o)/2,n=0==l?0:a<.5?l/(2*a):l/(2-2*a),{h:i,s:n,l:a,toString:Rt}},e._path2string=function(){return this.join(",").replace(xt,"$1")};var Dt=e._preload=function(t,e){var r=T.doc.createElement("img");r.style.cssText="position:absolute;left:-9999em;top:-9999em",r.onload=function(){e.call(this),this.onload=null,T.doc.body.removeChild(this)},r.onerror=function(){T.doc.body.removeChild(this)},T.doc.body.appendChild(r),r.src=t};e.getRGB=n(function(t){if(!t||(t=I(t)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:a};if("none"==t)return{r:-1,g:-1,b:-1,hex:"none",toString:a};!(vt[A](t.toLowerCase().substring(0,2))||"#"==t.charAt())&&(t=Pt(t));var r,i,n,s,o,l,h,u=t.match(nt);return u?(u[2]&&(s=ut(u[2].substring(5),16),n=ut(u[2].substring(3,5),16),i=ut(u[2].substring(1,3),16)),u[3]&&(s=ut((l=u[3].charAt(3))+l,16),n=ut((l=u[3].charAt(2))+l,16),i=ut((l=u[3].charAt(1))+l,16)),u[4]&&(h=u[4][q](gt),i=ht(h[0]),"%"==h[0].slice(-1)&&(i*=2.55),n=ht(h[1]),"%"==h[1].slice(-1)&&(n*=2.55),s=ht(h[2]),"%"==h[2].slice(-1)&&(s*=2.55),"rgba"==u[1].toLowerCase().slice(0,4)&&(o=ht(h[3])),h[3]&&"%"==h[3].slice(-1)&&(o/=100)),u[5]?(h=u[5][q](gt),i=ht(h[0]),"%"==h[0].slice(-1)&&(i*=2.55),n=ht(h[1]),"%"==h[1].slice(-1)&&(n*=2.55),s=ht(h[2]),"%"==h[2].slice(-1)&&(s*=2.55),("deg"==h[0].slice(-3)||"°"==h[0].slice(-1))&&(i/=360),"hsba"==u[1].toLowerCase().slice(0,4)&&(o=ht(h[3])),h[3]&&"%"==h[3].slice(-1)&&(o/=100),e.hsb2rgb(i,n,s,o)):u[6]?(h=u[6][q](gt),i=ht(h[0]),"%"==h[0].slice(-1)&&(i*=2.55),n=ht(h[1]),"%"==h[1].slice(-1)&&(n*=2.55),s=ht(h[2]),"%"==h[2].slice(-1)&&(s*=2.55),("deg"==h[0].slice(-3)||"°"==h[0].slice(-1))&&(i/=360),"hsla"==u[1].toLowerCase().slice(0,4)&&(o=ht(h[3])),h[3]&&"%"==h[3].slice(-1)&&(o/=100),e.hsl2rgb(i,n,s,o)):(u={r:i,g:n,b:s,toString:a},u.hex="#"+(16777216|s|n<<8|i<<16).toString(16).slice(1),e.is(o,"finite")&&(u.opacity=o),u)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:a}},e),e.hsb=n(function(t,r,i){return e.hsb2rgb(t,r,i).hex}),e.hsl=n(function(t,r,i){return e.hsl2rgb(t,r,i).hex}),e.rgb=n(function(t,e,r){function i(t){return t+.5|0}return"#"+(16777216|i(r)|i(e)<<8|i(t)<<16).toString(16).slice(1)}),e.getColor=function(t){var e=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},r=this.hsb2rgb(e.h,e.s,e.b);return e.h+=.075,e.h>1&&(e.h=0,e.s-=.2,e.s<=0&&(this.getColor.start={h:0,s:1,b:e.b})),r.hex},e.getColor.reset=function(){delete this.start},e.parsePathString=function(t){if(!t)return null;var r=Vt(t);if(r.arr)return Yt(r.arr);var i={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},n=[];return e.is(t,Q)&&e.is(t[0],Q)&&(n=Yt(t)),n.length||I(t).replace(yt,function(t,e,r){var a=[],s=e.toLowerCase();if(r.replace(bt,function(t,e){e&&a.push(+e)}),"m"==s&&a.length>2&&(n.push([e][P](a.splice(0,2))),s="l",e="m"==e?"l":"L"),"r"==s)n.push([e][P](a));else for(;a.length>=i[s]&&(n.push([e][P](a.splice(0,i[s]))),i[s]););}),n.toString=e._path2string,r.arr=Yt(n),n},e.parseTransformString=n(function(t){if(!t)return null;var r={r:3,s:4,t:2,m:6},i=[];return e.is(t,Q)&&e.is(t[0],Q)&&(i=Yt(t)),i.length||I(t).replace(mt,function(t,e,r){var n=[],a=O.call(e);r.replace(bt,function(t,e){e&&n.push(+e)}),i.push([e][P](n))}),i.toString=e._path2string,i});var Vt=function(t){var e=Vt.ps=Vt.ps||{};return e[t]?e[t].sleep=100:e[t]={sleep:100},setTimeout(function(){for(var r in e)e[A](r)&&r!=t&&(e[r].sleep--,!e[r].sleep&&delete e[r])}),e[t]};e.findDotsAtSegment=function(t,e,r,i,n,a,s,o,l){var h=1-l,u=X(h,3),c=X(h,2),f=l*l,p=f*l,d=u*t+3*c*l*r+3*h*l*l*n+p*s,g=u*e+3*c*l*i+3*h*l*l*a+p*o,v=t+2*l*(r-t)+f*(n-2*r+t),x=e+2*l*(i-e)+f*(a-2*i+e),y=r+2*l*(n-r)+f*(s-2*n+r),m=i+2*l*(a-i)+f*(o-2*a+i),b=h*t+l*r,_=h*e+l*i,w=h*n+l*s,k=h*a+l*o,B=90-180*Y.atan2(v-y,x-m)/U;return(v>y||x<m)&&(B+=180),{x:d,y:g,m:{x:v,y:x},n:{x:y,y:m},start:{x:b,y:_},end:{x:w,y:k},alpha:B}},e.bezierBBox=function(t,r,i,n,a,s,o,l){e.is(t,"array")||(t=[t,r,i,n,a,s,o,l]);var h=Zt.apply(null,t);return{x:h.min.x,y:h.min.y,x2:h.max.x,y2:h.max.y,width:h.max.x-h.min.x,height:h.max.y-h.min.y}},e.isPointInsideBBox=function(t,e,r){return e>=t.x&&e<=t.x2&&r>=t.y&&r<=t.y2},e.isBBoxIntersect=function(t,r){var i=e.isPointInsideBBox;return i(r,t.x,t.y)||i(r,t.x2,t.y)||i(r,t.x,t.y2)||i(r,t.x2,t.y2)||i(t,r.x,r.y)||i(t,r.x2,r.y)||i(t,r.x,r.y2)||i(t,r.x2,r.y2)||(t.x<r.x2&&t.x>r.x||r.x<t.x2&&r.x>t.x)&&(t.y<r.y2&&t.y>r.y||r.y<t.y2&&r.y>t.y)},e.pathIntersection=function(t,e){return d(t,e)},e.pathIntersectionNumber=function(t,e){return d(t,e,1)},e.isPointInsidePath=function(t,r,i){var n=e.pathBBox(t);return e.isPointInsideBBox(n,r,i)&&d(t,[["M",r,i],["H",n.x2+10]],1)%2==1},e._removedFactory=function(e){return function(){t("raphael.log",null,"Raphaël: you are calling to method “"+e+"” of removed object",e)}};var Ot=e.pathBBox=function(t){var e=Vt(t);if(e.bbox)return r(e.bbox);if(!t)return{x:0,y:0,width:0,height:0,x2:0,y2:0};t=Qt(t);for(var i=0,n=0,a=[],s=[],o,l=0,h=t.length;l<h;l++)if(o=t[l],"M"==o[0])i=o[1],n=o[2],a.push(i),s.push(n);else{var u=Zt(i,n,o[1],o[2],o[3],o[4],o[5],o[6]);a=a[P](u.min.x,u.max.x),s=s[P](u.min.y,u.max.y),i=o[5],n=o[6]}var c=G[z](0,a),f=G[z](0,s),p=W[z](0,a),d=W[z](0,s),g=p-c,v=d-f,x={x:c,y:f,x2:p,y2:d,width:g,height:v,cx:c+g/2,cy:f+v/2};return e.bbox=r(x),x},Yt=function(t){var i=r(t);return i.toString=e._path2string,i},Wt=e._pathToRelative=function(t){var r=Vt(t);if(r.rel)return Yt(r.rel);e.is(t,Q)&&e.is(t&&t[0],Q)||(t=e.parsePathString(t));var i=[],n=0,a=0,s=0,o=0,l=0;"M"==t[0][0]&&(n=t[0][1],a=t[0][2],s=n,o=a,l++,i.push(["M",n,a]));for(var h=l,u=t.length;h<u;h++){var c=i[h]=[],f=t[h];if(f[0]!=O.call(f[0]))switch(c[0]=O.call(f[0]),c[0]){case"a":c[1]=f[1],c[2]=f[2],c[3]=f[3],c[4]=f[4],c[5]=f[5],c[6]=+(f[6]-n).toFixed(3),c[7]=+(f[7]-a).toFixed(3);break;case"v":c[1]=+(f[1]-a).toFixed(3);break;case"m":s=f[1],o=f[2];default:for(var p=1,d=f.length;p<d;p++)c[p]=+(f[p]-(p%2?n:a)).toFixed(3)}else{c=i[h]=[],"m"==f[0]&&(s=f[1]+n,o=f[2]+a);for(var g=0,v=f.length;g<v;g++)i[h][g]=f[g]}var x=i[h].length;switch(i[h][0]){case"z":n=s,a=o;break;case"h":n+=+i[h][x-1];break;case"v":a+=+i[h][x-1];break;default:n+=+i[h][x-2],a+=+i[h][x-1]}}return i.toString=e._path2string,r.rel=Yt(i),i},Gt=e._pathToAbsolute=function(t){var r=Vt(t);if(r.abs)return Yt(r.abs);if(e.is(t,Q)&&e.is(t&&t[0],Q)||(t=e.parsePathString(t)),!t||!t.length)return[["M",0,0]];var i=[],n=0,a=0,o=0,l=0,h=0;"M"==t[0][0]&&(n=+t[0][1],a=+t[0][2],o=n,l=a,h++,i[0]=["M",n,a]);for(var u=3==t.length&&"M"==t[0][0]&&"R"==t[1][0].toUpperCase()&&"Z"==t[2][0].toUpperCase(),c,f,p=h,d=t.length;p<d;p++){if(i.push(c=[]),f=t[p],f[0]!=ct.call(f[0]))switch(c[0]=ct.call(f[0]),c[0]){case"A":c[1]=f[1],c[2]=f[2],c[3]=f[3],c[4]=f[4],c[5]=f[5],c[6]=+(f[6]+n),c[7]=+(f[7]+a);break;case"V":c[1]=+f[1]+a;break;case"H":c[1]=+f[1]+n;break;case"R":for(var g=[n,a][P](f.slice(1)),v=2,x=g.length;v<x;v++)g[v]=+g[v]+n,g[++v]=+g[v]+a;i.pop(),i=i[P](s(g,u));break;case"M":o=+f[1]+n,l=+f[2]+a;default:for(v=1,x=f.length;v<x;v++)c[v]=+f[v]+(v%2?n:a)}else if("R"==f[0])g=[n,a][P](f.slice(1)),i.pop(),i=i[P](s(g,u)),c=["R"][P](f.slice(-2));else for(var y=0,m=f.length;y<m;y++)c[y]=f[y];switch(c[0]){case"Z":n=o,a=l;break;case"H":n=c[1];break;case"V":a=c[1];break;case"M":o=c[c.length-2],l=c[c.length-1];default:n=c[c.length-2],a=c[c.length-1]}}return i.toString=e._path2string,r.abs=Yt(i),i},Ht=function(t,e,r,i){return[t,e,r,i,r,i]},Xt=function(t,e,r,i,n,a){var s=1/3,o=2/3;return[s*t+o*r,s*e+o*i,s*n+o*r,s*a+o*i,n,a]},Ut=function(t,e,r,i,a,s,o,l,h,u){var c=120*U/180,f=U/180*(+a||0),p=[],d,g=n(function(t,e,r){var i=t*Y.cos(r)-e*Y.sin(r),n=t*Y.sin(r)+e*Y.cos(r);return{x:i,y:n}});if(u)S=u[0],A=u[1],B=u[2],C=u[3];else{d=g(t,e,-f),t=d.x,e=d.y,d=g(l,h,-f),l=d.x,h=d.y;var v=Y.cos(U/180*a),x=Y.sin(U/180*a),y=(t-l)/2,m=(e-h)/2,b=y*y/(r*r)+m*m/(i*i);b>1&&(b=Y.sqrt(b),r=b*r,i=b*i);var _=r*r,w=i*i,k=(s==o?-1:1)*Y.sqrt(H((_*w-_*m*m-w*y*y)/(_*m*m+w*y*y))),B=k*r*m/i+(t+l)/2,C=k*-i*y/r+(e+h)/2,S=Y.asin(((e-C)/i).toFixed(9)),A=Y.asin(((h-C)/i).toFixed(9));S=t<B?U-S:S,A=l<B?U-A:A,S<0&&(S=2*U+S),A<0&&(A=2*U+A),o&&S>A&&(S-=2*U),!o&&A>S&&(A-=2*U)}var T=A-S;if(H(T)>c){var E=A,M=l,N=h;A=S+c*(o&&A>S?1:-1),l=B+r*Y.cos(A),h=C+i*Y.sin(A),p=Ut(l,h,r,i,a,0,o,M,N,[A,E,B,C])}T=A-S;var L=Y.cos(S),z=Y.sin(S),F=Y.cos(A),R=Y.sin(A),j=Y.tan(T/4),I=4/3*r*j,D=4/3*i*j,V=[t,e],O=[t+I*z,e-D*L],W=[l+I*R,h-D*F],G=[l,h];if(O[0]=2*V[0]-O[0],O[1]=2*V[1]-O[1],u)return[O,W,G][P](p);p=[O,W,G][P](p).join()[q](",");for(var X=[],$=0,Z=p.length;$<Z;$++)X[$]=$%2?g(p[$-1],p[$],f).y:g(p[$],p[$+1],f).x;return X},$t=function(t,e,r,i,n,a,s,o,l){var h=1-l;return{x:X(h,3)*t+3*X(h,2)*l*r+3*h*l*l*n+X(l,3)*s,y:X(h,3)*e+3*X(h,2)*l*i+3*h*l*l*a+X(l,3)*o}},Zt=n(function(t,e,r,i,n,a,s,o){var l=n-2*r+t-(s-2*n+r),h=2*(r-t)-2*(n-r),u=t-r,c=(-h+Y.sqrt(h*h-4*l*u))/2/l,f=(-h-Y.sqrt(h*h-4*l*u))/2/l,p=[e,o],d=[t,s],g;return H(c)>"1e12"&&(c=.5),H(f)>"1e12"&&(f=.5),c>0&&c<1&&(g=$t(t,e,r,i,n,a,s,o,c),d.push(g.x),p.push(g.y)),f>0&&f<1&&(g=$t(t,e,r,i,n,a,s,o,f),d.push(g.x),p.push(g.y)),l=a-2*i+e-(o-2*a+i),h=2*(i-e)-2*(a-i),u=e-i,c=(-h+Y.sqrt(h*h-4*l*u))/2/l,f=(-h-Y.sqrt(h*h-4*l*u))/2/l,H(c)>"1e12"&&(c=.5),H(f)>"1e12"&&(f=.5),c>0&&c<1&&(g=$t(t,e,r,i,n,a,s,o,c),d.push(g.x),p.push(g.y)),f>0&&f<1&&(g=$t(t,e,r,i,n,a,s,o,f),d.push(g.x),p.push(g.y)),{min:{x:G[z](0,d),y:G[z](0,p)},max:{x:W[z](0,d),y:W[z](0,p)}}}),Qt=e._path2curve=n(function(t,e){var r=!e&&Vt(t);if(!e&&r.curve)return Yt(r.curve);for(var i=Gt(t),n=e&&Gt(e),a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o=(function(t,e,r){var i,n,a={T:1,Q:1};if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in a)&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][P](Ut[z](0,[e.x,e.y][P](t.slice(1))));break;case"S":"C"==r||"S"==r?(i=2*e.x-e.bx,n=2*e.y-e.by):(i=e.x,n=e.y),t=["C",i,n][P](t.slice(1));break;case"T":"Q"==r||"T"==r?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"][P](Xt(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][P](Xt(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][P](Ht(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][P](Ht(e.x,e.y,t[1],e.y));break;case"V":t=["C"][P](Ht(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][P](Ht(e.x,e.y,e.X,e.Y))}return t}),l=function(t,e){if(t[e].length>7){t[e].shift();for(var r=t[e];r.length;)u[e]="A",n&&(c[e]="A"),t.splice(e++,0,["C"][P](r.splice(0,6)));t.splice(e,1),g=W(i.length,n&&n.length||0)}},h=function(t,e,r,a,s){t&&e&&"M"==t[s][0]&&"M"!=e[s][0]&&(e.splice(s,0,["M",a.x,a.y]),r.bx=0,r.by=0,r.x=t[s][1],r.y=t[s][2],g=W(i.length,n&&n.length||0))},u=[],c=[],f="",p="",d=0,g=W(i.length,n&&n.length||0);d<g;d++){i[d]&&(f=i[d][0]),"C"!=f&&(u[d]=f,d&&(p=u[d-1])),i[d]=o(i[d],a,p),"A"!=u[d]&&"C"==f&&(u[d]="C"),l(i,d),n&&(n[d]&&(f=n[d][0]),"C"!=f&&(c[d]=f,d&&(p=c[d-1])),n[d]=o(n[d],s,p),"A"!=c[d]&&"C"==f&&(c[d]="C"),l(n,d)),h(i,n,a,s,d),h(n,i,s,a,d);var v=i[d],x=n&&n[d],y=v.length,m=n&&x.length;a.x=v[y-2],a.y=v[y-1],a.bx=ht(v[y-4])||a.x,a.by=ht(v[y-3])||a.y,s.bx=n&&(ht(x[m-4])||s.x),s.by=n&&(ht(x[m-3])||s.y),s.x=n&&x[m-2],s.y=n&&x[m-1]}return n||(r.curve=Yt(i)),n?[i,n]:i},null,Yt),Jt=e._parseDots=n(function(t){for(var r=[],i=0,n=t.length;i<n;i++){var a={},s=t[i].match(/^([^:]*):?([\d\.]*)/);if(a.color=e.getRGB(s[1]),a.color.error)return null;a.opacity=a.color.opacity,a.color=a.color.hex,s[2]&&(a.offset=s[2]+"%"),r.push(a)}for(i=1,n=r.length-1;i<n;i++)if(!r[i].offset){for(var o=ht(r[i-1].offset||0),l=0,h=i+1;h<n;h++)if(r[h].offset){l=r[h].offset;break}l||(l=100,h=n),l=ht(l);for(var u=(l-o)/(h-i+1);i<h;i++)o+=u,r[i].offset=o+"%"}return r}),Kt=e._tear=function(t,e){t==e.top&&(e.top=t.prev),t==e.bottom&&(e.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)},te=e._tofront=function(t,e){e.top!==t&&(Kt(t,e),t.next=null,t.prev=e.top,e.top.next=t,e.top=t)},ee=e._toback=function(t,e){e.bottom!==t&&(Kt(t,e),t.next=e.bottom,t.prev=null,e.bottom.prev=t,e.bottom=t)},re=e._insertafter=function(t,e,r){Kt(t,r),e==r.top&&(r.top=t),e.next&&(e.next.prev=t),t.next=e.next,t.prev=e,e.next=t},ie=e._insertbefore=function(t,e,r){Kt(t,r),e==r.bottom&&(r.bottom=t),e.prev&&(e.prev.next=t),t.prev=e.prev,e.prev=t,t.next=e},ne=e.toMatrix=function(t,e){var r=Ot(t),i={_:{transform:R},getBBox:function(){return r}};return se(i,e),i.matrix},ae=e.transformPath=function(t,e){return Mt(t,ne(t,e))},se=e._extractTransform=function(t,r){if(null==r)return t._.transform;r=I(r).replace(/\.{3}|\u2026/g,t._.transform||R);var i=e.parseTransformString(r),n=0,a=0,s=0,o=1,l=1,h=t._,u=new g;if(h.transform=i||[],i)for(var c=0,f=i.length;c<f;c++){var p=i[c],d=p.length,v=I(p[0]).toLowerCase(),x=p[0]!=v,y=x?u.invert():0,m,b,_,w,k;"t"==v&&3==d?x?(m=y.x(0,0),b=y.y(0,0),_=y.x(p[1],p[2]),w=y.y(p[1],p[2]),u.translate(_-m,w-b)):u.translate(p[1],p[2]):"r"==v?2==d?(k=k||t.getBBox(1),u.rotate(p[1],k.x+k.width/2,k.y+k.height/2),n+=p[1]):4==d&&(x?(_=y.x(p[2],p[3]),w=y.y(p[2],p[3]),u.rotate(p[1],_,w)):u.rotate(p[1],p[2],p[3]),n+=p[1]):"s"==v?2==d||3==d?(k=k||t.getBBox(1),u.scale(p[1],p[d-1],k.x+k.width/2,k.y+k.height/2),o*=p[1],l*=p[d-1]):5==d&&(x?(_=y.x(p[3],p[4]),w=y.y(p[3],p[4]),u.scale(p[1],p[2],_,w)):u.scale(p[1],p[2],p[3],p[4]),o*=p[1],l*=p[2]):"m"==v&&7==d&&u.add(p[1],p[2],p[3],p[4],p[5],p[6]),h.dirtyT=1,t.matrix=u}t.matrix=u,h.sx=o,h.sy=l,h.deg=n,h.dx=a=u.e,h.dy=s=u.f,1==o&&1==l&&!n&&h.bbox?(h.bbox.x+=+a,h.bbox.y+=+s):h.dirtyT=1},oe=function(t){var e=t[0];switch(e.toLowerCase()){case"t":return[e,0,0];case"m":return[e,1,0,0,1,0,0];case"r":return 4==t.length?[e,0,t[2],t[3]]:[e,0];case"s":return 5==t.length?[e,1,1,t[3],t[4]]:3==t.length?[e,1,1]:[e,1]}},le=e._equaliseTransform=function(t,r){r=I(r).replace(/\.{3}|\u2026/g,t),t=e.parseTransformString(t)||[],r=e.parseTransformString(r)||[];for(var i=W(t.length,r.length),n=[],a=[],s=0,o,l,h,u;s<i;s++){if(h=t[s]||oe(r[s]),u=r[s]||oe(h),h[0]!=u[0]||"r"==h[0].toLowerCase()&&(h[2]!=u[2]||h[3]!=u[3])||"s"==h[0].toLowerCase()&&(h[3]!=u[3]||h[4]!=u[4]))return;for(n[s]=[],a[s]=[],o=0,l=W(h.length,u.length);o<l;o++)o in h&&(n[s][o]=h[o]),o in u&&(a[s][o]=u[o])}return{from:n,to:a}};e._getContainer=function(t,r,i,n){var a;if(a=null!=n||e.is(t,"object")?t:T.doc.getElementById(t),null!=a)return a.tagName?null==r?{container:a,width:a.style.pixelWidth||a.offsetWidth,height:a.style.pixelHeight||a.offsetHeight}:{container:a,width:r,height:i}:{container:1,x:t,y:r,width:i,height:n}},e.pathToRelative=Wt,e._engine={},e.path2curve=Qt,e.matrix=function(t,e,r,i,n,a){return new g(t,e,r,i,n,a)},function(t){function r(t){return t[0]*t[0]+t[1]*t[1]}function i(t){var e=Y.sqrt(r(t));t[0]&&(t[0]/=e),t[1]&&(t[1]/=e)}t.add=function(t,e,r,i,n,a){var s=[[],[],[]],o=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],l=[[t,r,n],[e,i,a],[0,0,1]],h,u,c,f;for(t&&t instanceof g&&(l=[[t.a,t.c,t.e],[t.b,t.d,t.f],[0,0,1]]),h=0;h<3;h++)for(u=0;u<3;u++){for(f=0,c=0;c<3;c++)f+=o[h][c]*l[c][u];s[h][u]=f}this.a=s[0][0],this.b=s[1][0],this.c=s[0][1],this.d=s[1][1],this.e=s[0][2],this.f=s[1][2]},t.invert=function(){var t=this,e=t.a*t.d-t.b*t.c;return new g(t.d/e,-t.b/e,-t.c/e,t.a/e,(t.c*t.f-t.d*t.e)/e,(t.b*t.e-t.a*t.f)/e)},t.clone=function(){return new g(this.a,this.b,this.c,this.d,this.e,this.f)},t.translate=function(t,e){
this.add(1,0,0,1,t,e)},t.scale=function(t,e,r,i){null==e&&(e=t),(r||i)&&this.add(1,0,0,1,r,i),this.add(t,0,0,e,0,0),(r||i)&&this.add(1,0,0,1,-r,-i)},t.rotate=function(t,r,i){t=e.rad(t),r=r||0,i=i||0;var n=+Y.cos(t).toFixed(9),a=+Y.sin(t).toFixed(9);this.add(n,a,-a,n,r,i),this.add(1,0,0,1,-r,-i)},t.x=function(t,e){return t*this.a+e*this.c+this.e},t.y=function(t,e){return t*this.b+e*this.d+this.f},t.get=function(t){return+this[I.fromCharCode(97+t)].toFixed(4)},t.toString=function(){return e.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},t.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},t.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},t.split=function(){var t={};t.dx=this.e,t.dy=this.f;var n=[[this.a,this.c],[this.b,this.d]];t.scalex=Y.sqrt(r(n[0])),i(n[0]),t.shear=n[0][0]*n[1][0]+n[0][1]*n[1][1],n[1]=[n[1][0]-n[0][0]*t.shear,n[1][1]-n[0][1]*t.shear],t.scaley=Y.sqrt(r(n[1])),i(n[1]),t.shear/=t.scaley;var a=-n[0][1],s=n[1][1];return s<0?(t.rotate=e.deg(Y.acos(s)),a<0&&(t.rotate=360-t.rotate)):t.rotate=e.deg(Y.asin(a)),t.isSimple=!(+t.shear.toFixed(9)||t.scalex.toFixed(9)!=t.scaley.toFixed(9)&&t.rotate),t.isSuperSimple=!+t.shear.toFixed(9)&&t.scalex.toFixed(9)==t.scaley.toFixed(9)&&!t.rotate,t.noRotation=!+t.shear.toFixed(9)&&!t.rotate,t},t.toTransformString=function(t){var e=t||this[q]();return e.isSimple?(e.scalex=+e.scalex.toFixed(4),e.scaley=+e.scaley.toFixed(4),e.rotate=+e.rotate.toFixed(4),(e.dx||e.dy?"t"+[e.dx,e.dy]:R)+(1!=e.scalex||1!=e.scaley?"s"+[e.scalex,e.scaley,0,0]:R)+(e.rotate?"r"+[e.rotate,0,0]:R)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(g.prototype);for(var he=function(){this.returnValue=!1},ue=function(){return this.originalEvent.preventDefault()},ce=function(){this.cancelBubble=!0},fe=function(){return this.originalEvent.stopPropagation()},pe=function(t){var e=T.doc.documentElement.scrollTop||T.doc.body.scrollTop,r=T.doc.documentElement.scrollLeft||T.doc.body.scrollLeft;return{x:t.clientX+r,y:t.clientY+e}},de=function(){return T.doc.addEventListener?function(t,e,r,i){var n=function(t){var e=pe(t);return r.call(i,t,e.x,e.y)};if(t.addEventListener(e,n,!1),F&&V[e]){var a=function(e){for(var n=pe(e),a=e,s=0,o=e.targetTouches&&e.targetTouches.length;s<o;s++)if(e.targetTouches[s].target==t){e=e.targetTouches[s],e.originalEvent=a,e.preventDefault=ue,e.stopPropagation=fe;break}return r.call(i,e,n.x,n.y)};t.addEventListener(V[e],a,!1)}return function(){return t.removeEventListener(e,n,!1),F&&V[e]&&t.removeEventListener(V[e],a,!1),!0}}:T.doc.attachEvent?function(t,e,r,i){var n=function(t){t=t||T.win.event;var e=T.doc.documentElement.scrollTop||T.doc.body.scrollTop,n=T.doc.documentElement.scrollLeft||T.doc.body.scrollLeft,a=t.clientX+n,s=t.clientY+e;return t.preventDefault=t.preventDefault||he,t.stopPropagation=t.stopPropagation||ce,r.call(i,t,a,s)};t.attachEvent("on"+e,n);var a=function(){return t.detachEvent("on"+e,n),!0};return a}:void 0}(),ge=[],ve=function(e){for(var r=e.clientX,i=e.clientY,n=T.doc.documentElement.scrollTop||T.doc.body.scrollTop,a=T.doc.documentElement.scrollLeft||T.doc.body.scrollLeft,s,o=ge.length;o--;){if(s=ge[o],F&&e.touches){for(var l=e.touches.length,h;l--;)if(h=e.touches[l],h.identifier==s.el._drag.id){r=h.clientX,i=h.clientY,(e.originalEvent?e.originalEvent:e).preventDefault();break}}else e.preventDefault();var u=s.el.node,c,f=u.nextSibling,p=u.parentNode,d=u.style.display;T.win.opera&&p.removeChild(u),u.style.display="none",c=s.el.paper.getElementByPoint(r,i),u.style.display=d,T.win.opera&&(f?p.insertBefore(u,f):p.appendChild(u)),c&&t("raphael.drag.over."+s.el.id,s.el,c),r+=a,i+=n,t("raphael.drag.move."+s.el.id,s.move_scope||s.el,r-s.el._drag.x,i-s.el._drag.y,r,i,e)}},xe=function(r){e.unmousemove(ve).unmouseup(xe);for(var i=ge.length,n;i--;)n=ge[i],n.el._drag={},t("raphael.drag.end."+n.el.id,n.end_scope||n.start_scope||n.move_scope||n.el,r);ge=[]},ye=e.el={},me=D.length;me--;)!function(t){e[t]=ye[t]=function(r,i){return e.is(r,"function")&&(this.events=this.events||[],this.events.push({name:t,f:r,unbind:de(this.shape||this.node||T.doc,t,r,i||this)})),this},e["un"+t]=ye["un"+t]=function(r){for(var i=this.events||[],n=i.length;n--;)i[n].name!=t||!e.is(r,"undefined")&&i[n].f!=r||(i[n].unbind(),i.splice(n,1),!i.length&&delete this.events);return this}}(D[me]);ye.data=function(r,i){var n=wt[this.id]=wt[this.id]||{};if(0==arguments.length)return n;if(1==arguments.length){if(e.is(r,"object")){for(var a in r)r[A](a)&&this.data(a,r[a]);return this}return t("raphael.data.get."+this.id,this,n[r],r),n[r]}return n[r]=i,t("raphael.data.set."+this.id,this,i,r),this},ye.removeData=function(t){return null==t?wt[this.id]={}:wt[this.id]&&delete wt[this.id][t],this},ye.getData=function(){return r(wt[this.id]||{})},ye.hover=function(t,e,r,i){return this.mouseover(t,r).mouseout(e,i||r)},ye.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)};var be=[];ye.drag=function(r,i,n,a,s,o){function l(l){(l.originalEvent||l).preventDefault();var h=l.clientX,u=l.clientY,c=T.doc.documentElement.scrollTop||T.doc.body.scrollTop,f=T.doc.documentElement.scrollLeft||T.doc.body.scrollLeft;if(this._drag.id=l.identifier,F&&l.touches)for(var p=l.touches.length,d;p--;)if(d=l.touches[p],this._drag.id=d.identifier,d.identifier==this._drag.id){h=d.clientX,u=d.clientY;break}this._drag.x=h+f,this._drag.y=u+c,!ge.length&&e.mousemove(ve).mouseup(xe),ge.push({el:this,move_scope:a,start_scope:s,end_scope:o}),i&&t.on("raphael.drag.start."+this.id,i),r&&t.on("raphael.drag.move."+this.id,r),n&&t.on("raphael.drag.end."+this.id,n),t("raphael.drag.start."+this.id,s||a||this,l.clientX+f,l.clientY+c,l)}return this._drag={},be.push({el:this,start:l}),this.mousedown(l),this},ye.onDragOver=function(e){e?t.on("raphael.drag.over."+this.id,e):t.unbind("raphael.drag.over."+this.id)},ye.undrag=function(){for(var r=be.length;r--;)be[r].el==this&&(this.unmousedown(be[r].start),be.splice(r,1),t.unbind("raphael.drag.*."+this.id));!be.length&&e.unmousemove(ve).unmouseup(xe),ge=[]},N.circle=function(t,r,i){var n=e._engine.circle(this,t||0,r||0,i||0);return this.__set__&&this.__set__.push(n),n},N.rect=function(t,r,i,n,a){var s=e._engine.rect(this,t||0,r||0,i||0,n||0,a||0);return this.__set__&&this.__set__.push(s),s},N.ellipse=function(t,r,i,n){var a=e._engine.ellipse(this,t||0,r||0,i||0,n||0);return this.__set__&&this.__set__.push(a),a},N.path=function(t){t&&!e.is(t,Z)&&!e.is(t[0],Q)&&(t+=R);var r=e._engine.path(e.format[z](e,arguments),this);return this.__set__&&this.__set__.push(r),r},N.image=function(t,r,i,n,a){var s=e._engine.image(this,t||"about:blank",r||0,i||0,n||0,a||0);return this.__set__&&this.__set__.push(s),s},N.text=function(t,r,i){var n=e._engine.text(this,t||0,r||0,I(i));return this.__set__&&this.__set__.push(n),n},N.set=function(t){!e.is(t,"array")&&(t=Array.prototype.splice.call(arguments,0,arguments.length));var r=new ze(t);return this.__set__&&this.__set__.push(r),r.paper=this,r.type="set",r},N.setStart=function(t){this.__set__=t||this.set()},N.setFinish=function(t){var e=this.__set__;return delete this.__set__,e},N.getSize=function(){var t=this.canvas.parentNode;return{width:t.offsetWidth,height:t.offsetHeight}},N.setSize=function(t,r){return e._engine.setSize.call(this,t,r)},N.setViewBox=function(t,r,i,n,a){return e._engine.setViewBox.call(this,t,r,i,n,a)},N.top=N.bottom=null,N.raphael=e;var _e=function(t){var e=t.getBoundingClientRect(),r=t.ownerDocument,i=r.body,n=r.documentElement,a=n.clientTop||i.clientTop||0,s=n.clientLeft||i.clientLeft||0,o=e.top+(T.win.pageYOffset||n.scrollTop||i.scrollTop)-a,l=e.left+(T.win.pageXOffset||n.scrollLeft||i.scrollLeft)-s;return{y:o,x:l}};N.getElementByPoint=function(t,e){var r=this,i=r.canvas,n=T.doc.elementFromPoint(t,e);if(T.win.opera&&"svg"==n.tagName){var a=_e(i),s=i.createSVGRect();s.x=t-a.x,s.y=e-a.y,s.width=s.height=1;var o=i.getIntersectionList(s,null);o.length&&(n=o[o.length-1])}if(!n)return null;for(;n.parentNode&&n!=i.parentNode&&!n.raphael;)n=n.parentNode;return n==r.canvas.parentNode&&(n=i),n=n&&n.raphael?r.getById(n.raphaelid):null},N.getElementsByBBox=function(t){var r=this.set();return this.forEach(function(i){e.isBBoxIntersect(i.getBBox(),t)&&r.push(i)}),r},N.getById=function(t){for(var e=this.bottom;e;){if(e.id==t)return e;e=e.next}return null},N.forEach=function(t,e){for(var r=this.bottom;r;){if(t.call(e,r)===!1)return this;r=r.next}return this},N.getElementsByPoint=function(t,e){var r=this.set();return this.forEach(function(i){i.isPointInside(t,e)&&r.push(i)}),r},ye.isPointInside=function(t,r){var i=this.realPath=Et[this.type](this);return this.attr("transform")&&this.attr("transform").length&&(i=e.transformPath(i,this.attr("transform"))),e.isPointInsidePath(i,t,r)},ye.getBBox=function(t){if(this.removed)return{};var e=this._;return t?(!e.dirty&&e.bboxwt||(this.realPath=Et[this.type](this),e.bboxwt=Ot(this.realPath),e.bboxwt.toString=x,e.dirty=0),e.bboxwt):((e.dirty||e.dirtyT||!e.bbox)&&(!e.dirty&&this.realPath||(e.bboxwt=0,this.realPath=Et[this.type](this)),e.bbox=Ot(Mt(this.realPath,this.matrix)),e.bbox.toString=x,e.dirty=e.dirtyT=0),e.bbox)},ye.clone=function(){if(this.removed)return null;var t=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(t),t},ye.glow=function(t){if("text"==this.type)return null;t=t||{};var e={width:(t.width||10)+(+this.attr("stroke-width")||1),fill:t.fill||!1,opacity:null==t.opacity?.5:t.opacity,offsetx:t.offsetx||0,offsety:t.offsety||0,color:t.color||"#000"},r=e.width/2,i=this.paper,n=i.set(),a=this.realPath||Et[this.type](this);a=this.matrix?Mt(a,this.matrix):a;for(var s=1;s<r+1;s++)n.push(i.path(a).attr({stroke:e.color,fill:e.fill?e.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(e.width/r*s).toFixed(3),opacity:+(e.opacity/r).toFixed(3)}));return n.insertBefore(this).translate(e.offsetx,e.offsety)};var we={},ke=function(t,r,i,n,a,s,o,u,c){return null==c?l(t,r,i,n,a,s,o,u):e.findDotsAtSegment(t,r,i,n,a,s,o,u,h(t,r,i,n,a,s,o,u,c))},Be=function(t,r){return function(i,n,a){i=Qt(i);for(var s,o,l,h,u="",c={},f,p=0,d=0,g=i.length;d<g;d++){if(l=i[d],"M"==l[0])s=+l[1],o=+l[2];else{if(h=ke(s,o,l[1],l[2],l[3],l[4],l[5],l[6]),p+h>n){if(r&&!c.start){if(f=ke(s,o,l[1],l[2],l[3],l[4],l[5],l[6],n-p),u+=["C"+f.start.x,f.start.y,f.m.x,f.m.y,f.x,f.y],a)return u;c.start=u,u=["M"+f.x,f.y+"C"+f.n.x,f.n.y,f.end.x,f.end.y,l[5],l[6]].join(),p+=h,s=+l[5],o=+l[6];continue}if(!t&&!r)return f=ke(s,o,l[1],l[2],l[3],l[4],l[5],l[6],n-p),{x:f.x,y:f.y,alpha:f.alpha}}p+=h,s=+l[5],o=+l[6]}u+=l.shift()+l}return c.end=u,f=t?p:r?c:e.findDotsAtSegment(s,o,l[0],l[1],l[2],l[3],l[4],l[5],1),f.alpha&&(f={x:f.x,y:f.y,alpha:f.alpha}),f}},Ce=Be(1),Se=Be(),Ae=Be(0,1);e.getTotalLength=Ce,e.getPointAtLength=Se,e.getSubpath=function(t,e,r){if(this.getTotalLength(t)-r<1e-6)return Ae(t,e).end;var i=Ae(t,r,1);return e?Ae(i,e).end:i},ye.getTotalLength=function(){var t=this.getPath();if(t)return this.node.getTotalLength?this.node.getTotalLength():Ce(t)},ye.getPointAtLength=function(t){var e=this.getPath();if(e)return Se(e,t)},ye.getPath=function(){var t,r=e._getPath[this.type];if("text"!=this.type&&"set"!=this.type)return r&&(t=r(this)),t},ye.getSubpath=function(t,r){var i=this.getPath();if(i)return e.getSubpath(i,t,r)};var Te=e.easing_formulas={linear:function(t){return t},"<":function(t){return X(t,1.7)},">":function(t){return X(t,.48)},"<>":function(t){var e=.48-t/1.04,r=Y.sqrt(.1734+e*e),i=r-e,n=X(H(i),1/3)*(i<0?-1:1),a=-r-e,s=X(H(a),1/3)*(a<0?-1:1),o=n+s+.5;return 3*(1-o)*o*o+o*o*o},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},elastic:function(t){return t==!!t?t:X(2,-10*t)*Y.sin((t-.075)*(2*U)/.3)+1},bounce:function(t){var e=7.5625,r=2.75,i;return t<1/r?i=e*t*t:t<2/r?(t-=1.5/r,i=e*t*t+.75):t<2.5/r?(t-=2.25/r,i=e*t*t+.9375):(t-=2.625/r,i=e*t*t+.984375),i}};Te.easeIn=Te["ease-in"]=Te["<"],Te.easeOut=Te["ease-out"]=Te[">"],Te.easeInOut=Te["ease-in-out"]=Te["<>"],Te["back-in"]=Te.backIn,Te["back-out"]=Te.backOut;var Ee=[],Me=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,16)},Ne=function(){for(var r=+new Date,i=0;i<Ee.length;i++){var n=Ee[i];if(!n.el.removed&&!n.paused){var a=r-n.start,s=n.ms,o=n.easing,l=n.from,h=n.diff,u=n.to,c=n.t,f=n.el,p={},d,g={},v;if(n.initstatus?(a=(n.initstatus*n.anim.top-n.prev)/(n.percent-n.prev)*s,n.status=n.initstatus,delete n.initstatus,n.stop&&Ee.splice(i--,1)):n.status=(n.prev+(n.percent-n.prev)*(a/s))/n.anim.top,!(a<0))if(a<s){var x=o(a/s);for(var y in l)if(l[A](y)){switch(pt[y]){case $:d=+l[y]+x*s*h[y];break;case"colour":d="rgb("+[Le(ot(l[y].r+x*s*h[y].r)),Le(ot(l[y].g+x*s*h[y].g)),Le(ot(l[y].b+x*s*h[y].b))].join(",")+")";break;case"path":d=[];for(var m=0,_=l[y].length;m<_;m++){d[m]=[l[y][m][0]];for(var w=1,k=l[y][m].length;w<k;w++)d[m][w]=+l[y][m][w]+x*s*h[y][m][w];d[m]=d[m].join(j)}d=d.join(j);break;case"transform":if(h[y].real)for(d=[],m=0,_=l[y].length;m<_;m++)for(d[m]=[l[y][m][0]],w=1,k=l[y][m].length;w<k;w++)d[m][w]=l[y][m][w]+x*s*h[y][m][w];else{var B=function(t){return+l[y][t]+x*s*h[y][t]};d=[["m",B(0),B(1),B(2),B(3),B(4),B(5)]]}break;case"csv":if("clip-rect"==y)for(d=[],m=4;m--;)d[m]=+l[y][m]+x*s*h[y][m];break;default:var C=[][P](l[y]);for(d=[],m=f.paper.customAttributes[y].length;m--;)d[m]=+C[m]+x*s*h[y][m]}p[y]=d}f.attr(p),function(e,r,i){setTimeout(function(){t("raphael.anim.frame."+e,r,i)})}(f.id,f,n.anim)}else{if(function(r,i,n){setTimeout(function(){t("raphael.anim.frame."+i.id,i,n),t("raphael.anim.finish."+i.id,i,n),e.is(r,"function")&&r.call(i)})}(n.callback,f,n.anim),f.attr(u),Ee.splice(i--,1),n.repeat>1&&!n.next){for(v in u)u[A](v)&&(g[v]=n.totalOrigin[v]);n.el.attr(g),b(n.anim,n.el,n.anim.percents[0],null,n.totalOrigin,n.repeat-1)}n.next&&!n.stop&&b(n.anim,n.el,n.next,null,n.totalOrigin,n.repeat)}}}Ee.length&&Me(Ne)},Le=function(t){return t>255?255:t<0?0:t};ye.animateWith=function(t,r,i,n,a,s){var o=this;if(o.removed)return s&&s.call(o),o;var l=i instanceof m?i:e.animation(i,n,a,s),h,u;b(l,o,l.percents[0],null,o.attr());for(var c=0,f=Ee.length;c<f;c++)if(Ee[c].anim==r&&Ee[c].el==t){Ee[f-1].start=Ee[c].start;break}return o},ye.onAnimation=function(e){return e?t.on("raphael.anim.frame."+this.id,e):t.unbind("raphael.anim.frame."+this.id),this},m.prototype.delay=function(t){var e=new m(this.anim,this.ms);return e.times=this.times,e.del=+t||0,e},m.prototype.repeat=function(t){var e=new m(this.anim,this.ms);return e.del=this.del,e.times=Y.floor(W(t,0))||1,e},e.animation=function(t,r,i,n){if(t instanceof m)return t;!e.is(i,"function")&&i||(n=n||i||null,i=null),t=Object(t),r=+r||0;var a={},s,o;for(o in t)t[A](o)&&ht(o)!=o&&ht(o)+"%"!=o&&(s=!0,a[o]=t[o]);if(s)return i&&(a.easing=i),n&&(a.callback=n),new m({100:a},r);if(n){var l=0;for(var h in t){var u=ut(h);t[A](h)&&u>l&&(l=u)}l+="%",!t[l].callback&&(t[l].callback=n)}return new m(t,r)},ye.animate=function(t,r,i,n){var a=this;if(a.removed)return n&&n.call(a),a;var s=t instanceof m?t:e.animation(t,r,i,n);return b(s,a,s.percents[0],null,a.attr()),a},ye.setTime=function(t,e){return t&&null!=e&&this.status(t,G(e,t.ms)/t.ms),this},ye.status=function(t,e){var r=[],i=0,n,a;if(null!=e)return b(t,this,-1,G(e,1)),this;for(n=Ee.length;i<n;i++)if(a=Ee[i],a.el.id==this.id&&(!t||a.anim==t)){if(t)return a.status;r.push({anim:a.anim,status:a.status})}return t?0:r},ye.pause=function(e){for(var r=0;r<Ee.length;r++)Ee[r].el.id!=this.id||e&&Ee[r].anim!=e||t("raphael.anim.pause."+this.id,this,Ee[r].anim)!==!1&&(Ee[r].paused=!0);return this},ye.resume=function(e){for(var r=0;r<Ee.length;r++)if(Ee[r].el.id==this.id&&(!e||Ee[r].anim==e)){var i=Ee[r];t("raphael.anim.resume."+this.id,this,i.anim)!==!1&&(delete i.paused,this.status(i.anim,i.status))}return this},ye.stop=function(e){for(var r=0;r<Ee.length;r++)Ee[r].el.id!=this.id||e&&Ee[r].anim!=e||t("raphael.anim.stop."+this.id,this,Ee[r].anim)!==!1&&Ee.splice(r--,1);return this},t.on("raphael.remove",_),t.on("raphael.clear",_),ye.toString=function(){return"Raphaël’s object"};var ze=function(t){if(this.items=[],this.length=0,this.type="set",t)for(var e=0,r=t.length;e<r;e++)!t[e]||t[e].constructor!=ye.constructor&&t[e].constructor!=ze||(this[this.items.length]=this.items[this.items.length]=t[e],this.length++)},Pe=ze.prototype;Pe.push=function(){for(var t,e,r=0,i=arguments.length;r<i;r++)t=arguments[r],!t||t.constructor!=ye.constructor&&t.constructor!=ze||(e=this.items.length,this[e]=this.items[e]=t,this.length++);return this},Pe.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},Pe.forEach=function(t,e){for(var r=0,i=this.items.length;r<i;r++)if(t.call(e,this.items[r],r)===!1)return this;return this};for(var Fe in ye)ye[A](Fe)&&(Pe[Fe]=function(t){return function(){var e=arguments;return this.forEach(function(r){r[t][z](r,e)})}}(Fe));return Pe.attr=function(t,r){if(t&&e.is(t,Q)&&e.is(t[0],"object"))for(var i=0,n=t.length;i<n;i++)this.items[i].attr(t[i]);else for(var a=0,s=this.items.length;a<s;a++)this.items[a].attr(t,r);return this},Pe.clear=function(){for(;this.length;)this.pop()},Pe.splice=function(t,e,r){t=t<0?W(this.length+t,0):t,e=W(0,G(this.length-t,e));var i=[],n=[],a=[],s;for(s=2;s<arguments.length;s++)a.push(arguments[s]);for(s=0;s<e;s++)n.push(this[t+s]);for(;s<this.length-t;s++)i.push(this[t+s]);var o=a.length;for(s=0;s<o+i.length;s++)this.items[t+s]=this[t+s]=s<o?a[s]:i[s-o];for(s=this.items.length=this.length-=e-o;this[s];)delete this[s++];return new ze(n)},Pe.exclude=function(t){for(var e=0,r=this.length;e<r;e++)if(this[e]==t)return this.splice(e,1),!0},Pe.animate=function(t,r,i,n){(e.is(i,"function")||!i)&&(n=i||null);var a=this.items.length,s=a,o,l=this,h;if(!a)return this;n&&(h=function(){!--a&&n.call(l)}),i=e.is(i,Z)?i:h;var u=e.animation(t,r,i,h);for(o=this.items[--s].animate(u);s--;)this.items[s]&&!this.items[s].removed&&this.items[s].animateWith(o,u,u),this.items[s]&&!this.items[s].removed||a--;return this},Pe.insertAfter=function(t){for(var e=this.items.length;e--;)this.items[e].insertAfter(t);return this},Pe.getBBox=function(){for(var t=[],e=[],r=[],i=[],n=this.items.length;n--;)if(!this.items[n].removed){var a=this.items[n].getBBox();t.push(a.x),e.push(a.y),r.push(a.x+a.width),i.push(a.y+a.height)}return t=G[z](0,t),e=G[z](0,e),r=W[z](0,r),i=W[z](0,i),{x:t,y:e,x2:r,y2:i,width:r-t,height:i-e}},Pe.clone=function(t){t=this.paper.set();for(var e=0,r=this.items.length;e<r;e++)t.push(this.items[e].clone());return t},Pe.toString=function(){return"Raphaël‘s set"},Pe.glow=function(t){var e=this.paper.set();return this.forEach(function(r,i){var n=r.glow(t);null!=n&&n.forEach(function(t,r){e.push(t)})}),e},Pe.isPointInside=function(t,e){var r=!1;return this.forEach(function(i){if(i.isPointInside(t,e))return r=!0,!1}),r},e.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var e={w:t.w,face:{},glyphs:{}},r=t.face["font-family"];for(var i in t.face)t.face[A](i)&&(e.face[i]=t.face[i]);if(this.fonts[r]?this.fonts[r].push(e):this.fonts[r]=[e],!t.svg){e.face["units-per-em"]=ut(t.face["units-per-em"],10);for(var n in t.glyphs)if(t.glyphs[A](n)){var a=t.glyphs[n];if(e.glyphs[n]={w:a.w,k:{},d:a.d&&"M"+a.d.replace(/[mlcxtrv]/g,function(t){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[t]||"M"})+"z"},a.k)for(var s in a.k)a[A](s)&&(e.glyphs[n].k[s]=a.k[s])}}return t},N.getFont=function(t,r,i,n){if(n=n||"normal",i=i||"normal",r=+r||{normal:400,bold:700,lighter:300,bolder:800}[r]||400,e.fonts){var a=e.fonts[t];if(!a){var s=new RegExp("(^|\\s)"+t.replace(/[^\w\d\s+!~.:_-]/g,R)+"(\\s|$)","i");for(var o in e.fonts)if(e.fonts[A](o)&&s.test(o)){a=e.fonts[o];break}}var l;if(a)for(var h=0,u=a.length;h<u&&(l=a[h],l.face["font-weight"]!=r||l.face["font-style"]!=i&&l.face["font-style"]||l.face["font-stretch"]!=n);h++);return l}},N.print=function(t,r,i,n,a,s,o,l){s=s||"middle",o=W(G(o||0,1),-1),l=W(G(l||1,3),1);var h=I(i)[q](R),u=0,c=0,f=R,p;if(e.is(n,"string")&&(n=this.getFont(n)),n){p=(a||16)/n.face["units-per-em"];for(var d=n.face.bbox[q](k),g=+d[0],v=d[3]-d[1],x=0,y=+d[1]+("baseline"==s?v+ +n.face.descent:v/2),m=0,b=h.length;m<b;m++){if("\n"==h[m])u=0,w=0,c=0,x+=v*l;else{var _=c&&n.glyphs[h[m-1]]||{},w=n.glyphs[h[m]];u+=c?(_.w||n.w)+(_.k&&_.k[h[m]]||0)+n.w*o:0,c=1}w&&w.d&&(f+=e.transformPath(w.d,["t",u*p,x*p,"s",p,p,g,y,"t",(t-g)/p,(r-y)/p]))}}return this.path(f).attr({fill:"#000",stroke:"none"})},N.add=function(t){if(e.is(t,"array"))for(var r=this.set(),i=0,n=t.length,a;i<n;i++)a=t[i]||{},B[A](a.type)&&r.push(this[a.type]().attr(a));return r},e.format=function(t,r){var i=e.is(r,Q)?[0][P](r):arguments;return t&&e.is(t,Z)&&i.length-1&&(t=t.replace(C,function(t,e){return null==i[++e]?R:i[e]})),t||R},e.fullfill=function(){var t=/\{([^\}]+)\}/g,e=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,r=function(t,r,i){var n=i;return r.replace(e,function(t,e,r,i,a){e=e||i,n&&(e in n&&(n=n[e]),"function"==typeof n&&a&&(n=n()))}),n=(null==n||n==i?t:n)+""};return function(e,i){return String(e).replace(t,function(t,e){return r(t,e,i)})}}(),e.ninja=function(){if(E.was)T.win.Raphael=E.is;else{window.Raphael=void 0;try{delete window.Raphael}catch(t){}}return e},e.st=Pe,t.on("raphael.DOMload",function(){w=!0}),function(t,r,i){function n(){/in/.test(t.readyState)?setTimeout(n,9):e.eve("raphael.DOMload")}null==t.readyState&&t.addEventListener&&(t.addEventListener(r,i=function(){t.removeEventListener(r,i,!1),t.readyState="complete"},!1),t.readyState="loading"),n()}(document,"DOMContentLoaded"),e}.apply(e,i),!(void 0!==n&&(t.exports=n))},function(t,e,r){var i,n;!function(r){var a="0.5.0",s="hasOwnProperty",o=/[\.\/]/,l=/\s*,\s*/,h="*",u=function(){},c=function(t,e){return t-e},f,p,d={n:{}},g=function(){for(var t=0,e=this.length;t<e;t++)if("undefined"!=typeof this[t])return this[t]},v=function(){for(var t=this.length;--t;)if("undefined"!=typeof this[t])return this[t]},x=Object.prototype.toString,y=String,m=Array.isArray||function(t){return t instanceof Array||"[object Array]"==x.call(t)};eve=function(t,e){var r=d,i=p,n=Array.prototype.slice.call(arguments,2),a=eve.listeners(t),s=0,o=!1,l,h=[],u={},x=[],y=f,m=[];x.firstDefined=g,x.lastDefined=v,f=t,p=0;for(var b=0,_=a.length;b<_;b++)"zIndex"in a[b]&&(h.push(a[b].zIndex),a[b].zIndex<0&&(u[a[b].zIndex]=a[b]));for(h.sort(c);h[s]<0;)if(l=u[h[s++]],x.push(l.apply(e,n)),p)return p=i,x;for(b=0;b<_;b++)if(l=a[b],"zIndex"in l)if(l.zIndex==h[s]){if(x.push(l.apply(e,n)),p)break;do if(s++,l=u[h[s]],l&&x.push(l.apply(e,n)),p)break;while(l)}else u[l.zIndex]=l;else if(x.push(l.apply(e,n)),p)break;return p=i,f=y,x},eve._events=d,eve.listeners=function(t){var e=m(t)?t:t.split(o),r=d,i,n,a,s,l,u,c,f,p=[r],g=[];for(s=0,l=e.length;s<l;s++){for(f=[],u=0,c=p.length;u<c;u++)for(r=p[u].n,n=[r[e[s]],r[h]],a=2;a--;)i=n[a],i&&(f.push(i),g=g.concat(i.f||[]));p=f}return g},eve.separator=function(t){t?(t=y(t).replace(/(?=[\.\^\]\[\-])/g,"\\"),t="["+t+"]",o=new RegExp(t)):o=/[\.\/]/},eve.on=function(t,e){if("function"!=typeof e)return function(){};for(var r=m(t)?m(t[0])?t:[t]:y(t).split(l),i=0,n=r.length;i<n;i++)!function(t){for(var r=m(t)?t:y(t).split(o),i=d,n,a=0,s=r.length;a<s;a++)i=i.n,i=i.hasOwnProperty(r[a])&&i[r[a]]||(i[r[a]]={n:{}});for(i.f=i.f||[],a=0,s=i.f.length;a<s;a++)if(i.f[a]==e){n=!0;break}!n&&i.f.push(e)}(r[i]);return function(t){+t==+t&&(e.zIndex=+t)}},eve.f=function(t){var e=[].slice.call(arguments,1);return function(){eve.apply(null,[t,null].concat(e).concat([].slice.call(arguments,0)))}},eve.stop=function(){p=1},eve.nt=function(t){var e=m(f)?f.join("."):f;return t?new RegExp("(?:\\.|\\/|^)"+t+"(?:\\.|\\/|$)").test(e):e},eve.nts=function(){return m(f)?f:f.split(o)},eve.off=eve.unbind=function(t,e){if(!t)return void(eve._events=d={n:{}});var r=m(t)?m(t[0])?t:[t]:y(t).split(l);if(r.length>1)for(var i=0,n=r.length;i<n;i++)eve.off(r[i],e);else{r=m(t)?t:y(t).split(o);var a,u,c,i,n,f,p,g=[d];for(i=0,n=r.length;i<n;i++)for(f=0;f<g.length;f+=c.length-2){if(c=[f,1],a=g[f].n,r[i]!=h)a[r[i]]&&c.push(a[r[i]]);else for(u in a)a[s](u)&&c.push(a[u]);g.splice.apply(g,c)}for(i=0,n=g.length;i<n;i++)for(a=g[i];a.n;){if(e){if(a.f){for(f=0,p=a.f.length;f<p;f++)if(a.f[f]==e){a.f.splice(f,1);break}!a.f.length&&delete a.f}for(u in a.n)if(a.n[s](u)&&a.n[u].f){var v=a.n[u].f;for(f=0,p=v.length;f<p;f++)if(v[f]==e){v.splice(f,1);break}!v.length&&delete a.n[u].f}}else{delete a.f;for(u in a.n)a.n[s](u)&&a.n[u].f&&delete a.n[u].f}a=a.n}}},eve.once=function(t,e){var r=function(){return eve.off(t,r),e.apply(this,arguments)};return eve.on(t,r)},eve.version=a,eve.toString=function(){return"You are running Eve "+a},"undefined"!=typeof t&&t.exports?t.exports=eve:(i=[],n=function(){return eve}.apply(e,i),!(void 0!==n&&(t.exports=n)))}(this)},function(t,e,r){var i,n;i=[r(1)],n=function(t){if(!t||t.svg){var e="hasOwnProperty",r=String,i=parseFloat,n=parseInt,a=Math,s=a.max,o=a.abs,l=a.pow,h=/[, ]+/,u=t.eve,c="",f=" ",p="http://www.w3.org/1999/xlink",d={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},g={};t.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var v=function(i,n){if(n){"string"==typeof i&&(i=v(i));for(var a in n)n[e](a)&&("xlink:"==a.substring(0,6)?i.setAttributeNS(p,a.substring(6),r(n[a])):i.setAttribute(a,r(n[a])))}else i=t._g.doc.createElementNS("http://www.w3.org/2000/svg",i),i.style&&(i.style.webkitTapHighlightColor="rgba(0,0,0,0)");return i},x=function(e,n){var h="linear",u=e.id+n,f=.5,p=.5,d=e.node,g=e.paper,x=d.style,y=t._g.doc.getElementById(u);if(!y){if(n=r(n).replace(t._radial_gradient,function(t,e,r){if(h="radial",e&&r){f=i(e),p=i(r);var n=2*(p>.5)-1;l(f-.5,2)+l(p-.5,2)>.25&&(p=a.sqrt(.25-l(f-.5,2))*n+.5)&&.5!=p&&(p=p.toFixed(5)-1e-5*n)}return c}),n=n.split(/\s*\-\s*/),"linear"==h){var b=n.shift();if(b=-i(b),isNaN(b))return null;var _=[0,0,a.cos(t.rad(b)),a.sin(t.rad(b))],w=1/(s(o(_[2]),o(_[3]))||1);_[2]*=w,_[3]*=w,_[2]<0&&(_[0]=-_[2],_[2]=0),_[3]<0&&(_[1]=-_[3],_[3]=0)}var k=t._parseDots(n);if(!k)return null;if(u=u.replace(/[\(\)\s,\xb0#]/g,"_"),e.gradient&&u!=e.gradient.id&&(g.defs.removeChild(e.gradient),delete e.gradient),!e.gradient){y=v(h+"Gradient",{id:u}),e.gradient=y,v(y,"radial"==h?{fx:f,fy:p}:{x1:_[0],y1:_[1],x2:_[2],y2:_[3],gradientTransform:e.matrix.invert()}),g.defs.appendChild(y);for(var B=0,C=k.length;B<C;B++)y.appendChild(v("stop",{offset:k[B].offset?k[B].offset:B?"100%":"0%","stop-color":k[B].color||"#fff","stop-opacity":isFinite(k[B].opacity)?k[B].opacity:1}))}}return v(d,{fill:m(u),opacity:1,"fill-opacity":1}),x.fill=c,x.opacity=1,x.fillOpacity=1,1},y=function(){var t=document.documentMode;return t&&(9===t||10===t)},m=function(t){if(y())return"url('#"+t+"')";var e=document.location,r=e.protocol+"//"+e.host+e.pathname+e.search;return"url('"+r+"#"+t+"')"},b=function(t){var e=t.getBBox(1);v(t.pattern,{patternTransform:t.matrix.invert()+" translate("+e.x+","+e.y+")"})},_=function(i,n,a){if("path"==i.type){for(var s=r(n).toLowerCase().split("-"),o=i.paper,l=a?"end":"start",h=i.node,u=i.attrs,f=u["stroke-width"],p=s.length,x="classic",y,m,b,_,w,k=3,B=3,C=5;p--;)switch(s[p]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":x=s[p];break;case"wide":B=5;break;case"narrow":B=2;break;case"long":k=5;break;case"short":k=2}if("open"==x?(k+=2,B+=2,C+=2,b=1,_=a?4:1,w={fill:"none",stroke:u.stroke}):(_=b=k/2,w={fill:u.stroke,stroke:"none"}),i._.arrows?a?(i._.arrows.endPath&&g[i._.arrows.endPath]--,i._.arrows.endMarker&&g[i._.arrows.endMarker]--):(i._.arrows.startPath&&g[i._.arrows.startPath]--,i._.arrows.startMarker&&g[i._.arrows.startMarker]--):i._.arrows={},"none"!=x){var S="raphael-marker-"+x,A="raphael-marker-"+l+x+k+B+"-obj"+i.id;t._g.doc.getElementById(S)?g[S]++:(o.defs.appendChild(v(v("path"),{"stroke-linecap":"round",d:d[x],id:S})),g[S]=1);var T=t._g.doc.getElementById(A),E;T?(g[A]++,E=T.getElementsByTagName("use")[0]):(T=v(v("marker"),{id:A,markerHeight:B,markerWidth:k,orient:"auto",refX:_,refY:B/2}),E=v(v("use"),{"xlink:href":"#"+S,transform:(a?"rotate(180 "+k/2+" "+B/2+") ":c)+"scale("+k/C+","+B/C+")","stroke-width":(1/((k/C+B/C)/2)).toFixed(4)}),T.appendChild(E),o.defs.appendChild(T),g[A]=1),v(E,w);var M=b*("diamond"!=x&&"oval"!=x);a?(y=i._.arrows.startdx*f||0,m=t.getTotalLength(u.path)-M*f):(y=M*f,m=t.getTotalLength(u.path)-(i._.arrows.enddx*f||0)),w={},w["marker-"+l]="url(#"+A+")",(m||y)&&(w.d=t.getSubpath(u.path,y,m)),v(h,w),i._.arrows[l+"Path"]=S,i._.arrows[l+"Marker"]=A,i._.arrows[l+"dx"]=M,i._.arrows[l+"Type"]=x,i._.arrows[l+"String"]=n}else a?(y=i._.arrows.startdx*f||0,m=t.getTotalLength(u.path)-y):(y=0,m=t.getTotalLength(u.path)-(i._.arrows.enddx*f||0)),i._.arrows[l+"Path"]&&v(h,{d:t.getSubpath(u.path,y,m)}),delete i._.arrows[l+"Path"],delete i._.arrows[l+"Marker"],delete i._.arrows[l+"dx"],delete i._.arrows[l+"Type"],delete i._.arrows[l+"String"];for(w in g)if(g[e](w)&&!g[w]){var N=t._g.doc.getElementById(w);N&&N.parentNode.removeChild(N)}}},w={"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},k=function(t,e,i){if(e=w[r(e).toLowerCase()]){for(var n=t.attrs["stroke-width"]||"1",a={round:n,square:n,butt:0}[t.attrs["stroke-linecap"]||i["stroke-linecap"]]||0,s=[],o=e.length;o--;)s[o]=e[o]*n+(o%2?1:-1)*a;v(t.node,{"stroke-dasharray":s.join(",")})}else v(t.node,{"stroke-dasharray":"none"})},B=function(i,a){var l=i.node,u=i.attrs,f=l.style.visibility;l.style.visibility="hidden";for(var d in a)if(a[e](d)){if(!t._availableAttrs[e](d))continue;var g=a[d];switch(u[d]=g,d){case"blur":i.blur(g);break;case"title":var y=l.getElementsByTagName("title");if(y.length&&(y=y[0]))y.firstChild.nodeValue=g;else{y=v("title");var m=t._g.doc.createTextNode(g);y.appendChild(m),l.appendChild(y)}break;case"href":case"target":var w=l.parentNode;if("a"!=w.tagName.toLowerCase()){var B=v("a");w.insertBefore(B,l),B.appendChild(l),w=B}"target"==d?w.setAttributeNS(p,"show","blank"==g?"new":g):w.setAttributeNS(p,d,g);break;case"cursor":l.style.cursor=g;break;case"transform":i.transform(g);break;case"arrow-start":_(i,g);break;case"arrow-end":_(i,g,1);break;case"clip-rect":var C=r(g).split(h);if(4==C.length){i.clip&&i.clip.parentNode.parentNode.removeChild(i.clip.parentNode);var A=v("clipPath"),T=v("rect");A.id=t.createUUID(),v(T,{x:C[0],y:C[1],width:C[2],height:C[3]}),A.appendChild(T),i.paper.defs.appendChild(A),v(l,{"clip-path":"url(#"+A.id+")"}),i.clip=T}if(!g){var E=l.getAttribute("clip-path");if(E){var M=t._g.doc.getElementById(E.replace(/(^url\(#|\)$)/g,c));M&&M.parentNode.removeChild(M),v(l,{"clip-path":c}),delete i.clip}}break;case"path":"path"==i.type&&(v(l,{d:g?u.path=t._pathToAbsolute(g):"M0,0"}),i._.dirty=1,i._.arrows&&("startString"in i._.arrows&&_(i,i._.arrows.startString),"endString"in i._.arrows&&_(i,i._.arrows.endString,1)));break;case"width":if(l.setAttribute(d,g),i._.dirty=1,!u.fx)break;d="x",g=u.x;case"x":u.fx&&(g=-u.x-(u.width||0));case"rx":if("rx"==d&&"rect"==i.type)break;case"cx":l.setAttribute(d,g),i.pattern&&b(i),i._.dirty=1;break;case"height":if(l.setAttribute(d,g),i._.dirty=1,!u.fy)break;d="y",g=u.y;case"y":u.fy&&(g=-u.y-(u.height||0));case"ry":if("ry"==d&&"rect"==i.type)break;case"cy":l.setAttribute(d,g),i.pattern&&b(i),i._.dirty=1;break;case"r":"rect"==i.type?v(l,{rx:g,ry:g}):l.setAttribute(d,g),i._.dirty=1;break;case"src":"image"==i.type&&l.setAttributeNS(p,"href",g);break;case"stroke-width":1==i._.sx&&1==i._.sy||(g/=s(o(i._.sx),o(i._.sy))||1),l.setAttribute(d,g),u["stroke-dasharray"]&&k(i,u["stroke-dasharray"],a),
i._.arrows&&("startString"in i._.arrows&&_(i,i._.arrows.startString),"endString"in i._.arrows&&_(i,i._.arrows.endString,1));break;case"stroke-dasharray":k(i,g,a);break;case"fill":var N=r(g).match(t._ISURL);if(N){A=v("pattern");var L=v("image");A.id=t.createUUID(),v(A,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),v(L,{x:0,y:0,"xlink:href":N[1]}),A.appendChild(L),function(e){t._preload(N[1],function(){var t=this.offsetWidth,r=this.offsetHeight;v(e,{width:t,height:r}),v(L,{width:t,height:r})})}(A),i.paper.defs.appendChild(A),v(l,{fill:"url(#"+A.id+")"}),i.pattern=A,i.pattern&&b(i);break}var z=t.getRGB(g);if(z.error){if(("circle"==i.type||"ellipse"==i.type||"r"!=r(g).charAt())&&x(i,g)){if("opacity"in u||"fill-opacity"in u){var P=t._g.doc.getElementById(l.getAttribute("fill").replace(/^url\(#|\)$/g,c));if(P){var F=P.getElementsByTagName("stop");v(F[F.length-1],{"stop-opacity":("opacity"in u?u.opacity:1)*("fill-opacity"in u?u["fill-opacity"]:1)})}}u.gradient=g,u.fill="none";break}}else delete a.gradient,delete u.gradient,!t.is(u.opacity,"undefined")&&t.is(a.opacity,"undefined")&&v(l,{opacity:u.opacity}),!t.is(u["fill-opacity"],"undefined")&&t.is(a["fill-opacity"],"undefined")&&v(l,{"fill-opacity":u["fill-opacity"]});z[e]("opacity")&&v(l,{"fill-opacity":z.opacity>1?z.opacity/100:z.opacity});case"stroke":z=t.getRGB(g),l.setAttribute(d,z.hex),"stroke"==d&&z[e]("opacity")&&v(l,{"stroke-opacity":z.opacity>1?z.opacity/100:z.opacity}),"stroke"==d&&i._.arrows&&("startString"in i._.arrows&&_(i,i._.arrows.startString),"endString"in i._.arrows&&_(i,i._.arrows.endString,1));break;case"gradient":("circle"==i.type||"ellipse"==i.type||"r"!=r(g).charAt())&&x(i,g);break;case"opacity":u.gradient&&!u[e]("stroke-opacity")&&v(l,{"stroke-opacity":g>1?g/100:g});case"fill-opacity":if(u.gradient){P=t._g.doc.getElementById(l.getAttribute("fill").replace(/^url\(#|\)$/g,c)),P&&(F=P.getElementsByTagName("stop"),v(F[F.length-1],{"stop-opacity":g}));break}default:"font-size"==d&&(g=n(g,10)+"px");var R=d.replace(/(\-.)/g,function(t){return t.substring(1).toUpperCase()});l.style[R]=g,i._.dirty=1,l.setAttribute(d,g)}}S(i,a),l.style.visibility=f},C=1.2,S=function(i,a){if("text"==i.type&&(a[e]("text")||a[e]("font")||a[e]("font-size")||a[e]("x")||a[e]("y"))){var s=i.attrs,o=i.node,l=o.firstChild?n(t._g.doc.defaultView.getComputedStyle(o.firstChild,c).getPropertyValue("font-size"),10):10;if(a[e]("text")){for(s.text=a.text;o.firstChild;)o.removeChild(o.firstChild);for(var h=r(a.text).split("\n"),u=[],f,p=0,d=h.length;p<d;p++)f=v("tspan"),p&&v(f,{dy:l*C,x:s.x}),f.appendChild(t._g.doc.createTextNode(h[p])),o.appendChild(f),u[p]=f}else for(u=o.getElementsByTagName("tspan"),p=0,d=u.length;p<d;p++)p?v(u[p],{dy:l*C,x:s.x}):v(u[0],{dy:0});v(o,{x:s.x,y:s.y}),i._.dirty=1;var g=i._getBBox(),x=s.y-(g.y+g.height/2);x&&t.is(x,"finite")&&v(u[0],{dy:x})}},A=function(t){return t.parentNode&&"a"===t.parentNode.tagName.toLowerCase()?t.parentNode:t},T=function(e,r){function i(){return("0000"+(Math.random()*Math.pow(36,5)<<0).toString(36)).slice(-5)}var n=0,a=0;this[0]=this.node=e,e.raphael=!0,this.id=i(),e.raphaelid=this.id,this.matrix=t.matrix(),this.realPath=null,this.paper=r,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!r.bottom&&(r.bottom=this),this.prev=r.top,r.top&&(r.top.next=this),r.top=this,this.next=null},E=t.el;T.prototype=E,E.constructor=T,t._engine.path=function(t,e){var r=v("path");e.canvas&&e.canvas.appendChild(r);var i=new T(r,e);return i.type="path",B(i,{fill:"none",stroke:"#000",path:t}),i},E.rotate=function(t,e,n){if(this.removed)return this;if(t=r(t).split(h),t.length-1&&(e=i(t[1]),n=i(t[2])),t=i(t[0]),null==n&&(e=n),null==e||null==n){var a=this.getBBox(1);e=a.x+a.width/2,n=a.y+a.height/2}return this.transform(this._.transform.concat([["r",t,e,n]])),this},E.scale=function(t,e,n,a){if(this.removed)return this;if(t=r(t).split(h),t.length-1&&(e=i(t[1]),n=i(t[2]),a=i(t[3])),t=i(t[0]),null==e&&(e=t),null==a&&(n=a),null==n||null==a)var s=this.getBBox(1);return n=null==n?s.x+s.width/2:n,a=null==a?s.y+s.height/2:a,this.transform(this._.transform.concat([["s",t,e,n,a]])),this},E.translate=function(t,e){return this.removed?this:(t=r(t).split(h),t.length-1&&(e=i(t[1])),t=i(t[0])||0,e=+e||0,this.transform(this._.transform.concat([["t",t,e]])),this)},E.transform=function(r){var i=this._;if(null==r)return i.transform;if(t._extractTransform(this,r),this.clip&&v(this.clip,{transform:this.matrix.invert()}),this.pattern&&b(this),this.node&&v(this.node,{transform:this.matrix}),1!=i.sx||1!=i.sy){var n=this.attrs[e]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":n})}return this},E.hide=function(){return this.removed||(this.node.style.display="none"),this},E.show=function(){return this.removed||(this.node.style.display=""),this},E.remove=function(){var e=A(this.node);if(!this.removed&&e.parentNode){var r=this.paper;r.__set__&&r.__set__.exclude(this),u.unbind("raphael.*.*."+this.id),this.gradient&&r.defs.removeChild(this.gradient),t._tear(this,r),e.parentNode.removeChild(e),this.removeData();for(var i in this)this[i]="function"==typeof this[i]?t._removedFactory(i):null;this.removed=!0}},E._getBBox=function(){if("none"==this.node.style.display){this.show();var t=!0}var e=!1,r;this.paper.canvas.parentElement?r=this.paper.canvas.parentElement.style:this.paper.canvas.parentNode&&(r=this.paper.canvas.parentNode.style),r&&"none"==r.display&&(e=!0,r.display="");var i={};try{i=this.node.getBBox()}catch(n){i={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}finally{i=i||{},e&&(r.display="none")}return t&&this.hide(),i},E.attr=function(r,i){if(this.removed)return this;if(null==r){var n={};for(var a in this.attrs)this.attrs[e](a)&&(n[a]=this.attrs[a]);return n.gradient&&"none"==n.fill&&(n.fill=n.gradient)&&delete n.gradient,n.transform=this._.transform,n}if(null==i&&t.is(r,"string")){if("fill"==r&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==r)return this._.transform;for(var s=r.split(h),o={},l=0,c=s.length;l<c;l++)r=s[l],r in this.attrs?o[r]=this.attrs[r]:t.is(this.paper.customAttributes[r],"function")?o[r]=this.paper.customAttributes[r].def:o[r]=t._availableAttrs[r];return c-1?o:o[s[0]]}if(null==i&&t.is(r,"array")){for(o={},l=0,c=r.length;l<c;l++)o[r[l]]=this.attr(r[l]);return o}if(null!=i){var f={};f[r]=i}else null!=r&&t.is(r,"object")&&(f=r);for(var p in f)u("raphael.attr."+p+"."+this.id,this,f[p]);for(p in this.paper.customAttributes)if(this.paper.customAttributes[e](p)&&f[e](p)&&t.is(this.paper.customAttributes[p],"function")){var d=this.paper.customAttributes[p].apply(this,[].concat(f[p]));this.attrs[p]=f[p];for(var g in d)d[e](g)&&(f[g]=d[g])}return B(this,f),this},E.toFront=function(){if(this.removed)return this;var e=A(this.node);e.parentNode.appendChild(e);var r=this.paper;return r.top!=this&&t._tofront(this,r),this},E.toBack=function(){if(this.removed)return this;var e=A(this.node),r=e.parentNode;r.insertBefore(e,r.firstChild),t._toback(this,this.paper);var i=this.paper;return this},E.insertAfter=function(e){if(this.removed||!e)return this;var r=A(this.node),i=A(e.node||e[e.length-1].node);return i.nextSibling?i.parentNode.insertBefore(r,i.nextSibling):i.parentNode.appendChild(r),t._insertafter(this,e,this.paper),this},E.insertBefore=function(e){if(this.removed||!e)return this;var r=A(this.node),i=A(e.node||e[0].node);return i.parentNode.insertBefore(r,i),t._insertbefore(this,e,this.paper),this},E.blur=function(e){var r=this;if(0!==+e){var i=v("filter"),n=v("feGaussianBlur");r.attrs.blur=e,i.id=t.createUUID(),v(n,{stdDeviation:+e||1.5}),i.appendChild(n),r.paper.defs.appendChild(i),r._blur=i,v(r.node,{filter:"url(#"+i.id+")"})}else r._blur&&(r._blur.parentNode.removeChild(r._blur),delete r._blur,delete r.attrs.blur),r.node.removeAttribute("filter");return r},t._engine.circle=function(t,e,r,i){var n=v("circle");t.canvas&&t.canvas.appendChild(n);var a=new T(n,t);return a.attrs={cx:e,cy:r,r:i,fill:"none",stroke:"#000"},a.type="circle",v(n,a.attrs),a},t._engine.rect=function(t,e,r,i,n,a){var s=v("rect");t.canvas&&t.canvas.appendChild(s);var o=new T(s,t);return o.attrs={x:e,y:r,width:i,height:n,rx:a||0,ry:a||0,fill:"none",stroke:"#000"},o.type="rect",v(s,o.attrs),o},t._engine.ellipse=function(t,e,r,i,n){var a=v("ellipse");t.canvas&&t.canvas.appendChild(a);var s=new T(a,t);return s.attrs={cx:e,cy:r,rx:i,ry:n,fill:"none",stroke:"#000"},s.type="ellipse",v(a,s.attrs),s},t._engine.image=function(t,e,r,i,n,a){var s=v("image");v(s,{x:r,y:i,width:n,height:a,preserveAspectRatio:"none"}),s.setAttributeNS(p,"href",e),t.canvas&&t.canvas.appendChild(s);var o=new T(s,t);return o.attrs={x:r,y:i,width:n,height:a,src:e},o.type="image",o},t._engine.text=function(e,r,i,n){var a=v("text");e.canvas&&e.canvas.appendChild(a);var s=new T(a,e);return s.attrs={x:r,y:i,"text-anchor":"middle",text:n,"font-family":t._availableAttrs["font-family"],"font-size":t._availableAttrs["font-size"],stroke:"none",fill:"#000"},s.type="text",B(s,s.attrs),s},t._engine.setSize=function(t,e){return this.width=t||this.width,this.height=e||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},t._engine.create=function(){var e=t._getContainer.apply(0,arguments),r=e&&e.container,i=e.x,n=e.y,a=e.width,s=e.height;if(!r)throw new Error("SVG container not found.");var o=v("svg"),l="overflow:hidden;",h;return i=i||0,n=n||0,a=a||512,s=s||342,v(o,{height:s,version:1.1,width:a,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}),1==r?(o.style.cssText=l+"position:absolute;left:"+i+"px;top:"+n+"px",t._g.doc.body.appendChild(o),h=1):(o.style.cssText=l+"position:relative",r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o)),r=new t._Paper,r.width=a,r.height=s,r.canvas=o,r.clear(),r._left=r._top=0,h&&(r.renderfix=function(){}),r.renderfix(),r},t._engine.setViewBox=function(t,e,r,i,n){u("raphael.setViewBox",this,this._viewBox,[t,e,r,i,n]);var a=this.getSize(),o=s(r/a.width,i/a.height),l=this.top,h=n?"xMidYMid meet":"xMinYMin",c,p;for(null==t?(this._vbSize&&(o=1),delete this._vbSize,c="0 0 "+this.width+f+this.height):(this._vbSize=o,c=t+f+e+f+r+f+i),v(this.canvas,{viewBox:c,preserveAspectRatio:h});o&&l;)p="stroke-width"in l.attrs?l.attrs["stroke-width"]:1,l.attr({"stroke-width":p}),l._.dirty=1,l._.dirtyT=1,l=l.prev;return this._viewBox=[t,e,r,i,!!n],this},t.prototype.renderfix=function(){var t=this.canvas,e=t.style,r;try{r=t.getScreenCTM()||t.createSVGMatrix()}catch(i){r=t.createSVGMatrix()}var n=-r.e%1,a=-r.f%1;(n||a)&&(n&&(this._left=(this._left+n)%1,e.left=this._left+"px"),a&&(this._top=(this._top+a)%1,e.top=this._top+"px"))},t.prototype.clear=function(){t.eve("raphael.clear",this);for(var e=this.canvas;e.firstChild;)e.removeChild(e.firstChild);this.bottom=this.top=null,(this.desc=v("desc")).appendChild(t._g.doc.createTextNode("Created with Raphaël "+t.version)),e.appendChild(this.desc),e.appendChild(this.defs=v("defs"))},t.prototype.remove=function(){u("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null};var M=t.st;for(var N in E)E[e](N)&&!M[e](N)&&(M[N]=function(t){return function(){var e=arguments;return this.forEach(function(r){r[t].apply(r,e)})}}(N))}}.apply(e,i),!(void 0!==n&&(t.exports=n))},function(t,e,r){var i,n;i=[r(1)],n=function(t){if(!t||t.vml){var e="hasOwnProperty",r=String,i=parseFloat,n=Math,a=n.round,s=n.max,o=n.min,l=n.abs,h="fill",u=/[, ]+/,c=t.eve,f=" progid:DXImageTransform.Microsoft",p=" ",d="",g={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},v=/([clmz]),?([^clmz]*)/gi,x=/ progid:\S+Blur\([^\)]+\)/g,y=/-?[^,\s-]+/g,m="position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)",b=21600,_={path:1,rect:1,image:1},w={circle:1,ellipse:1},k=function(e){var i=/[ahqstv]/gi,n=t._pathToAbsolute;if(r(e).match(i)&&(n=t._path2curve),i=/[clmz]/g,n==t._pathToAbsolute&&!r(e).match(i)){var s=r(e).replace(v,function(t,e,r){var i=[],n="m"==e.toLowerCase(),s=g[e];return r.replace(y,function(t){n&&2==i.length&&(s+=i+g["m"==e?"l":"L"],i=[]),i.push(a(t*b))}),s+i});return s}var o=n(e),l,h;s=[];for(var u=0,c=o.length;u<c;u++){l=o[u],h=o[u][0].toLowerCase(),"z"==h&&(h="x");for(var f=1,x=l.length;f<x;f++)h+=a(l[f]*b)+(f!=x-1?",":d);s.push(h)}return s.join(p)},B=function(e,r,i){var n=t.matrix();return n.rotate(-e,.5,.5),{dx:n.x(r,i),dy:n.y(r,i)}},C=function(t,e,r,i,n,a){var s=t._,o=t.matrix,u=s.fillpos,c=t.node,f=c.style,d=1,g="",v,x=b/e,y=b/r;if(f.visibility="hidden",e&&r){if(c.coordsize=l(x)+p+l(y),f.rotation=a*(e*r<0?-1:1),a){var m=B(a,i,n);i=m.dx,n=m.dy}if(e<0&&(g+="x"),r<0&&(g+=" y")&&(d=-1),f.flip=g,c.coordorigin=i*-x+p+n*-y,u||s.fillsize){var _=c.getElementsByTagName(h);_=_&&_[0],c.removeChild(_),u&&(m=B(a,o.x(u[0],u[1]),o.y(u[0],u[1])),_.position=m.dx*d+p+m.dy*d),s.fillsize&&(_.size=s.fillsize[0]*l(e)+p+s.fillsize[1]*l(r)),c.appendChild(_)}f.visibility="visible"}};t.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var S=function(t,e,i){for(var n=r(e).toLowerCase().split("-"),a=i?"end":"start",s=n.length,o="classic",l="medium",h="medium";s--;)switch(n[s]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":o=n[s];break;case"wide":case"narrow":h=n[s];break;case"long":case"short":l=n[s]}var u=t.node.getElementsByTagName("stroke")[0];u[a+"arrow"]=o,u[a+"arrowlength"]=l,u[a+"arrowwidth"]=h},A=function(n,l){n.attrs=n.attrs||{};var c=n.node,f=n.attrs,g=c.style,v,x=_[n.type]&&(l.x!=f.x||l.y!=f.y||l.width!=f.width||l.height!=f.height||l.cx!=f.cx||l.cy!=f.cy||l.rx!=f.rx||l.ry!=f.ry||l.r!=f.r),y=w[n.type]&&(f.cx!=l.cx||f.cy!=l.cy||f.r!=l.r||f.rx!=l.rx||f.ry!=l.ry),m=n;for(var B in l)l[e](B)&&(f[B]=l[B]);if(x&&(f.path=t._getPath[n.type](n),n._.dirty=1),l.href&&(c.href=l.href),l.title&&(c.title=l.title),l.target&&(c.target=l.target),l.cursor&&(g.cursor=l.cursor),"blur"in l&&n.blur(l.blur),(l.path&&"path"==n.type||x)&&(c.path=k(~r(f.path).toLowerCase().indexOf("r")?t._pathToAbsolute(f.path):f.path),n._.dirty=1,"image"==n.type&&(n._.fillpos=[f.x,f.y],n._.fillsize=[f.width,f.height],C(n,1,1,0,0,0))),"transform"in l&&n.transform(l.transform),y){var A=+f.cx,E=+f.cy,M=+f.rx||+f.r||0,L=+f.ry||+f.r||0;c.path=t.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",a((A-M)*b),a((E-L)*b),a((A+M)*b),a((E+L)*b),a(A*b)),n._.dirty=1}if("clip-rect"in l){var z=r(l["clip-rect"]).split(u);if(4==z.length){z[2]=+z[2]+ +z[0],z[3]=+z[3]+ +z[1];var P=c.clipRect||t._g.doc.createElement("div"),F=P.style;F.clip=t.format("rect({1}px {2}px {3}px {0}px)",z),c.clipRect||(F.position="absolute",F.top=0,F.left=0,F.width=n.paper.width+"px",F.height=n.paper.height+"px",c.parentNode.insertBefore(P,c),P.appendChild(c),c.clipRect=P)}l["clip-rect"]||c.clipRect&&(c.clipRect.style.clip="auto")}if(n.textpath){var R=n.textpath.style;l.font&&(R.font=l.font),l["font-family"]&&(R.fontFamily='"'+l["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,d)+'"'),l["font-size"]&&(R.fontSize=l["font-size"]),l["font-weight"]&&(R.fontWeight=l["font-weight"]),l["font-style"]&&(R.fontStyle=l["font-style"])}if("arrow-start"in l&&S(m,l["arrow-start"]),"arrow-end"in l&&S(m,l["arrow-end"],1),null!=l.opacity||null!=l.fill||null!=l.src||null!=l.stroke||null!=l["stroke-width"]||null!=l["stroke-opacity"]||null!=l["fill-opacity"]||null!=l["stroke-dasharray"]||null!=l["stroke-miterlimit"]||null!=l["stroke-linejoin"]||null!=l["stroke-linecap"]){var j=c.getElementsByTagName(h),I=!1;if(j=j&&j[0],!j&&(I=j=N(h)),"image"==n.type&&l.src&&(j.src=l.src),l.fill&&(j.on=!0),null!=j.on&&"none"!=l.fill&&null!==l.fill||(j.on=!1),j.on&&l.fill){var q=r(l.fill).match(t._ISURL);if(q){j.parentNode==c&&c.removeChild(j),j.rotate=!0,j.src=q[1],j.type="tile";var D=n.getBBox(1);j.position=D.x+p+D.y,n._.fillpos=[D.x,D.y],t._preload(q[1],function(){n._.fillsize=[this.offsetWidth,this.offsetHeight]})}else j.color=t.getRGB(l.fill).hex,j.src=d,j.type="solid",t.getRGB(l.fill).error&&(m.type in{circle:1,ellipse:1}||"r"!=r(l.fill).charAt())&&T(m,l.fill,j)&&(f.fill="none",f.gradient=l.fill,j.rotate=!1)}if("fill-opacity"in l||"opacity"in l){var V=((+f["fill-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+t.getRGB(l.fill).o+1||2)-1);V=o(s(V,0),1),j.opacity=V,j.src&&(j.color="none")}c.appendChild(j);var O=c.getElementsByTagName("stroke")&&c.getElementsByTagName("stroke")[0],Y=!1;!O&&(Y=O=N("stroke")),(l.stroke&&"none"!=l.stroke||l["stroke-width"]||null!=l["stroke-opacity"]||l["stroke-dasharray"]||l["stroke-miterlimit"]||l["stroke-linejoin"]||l["stroke-linecap"])&&(O.on=!0),("none"==l.stroke||null===l.stroke||null==O.on||0==l.stroke||0==l["stroke-width"])&&(O.on=!1);var W=t.getRGB(l.stroke);O.on&&l.stroke&&(O.color=W.hex),V=((+f["stroke-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+W.o+1||2)-1);var G=.75*(i(l["stroke-width"])||1);if(V=o(s(V,0),1),null==l["stroke-width"]&&(G=f["stroke-width"]),l["stroke-width"]&&(O.weight=G),G&&G<1&&(V*=G)&&(O.weight=1),O.opacity=V,l["stroke-linejoin"]&&(O.joinstyle=l["stroke-linejoin"]||"miter"),O.miterlimit=l["stroke-miterlimit"]||8,l["stroke-linecap"]&&(O.endcap="butt"==l["stroke-linecap"]?"flat":"square"==l["stroke-linecap"]?"square":"round"),"stroke-dasharray"in l){var H={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};O.dashstyle=H[e](l["stroke-dasharray"])?H[l["stroke-dasharray"]]:d}Y&&c.appendChild(O)}if("text"==m.type){m.paper.canvas.style.display=d;var X=m.paper.span,U=100,$=f.font&&f.font.match(/\d+(?:\.\d*)?(?=px)/);g=X.style,f.font&&(g.font=f.font),f["font-family"]&&(g.fontFamily=f["font-family"]),f["font-weight"]&&(g.fontWeight=f["font-weight"]),f["font-style"]&&(g.fontStyle=f["font-style"]),$=i(f["font-size"]||$&&$[0])||10,g.fontSize=$*U+"px",m.textpath.string&&(X.innerHTML=r(m.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var Z=X.getBoundingClientRect();m.W=f.w=(Z.right-Z.left)/U,m.H=f.h=(Z.bottom-Z.top)/U,m.X=f.x,m.Y=f.y+m.H/2,("x"in l||"y"in l)&&(m.path.v=t.format("m{0},{1}l{2},{1}",a(f.x*b),a(f.y*b),a(f.x*b)+1));for(var Q=["x","y","text","font","font-family","font-weight","font-style","font-size"],J=0,K=Q.length;J<K;J++)if(Q[J]in l){m._.dirty=1;break}switch(f["text-anchor"]){case"start":m.textpath.style["v-text-align"]="left",m.bbx=m.W/2;break;case"end":m.textpath.style["v-text-align"]="right",m.bbx=-m.W/2;break;default:m.textpath.style["v-text-align"]="center",m.bbx=0}m.textpath.style["v-text-kern"]=!0}},T=function(e,a,s){e.attrs=e.attrs||{};var o=e.attrs,l=Math.pow,h,u,c="linear",f=".5 .5";if(e.attrs.gradient=a,a=r(a).replace(t._radial_gradient,function(t,e,r){return c="radial",e&&r&&(e=i(e),r=i(r),l(e-.5,2)+l(r-.5,2)>.25&&(r=n.sqrt(.25-l(e-.5,2))*(2*(r>.5)-1)+.5),f=e+p+r),d}),a=a.split(/\s*\-\s*/),"linear"==c){var g=a.shift();if(g=-i(g),isNaN(g))return null}var v=t._parseDots(a);if(!v)return null;if(e=e.shape||e.node,v.length){e.removeChild(s),s.on=!0,s.method="none",s.color=v[0].color,s.color2=v[v.length-1].color;for(var x=[],y=0,m=v.length;y<m;y++)v[y].offset&&x.push(v[y].offset+p+v[y].color);s.colors=x.length?x.join():"0% "+s.color,"radial"==c?(s.type="gradientTitle",s.focus="100%",s.focussize="0 0",s.focusposition=f,s.angle=0):(s.type="gradient",s.angle=(270-g)%360),e.appendChild(s)}return 1},E=function(e,r){this[0]=this.node=e,e.raphael=!0,this.id=t._oid++,e.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=r,this.matrix=t.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!r.bottom&&(r.bottom=this),this.prev=r.top,r.top&&(r.top.next=this),r.top=this,this.next=null},M=t.el;E.prototype=M,M.constructor=E,M.transform=function(e){if(null==e)return this._.transform;var i=this.paper._viewBoxShift,n=i?"s"+[i.scale,i.scale]+"-1-1t"+[i.dx,i.dy]:d,a;i&&(a=e=r(e).replace(/\.{3}|\u2026/g,this._.transform||d)),t._extractTransform(this,n+e);var s=this.matrix.clone(),o=this.skew,l=this.node,h,u=~r(this.attrs.fill).indexOf("-"),c=!r(this.attrs.fill).indexOf("url(");if(s.translate(1,1),c||u||"image"==this.type)if(o.matrix="1 0 0 1",o.offset="0 0",h=s.split(),u&&h.noRotation||!h.isSimple){l.style.filter=s.toFilter();var f=this.getBBox(),g=this.getBBox(1),v=f.x-g.x,x=f.y-g.y;l.coordorigin=v*-b+p+x*-b,C(this,1,1,v,x,0)}else l.style.filter=d,C(this,h.scalex,h.scaley,h.dx,h.dy,h.rotate);else l.style.filter=d,o.matrix=r(s),o.offset=s.offset();return null!==a&&(this._.transform=a,t._extractTransform(this,a)),this},M.rotate=function(t,e,n){if(this.removed)return this;if(null!=t){if(t=r(t).split(u),t.length-1&&(e=i(t[1]),n=i(t[2])),t=i(t[0]),null==n&&(e=n),null==e||null==n){var a=this.getBBox(1);e=a.x+a.width/2,n=a.y+a.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",t,e,n]])),this}},M.translate=function(t,e){return this.removed?this:(t=r(t).split(u),t.length-1&&(e=i(t[1])),t=i(t[0])||0,e=+e||0,this._.bbox&&(this._.bbox.x+=t,this._.bbox.y+=e),this.transform(this._.transform.concat([["t",t,e]])),this)},M.scale=function(t,e,n,a){if(this.removed)return this;if(t=r(t).split(u),t.length-1&&(e=i(t[1]),n=i(t[2]),a=i(t[3]),isNaN(n)&&(n=null),isNaN(a)&&(a=null)),t=i(t[0]),null==e&&(e=t),null==a&&(n=a),null==n||null==a)var s=this.getBBox(1);return n=null==n?s.x+s.width/2:n,a=null==a?s.y+s.height/2:a,this.transform(this._.transform.concat([["s",t,e,n,a]])),this._.dirtyT=1,this},M.hide=function(){return!this.removed&&(this.node.style.display="none"),this},M.show=function(){return!this.removed&&(this.node.style.display=d),this},M.auxGetBBox=t.el.getBBox,M.getBBox=function(){var t=this.auxGetBBox();if(this.paper&&this.paper._viewBoxShift){var e={},r=1/this.paper._viewBoxShift.scale;return e.x=t.x-this.paper._viewBoxShift.dx,e.x*=r,e.y=t.y-this.paper._viewBoxShift.dy,e.y*=r,e.width=t.width*r,e.height=t.height*r,e.x2=e.x+e.width,e.y2=e.y+e.height,e}return t},M._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},M.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),t.eve.unbind("raphael.*.*."+this.id),t._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null;this.removed=!0}},M.attr=function(r,i){if(this.removed)return this;if(null==r){var n={};for(var a in this.attrs)this.attrs[e](a)&&(n[a]=this.attrs[a]);return n.gradient&&"none"==n.fill&&(n.fill=n.gradient)&&delete n.gradient,n.transform=this._.transform,n}if(null==i&&t.is(r,"string")){if(r==h&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;for(var s=r.split(u),o={},l=0,f=s.length;l<f;l++)r=s[l],r in this.attrs?o[r]=this.attrs[r]:t.is(this.paper.customAttributes[r],"function")?o[r]=this.paper.customAttributes[r].def:o[r]=t._availableAttrs[r];return f-1?o:o[s[0]]}if(this.attrs&&null==i&&t.is(r,"array")){for(o={},l=0,f=r.length;l<f;l++)o[r[l]]=this.attr(r[l]);return o}var p;null!=i&&(p={},p[r]=i),null==i&&t.is(r,"object")&&(p=r);for(var d in p)c("raphael.attr."+d+"."+this.id,this,p[d]);if(p){for(d in this.paper.customAttributes)if(this.paper.customAttributes[e](d)&&p[e](d)&&t.is(this.paper.customAttributes[d],"function")){var g=this.paper.customAttributes[d].apply(this,[].concat(p[d]));this.attrs[d]=p[d];for(var v in g)g[e](v)&&(p[v]=g[v])}p.text&&"text"==this.type&&(this.textpath.string=p.text),A(this,p)}return this},M.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&t._tofront(this,this.paper),this},M.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),t._toback(this,this.paper)),this)},M.insertAfter=function(e){return this.removed?this:(e.constructor==t.st.constructor&&(e=e[e.length-1]),e.node.nextSibling?e.node.parentNode.insertBefore(this.node,e.node.nextSibling):e.node.parentNode.appendChild(this.node),t._insertafter(this,e,this.paper),this)},M.insertBefore=function(e){return this.removed?this:(e.constructor==t.st.constructor&&(e=e[0]),e.node.parentNode.insertBefore(this.node,e.node),t._insertbefore(this,e,this.paper),this)},M.blur=function(e){var r=this.node.runtimeStyle,i=r.filter;return i=i.replace(x,d),0!==+e?(this.attrs.blur=e,r.filter=i+p+f+".Blur(pixelradius="+(+e||1.5)+")",r.margin=t.format("-{0}px 0 0 -{0}px",a(+e||1.5))):(r.filter=i,r.margin=0,delete this.attrs.blur),this},t._engine.path=function(t,e){var r=N("shape");r.style.cssText=m,r.coordsize=b+p+b,r.coordorigin=e.coordorigin;var i=new E(r,e),n={fill:"none",stroke:"#000"};t&&(n.path=t),i.type="path",i.path=[],i.Path=d,A(i,n),e.canvas&&e.canvas.appendChild(r);var a=N("skew");return a.on=!0,r.appendChild(a),i.skew=a,i.transform(d),i},t._engine.rect=function(e,r,i,n,a,s){var o=t._rectPath(r,i,n,a,s),l=e.path(o),h=l.attrs;return l.X=h.x=r,l.Y=h.y=i,l.W=h.width=n,l.H=h.height=a,h.r=s,h.path=o,l.type="rect",l},t._engine.ellipse=function(t,e,r,i,n){var a=t.path(),s=a.attrs;return a.X=e-i,a.Y=r-n,a.W=2*i,a.H=2*n,a.type="ellipse",A(a,{cx:e,cy:r,rx:i,ry:n}),a},t._engine.circle=function(t,e,r,i){var n=t.path(),a=n.attrs;return n.X=e-i,n.Y=r-i,n.W=n.H=2*i,n.type="circle",A(n,{cx:e,cy:r,r:i}),n},t._engine.image=function(e,r,i,n,a,s){var o=t._rectPath(i,n,a,s),l=e.path(o).attr({stroke:"none"}),u=l.attrs,c=l.node,f=c.getElementsByTagName(h)[0];return u.src=r,l.X=u.x=i,l.Y=u.y=n,l.W=u.width=a,l.H=u.height=s,u.path=o,l.type="image",f.parentNode==c&&c.removeChild(f),f.rotate=!0,f.src=r,f.type="tile",l._.fillpos=[i,n],l._.fillsize=[a,s],c.appendChild(f),C(l,1,1,0,0,0),l},t._engine.text=function(e,i,n,s){var o=N("shape"),l=N("path"),h=N("textpath");i=i||0,n=n||0,s=s||"",l.v=t.format("m{0},{1}l{2},{1}",a(i*b),a(n*b),a(i*b)+1),l.textpathok=!0,h.string=r(s),h.on=!0,o.style.cssText=m,o.coordsize=b+p+b,o.coordorigin="0 0";var u=new E(o,e),c={fill:"#000",stroke:"none",font:t._availableAttrs.font,text:s};u.shape=o,u.path=l,u.textpath=h,u.type="text",u.attrs.text=r(s),u.attrs.x=i,u.attrs.y=n,u.attrs.w=1,u.attrs.h=1,A(u,c),o.appendChild(h),o.appendChild(l),e.canvas.appendChild(o);var f=N("skew");return f.on=!0,o.appendChild(f),u.skew=f,u.transform(d),u},t._engine.setSize=function(e,r){var i=this.canvas.style;return this.width=e,this.height=r,e==+e&&(e+="px"),r==+r&&(r+="px"),i.width=e,i.height=r,i.clip="rect(0 "+e+" "+r+" 0)",this._viewBox&&t._engine.setViewBox.apply(this,this._viewBox),this},t._engine.setViewBox=function(e,r,i,n,a){t.eve("raphael.setViewBox",this,this._viewBox,[e,r,i,n,a]);var s=this.getSize(),o=s.width,l=s.height,h,u;return a&&(h=l/n,u=o/i,i*h<o&&(e-=(o-i*h)/2/h),n*u<l&&(r-=(l-n*u)/2/u)),this._viewBox=[e,r,i,n,!!a],this._viewBoxShift={dx:-e,dy:-r,scale:s},this.forEach(function(t){t.transform("...")}),this};var N;t._engine.initWin=function(t){var e=t.document;e.styleSheets.length<31?e.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):e.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");try{!e.namespaces.rvml&&e.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),N=function(t){return e.createElement("<rvml:"+t+' class="rvml">')}}catch(r){N=function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},t._engine.initWin(t._g.win),t._engine.create=function(){var e=t._getContainer.apply(0,arguments),r=e.container,i=e.height,n,a=e.width,s=e.x,o=e.y;if(!r)throw new Error("VML container not found.");var l=new t._Paper,h=l.canvas=t._g.doc.createElement("div"),u=h.style;return s=s||0,o=o||0,a=a||512,i=i||342,l.width=a,l.height=i,a==+a&&(a+="px"),i==+i&&(i+="px"),l.coordsize=1e3*b+p+1e3*b,l.coordorigin="0 0",l.span=t._g.doc.createElement("span"),l.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",h.appendChild(l.span),u.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",a,i),1==r?(t._g.doc.body.appendChild(h),u.left=s+"px",u.top=o+"px",u.position="absolute"):r.firstChild?r.insertBefore(h,r.firstChild):r.appendChild(h),l.renderfix=function(){},l},t.prototype.clear=function(){t.eve("raphael.clear",this),this.canvas.innerHTML=d,this.span=t._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},t.prototype.remove=function(){t.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null;return!0};var L=t.st;for(var z in M)M[e](z)&&!L[e](z)&&(L[z]=function(t){return function(){var e=arguments;return this.forEach(function(r){r[t].apply(r,e)})}}(z))}}.apply(e,i),!(void 0!==n&&(t.exports=n))}])});

/*
* qTip2 - Pretty powerful tooltips
* http://craigsworks.com/projects/qtip2/
*
* Version: nightly
* Copyright 2009-2010 Craig Michael Thompson - http://craigsworks.com
*
* Dual licensed under MIT or GPLv2 licenses
*   http://en.wikipedia.org/wiki/MIT_License
*   http://en.wikipedia.org/wiki/GNU_General_Public_License
*
* Date: Mon Nov 21 13:18:18.0000000000 2011
*//*jslint browser: true, onevar: true, undef: true, nomen: true, bitwise: true, regexp: true, newcap: true, immed: true, strict: true *//*global window: false, jQuery: false, console: false */
(function(a,b,c){function z(b,c){var i,j,k,l,m,n=a(this),o=a(document.body),p=this===document?o:n,q=n.metadata?n.metadata(c.metadata):f,r=c.metadata.type==="html5"&&q?q[c.metadata.name]:f,s=n.data(c.metadata.name||"qtipopts");try{s=typeof s==="string"?(new Function("return "+s))():s}catch(t){w("Unable to parse HTML5 attribute data: "+s)}l=a.extend(d,{},g.defaults,c,typeof s==="object"?x(s):f,x(r||q)),j=l.position,l.id=b;if("boolean"===typeof l.content.text){k=n.attr(l.content.attr);if(l.content.attr!==e&&k)l.content.text=k;else{w("Unable to locate content for tooltip! Aborting render of tooltip on element: ",n);return e}}j.container===e&&(j.container=o),j.target===e&&(j.target=p),l.show.target===e&&(l.show.target=p),l.show.solo===d&&(l.show.solo=o),l.hide.target===e&&(l.hide.target=p),l.position.viewport===d&&(l.position.viewport=j.container),j.at=new h.Corner(j.at),j.my=new h.Corner(j.my);if(a.data(this,"qtip"))if(l.overwrite)n.qtip("destroy");else if(l.overwrite===e)return e;l.suppress&&(m=a.attr(this,"title"))&&a(this).removeAttr("title").attr(u,m),i=new y(n,l,b,!!k),a.data(this,"qtip",i),n.bind("remove.qtip-"+b,function(){i.destroy()});return i}function y(s,t,w,y){function R(){var c=[t.show.target[0],t.hide.target[0],z.rendered&&G.tooltip[0],t.position.container[0],t.position.viewport[0],b,document];z.rendered?a([]).pushStack(a.grep(c,function(a){return typeof a==="object"})).unbind(F):t.show.target.unbind(F+"-create")}function Q(){function p(a){E.is(":visible")&&z.reposition(a)}function o(a){if(E.hasClass(m))return e;clearTimeout(z.timers.inactive),z.timers.inactive=setTimeout(function(){z.hide(a)},t.hide.inactive)}function l(b){if(E.hasClass(m)||C||D)return e;var d=a(b.relatedTarget||b.target),g=d.closest(n)[0]===E[0],h=d[0]===f.show[0];clearTimeout(z.timers.show),clearTimeout(z.timers.hide);if(c.target==="mouse"&&g||t.hide.fixed&&(/mouse(out|leave|move)/.test(b.type)&&(g||h)))try{b.preventDefault(),b.stopImmediatePropagation()}catch(i){}else t.hide.delay>0?z.timers.hide=setTimeout(function(){z.hide(b)},t.hide.delay):z.hide(b)}function k(a){if(E.hasClass(m))return e;clearTimeout(z.timers.show),clearTimeout(z.timers.hide);var b=function(){z.toggle(d,a)};t.show.delay>0?z.timers.show=setTimeout(b,t.show.delay):b()}var c=t.position,f={show:t.show.target,hide:t.hide.target,viewport:a(c.viewport),document:a(document),body:a(document.body),window:a(b)},h={show:a.trim(""+t.show.event).split(" "),hide:a.trim(""+t.hide.event).split(" ")},j=a.browser.msie&&parseInt(a.browser.version,10)===6;E.bind("mouseenter"+F+" mouseleave"+F,function(a){var b=a.type==="mouseenter";b&&z.focus(a),E.toggleClass(q,b)}),t.hide.fixed&&(f.hide=f.hide.add(E),E.bind("mouseover"+F,function(){E.hasClass(m)||clearTimeout(z.timers.hide)})),/mouse(out|leave)/i.test(t.hide.event)?t.hide.leave==="window"&&f.window.bind("mouseout"+F+" blur"+F,function(a){/select|option/.test(a.target)&&!a.relatedTarget&&z.hide(a)}):/mouse(over|enter)/i.test(t.show.event)&&f.hide.bind("mouseleave"+F,function(a){clearTimeout(z.timers.show)}),(""+t.hide.event).indexOf("unfocus")>-1&&f.body.bind("mousedown"+F,function(b){var c=a(b.target),d=!E.hasClass(m)&&E.is(":visible");c[0]!==E[0]&&c.parents(n).length===0&&c.add(s).length>1&&!c.attr("disabled")&&z.hide(b)}),"number"===typeof t.hide.inactive&&(f.show.bind("qtip-"+w+"-inactive",o),a.each(g.inactiveEvents,function(a,b){f.hide.add(G.tooltip).bind(b+F+"-inactive",o)})),a.each(h.hide,function(b,c){var d=a.inArray(c,h.show),e=a(f.hide);d>-1&&e.add(f.show).length===e.length||c==="unfocus"?(f.show.bind(c+F,function(a){E.is(":visible")?l(a):k(a)}),delete h.show[d]):f.hide.bind(c+F,l)}),a.each(h.show,function(a,b){f.show.bind(b+F,k)}),"number"===typeof t.hide.distance&&f.show.add(E).bind("mousemove"+F,function(a){var b=H.origin||{},c=t.hide.distance,d=Math.abs;(d(a.pageX-b.pageX)>=c||d(a.pageY-b.pageY)>=c)&&z.hide(a)}),c.target==="mouse"&&(f.show.bind("mousemove"+F,function(a){i={pageX:a.pageX,pageY:a.pageY,type:"mousemove"}}),c.adjust.mouse&&(t.hide.event&&E.bind("mouseleave"+F,function(a){(a.relatedTarget||a.target)!==f.show[0]&&z.hide(a)}),f.document.bind("mousemove"+F,function(a){!E.hasClass(m)&&E.is(":visible")&&z.reposition(a||i)}))),(c.adjust.resize||f.viewport.length)&&(a.event.special.resize?f.viewport:f.window).bind("resize"+F,p),(f.viewport.length||j&&E.css("position")==="fixed")&&f.viewport.bind("scroll"+F,p)}function P(b,d){function g(b){function i(c){c&&(delete h[c.src],clearTimeout(z.timers.img[c.src]),a(c).unbind(F)),a.isEmptyObject(h)&&(z.redraw(),d!==e&&z.reposition(H.event),b())}var g,h={};if((g=f.find("img:not([height]):not([width])")).length===0)return i();g.each(function(b,d){if(h[d.src]===c){var e=0,f=3;(function g(){if(d.height||d.width||e>f)return i(d);e+=1,z.timers.img[d.src]=setTimeout(g,700)})(),a(d).bind("error"+F+" load"+F,function(){i(this)}),h[d.src]=d}})}var f=G.content;if(!z.rendered||!b)return e;a.isFunction(b)&&(b=b.call(s,H.event,z)||""),b.jquery&&b.length>0?f.empty().append(b.css({display:"block"})):f.html(b),z.rendered<0?E.queue("fx",g):(D=0,g(a.noop));return z}function O(b,c){var d=G.title;if(!z.rendered||!b)return e;a.isFunction(b)&&(b=b.call(s,H.event,z));if(b===e)return K(e);b.jquery&&b.length>0?d.empty().append(b.css({display:"block"})):d.html(b),z.redraw(),c!==e&&z.rendered&&E.is(":visible")&&z.reposition(H.event)}function N(a){var b=G.button,c=G.title;if(!z.rendered)return e;a?(c||M(),L()):b.remove()}function M(){var b=B+"-title";G.titlebar&&K(),G.titlebar=a("<div />",{"class":k+"-titlebar "+(t.style.widget?"ui-widget-header":"")}).append(G.title=a("<div />",{id:b,"class":k+"-title","aria-atomic":d})).insertBefore(G.content).delegate(".ui-tooltip-close","mousedown keydown mouseup keyup mouseout",function(b){a(this).toggleClass("ui-state-active ui-state-focus",b.type.substr(-4)==="down")}).delegate(".ui-tooltip-close","mouseover mouseout",function(b){a(this).toggleClass("ui-state-hover",b.type==="mouseover")}),t.content.title.button?L():z.rendered&&z.redraw()}function L(){var b=t.content.title.button,c=typeof b==="string",d=c?b:"Close tooltip";G.button&&G.button.remove(),b.jquery?G.button=b:G.button=a("<a />",{"class":"ui-state-default ui-tooltip-close "+(t.style.widget?"":k+"-icon"),title:d,"aria-label":d}).prepend(a("<span />",{"class":"ui-icon ui-icon-close",html:"&times;"})),G.button.appendTo(G.titlebar).attr("role","button").click(function(a){E.hasClass(m)||z.hide(a);return e}),z.redraw()}function K(a){G.title&&(G.titlebar.remove(),G.titlebar=G.title=G.button=f,a!==e&&z.reposition())}function J(){var a=t.style.widget;E.toggleClass(l,a).toggleClass(o,!a),G.content.toggleClass(l+"-content",a),G.titlebar&&G.titlebar.toggleClass(l+"-header",a),G.button&&G.button.toggleClass(k+"-icon",!a)}function I(a){var b=0,c,d=t,e=a.split(".");while(d=d[e[b++]])b<e.length&&(c=d);return[c||t,e.pop()]}var z=this,A=document.body,B=k+"-"+w,C=0,D=0,E=a(),F=".qtip-"+w,G,H;z.id=w,z.rendered=e,z.elements=G={target:s},z.timers={img:{}},z.options=t,z.checks={},z.plugins={},z.cache=H={event:{},target:a(),disabled:e,attr:y},z.checks.builtin={"^id$":function(b,c,f){var h=f===d?g.nextid:f,i=k+"-"+h;h!==e&&h.length>0&&!a("#"+i).length&&(E[0].id=i,G.content[0].id=i+"-content",G.title[0].id=i+"-title")},"^content.text$":function(a,b,c){P(c)},"^content.title.text$":function(a,b,c){if(!c)return K();!G.title&&c&&M(),O(c)},"^content.title.button$":function(a,b,c){N(c)},"^position.(my|at)$":function(a,b,c){"string"===typeof c&&(a[b]=new h.Corner(c))},"^position.container$":function(a,b,c){z.rendered&&E.appendTo(c)},"^show.ready$":function(){z.rendered?z.toggle(d):z.render(1)},"^style.classes$":function(a,b,c){E.attr("class",k+" qtip ui-helper-reset "+c)},"^style.widget|content.title":J,"^events.(render|show|move|hide|focus|blur)$":function(b,c,d){E[(a.isFunction(d)?"":"un")+"bind"]("tooltip"+c,d)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){var a=t.position;E.attr("tracking",a.target==="mouse"&&a.adjust.mouse),R(),Q()}},a.extend(z,{render:function(b){if(z.rendered)return z;var c=t.content.text,f=t.content.title.text,g=t.position,i=a.Event("tooltiprender");a.attr(s[0],"aria-describedby",B),E=G.tooltip=a("<div/>",{id:B,"class":k+" qtip ui-helper-reset "+o+" "+t.style.classes+" "+k+"-pos-"+t.position.my.abbrev(),width:t.style.width||"",height:t.style.height||"",tracking:g.target==="mouse"&&g.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":e,"aria-describedby":B+"-content","aria-hidden":d}).toggleClass(m,H.disabled).data("qtip",z).appendTo(t.position.container).append(G.content=a("<div />",{"class":k+"-content",id:B+"-content","aria-atomic":d})),z.rendered=-1,C=D=1,f&&(M(),a.isFunction(f)||O(f,e)),a.isFunction(c)||P(c,e),z.rendered=d,J(),a.each(t.events,function(b,c){a.isFunction(c)&&E.bind(b==="toggle"?"tooltipshow tooltiphide":"tooltip"+b,c)}),a.each(h,function(){this.initialize==="render"&&this(z)}),Q(),E.queue("fx",function(a){i.originalEvent=H.event,E.trigger(i,[z]),C=D=0,z.redraw(),(t.show.ready||b)&&z.toggle(d,H.event),a()});return z},get:function(a){var b,c;switch(a.toLowerCase()){case"dimensions":b={height:E.outerHeight(),width:E.outerWidth()};break;case"offset":b=h.offset(E,t.position.container);break;default:c=I(a.toLowerCase()),b=c[0][c[1]],b=b.precedance?b.string():b}return b},set:function(b,c){function m(a,b){var c,d,e;for(c in k)for(d in k[c])if(e=(new RegExp(d,"i")).exec(a))b.push(e),k[c][d].apply(z,b)}var g=/^position\.(my|at|adjust|target|container)|style|content|show\.ready/i,h=/^content\.(title|attr)|style/i,i=e,j=e,k=z.checks,l;"string"===typeof b?(l=b,b={},b[l]=c):b=a.extend(d,{},b),a.each(b,function(c,d){var e=I(c.toLowerCase()),f;f=e[0][e[1]],e[0][e[1]]="object"===typeof d&&d.nodeType?a(d):d,b[c]=[e[0],e[1],d,f],i=g.test(c)||i,j=h.test(c)||j}),x(t),C=D=1,a.each(b,m),C=D=0,E.is(":visible")&&z.rendered&&(i&&z.reposition(t.position.target==="mouse"?f:H.event),j&&z.redraw());return z},toggle:function(b,c){function q(){b?(a.browser.msie&&E[0].style.removeAttribute("filter"),E.css("overflow",""),"string"===typeof h.autofocus&&a(h.autofocus,E).focus(),p=a.Event("tooltipvisible"),p.originalEvent=c?H.event:f,E.trigger(p,[z]),h.target.trigger("qtip-"+w+"-inactive")):E.css({display:"",visibility:"",opacity:"",left:"",top:""})}if(!z.rendered)return b?z.render(1):z;var g=b?"show":"hide",h=t[g],j=E.is(":visible"),k=!c||t[g].target.length<2||H.target[0]===c.target,l=t.position,m=t.content,o,p;(typeof b).search("boolean|number")&&(b=!j);if(!E.is(":animated")&&j===b&&k)return z;if(c){if(/over|enter/.test(c.type)&&/out|leave/.test(H.event.type)&&c.target===t.show.target[0]&&E.has(c.relatedTarget).length)return z;H.event=a.extend({},c)}p=a.Event("tooltip"+g),p.originalEvent=c?H.event:f,E.trigger(p,[z,90]);if(p.isDefaultPrevented())return z;a.attr(E[0],"aria-hidden",!b),b?(H.origin=a.extend({},i),z.focus(c),a.isFunction(m.text)&&P(m.text,e),a.isFunction(m.title.text)&&O(m.title.text,e),!v&&l.target==="mouse"&&l.adjust.mouse&&(a(document).bind("mousemove.qtip",function(a){i={pageX:a.pageX,pageY:a.pageY,type:"mousemove"}}),v=d),z.reposition(c),(p.solo=!!h.solo)&&a(n,h.solo).not(E).qtip("hide",p)):(clearTimeout(z.timers.show),delete H.origin,v&&!a(n+'[tracking="true"]:visible',h.solo).not(E).length&&(a(document).unbind("mousemove.qtip"),v=e),z.blur(c)),k&&E.stop(0,1),h.effect===e?(E[g](),q.call(E)):a.isFunction(h.effect)?(h.effect.call(E,z),E.queue("fx",function(a){q(),a()})):E.fadeTo(90,b?1:0,q),b&&h.target.trigger("qtip-"+w+"-inactive");return z},show:function(a){return z.toggle(d,a)},hide:function(a){return z.toggle(e,a)},focus:function(b){if(!z.rendered)return z;var c=a(n),d=parseInt(E[0].style.zIndex,10),e=g.zindex+c.length,f=a.extend({},b),h,i;E.hasClass(p)||(i=a.Event("tooltipfocus"),i.originalEvent=f,E.trigger(i,[z,e]),i.isDefaultPrevented()||(d!==e&&(c.each(function(){this.style.zIndex>d&&(this.style.zIndex=this.style.zIndex-1)}),c.filter("."+p).qtip("blur",f)),E.addClass(p)[0].style.zIndex=e));return z},blur:function(b){var c=a.extend({},b),d;E.removeClass(p),d=a.Event("tooltipblur"),d.originalEvent=c,E.trigger(d,[z]);return z},reposition:function(c,d){if(!z.rendered||C)return z;C=1;var f=t.position.target,g=t.position,j=g.my,l=g.at,m=g.adjust,n=m.method.split(" "),o=E.outerWidth(),p=E.outerHeight(),q=0,r=0,s=a.Event("tooltipmove"),u=E.css("position")==="fixed",v=g.viewport,w={left:0,top:0},x=g.container,y=e,B=z.plugins.tip,D={horizontal:n[0],vertical:n[1]=n[1]||n[0],enabled:v.jquery&&f[0]!==b&&f[0]!==A&&m.method!=="none",left:function(a){var b=D.horizontal==="shift",c=-x.offset.left+v.offset.left+v.scrollLeft,d=j.x==="left"?o:j.x==="right"?-o:-o/2,e=l.x==="left"?q:l.x==="right"?-q:-q/2,f=B&&B.size?B.size.width||0:0,g=B&&B.corner&&B.corner.precedance==="x"&&!b?f:0,h=c-a+g,i=a+o-v.width-c+g,k=d-(j.precedance==="x"||j.x===j.y?e:0),n=j.x==="center";b?(g=B&&B.corner&&B.corner.precedance==="y"?f:0,k=(j.x==="left"?1:-1)*d-g,w.left+=h>0?h:i>0?-i:0,w.left=Math.max(-x.offset.left+v.offset.left+(g&&B.corner.x==="center"?B.offset:0),a-k,Math.min(Math.max(-x.offset.left+v.offset.left+v.width,a+k),w.left))):(h>0&&(j.x!=="left"||i>0)?w.left-=k:i>0&&(j.x!=="right"||h>0)&&(w.left-=n?-k:k),w.left!==a&&n&&(w.left-=m.x),w.left<c&&-w.left>i&&(w.left=a));return w.left-a},top:function(a){var b=D.vertical==="shift",c=-x.offset.top+v.offset.top+v.scrollTop,d=j.y==="top"?p:j.y==="bottom"?-p:-p/2,e=l.y==="top"?r:l.y==="bottom"?-r:-r/2,f=B&&B.size?B.size.height||0:0,g=B&&B.corner&&B.corner.precedance==="y"&&!b?f:0,h=c-a+g,i=a+p-v.height-c+g,k=d-(j.precedance==="y"||j.x===j.y?e:0),n=j.y==="center";b?(g=B&&B.corner&&B.corner.precedance==="x"?f:0,k=(j.y==="top"?1:-1)*d-g,w.top+=h>0?h:i>0?-i:0,w.top=Math.max(-x.offset.top+v.offset.top+(g&&B.corner.x==="center"?B.offset:0),a-k,Math.min(Math.max(-x.offset.top+v.offset.top+v.height,a+k),w.top))):(h>0&&(j.y!=="top"||i>0)?w.top-=k:i>0&&(j.y!=="bottom"||h>0)&&(w.top-=n?-k:k),w.top!==a&&n&&(w.top-=m.y),w.top<0&&-w.top>i&&(w.top=a));return w.top-a}},F;if(a.isArray(f)&&f.length===2)l={x:"left",y:"top"},w={left:f[0],top:f[1]};else if(f==="mouse"&&(c&&c.pageX||H.event.pageX))l={x:"left",y:"top"},c=(c&&(c.type==="resize"||c.type==="scroll")?H.event:c&&c.pageX&&c.type==="mousemove"?c:i&&i.pageX&&(m.mouse||!c||!c.pageX)?{pageX:i.pageX,pageY:i.pageY}:!m.mouse&&H.origin&&H.origin.pageX?H.origin:c)||c||H.event||i||{},w={top:c.pageY,left:c.pageX};else{f==="event"?c&&c.target&&c.type!=="scroll"&&c.type!=="resize"?f=H.target=a(c.target):f=H.target:H.target=a(f),f=a(f).eq(0);if(f.length===0)return z;f[0]===document||f[0]===b?(q=h.iOS?b.innerWidth:f.width(),r=h.iOS?b.innerHeight:f.height(),f[0]===b&&(w={top:u||h.iOS?(v||f).scrollTop():0,left:u||h.iOS?(v||f).scrollLeft():0})):f.is("area")&&h.imagemap?w=h.imagemap(f,l,D.enabled?n:e):f[0].namespaceURI==="http://www.w3.org/2000/svg"&&h.svg?w=h.svg(f,l):(q=f.outerWidth(),r=f.outerHeight(),w=h.offset(f,x)),w.offset&&(q=w.width,r=w.height,y=w.flipoffset,w=w.offset);if(h.iOS<4.1&&h.iOS>3.1||h.iOS==4.3||!h.iOS&&u)F=a(b),w.left-=F.scrollLeft(),w.top-=F.scrollTop();w.left+=l.x==="right"?q:l.x==="center"?q/2:0,w.top+=l.y==="bottom"?r:l.y==="center"?r/2:0}w.left+=m.x+(j.x==="right"?-o:j.x==="center"?-o/2:0),w.top+=m.y+(j.y==="bottom"?-p:j.y==="center"?-p/2:0),D.enabled?(v={elem:v,height:v[(v[0]===b?"h":"outerH")+"eight"](),width:v[(v[0]===b?"w":"outerW")+"idth"](),scrollLeft:u?0:v.scrollLeft(),scrollTop:u?0:v.scrollTop(),offset:v.offset()||{left:0,top:0}},x={elem:x,scrollLeft:x.scrollLeft(),scrollTop:x.scrollTop(),offset:x.offset()||{left:0,top:0}},w.adjusted={left:D.horizontal!=="none"?D.left(w.left):0,top:D.vertical!=="none"?D.top(w.top):0},w.adjusted.left+w.adjusted.top&&E.attr("class",E[0].className.replace(/ui-tooltip-pos-\w+/i,k+"-pos-"+j.abbrev())),y&&w.adjusted.left&&(w.left+=y.left),y&&w.adjusted.top&&(w.top+=y.top)):w.adjusted={left:0,top:0},s.originalEvent=a.extend({},c),E.trigger(s,[z,w,v.elem||v]);if(s.isDefaultPrevented())return z;delete w.adjusted,d===e||isNaN(w.left)||isNaN(w.top)||f==="mouse"||!a.isFunction(g.effect)?E.css(w):a.isFunction(g.effect)&&(g.effect.call(E,z,a.extend({},w)),E.queue(function(b){a(this).css({opacity:"",height:""}),a.browser.msie&&this.style.removeAttribute("filter"),b()})),C=0;return z},redraw:function(){if(z.rendered<1||D)return z;var a=t.position.container,b,c,d,e;D=1,t.style.height&&E.css("height",t.style.height),t.style.width?E.css("width",t.style.width):(E.css("width","").addClass(r),c=E.width()+1,d=E.css("max-width")||"",e=E.css("min-width")||"",b=(d+e).indexOf("%")>-1?a.width()/100:0,d=(d.indexOf("%")>-1?b:1)*parseInt(d,10)||c,e=(e.indexOf("%")>-1?b:1)*parseInt(e,10)||0,c=d+e?Math.min(Math.max(c,e),d):c,E.css("width",Math.round(c)).removeClass(r)),D=0;return z},disable:function(b){"boolean"!==typeof b&&(b=!E.hasClass(m)&&!H.disabled),z.rendered?(E.toggleClass(m,b),a.attr(E[0],"aria-disabled",b)):H.disabled=!!b;return z},enable:function(){return z.disable(e)},destroy:function(){var b=s[0],c=a.attr(b,u),d=s.data("qtip");z.rendered&&(E.remove(),a.each(z.plugins,function(){this.destroy&&this.destroy()})),clearTimeout(z.timers.show),clearTimeout(z.timers.hide),R();if(!d||z===d)a.removeData(b,"qtip"),t.suppress&&c&&(a.attr(b,"title",c),s.removeAttr(u)),s.removeAttr("aria-describedby");s.unbind(".qtip-"+w),delete j[z.id];return s}})}function x(b){var c;if(!b||"object"!==typeof b)return e;if(b.metadata===f||"object"!==typeof b.metadata)b.metadata={type:b.metadata};if("content"in b){if(b.content===f||"object"!==typeof b.content||b.content.jquery)b.content={text:b.content};c=b.content.text||e,!a.isFunction(c)&&(!c&&!c.attr||c.length<1||"object"===typeof c&&!c.jquery)&&(b.content.text=e);if("title"in b.content){if(b.content.title===f||"object"!==typeof b.content.title)b.content.title={text:b.content.title};c=b.content.title.text||e,!a.isFunction(c)&&(!c&&!c.attr||c.length<1||"object"===typeof c&&!c.jquery)&&(b.content.title.text=e)}}if("position"in b)if(b.position===f||"object"!==typeof b.position)b.position={my:b.position,at:b.position};if("show"in b)if(b.show===f||"object"!==typeof b.show)b.show.jquery?b.show={target:b.show}:b.show={event:b.show};if("hide"in b)if(b.hide===f||"object"!==typeof b.hide)b.hide.jquery?b.hide={target:b.hide}:b.hide={event:b.hide};if("style"in b)if(b.style===f||"object"!==typeof b.style)b.style={classes:b.style};a.each(h,function(){this.sanitize&&this.sanitize(b)});return b}function w(){w.history=w.history||[],w.history.push(arguments);if("object"===typeof console){var a=console[console.warn?"warn":"log"],b=Array.prototype.slice.call(arguments),c;typeof arguments[0]==="string"&&(b[0]="qTip2: "+b[0]),c=a.apply?a.apply(console,b):a(b)}}"use strict";var d=!0,e=!1,f=null,g,h,i,j={},k="ui-tooltip",l="ui-widget",m="ui-state-disabled",n="div.qtip."+k,o=k+"-default",p=k+"-focus",q=k+"-hover",r=k+"-fluid",s="-31000px",t="_replacedByqTip",u="oldtitle",v;g=a.fn.qtip=function(b,h,i){var j=(""+b).toLowerCase(),k=f,l=a.makeArray(arguments).slice(1),m=l[l.length-1],n=this[0]?a.data(this[0],"qtip"):f;if(!arguments.length&&n||j==="api")return n;if("string"===typeof b){this.each(function(){var b=a.data(this,"qtip");if(!b)return d;m&&m.timeStamp&&(b.cache.event=m);if(j!=="option"&&j!=="options"||!h)b[j]&&b[j].apply(b[j],l);else if(a.isPlainObject(h)||i!==c)b.set(h,i);else{k=b.get(h);return e}});return k!==f?k:this}if("object"===typeof b||!arguments.length){n=x(a.extend(d,{},b));return g.bind.call(this,n,m)}},g.bind=function(b,f){return this.each(function(k){function r(b){function d(){p.render(typeof b==="object"||l.show.ready),m.show.add(m.hide).unbind(o)}if(p.cache.disabled)return e;p.cache.event=a.extend({},b),p.cache.target=b?a(b.target):[c],l.show.delay>0?(clearTimeout(p.timers.show),p.timers.show=setTimeout(d,l.show.delay),n.show!==n.hide&&m.hide.bind(n.hide,function(){clearTimeout(p.timers.show)})):d()}var l,m,n,o,p,q;q=a.isArray(b.id)?b.id[k]:b.id,q=!q||q===e||q.length<1||j[q]?g.nextid++:j[q]=q,o=".qtip-"+q+"-create",p=z.call(this,q,b);if(p===e)return d;l=p.options,a.each(h,function(){this.initialize==="initialize"&&this(p)}),m={show:l.show.target,hide:l.hide.target},n={show:a.trim(""+l.show.event).replace(/ /g,o+" ")+o,hide:a.trim(""+l.hide.event).replace(/ /g,o+" ")+o},/mouse(over|enter)/i.test(n.show)&&!/mouse(out|leave)/i.test(n.hide)&&(n.hide+=" mouseleave"+o),m.show.bind("mousemove"+o,function(a){i={pageX:a.pageX,pageY:a.pageY,type:"mousemove"}}),m.show.bind(n.show,r),(l.show.ready||l.prerender)&&r(f)})},h=g.plugins={Corner:function(a){a=(""+a).replace(/([A-Z])/," $1").replace(/middle/gi,"center").toLowerCase(),this.x=(a.match(/left|right/i)||a.match(/center/)||["inherit"])[0].toLowerCase(),this.y=(a.match(/top|bottom|center/i)||["inherit"])[0].toLowerCase();var b=a.charAt(0);this.precedance=b==="t"||b==="b"?"y":"x",this.string=function(){return this.precedance==="y"?this.y+this.x:this.x+this.y},this.abbrev=function(){var a=this.x.substr(0,1),b=this.y.substr(0,1);return a===b?a:a==="c"||a!=="c"&&b!=="c"?b+a:a+b},this.clone=function(){return{x:this.x,y:this.y,precedance:this.precedance,string:this.string,abbrev:this.abbrev,clone:this.clone}}},offset:function(a,b){function i(a,b){c.left+=b*a.scrollLeft(),c.top+=b*a.scrollTop()}var c=a.offset(),d=b,e=0,f=document.body,g,h;if(d){do{d.css("position")!=="static"&&(g=d[0]===f?{left:parseInt(d.css("left"),10)||0,top:parseInt(d.css("top"),10)||0}:d.position(),c.left-=g.left+(parseInt(d.css("borderLeftWidth"),10)||0)+(parseInt(d.css("marginLeft"),10)||0),c.top-=g.top+(parseInt(d.css("borderTopWidth"),10)||0),h=d.css("overflow"),(h==="scroll"||h==="auto")&&++e);if(d[0]===f)break}while(d=d.offsetParent());b[0]!==f&&e&&i(b,1)}return c},iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,3})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_","."))||e,fn:{attr:function(b,c){if(this.length){var d=this[0],e="title",f=a.data(d,"qtip");if(b===e&&f&&"object"===typeof f&&f.options.suppress){if(arguments.length<2)return a.attr(d,u);f&&f.options.content.attr===e&&f.cache.attr&&f.set("content.text",c);return this.attr(u,c)}}return a.fn["attr"+t].apply(this,arguments)},clone:function(b){var c=a([]),d="title",e=a.fn["clone"+t].apply(this,arguments);b||e.filter("["+u+"]").attr("title",function(){return a.attr(this,u)}).removeAttr(u);return e},remove:a.ui?f:function(b,c){a.ui||a(this).each(function(){c||(!b||a.filter(b,[this]).length)&&a("*",this).add(this).each(function(){a(this).triggerHandler("remove")})})}}},a.each(h.fn,function(b,c){if(!c||a.fn[b+t])return d;var e=a.fn[b+t]=a.fn[b];a.fn[b]=function(){return c.apply(this,arguments)||e.apply(this,arguments)}}),g.version="nightly",g.nextid=0,g.inactiveEvents="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" "),g.zindex=15e3,g.defaults={prerender:e,id:e,overwrite:d,suppress:d,content:{text:d,attr:"title",title:{text:e,button:e}},position:{my:"top left",at:"bottom right",target:e,container:e,viewport:e,adjust:{x:0,y:0,mouse:d,resize:d,method:"flip flip"},effect:function(b,c,d){a(this).animate(c,{duration:200,queue:e})}},show:{target:e,event:"mouseenter",effect:d,delay:90,solo:e,ready:e,autofocus:e},hide:{target:e,event:"mouseleave",effect:d,delay:0,fixed:e,inactive:e,leave:"window",distance:e},style:{classes:"",widget:e,width:e,height:e},events:{render:f,move:f,show:f,hide:f,toggle:f,visible:f,focus:f,blur:f}},h.svg=function(b,c){var d=a(document),e=b[0],f={width:0,height:0,offset:{top:1e10,left:1e10}},g,h,i,j,k;if(e.getBBox&&e.parentNode){g=e.getBBox(),h=e.getScreenCTM(),i=e.farthestViewportElement||e;if(!i.createSVGPoint)return f;j=i.createSVGPoint(),j.x=g.x,j.y=g.y,k=j.matrixTransform(h),f.offset.left=k.x,f.offset.top=k.y,j.x+=g.width,j.y+=g.height,k=j.matrixTransform(h),f.width=k.x-f.offset.left,f.height=k.y-f.offset.top,f.offset.left+=d.scrollLeft(),f.offset.top+=d.scrollTop()}return f}})(jQuery,window);

/*
 *  Kartograph 0.8.2 - a svg mapping library
 *  Copyright (C) 2011-2013  Gregor Aisch
 *
 *  This library is free software; you can redistribute it and/or
 *  modify it under the terms of the GNU Lesser General Public
 *  License as published by the Free Software Foundation; either
 *  version 2.1 of the License, or (at your option) any later version.
 *
 *  This library is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 *  Lesser General Public License for more details.
 *
 *  You should have received a copy of the GNU Lesser General Public
 *  License along with this library. If not, see <http://www.gnu.org/licenses/>.
 *
 * NOTE, manual modification made:
 * - removed Function.bind implementation, does not work properly w/ angular 1.6
*/
!function(){function t(){var t={},e=[],n=1,o=1;return t.size=function(r){return arguments.length?(o=r,t):o},t.iterations=function(r){return arguments.length?(n=r,t):n},t.add=function(r){return e.push(r),t},t.means=function(){for(var t=[],i={},a=Math.min(o,e.length),s=0,l=2*a;l>s;s++){var u=e[~~(Math.random()*e.length)],p=u.x+"/"+u.y;if(!(p in i)&&(i[p]=1,t.push({x:u.x,y:u.y})>=a))break}a=t.length;for(var h=0;n>h;h++){for(var c=r().points(t),s=0;a>s;s++){var f=t[s];f.sumX=0,f.sumY=0,f.size=0,f.points=[],f.indices=[]}for(var s=0;s<e.length;s++){var d=e[s],f=c.find(d);f.sumX+=d.x,f.sumY+=d.y,f.size++,f.points.push(d),f.indices.push(s)}for(var s=0;a>s;s++){var f=t[s];f.size&&(f.x=f.sumX/f.size,f.y=f.sumY/f.size)}}return t},t}function r(){function t(r,n){if(r.length){var o=a[n%a.length],i=r.length>>1;return r.sort(e(o)),{axis:o,point:r[i],left:t(r.slice(0,i),n+1),right:t(r.slice(i+1),n+1)}}}function r(t,r){for(var e=0,n=0;n<a.length;n++){var o=a[n],i=t[o]-r[o];e+=i*i}return e}function e(t){return function(r,e){return r=r[t],e=e[t],e>r?-1:r>e?1:0}}function n(t,e,o){if(r(t.point,e)<r(o.point,e)&&(o=t),t.left&&(o=n(t.left,e,o)),t.right){var i=t.point[t.axis]-e[t.axis];i*i<r(o.point,e)&&(o=n(t.right,e,o))}return o}var o,i={},a=["x","y"],s=[];return i.axes=function(t){return arguments.length?(a=t,i):a},i.points=function(t){return arguments.length?(s=t,o=null,i):s},i.find=function(t){return n(i.root(),t,o).point},i.root=function(){return o||(o=t(s,0))},i}var e,n,o,i,a,l,u,p,h,c,f,d,y,v,g,_,b,x,w,M,P,C,j,A,B,L,S,k,I,N,G,z,E,T,R,F,V,O,H,X,q,D,U,Q,Y,W,Z,$,K,J,tr,rr,er,nr,or,ir,ar,sr,lr,ur,pr,hr,cr,fr,dr,yr,mr,vr,gr,_r,br,xr,wr,Mr,Pr,Cr,jr,Ar,Br,Lr,Sr,kr,Ir,Nr,Gr,zr,Er,Tr,Rr,Fr,Vr,Or,Hr,Xr,qr,Dr,Ur,Qr,Yr,Wr,Zr,$r,Kr,Jr,te,re,ee,ne,oe,ie={}.hasOwnProperty,ae=function(t,r){function e(){this.constructor=t}for(var n in r)ie.call(r,n)&&(t[n]=r[n]);return e.prototype=r.prototype,t.prototype=new e,t.__super__=r.prototype,t},se=function(t,r){return function(){return t.apply(r,arguments)}},le=[].indexOf||function(t){for(var r=0,e=this.length;e>r;r++)if(r in this&&this[r]===t)return r;return-1};Br="undefined"!=typeof exports&&null!==exports?exports:this,br=Br.$K=null!=(Rr=Br.kartograph)?Rr:Br.kartograph={},br.version="0.8.1",e=Br.jQuery,br.__verbose=!1,Sr=function(){var t;try{return console.warn.apply(console,arguments)}catch(r){t=r;try{return opera.postError.apply(opera,arguments)}catch(r){return t=r,alert(Array.prototype.join.call(arguments," "))}}},xr=function(){var t;if(br.__verbose)try{return console.debug.apply(console,arguments)}catch(r){t=r;try{return opera.postError.apply(opera,arguments)}catch(r){return t=r,alert(Array.prototype.join.call(arguments," "))}}},null==(Fr=(Er=String.prototype).trim)&&(Er.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){"use strict";if(null==this)throw new TypeError;var r=Object(this),e=r.length>>>0;if(0===e)return-1;var n=0;if(arguments.length>0&&(n=Number(arguments[1]),n!=n?n=0:0!=n&&1/0!=n&&n!=-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=e)return-1;for(var o=n>=0?n:Math.max(e-Math.abs(n),0);e>o;o++)if(o in r&&r[o]===t)return o;return-1}),zr=function(){var t,r,e,n,o;for(t={},o="Boolean Number String Function Array Date RegExp Undefined Null".split(" "),e=0,n=o.length;n>e;e++)r=o[e],t["[object "+r+"]"]=r.toLowerCase();return function(r){var e;return e=Object.prototype.toString.call(r),t[e]||"object"}}(),i=function(){function t(t,r,e,n){var o;null==t&&(t=0),null==r&&(r=0),null==e&&(e=null),null==n&&(n=null),o=this,null===e?(o.xmin=Number.MAX_VALUE,o.xmax=-1*Number.MAX_VALUE):(o.xmin=o.left=t,o.xmax=o.right=t+e,o.width=e),null===n?(o.ymin=Number.MAX_VALUE,o.ymax=-1*Number.MAX_VALUE):(o.ymin=o.top=r,o.ymax=o.bottom=n+r,o.height=n)}return t.prototype.update=function(t,r){var e;return null==r&&(r=t[1],t=t[0]),e=this,e.xmin=Math.min(e.xmin,t),e.ymin=Math.min(e.ymin,r),e.xmax=Math.max(e.xmax,t),e.ymax=Math.max(e.ymax,r),e.left=e.xmin,e.top=e.ymin,e.right=e.xmax,e.bottom=e.ymax,e.width=e.xmax-e.xmin,e.height=e.ymax-e.ymin,this},t.prototype.intersects=function(t){return t.left<s.right&&t.right>s.left&&t.top<s.bottom&&t.bottom>s.top},t.prototype.inside=function(t,r){var e;return e=this,t>=e.left&&t<=e.right&&r>=e.top&&r<=e.bottom},t.prototype.join=function(t){var r;return r=this,r.update(t.left,t.top),r.update(t.right,t.bottom),this},t}(),i.fromXML=function(t){var r,e,n,o;return n=Number(t.getAttribute("x")),o=Number(t.getAttribute("y")),e=Number(t.getAttribute("w")),r=Number(t.getAttribute("h")),new br.BBox(n,o,e,r)},br.BBox=i,null==(Zr=br.geom)&&(br.geom={}),null==(Kr=(Tr=br.geom).clipping)&&(Tr.clipping={}),d=function(){function t(){}var r,e,n,o,i;return e=0,n=1,o=2,r=4,i=8,t.prototype.compute_out_code=function(t,r,e){var n,o;return o=this,n=o.INSIDE,r<t.left?n|=o.LEFT:r>t.right&&(n|=o.RIGHT),e<t.top?n|=o.TOP:e>t.bottom&&(n|=o.BOTTOM),n},t.prototype.clip=function(t,r,e,n,o){var i,a,s,l,u,p,h;for(u=this,a=u.compute_out_code(t,r,e),s=u.compute_out_code(t,n,o),i=False;True;){if(!(a|s)){i=True;break}if(a&s)break;l=0===code?s:a,l&u.TOP?(p=r+(n-r)*(t.top-e)/(o-e),h=t.top):l&u.BOTTOM?(p=r+(n-r)*(t.bottom-e)/(o-e),h=t.bottom):l&u.RIGHT?(h=e+(o-e)*(t.right-r)/(n-r),p=t.right):l&u.LEFT&&(h=e+(o-e)*(t.left-r)/(n-r),p=t.left),l===a?(r=p,e=h,a=u.compute_out_code(t,r,e)):(n=p,o=h,s=u.compute_out_code(t,n,o))}return i?[r,e,n,o]:null},t}(),br.geom.clipping.CohenSutherland=d,S=function(){function t(t,r,n){var o,i;i=this,i.container=o=e(t),null==r&&(r=o.width()),null==n&&(n=o.height()),0===n&&(n="auto"),i.size={h:n,w:r},i.markers=[],i.pathById={},i.container.addClass("kartograph")}return t.prototype.createSVGLayer=function(t){var r,n,o,i,a,s,l,u;return i=this,null==(u=i._layerCnt)&&(i._layerCnt=0),o=i._layerCnt++,l=i.viewport,n=i.container,a=Raphael(n[0],l.width,l.height),s=e(a.canvas),s.css({position:"absolute",top:"0px",left:"0px","z-index":o+5}),"static"===n.css("position")&&n.css({position:"relative",height:l.height+"px"}),s.addClass(t),r=e("desc",a.canvas).text(),e("desc",a.canvas).text(r.replace("with ","with kartograph "+br.version+" and ")),a},t.prototype.createHTMLLayer=function(t){var r,n,o,i,a,s;return i=this,a=i.viewport,r=i.container,null==(s=i._layerCnt)&&(i._layerCnt=0),o=i._layerCnt++,n=e('<div class="layer '+t+'" />'),n.css({position:"absolute",top:"0px",left:"0px",width:a.width+"px",height:a.height+"px","z-index":o+5}),r.append(n),n},t.prototype.load=function(t,r,n){var o,i,a,s;return i=this,o=e.Deferred(),i.clear(),i.opts=null!=n?n:{},null==(s=(a=i.opts).zoom)&&(a.zoom=1),i.mapLoadCallback=r,i._loadMapDeferred=o,i._lastMapUrl=t,i.cacheMaps&&null!=br.__mapCache[t]?i._mapLoaded(br.__mapCache[t]):e.ajax({url:t,dataType:"text",success:i._mapLoaded,context:i,error:function(t,r,e){return Sr(t,r,e)}}),o.promise()},t.prototype.loadMap=function(){return this.load.apply(this,arguments)},t.prototype.setMap=function(t,r){var e,n,o;e=this,e.opts=null!=r?r:{},null==(o=(n=e.opts).zoom)&&(n.zoom=1),e._lastMapUrl="string",e._mapLoaded(t)},t.prototype._mapLoaded=function(t){var r,n,o,a,s,l,u,p,h,c,f,d,y,m,v,g,_;l=this,l.cacheMaps&&(null==(y=br.__mapCache)&&(br.__mapCache={}),br.__mapCache[l._lastMapUrl]=t);try{t=e(t)}catch(b){return o=b,Sr("something went horribly wrong while parsing svg"),l._loadMapDeferred.reject("could not parse svg"),void 0}l.svgSrc=t,r=e("view",t),null==l.paper&&(f=l.size.w,a=l.size.h,"auto"===a&&(p=r.attr("w")/r.attr("h"),a=f/p),l.viewport=new i(0,0,f,a)),c=l.viewport,l.viewAB=n=br.View.fromXML(r[0]),u=null!=(m=l.opts.padding)?m:0,s=null!=(v=l.opts.halign)?v:"center",h=null!=(g=l.opts.valign)?g:"center",d=null!=(_=l.opts.zoom)?_:1,l.viewBC=new br.View(l.viewAB.asBBox(),c.width*d,c.height*d,u,s,h),l.proj=br.Proj.fromXML(e("proj",r)[0]),null!=l.mapLoadCallback&&l.mapLoadCallback(l),null!=l._loadMapDeferred&&l._loadMapDeferred.resolve(l)},t.prototype.addLayer=function(t,r){var n,o,i,a,s,l,u,p,h,c,f,d,y,m,v,g,_;return null==r&&(r={}),u=this,null==(v=u.layerIds)&&(u.layerIds=[]),null==(g=u.layers)&&(u.layers={}),null==u.paper&&(u.paper=u.createSVGLayer()),d=t,"object"===zr(r)?(s=r.name,c=r.key,m=r.title):r={},l=u.paper,r.add_svg_layer&&(l=u.createSVGLayer()),null==s&&(s=d),y=e("#"+d,u.svgSrc),0!==y.length?(a=new V(s,c,u,r.filter,l),n=e("*",y[0]),f=n.length,o=null!=(_=r.chunks)?_:f,i=0,h=function(){var t,e,s,l,u,c;for(t=o*i,e=u=0;o>=0?o>u:u>o;e=o>=0?++u:--u)f>t+e&&a.addPath(n.get(t+e),m);if(null!=r.styles){c=r.styles;for(s in c)l=c[s],a.style(s,l)}return i++,f>i*o?setTimeout(h,0):p()},p=function(){var t,e,n,o;for(a.paths.length>0&&(u.layers[s]=a,u.layerIds.push(s)),t=["click","mouseenter","mouseleave","dblclick","mousedown","mouseup","mouseover","mouseout"],n=0,o=t.length;o>n;n++)e=t[n],"function"===zr(r[e])&&a.on(e,r[e]);return null!=r.tooltips&&a.tooltips(r.tooltips),null!=r.done?r.done():void 0},null!=r.chunks?setTimeout(h,0):h(),u):void 0},t.prototype.getLayer=function(t){var r;return r=this,null==r.layers[t]?(Sr("could not find layer "+t),null):r.layers[t]},t.prototype.getLayerPath=function(t,r){var e,n;return n=this,e=n.getLayer(t),null!=e?"object"===zr(r)?e.getPaths(r)[0]:e.getPath(r):null},t.prototype.onLayerEvent=function(t,r,e){var n;return n=this,n.getLayer(e).on(t,r),n},t.prototype.addMarker=function(t){var r,e;return r=this,r.markers.push(t),e=r.viewBC.project(r.viewAB.project(r.proj.project(t.lonlat.lon,t.lonlat.lat))),t.render(e[0],e[1],r.container,r.paper)},t.prototype.clearMarkers=function(){var t,r,e,n,o;for(r=this,o=r.markers,e=0,n=o.length;n>e;e++)t=o[e],t.clear();return r.markers=[]},t.prototype.fadeIn=function(t){var r,e,n,o,i,a,s,l,u,p,h;null==t&&(t={}),i=this,o=null!=(l=t.layer)?l:i.layerIds[i.layerIds.length-1],e=null!=(u=t.duration)?u:500,p=i.layers[o].pathsById,h=[];for(n in p)s=p[n],h.push(function(){var t,n,o;for(o=[],t=0,n=s.length;n>t;t++)a=s[t],r="function"===zr(e)?e(a.data):e,a.svgPath.attr("opacity",0),o.push(a.svgPath.animate({opacity:1},r));return o}());return h},t.prototype.loadCoastline=function(){var t;return t=this,e.ajax({url:"coastline.json",success:t.renderCoastline,context:t})},t.prototype.resize=function(t,r){var e,n,o,i,a,s,l,u,p,h,c,f,d,y,m,v,g;a=this,e=a.container,null==t&&(t=e.width()),null==r&&(r=e.height()),a.viewport=p=new br.BBox(0,0,t,r),null!=a.paper&&a.paper.setSize(p.width,p.height),p=a.viewport,s=null!=(d=a.opts.padding)?d:0,n=null!=(y=a.opts.halign)?y:"center",u=null!=(m=a.opts.valign)?m:"center",h=a.opts.zoom,a.viewBC=new br.View(a.viewAB.asBBox(),p.width*h,p.height*h,s,n,u),v=a.layers;for(o in v)i=v[o],i.setView(a.viewBC);if(null!=a.symbolGroups)for(g=a.symbolGroups,c=0,f=g.length;f>c;c++)l=g[c],l.onResize()},t.prototype.lonlat2xy=function(t){var r,e;return e=this,2===t.length&&(t=new br.LonLat(t[0],t[1])),3===t.length&&(t=new br.LonLat(t[0],t[1],t[2])),r=e.proj.project(t.lon,t.lat,t.alt),e.viewBC.project(e.viewAB.project(r))},t.prototype.addSymbolGroup=function(t){var r,e;return r=this,null==(e=r.symbolGroups)&&(r.symbolGroups=[]),r.symbolGroups.push(t)},t.prototype.removeSymbols=function(t){var r,e,n,o,i,a;if(r=this,null!=t)return r.symbolGroups[t].remove();for(i=r.symbolGroups,a=[],n=0,o=i.length;o>n;n++)e=i[n],a.push(e.remove());return a},t.prototype.clear=function(){var t,r,n,o,i,a;if(r=this,null!=r.layers){for(t in r.layers)r.layers[t].remove();r.layers={},r.layerIds=[]}if(null!=r.symbolGroups){for(a=r.symbolGroups,o=0,i=a.length;i>o;o++)n=a[o],n.remove();r.symbolGroups=[]}return null!=r.paper?(e(r.paper.canvas).remove(),r.paper=void 0):void 0},t.prototype.loadCSS=function(t,r){var n;return n=this,Raphael.svg?(e("body").append('<link rel="stylesheet" href="'+t+'" />'),r()):e.ajax({url:t,dataType:"text",success:function(t){return n.styles=br.parsecss(t),r()},error:function(r,e,n){return Sr("error while loading "+t,r,e,n)}})},t.prototype.applyCSS=function(t,r){var e,n,o,i,a,s,l,u,p,h,c,f,d,y,m;if(o=this,null==o.styles)return t;null==(f=o._pathTypes)&&(o._pathTypes=["path","circle","rectangle","ellipse"]),null==(d=o._regardStyles)&&(o._regardStyles=["fill","stroke","fill-opacity","stroke-width","stroke-opacity"]);for(s in o.styles)for(i=s,y=i.split(","),u=0,h=y.length;h>u;u++)if(l=y[u],i=l.split(" "),i=i[i.length-1],i=i.split(":"),!(i.length>1||(i=i[0].split("."),e=i.slice(1),e.length>0&&e.indexOf(r)<0||(i=i[0],o._pathTypes.indexOf(i)>=0&&i!==t.type))))for(a=o.styles[s],m=o._regardStyles,p=0,c=m.length;c>p;p++)n=m[p],null!=a[n]&&t.attr(n,a[n]);return t},t.prototype.style=function(t,r,e,n,o){var i;return i=this,t=i.getLayer(t),null!=t?t.style(r,e,n,o):void 0},t}(),L=br,Br.kartograph=function(t,r,e){return new S(t,r,e)},br.map=function(t,r,e){return new S(t,r,e)},br.__mapCache={},e.extend(Br.kartograph,L),R=function(){function t(t,r,e){null==e&&(e=0),this.lon=Number(t),this.lat=Number(r),this.alt=Number(e)}return t.prototype.distance=function(t){var r,e,n,o,i,a,s,l,u;return u=this,r=6371,a=Math.PI/180,o=(t.lat-u.lat)*a,i=(t.lon-u.lon)*a,s=u.lat*a,l=t.lat*a,e=Math.sin(o/2)*Math.sin(o/2)+Math.sin(i/2)*Math.sin(i/2)*Math.cos(s)*Math.cos(l),n=2*Math.atan2(Math.sqrt(e),Math.sqrt(1-e)),r*n},t}(),G=function(t){function r(t,e,n){null==n&&(n=0),r.__super__.constructor.call(this,e,t,n)}return ae(r,t),r}(R),br.LonLat=R,br.LatLon=G,V=function(){function t(t,r,e,n,o){var i;i=this,i.id=t,i.path_id=r,i.paper=null!=o?o:e.paper,i.view=e.viewBC,i.map=e,i.filter=n}return t.prototype.addPath=function(t,r){var e,n,o,i,a,s,l;return n=this,null==(a=n.paths)&&(n.paths=[]),e=new O(t,n.id,n,r),"function"===zr(n.filter)&&n.filter(e.data)===!1?(e.remove(),void 0):(n.paths.push(e),null!=n.path_id?(null==(s=n.pathsById)&&(n.pathsById={}),null==(l=(o=n.pathsById)[i=e.data[n.path_id]])&&(o[i]=[]),n.pathsById[e.data[n.path_id]].push(e)):void 0)},t.prototype.hasPath=function(t){var r;return r=this,null!=r.pathsById&&null!=r.pathsById[t]},t.prototype.getPathsData=function(){var t,r,e,n,o,i;for(t=this,e=[],i=t.paths,n=0,o=i.length;o>n;n++)r=i[n],e.push(r.data);return e},t.prototype.getPath=function(t){var r;return r=this,r.hasPath(t)?r.pathsById[t][0]:null},t.prototype.getPaths=function(t){var r,e,n,o,i,a,s,l;if(o=this,n=[],"object"===zr(t))for(l=o.paths,a=0,s=l.length;s>a;a++){i=l[a],e=!0;for(r in t)e=e&&i.data[r]===t[r];e&&n.push(i)}return n},t.prototype.setView=function(t){var r,e,n,o,i;for(r=this,i=r.paths,n=0,o=i.length;o>n;n++)e=i[n],e.setView(t);return r},t.prototype.remove=function(){var t,r,e,n,o,i;for(t=this,o=t.paths,i=[],e=0,n=o.length;n>e;e++)r=o[e],i.push(r.remove());return i},t.prototype.style=function(t,r,e,n){var o,i,a,s,l,u,p,h,c,f,d;if(u=this,"object"===zr(t)){for(l in t)h=t[l],u.style(l,h);return u}for(null==e&&(e=0),null==n&&(n=0),d=u.paths,c=0,f=d.length;f>c;c++)p=d[c],h=jr(r,p.data),s=jr(e,p.data),a=jr(n,p.data),s>0?(i={},i[t]=h,o=Raphael.animation(i,1e3*s),p.svgPath.animate(o.delay(1e3*a))):p.svgPath.attr(t,h);return u},t.prototype.on=function(t,r){var n,o,i,a,s,l,u;for(i=this,n=function(){function t(t,r,e){this.type=t,this.cb=r,this.layer=e,this.handle=se(this.handle,this)}return t.prototype.handle=function(t){var r;return i=this,r=i.layer.map.pathById[t.target.getAttribute("id")],i.cb(r.data,r.svgPath,t)},t}(),o=new n(t,r,i),u=i.paths,s=0,l=u.length;l>s;s++)a=u[s],e(a.svgPath.node).bind(t,o.handle);return i},t.prototype.tooltips=function(t,r){var n,o,i,a,s,l,u;for(n=this,i=function(t,n){var o;return o={position:{target:"mouse",viewport:e(window),adjust:{x:7,y:7}},show:{delay:null!=r?r:20},events:{show:function(t,r){return e(".qtip").filter(function(){return this!==r.elements.tooltip.get(0)}).hide()}},content:{}},null!=n?"string"==typeof n?o.content.text=n:e.isArray(n)&&(o.content.title=n[0],o.content.text=n[1]):o.content.text="n/a",e(t.svgPath.node).qtip(o)},u=n.paths,s=0,l=u.length;l>s;s++)o=u[s],a=jr(t,o.data),i(o,a);return n},t.prototype.sort=function(t){var r,e,n,o,i,a;for(e=this,e.paths.sort(function(r,e){var n,o,i;return n=t(r.data),o=t(e.data),n===o?0:null!=(i=n>o)?i:{1:-1}}),r=!1,a=e.paths,o=0,i=a.length;i>o;o++)n=a[o],r&&n.svgPath.insertAfter(r.svgPath),r=n;return e},t}(),jr=function(t,r){return"function"===zr(t)?t(r):t},wr=0,O=function(){function t(t,r,e,n){var o,i,a,s,l,u,p,h,c,f,d,y,m,v;for(l=this,u=e.paper,s=e.map,d=s.viewBC,l.path=p=br.geom.Path.fromSVG(t),l.vpath=d.projectPath(p),l.svgPath=l.vpath.toSVG(u),l.svgPath.data("path",l),null==s.styles?Raphael.svg&&l.svgPath.node.setAttribute("class",r):s.applyCSS(l.svgPath,r),c="path_"+wr++,l.svgPath.node.setAttribute("id",c),s.pathById[c]=l,i={},a=m=0,v=t.attributes.length-1;v>=0?v>=m:m>=v;a=v>=0?++m:--m)o=t.attributes[a],"data-"===o.name.substr(0,5)&&(f=o.value,y=Number(f),""===f.trim()||y!==f||isNaN(y)||(f=y),i[o.name.substr(5)]=f);l.data=i,"string"===zr(n)?h=n:"function"===zr(n)&&(h=n(i)),null!=h&&l.svgPath.attr("title",h)}return t.prototype.setView=function(t){var r,e,n;return r=this,e=t.projectPath(r.path),r.vpath=e,"path"===r.path.type?(n=e.svgString(),r.svgPath.attr({path:n})):"circle"===r.path.type?r.svgPath.attr({cx:e.x,cy:e.y,r:e.r}):void 0},t.prototype.remove=function(){var t;return t=this,t.svgPath.remove()},t}(),br.parsecss=function(t,r){var e,n,o,i,a,s,l,u;for(i={},t=Mr(t),u=t.split("`b%"),s=0,l=u.length;l>s;s++)if(e=u[s],e=e.split("%b`"),!(e.length<2))if(e[0]=Ar(e[0]),o=Cr(e[1]),null!=i[e[0]])for(n in o)a=o[n],i[e[0]][n]=a;else i[e[0]]=o;return"function"!==zr(r)?i:(r(i),void 0)},Pr={},Cr=function(t){var r,e,n,o,i,a;for(n=Pr[t].replace(/^{|}$/g,""),n=Mr(n),e={},a=n.split(";"),o=0,i=a.length;i>o;o++)r=a[o],r=r.split(":"),r.length<2||(e[Ar(r[0])]=Ar(r.slice(1).join(":")));return e},J=/{[^{}]*}/,rr=/\[[^\[\]]*\]|{[^{}]*}|\([^()]*\)|function(\s+\w+)?(\s*%b`\d+`b%){2}/,tr=/(?:\/\*(?:[^\*]|\*[^\/])*\*\/)|(\\.|"(?:[^\\\"]|\\.|\\\n)*"|'(?:[^\\\']|\\.|\\\n)*')/g,er=/%\w`(\d+)`\w%/,Lr=0,Mr=function(t,r){var e,n,o;for(t=t.replace(tr,function(t,r){var e;return r?(e="%s`"+ ++Lr+"`s%",Pr[Lr]=r.replace(/^\\/,""),e):""}),e=r?rr:J;n=e.exec(t);)o="%b`"+ ++Lr+"`b%",Pr[Lr]=n[0],t=t.replace(e,o);return t},Ar=function(t){var r;if(null==t)return t;for(;r=er.exec(t);)t=t.replace(er,Pr[r[1]]);return t.trim()},null==(Jr=br.geom)&&(br.geom={}),Q=function(){function t(t,r,e){var n,o,i,a;for(null==e&&(e=!0),o=this,o.type=t,o.contours=[],i=0,a=r.length;a>i;i++)n=r[i],Ir(n)||n.reverse(),o.contours.push(n);o.closed=e}return t.prototype.clipToBBox=function(){throw"path clipping is not implemented yet"},t.prototype.toSVG=function(t){var r;return r=this.svgString(),t.path(r)},t.prototype.svgString=function(){var t,r,e,n,o,i,a,s,l,u,p,h,c;for(n=this,o="",e=n.closed?"Z M":"M",h=n.contours,s=0,u=h.length;u>s;s++)for(t=h[s],r=!0,o+=""===o?"M":e,l=0,p=t.length;p>l;l++)c=t[l],i=c[0],a=c[1],r||(o+="L"),o+=i+","+a,r=!1;return n.closed&&(o+="Z"),o},t.prototype.area=function(){var t,r,e,n,o,i;if(e=this,null!=e.areas)return e._area;for(e.areas=[],e._area=0,i=e.contours,n=0,o=i.length;o>n;n++)r=i[n],t=kr(r),e.areas.push(t),e._area+=t;return e._area},t.prototype.centroid=function(){var t,r,e,n,o,i,a,s,l,u,p,h,c,f,d,y,m,v,g,_,b,x,w,M,P,C,j,A,B,L,S,k,I,N,G,z,E;if(y=this,null!=y._centroid)return y._centroid;for(e=y.area(),i=a=0,p=j=0,I=y.contours.length-1;I>=0?I>=j:j>=I;p=I>=0?++j:--j)if(o=y.contours[p],n=[],f=o.length,r=y.areas[p],c=r/e,0!==c){for(h=A=0,N=f-1;N>=0?N>=A:A>=N;h=N>=0?++A:--A)if(m=o[h],v=o[(h+1)%f],s=0,n.push(m),m[0]===v[0]&&(s=Math.abs(m[1]-v[1])),m[1]===v[1]&&(s=Math.abs(m[0]-v[0])),s>10)for(t=Math.floor(2*s),g=B=1,G=t-1;G>=1?G>=B:B>=G;g=G>=1?++B:--B)_=[m[0]+g/t*(v[0]-m[0]),m[1]+g/t*(v[1]-m[1])],n.push(_);for(w=P=M=C=0,f=n.length,S=[],b=0,h=L=0,z=f-1;z>=0?z>=L:L>=z;h=z>=0?++L:--L)m=n[h],v=n[(h+1)%f],l=v[0]-m[0],u=v[1]-m[1],d=Math.sqrt(l*l+u*u),S.push(d),b+=d;for(h=k=0,E=f-1;E>=0?E>=k:k>=E;h=E>=0?++k:--k)m=n[h],x=S[h]/b,w+=x*m[0],P+=x*m[1];i+=w*c,a+=P*c}return y._centroid=[i,a],y._centroid},t.prototype.isInside=function(t,r){var e,n,o,i,a,s;if(i=this,e=i._bbox,t<e[0]||t>e[2]||r<e[1]||r>e[3])return!1;for(o=a=0,s=i.contours.length-1;s>=0?s>=a:a>=s;o=s>=0?++a:--a)if(n=i.contours[o],Nr(n,[t,r]))return!0;return!1},t}(),br.geom.Path=Q,f=function(t){function r(t,e,n){this.x=t,this.y=e,this.r=n,r.__super__.constructor.call(this,"circle",null,!0)}return ae(r,t),r.prototype.toSVG=function(t){var r;return r=this,t.circle(r.x,r.y,r.r)},r.prototype.centroid=function(){var t;return t=this,[t.x,t.y]},r.prototype.area=function(){var t;return t=this,Math.PI*t.r*m.r},r}(Q),br.geom.Circle=f,Q.fromSVG=function(t){var r,e,n,o,i,a,s,l,u,p,h,c,f,d;if(o=[],c=t.nodeName,p=null,"path"===c){for(l=t.getAttribute("d").trim(),s=Raphael.parsePathString(l),r="Z"===s[s.length-1],h=r?"Z M":"M",n=[],f=0,d=s.length;d>f;f++)e=s[f],0!==e.length&&("M"===e[0]?(n.length>2&&(o.push(n),n=[]),n.push([e[1],e[2]])):"L"===e[0]?n.push([e[1],e[2]]):"Z"===e[0]&&n.length>2&&(o.push(n),n=[]));n.length>=2&&(o.push(n),n=[]),p=new br.geom.Path(c,o,r)}else"circle"===c&&(i=t.getAttribute("cx"),a=t.getAttribute("cy"),u=t.getAttribute("r"),p=new br.geom.Circle(i,a,u));return p},z=function(){function t(t){this.points=t}return t.prototype.clipToBBox=function(r){var e,n,o,i,a,s,l,u,p,h,c,f,d,y,m,v,g,_,b,x;for(c=this,e=(new br.geom.clipping.CohenSutherland).clip,h=[],a=[],i=!1,o=v=0,g=c.points.length-2;g>=0?g>=v:v>=g;o=g>=0?++v:--v){_=c.points[o],s=_[0],l=_[1],b=c.points[o+1],u=b[0],p=b[1];try{x=e(r,s,l,u,p),f=x[0],y=x[1],d=x[2],m=x[3],i=!0,h.push([f,y]),(u!==d||p!==y||o===len(c.points)-2)&&h.push([d,m])}catch(w){n=w,i&&h.length>1&&(a.push(new t(h)),h=[]),i=!1}}return h.length>1&&a.push(new t(h)),a},t.prototype.toSVG=function(){var t,r,e,n,o,i,a,s;for(r=this,t=[],a=r.points,o=0,i=a.length;i>o;o++)s=a[o],e=s[0],n=s[1],t.push(e+","+n);return"M"+t.join("L")},t}(),br.geom.Line=z,Nr=function(t,r){var e,n,o,i,a,s,l,u,p,h,c,f,d,y,m;for(s=Math.PI,n=Math.atan2,p=2*s,a=t.length,e=0,i=y=0,m=a-1;m>=0?m>=y:y>=m;i=m>=0?++y:--y){for(h=t[i][0]-r[0],f=t[i][1]-r[1],c=t[(i+1)%a][0]-r[0],d=t[(i+1)%a][1]-r[1],l=n(f,h),u=n(d,c),o=u-l;o>s;)o-=p;for(;-s>o;)o+=p;e+=o}return Math.abs(e)>=s},Ir=function(t){return kr(t)>0},kr=function(t){var r,e,n,o,i,a,s,l;for(n=0,e=t.length,r=l=0;e>=0?e>l:l>e;r=e>=0?++l:--l)o=t[r][0],a=t[r][1],i=t[(r+1)%e][0],s=t[(r+1)%e][1],n+=o*s-i*a;return n*=.5},Gr=br.proj={},W=function(){function t(t){var r,e,n;r=this,r.lon0=null!=(e=t.lon0)?e:0,r.lat0=null!=(n=t.lat0)?n:0,r.PI=Math.PI,r.HALFPI=.5*r.PI,r.QUARTERPI=.25*r.PI,r.RAD=r.PI/180,r.DEG=180/r.PI,r.lam0=r.rad(this.lon0),r.phi0=r.rad(this.lat0),r.minLat=-90,r.maxLat=90}return t.parameters=[],t.title="Projection",t.prototype.rad=function(t){return t*this.RAD},t.prototype.deg=function(t){return t*this.DEG},t.prototype.plot=function(t,r){var e,n,o,i,a,s,l,u,p,h,c;for(null==r&&(r=!0),i=[],e=!0,u=0,p=t.length;p>u;u++)h=t[u],o=h[0],n=h[1],a=this._visible(o,n),a&&(e=!1),c=this.project(o,n),s=c[0],l=c[1],!a&&r?i.push(this._truncate(s,l)):i.push([s,l]);return e?null:[i]},t.prototype.sea=function(){var t,r,e,n,o,i,a,s,l,u,p,h,c,f;for(i=this,o=i.project.bind(this),n=[],t=i.lon0,i.lon0=0,e=a=-180;180>=a;e=++a)n.push(o(e,i.maxLat));for(r=s=p=i.maxLat,h=i.minLat;h>=p?h>=s:s>=h;r=h>=p?++s:--s)n.push(o(180,r));for(e=l=180;l>=-180;e=--l)n.push(o(e,i.minLat));for(r=u=c=i.minLat,f=i.maxLat;f>=c?f>=u:u>=f;r=f>=c?++u:--u)n.push(o(-180,r));return i.lon0=t,n},t.prototype.world_bbox=function(){var t,r,e,n,o,i;for(r=this.project.bind(this),n=this.sea(),t=new br.BBox,o=0,i=n.length;i>o;o++)e=n[o],t.update(e[0],e[1]);return t},t.prototype.toString=function(){var t;return t=this,"[Proj: "+t.name+"]"},t}(),W.fromXML=function(t){var r,e,n,o,i,a,s;for(n=t.getAttribute("id"),o={},e=a=0,s=t.attributes.length-1;s>=0?s>=a:a>=s;e=s>=0?++a:--a)r=t.attributes[e],"id"!==r.name&&(o[r.name]=r.value);return i=new br.proj[n](o),i.name=n,i},br.Proj=W,v=function(t){function r(t){var e,n,o;null==t&&(t={}),e=this,e.flip=Number(null!=(n=t.flip)?n:0),1===e.flip&&(t.lon0=null!=(o=-t.lon0)?o:0),r.__super__.constructor.call(this,t)}return ae(r,t),r.parameters=["lon0","flip"],r.title="Cylindrical Projection",r.prototype._visible=function(){return!0},r.prototype.clon=function(t){return t-=this.lon0,-180>t?t+=360:t>180&&(t-=360),t},r.prototype.ll=function(t,r){return 1===this.flip?[-t,-r]:[t,r]},r}(W),b=function(t){function r(){return te=r.__super__.constructor.apply(this,arguments)}return ae(r,t),r.title="Equirectangular Projection",r.prototype.project=function(t,r){var e;return e=this.ll(t,r),t=e[0],r=e[1],t=this.clon(t),[1e3*t*Math.cos(this.phi0),1e3*-1*r]},r}(v),Gr.lonlat=b,h=function(t){function r(t){var e;r.__super__.constructor.call(this,t),this.lat1=null!=(e=t.lat1)?e:0,this.phi1=this.rad(this.lat1)}return ae(r,t),r.parameters=["lon0","lat1","flip"],r.title="Cylindrical Equal Area",r.prototype.project=function(t,r){var e,n,o,i,a;return a=this.ll(t,r),t=a[0],r=a[1],e=this.rad(this.clon(t)),n=this.rad(-1*r),o=e*Math.cos(this.phi1),i=Math.sin(n)/Math.cos(this.phi1),[1e3*o,1e3*i]},r}(v),Gr.cea=h,w=function(t){function r(t){t.lat1=45,r.__super__.constructor.call(this,t)}return ae(r,t),r.title="Gall-Peters Projection",r.parameters=["lon0","flip"],r}(h),Gr.gallpeters=w,j=function(t){function r(t){t.lat1=37.7,r.__super__.constructor.call(this,t)}return ae(r,t),r.title="Hobo-Dyer Projection",r.parameters=["lon0","flip"],r}(h),Gr.hobodyer=j,l=function(t){function r(t){t.lat1=30,r.__super__.constructor.call(this,t)}return ae(r,t),r.title="Behrmann Projection",r.parameters=["lon0","flip"],r}(h),Gr.behrmann=l,a=function(t){function r(t){t.lat1=50,r.__super__.constructor.call(this,t)}return ae(r,t),r.title="Balthasart Projection",r.parameters=["lon0","flip"],r}(h),Gr.balthasart=a,H=function(t){function r(t){r.__super__.constructor.call(this,t),this.minLat=-85,this.maxLat=85}return ae(r,t),r.title="Mercator Projection",r.prototype.project=function(t,r){var e,n,o,i,a,s,l;return i=this,l=i.ll(t,r),t=l[0],r=l[1],n=Math,e=i.rad(i.clon(t)),o=i.rad(-1*r),a=1e3*e,s=1e3*n.log((1+n.sin(o))/n.cos(o)),[a,s]},r}(v),Gr.mercator=H,$=function(t){function r(){return re=r.__super__.constructor.apply(this,arguments)}return ae(r,t),r.title="Pseudo-Cylindrical Projection",r}(v),q=function(t){function r(t){var e;r.__super__.constructor.call(this,t),e=this,e.A0=.8707,e.A1=-.131979,e.A2=-.013791,e.A3=.003971,e.A4=-.001529,e.B0=1.007226,e.B1=.015085,e.B2=-.044475,e.B3=.028874,e.B4=-.005916,e.C0=e.B0,e.C1=3*e.B1,e.C2=7*e.B2,e.C3=9*e.B3,e.C4=11*e.B4,e.EPS=1e-11,e.MAX_Y=.8707*.52*Math.PI}return ae(r,t),r.title="Natural Earth Projection",r.prototype.project=function(t,r){var e,n,o,i,a,s,l,u;return a=this,u=a.ll(t,r),t=u[0],r=u[1],e=a.rad(a.clon(t)),n=a.rad(-1*r),o=n*n,i=o*o,s=180*e*(a.A0+o*(a.A1+o*(a.A2+i*o*(a.A3+o*a.A4))))+500,l=180*n*(a.B0+o*(a.B1+i*(a.B2+a.B3*o+a.B4*i)))+270,[s,l]},r}($),Gr.naturalearth=q,nr=function(t){function r(t){var e;r.__super__.constructor.call(this,t),e=this,e.X=[1,-5.67239e-12,-715511e-10,311028e-11,.9986,-482241e-9,-24897e-9,-133094e-11,.9954,-831031e-9,-44861e-9,-9.86588e-7,.99,-.00135363,-596598e-10,367749e-11,.9822,-.00167442,-44975e-10,-572394e-11,.973,-.00214869,-903565e-10,1.88767e-8,.96,-.00305084,-900732e-10,164869e-11,.9427,-.00382792,-653428e-10,-261493e-11,.9216,-.00467747,-104566e-9,48122e-10,.8962,-.00536222,-323834e-10,-543445e-11,.8679,-.00609364,-1139e-7,332521e-11,.835,-.00698325,-640219e-10,9.34582e-7,.7986,-.00755337,-500038e-10,9.35532e-7,.7597,-.00798325,-359716e-10,-227604e-11,.7186,-.00851366,-70112e-9,-863072e-11,.6732,-.00986209,-199572e-9,191978e-10,.6213,-.010418,883948e-10,624031e-11,.5722,-.00906601,181999e-9,624033e-11,.5322,0,0,0],e.Y=[0,.0124,3.72529e-10,1.15484e-9,.062,.0124001,1.76951e-8,-5.92321e-9,.124,.0123998,-7.09668e-8,2.25753e-8,.186,.0124008,2.66917e-7,-8.44523e-8,.248,.0123971,-9.99682e-7,3.15569e-7,.31,.0124108,373349e-11,-11779e-10,.372,.0123598,-13935e-9,439588e-11,.434,.0125501,520034e-10,-100051e-10,.4968,.0123198,-980735e-10,922397e-11,.5571,.0120308,402857e-10,-52901e-10,.6176,.0120369,-390662e-10,7.36117e-7,.6769,.0117015,-280246e-10,-8.54283e-7,.7346,.0113572,-408389e-10,-5.18524e-7,.7903,.0109099,-486169e-10,-10718e-10,.8435,.0103433,-646934e-10,5.36384e-9,.8936,.00969679,-646129e-10,-854894e-11,.9394,.00840949,-192847e-9,-421023e-11,.9761,.00616525,-256001e-9,-421021e-11,1,0,0,0],e.NODES=18,e.FXC=.8487,e.FYC=1.3523,e.C1=11.459155902616464,e.RC1=.08726646259971647,e.ONEEPS=1.000001,e.EPS=1e-8}return ae(r,t),r.title="Robinson Projection",r.prototype._poly=function(t,r,e){return t[r]+e*(t[r+1]+e*(t[r+2]+e*t[r+3]))},r.prototype.project=function(t,r){var e,n,o,i,a,s,l,u;return a=this,u=a.ll(t,r),t=u[0],r=u[1],t=a.clon(t),n=a.rad(t),o=a.rad(-1*r),i=Math.abs(o),e=Math.floor(i*a.C1),e>=a.NODES&&(e=a.NODES-1),i=a.deg(i-a.RC1*e),e*=4,s=1e3*a._poly(a.X,e,i)*a.FXC*n,l=1e3*a._poly(a.Y,e,i)*a.FYC,0>o&&(l=-l),[s,l]},r}($),Gr.robinson=nr,g=function(t){function r(t){var e;r.__super__.constructor.call(this,t),e=this,e.C_x=.4222382003157712,e.C_y=1.3265004281770023,e.RC_y=.7538633073600218,e.C_p=3.5707963267948966,e.RC_p=.2800495767557787,e.EPS=1e-7,e.NITER=6}return ae(r,t),r.title="Eckert IV Projection",r.prototype.project=function(t,r){var e,n,o,i,a,s,l,u,p,h,c;for(s=this,c=s.ll(t,r),t=c[0],r=c[1],i=s.rad(s.clon(t)),a=s.rad(-1*r),l=s.C_p*Math.sin(a),e=a*a,a*=.895168+e*(.0218849+.00826809*e),o=s.NITER;o>0&&(n=Math.cos(a),u=Math.sin(a),e=(a+u*(n+2)-l)/(1+n*(n+2)-u*u),a-=e,!(Math.abs(e)<s.EPS));)o-=1;return 0===o?(p=s.C_x*i,h=0>a?-s.C_y:s.C_y):(p=s.C_x*i*(1+Math.cos(a)),h=s.C_y*Math.sin(a)),[p,h]},r}($),Gr.eckert4=g,ar=function(t){function r(){return ee=r.__super__.constructor.apply(this,arguments)}return ae(r,t),r.title="Sinusoidal Projection",r.prototype.project=function(t,r){var e,n,o,i,a,s;return n=this,s=n.ll(t,r),t=s[0],r=s[1],e=n.rad(n.clon(t)),o=n.rad(-1*r),i=1032*e*Math.cos(o),a=1032*o,[i,a]},r}($),Gr.sinusoidal=ar,X=function(t){function r(t,e,n,o,i){var a,s,l,u;null==e&&(e=1.5707963267948966),null==n&&(n=null),null==o&&(o=null),null==i&&(i=null),r.__super__.constructor.call(this,t),a=this,a.MAX_ITER=10,a.TOLERANCE=1e-7,null!=e?(s=e+e,u=Math.sin(e),l=Math.sqrt(2*Math.PI*u/(s+Math.sin(s))),a.cx=2*l/Math.PI,a.cy=l/u,a.cp=s+Math.sin(s)):null!=n&&null!=o&&"undefined"!=typeof cz&&null!==cz?(a.cx=n,a.cy=o,a.cp=i):Sr("kartograph.proj.Mollweide: either p or cx,cy,cp must be defined")}return ae(r,t),r.title="Mollweide Projection",r.prototype.project=function(t,r){var e,n,o,i,a,s,l,u,p,h,c;for(s=this,c=s.ll(t,r),t=c[0],r=c[1],a=Math,e=a.abs,i=s.rad(s.clon(t)),l=s.rad(r),o=s.cp*a.sin(l),n=s.MAX_ITER;0!==n&&(u=(l+a.sin(l)-o)/(1+a.cos(l)),l-=u,!(e(u)<s.TOLERANCE));)n-=1;return 0===n?l=l>=0?s.HALFPI:-s.HALFPI:l*=.5,p=1e3*s.cx*i*a.cos(l),h=1e3*s.cy*a.sin(l),[p,-1*h]},r}($),Gr.mollweide=X,dr=function(t){function r(t){r.__super__.constructor.call(this,t,1.0471975511965976)}return ae(r,t),r.title="Wagner IV Projection",r}(X),Gr.wagner4=dr,yr=function(t){function r(t){r.__super__.constructor.call(this,t,null,.90977,1.65014,3.00896)}return ae(r,t),r.title="Wagner V Projection",r}(X),Gr.wagner5=yr,F=function(t){function r(){return ne=r.__super__.constructor.apply(this,arguments)}var e,n;return ae(r,t),n=-89,e=89,r.parameters=["lon0","lat0","flip"],r.title="Loximuthal Projection (equidistant)",r.prototype.project=function(t,r){var e,n,o,i,a,s,l;return o=this,l=o.ll(t,r),t=l[0],r=l[1],n=Math,e=o.rad(o.clon(t)),i=o.rad(r),a=i===o.phi0?e*n.cos(o.phi0):e*(i-o.phi0)/(n.log(n.tan(o.QUARTERPI+.5*i))-n.log(n.tan(o.QUARTERPI+.5*o.phi0))),a*=1e3,s=1e3*(i-o.phi0),[a,-1*s]},r}($),Gr.loximuthal=F,c=function(t){function r(){return oe=r.__super__.constructor.apply(this,arguments)}var e,n,o,i,a;return ae(r,t),r.title="Canters Modified Sinusoidal I",r.parameters=["lon0"],e=1.1966,n=-.129,o=3*n,i=-.0076,a=5*i,r.prototype.project=function(t,r){var s,l,u,p,h,c;return s=this,c=s.ll(t,r),t=c[0],r=c[1],t=s.rad(s.clon(t)),r=s.rad(r),p=r*r,h=p*p,l=1e3*t*Math.cos(r)/(e+o*p+a*h),u=1e3*r*(e+n*p+i*h),[l,-1*u]},r}($),Gr.canters1=c,C=function(t){function r(t){r.__super__.constructor.call(this,t)}var e,n,o,i,a,s,l,u,p,h,c,f,d;return ae(r,t),r.title="Hatano Projection",l=20,o=1e-7,u=1.000001,e=2.67595,n=2.43763,p=.3736990601468637,h=.4102345310814193,a=1.75859,s=1.93052,f=.5686373742600607,d=.5179951515653813,i=.85,c=1.1764705882352942,r.prototype.project=function(t,r){var u,p,h,c,f,d,y,m,v,g;
for(c=this,g=c.ll(t,r),t=g[0],r=g[1],h=c.rad(c.clon(t)),f=c.rad(r),u=Math.sin(f)*(0>f?n:e),p=v=l;v>=1&&(d=(f+Math.sin(f)-u)/(1+Math.cos(f)),f-=d,!(Math.abs(d)<o));p=v+=-1);return y=1e3*i*h*Math.cos(f*=.5),m=1e3*Math.sin(f)*(0>f?s:a),[y,-1*m]},r}($),Gr.hatano=C,P=function(t){function r(t){var e;r.__super__.constructor.call(this,t),e=this,e.lat1=41.737,e.p1=new X,e.p0=new ar}return ae(r,t),r.title="Goode Homolosine Projection",r.parameters=["lon0"],r.prototype.project=function(t,r){var e,n;return e=this,n=e.ll(t,r),t=n[0],r=n[1],t=e.clon(t),Math.abs(r)>e.lat1?e.p1.project(t,r):e.p0.project(t,r)},r}($),Gr.goodehomolosine=P,D=function(t){function r(t){r.__super__.constructor.call(this,t),this.r=100*this.HALFPI}var e;return ae(r,t),r.title="Nicolosi Globular Projection",r.parameters=["lon0"],e=1e-10,r.prototype._visible=function(t){var r;return r=this,t=r.clon(t),t>-90&&90>t},r.prototype.project=function(t,r){var n,o,i,a,s,l,u,p,h,c,f,d,y;return s=this,y=s.ll(t,r),t=y[0],r=y[1],i=s.rad(s.clon(t)),u=s.rad(r),Math.abs(i)<e?(f=0,d=u):Math.abs(u)<e?(f=i,d=0):Math.abs(Math.abs(i)-s.HALFPI)<e?(f=i*Math.cos(u),d=s.HALFPI*Math.sin(u)):Math.abs(Math.abs(u)-s.HALFPI)<e?(f=0,d=u):(c=s.HALFPI/i-i/s.HALFPI,n=u/s.HALFPI,h=Math.sin(u),o=(1-n*n)/(h-n),p=c/o,p*=p,a=(c*h/o-.5*c)/(1+p),l=(h/p+.5*o)/(1+1/p),f=Math.cos(u),f=Math.sqrt(a*a+f*f/(1+p)),f=s.HALFPI*(a+(0>i?-f:f)),d=Math.sqrt(l*l-(h*h/p+o*h-1)/(1+1/p)),d=s.HALFPI*(l+(0>u?d:-d))),[100*f,-100*d]},r.prototype.sea=function(){var t,r,e,n,o;for(r=[],n=this.r,t=Math,e=o=0;360>=o;e=++o)r.push([t.cos(this.rad(e))*n,t.sin(this.rad(e))*n]);return r},r.prototype.world_bbox=function(){var t;return t=this.r,new br.BBox(-t,-t,2*t,2*t)},r}($),Gr.nicolosi=D,o=function(t){function r(t,e){var n;null==e&&(e=1e3),r.__super__.constructor.call(this,t),n=this,n.r=e,n.elevation0=n.to_elevation(n.lat0),n.azimuth0=n.to_azimuth(n.lon0)}return ae(r,t),r.parameters=["lon0","lat0"],r.title="Azimuthal Projection",r.prototype.to_elevation=function(t){var r;return r=this,(t+90)/180*r.PI-r.HALFPI},r.prototype.to_azimuth=function(t){var r;return r=this,2*(t+180)/360*r.PI-r.PI},r.prototype._visible=function(t,r){var e,n,o,i,a;return a=this,i=Math,o=a.to_elevation(r),e=a.to_azimuth(t),n=i.sin(o)*i.sin(a.elevation0)+i.cos(a.elevation0)*i.cos(o)*i.cos(e-a.azimuth0),n>=0},r.prototype._truncate=function(t,r){var e,n,o,i,a;return e=Math,n=this.r,o=e.atan2(r-n,t-n),i=n+n*e.cos(o),a=n+n*e.sin(o),[i,a]},r.prototype.sea=function(){var t,r,e,n,o;for(r=[],n=this.r,t=Math,e=o=0;360>=o;e=++o)r.push([n+t.cos(this.rad(e))*n,n+t.sin(this.rad(e))*n]);return r},r.prototype.world_bbox=function(){var t;return t=this.r,new br.BBox(0,0,2*t,2*t)},r}(W),U=function(t){function r(){return Vr=r.__super__.constructor.apply(this,arguments)}return ae(r,t),r.title="Orthographic Projection",r.prototype.project=function(t,r){var e,n,o,i,a,s,l,u;return i=this,o=Math,n=i.to_elevation(r),e=i.to_azimuth(t),s=i.r*o.cos(n)*o.sin(e-i.azimuth0),u=-i.r*(o.cos(i.elevation0)*o.sin(n)-o.sin(i.elevation0)*o.cos(n)*o.cos(e-i.azimuth0)),a=i.r+s,l=i.r+u,[a,l]},r}(o),Gr.ortho=U,k=function(t){function r(t){r.__super__.constructor.call(this,t),this.scale=.5*Math.sqrt(2)}return ae(r,t),r.title="Lambert Azimuthal Equal-Area Projection",r.prototype.project=function(t,r){var e,n,o,i,a,s,l,u,p,h;return a=this.rad(r),o=this.rad(t),i=Math,s=i.sin,e=i.cos,n=i.pow(2/(1+s(this.phi0)*s(a)+e(this.phi0)*e(a)*e(o-this.lam0)),.5),n*=this.scale,u=this.r*n*e(a)*s(o-this.lam0),h=-this.r*n*(e(this.phi0)*s(a)-s(this.phi0)*e(a)*e(o-this.lam0)),l=this.r+u,p=this.r+h,[l,p]},r}(o),Gr.laea=k,ur=function(t){function r(){return Or=r.__super__.constructor.apply(this,arguments)}return ae(r,t),r.title="Stereographic Projection",r.prototype.project=function(t,r){var e,n,o,i,a,s,l,u,p,h,c;return s=this.rad(r),i=this.rad(t),a=Math,l=a.sin,e=a.cos,o=.5,n=2*o/(1+l(this.phi0)*l(s)+e(this.phi0)*e(s)*e(i-this.lam0)),p=this.r*n*e(s)*l(i-this.lam0),c=-this.r*n*(e(this.phi0)*l(s)-l(this.phi0)*e(s)*e(i-this.lam0)),u=this.r+p,h=this.r+c,[u,h]},r}(o),Gr.stereo=ur,or=function(t){function r(t){var e,n,o,i,a,s,l,u,p,h;for(r.__super__.constructor.call(this,{lon0:0,lat0:0}),this.dist=null!=(u=t.dist)?u:3,this.up=this.rad(null!=(p=t.up)?p:0),this.tilt=this.rad(null!=(h=t.tilt)?h:0),this.scale=1,i=Number.MAX_VALUE,o=-1*Number.MAX_VALUE,e=s=0;179>=s;e=++s)for(n=l=0;360>=l;n=++l)a=this.project(n-180,e-90),i=Math.min(a[0],i),o=Math.max(a[0],o);this.scale=2*this.r/(o-i),r.__super__.constructor.call(this,t)}return ae(r,t),r.parameters=["lon0","lat0","tilt","dist","up"],r.title="Satellite Projection",r.prototype.project=function(t,r,e){var n,o,i,a,s,l,u,p,h,c,f,d,y,m,v,g,_,b,x,w,M;return null==e&&(e=0),c=this.rad(r),p=this.rad(t),h=Math,y=h.sin,i=h.cos,f=this.r,d=f*(e+6371)/3671,a=y(this.phi0)*y(c)+i(this.phi0)*i(c)*i(p-this.lam0),u=(this.dist-1)/(this.dist-a),u=(this.dist-1)/(this.dist-a),u*=this.scale,_=d*u*i(c)*y(p-this.lam0),w=-d*u*(i(this.phi0)*y(c)-y(this.phi0)*i(c)*i(p-this.lam0)),l=i(this.up),v=y(this.up),s=i(this.tilt),m=y(this.tilt),o=d*(this.dist-1),n=(w*l+_*v)*y(this.tilt)/o+s,b=(_*l-w*v)*i(this.tilt)/n,M=(w*l+_*v)/n,g=f+b,x=f+M,[g,x]},r.prototype._visible=function(t,r){var e,n,o,i;return o=this.to_elevation(r),e=this.to_azimuth(t),i=Math,n=i.sin(o)*i.sin(this.elevation0)+i.cos(this.elevation0)*i.cos(o)*i.cos(e-this.azimuth0),n>=1/this.dist},r.prototype.sea=function(){var t,r,e,n,o;for(r=[],n=this.r,t=Math,e=o=0;360>=o;e=++o)r.push([n+t.cos(this.rad(e))*n,n+t.sin(this.rad(e))*n]);return r},r}(o),Gr.satellite=or,_=function(t){function r(){return Hr=r.__super__.constructor.apply(this,arguments)}return ae(r,t),r.title="Equidistant Azimuthal Projection",r.prototype.project=function(t,r){var e,n,o,i,a,s,l,u,p,h,c,f,d;return l=this,u=l.rad(r),a=l.rad(t),s=Math,p=s.sin,n=s.cos,o=p(this.phi0)*p(u)+n(this.phi0)*n(u)*n(a-this.lam0),e=s.acos(o),i=.325*e/p(e),c=this.r*i*n(u)*p(a-this.lam0),d=-this.r*i*(n(this.phi0)*p(u)-p(this.phi0)*n(u)*n(a-this.lam0)),h=this.r+c,f=this.r+d,[h,f]},r.prototype._visible=function(){return!0},r}(o),Gr.equi=_,n=function(t){function r(t){var e;e=this,t.lat0=0,r.__super__.constructor.call(this,t),e.lam0=0}var e;return ae(r,t),r.title="Aitoff Projection",r.parameters=["lon0"],e=.6366197723675814,r.prototype.project=function(t,r){var n,o,i,a,s,l,u,p;return a=this,p=a.ll(t,r),t=p[0],r=p[1],t=a.clon(t),i=a.rad(t),s=a.rad(r),n=.5*i,o=Math.acos(Math.cos(s)*Math.cos(n)),0!==o?(u=1/Math.sin(o),l=2*o*Math.cos(s)*Math.sin(n)*u,u*=o*Math.sin(s)):l=u=0,a.winkel&&(l=.5*(l+i*e),u=.5*(u+s)),[1e3*l,-1e3*u]},r.prototype._visible=function(){return!0},r}($),Gr.aitoff=n,mr=function(t){function r(t){r.__super__.constructor.call(this,t),this.winkel=!0}return ae(r,t),r.title="Winkel Tripel Projection",r}(n),Gr.winkel3=mr,y=function(t){function r(t){var e,n,o;e=this,r.__super__.constructor.call(this,t),e.lat1=null!=(n=t.lat1)?n:30,e.phi1=e.rad(e.lat1),e.lat2=null!=(o=t.lat2)?o:50,e.phi2=e.rad(e.lat2)}return ae(r,t),r.title="Conic Projection",r.parameters=["lon0","lat0","lat1","lat2"],r.prototype._visible=function(t,r){var e;return e=this,r>e.minLat&&r<e.maxLat},r.prototype._truncate=function(t,r){return[t,r]},r.prototype.clon=function(t){return t-=this.lon0,-180>t?t+=360:t>180&&(t-=360),t},r}(W),I=function(t){function r(t){var e,n,o,i,a,s,l,u,p,h,c,f,d;p=this,r.__super__.constructor.call(this,t),a=Math,d=[a.sin,a.cos,a.abs,a.log,a.tan,a.pow],h=d[0],o=d[1],e=d[2],xr=d[3],f=d[4],l=d[5],p.n=s=c=h(p.phi1),i=o(p.phi1),u=e(p.phi1-p.phi2)>=1e-10,u&&(s=xr(i/o(p.phi2))/xr(f(p.QUARTERPI+.5*p.phi2)/f(p.QUARTERPI+.5*p.phi1))),p.c=n=i*l(f(p.QUARTERPI+.5*p.phi1),s)/s,p.rho0=e(e(p.phi0)-p.HALFPI)<1e-10?0:n*l(f(p.QUARTERPI+.5*p.phi0),-s),p.minLat=-60,p.maxLat=85}return ae(r,t),r.title="Lambert Conformal Conic Projection",r.prototype.project=function(t,r){var e,n,o,i,a,s,l,u,p,h,c,f,d,y,m;return h=this,l=h.rad(r),o=h.rad(h.clon(t)),a=Math,m=[a.sin,a.cos,a.abs,a.log,a.tan,a.pow],c=m[0],n=m[1],e=m[2],xr=m[3],f=m[4],u=m[5],s=h.n,p=e(e(l)-h.HALFPI)<1e-10?0:h.c*u(f(h.QUARTERPI+.5*l),-s),i=o*s,d=1e3*p*c(i),y=1e3*(h.rho0-p*n(i)),[d,-1*y]},r}(y),Gr.lcc=I,Z=function(t){function r(){return Xr=r.__super__.constructor.apply(this,arguments)}return ae(r,t),r}(y),fr=function(){function t(t,r,e,n,o,i){var a;a=this,a.bbox=t,a.width=r,a.padding=null!=n?n:0,a.halign=null!=o?o:"center",a.valign=null!=i?i:"center",a.height=e,a.scale=Math.min((r-2*n)/t.width,(e-2*n)/t.height)}return t.prototype.project=function(t,r){var e,n,o,i,a,s,l;return null==r&&(r=t[1],t=t[0]),o=this,i=o.scale,e=o.bbox,n=o.height,a=o.width,s="center"===o.halign?.5*(a-e.width*i):"left"===o.halign?o.padding*i:a-(e.width-o.padding)*i,l="center"===o.valign?.5*(n-e.height*i):"top"===o.valign?o.padding*i:0,t=(t-e.left)*i+s,r=(r-e.top)*i+l,[t,r]},t.prototype.projectPath=function(t){var r,e,n,o,i,a,s,l,u,p,h,c,f,d,y,m,v;if(o=this,"path"===t.type){for(n=[],r=[99999,99999,-99999,-99999],d=t.contours,p=0,c=d.length;c>p;p++){for(a=d[p],e=[],h=0,f=a.length;f>h;h++)y=a[h],l=y[0],u=y[1],m=o.project(l,u),l=m[0],u=m[1],e.push([l,u]),r[0]=Math.min(r[0],l),r[1]=Math.min(r[1],u),r[2]=Math.max(r[2],l),r[3]=Math.max(r[3],u);n.push(e)}return i=new br.geom.Path(t.type,n,t.closed),i._bbox=r,i}return"circle"===t.type?(v=o.project(t.x,t.y),l=v[0],u=v[1],s=t.r*o.scale,new br.geom.Circle(l,u,s)):void 0},t.prototype.asBBox=function(){var t;return t=this,new br.BBox(0,0,t.width,t.height)},t}(),fr.fromXML=function(t){var r,e,n,o,a;return a=Number(t.getAttribute("w")),n=Number(t.getAttribute("h")),o=Number(t.getAttribute("padding")),e=t.getElementsByTagName("bbox")[0],r=i.fromXML(e),new br.View(r,a,n,o)},br.View=fr,S.prototype.dotgrid=function(t){var r,e,n,o,i,a,s,l,u,p,h,c,f,d,y,m,v,g,_,b,x,w,M,P,C,j,A,B,L,S,k,I,N,G,z,E,T,R,F,V,O,H,X,q,D,U,Q,Y,W;if(v=this,m=null!=(T=t.layer)?T:v.layerIds[v.layerIds.length-1],!v.layers.hasOwnProperty(m))return Sr('dotgrid error: layer "'+m+'" not found'),void 0;if(y=v.layers[m],e=t.data,n=t.value,o=t.key,_={},null!=o&&"array"===zr(e))for(A=0,k=e.length;k>A;A++)w=e[A],d=w[o],_[String(d)]=w;else for(d in e)w=e[d],_[String(d)]=w;if(l=null!=(R=t.style)?R:{fill:"black",stroke:"none"},P=t.size,f=null!=(F=t.gridsize)?F:15,s=null!=(V=y.dotgrid)?V:y.dotgrid={gridsize:f,grid:[]},s.gridsize!==f)for(O=s.grid,B=0,I=O.length;I>B;B++)c=O[B],null!=c.shape&&(c.shape.remove(),c.shape=null);if(f>0){if(0===s.grid.length)for(C=L=0,H=v.viewport.width;f>0?H>=L:L>=H;C=L+=f)for(j=S=0,X=v.viewport.height;f>0?X>=S:S>=X;j=S+=f){c={x:C+.2*(Math.random()-.5)*f,y:j+.2*(Math.random()-.5)*f,pathid:!1},h=!1,q=y.pathsById;for(d in q){for(b=q[d],z=0,N=b.length;N>z;z++)if(g=b[z],g.vpath.isInside(c.x,c.y)){h=!0,x=null!=(D=_[d])?D:null,M=P(x),c.pathid=d,c.shape=y.paper.circle(c.x,c.y,1);break}if(h)break}s.grid.push(c)}for(U=s.grid,E=0,G=U.length;G>E;E++)c=U[E],c.pathid&&(x=null!=(Q=_[c.pathid])?Q:null,M=P(x),p=null!=(Y=t.duration)?Y:0,i=null!=(W=t.delay)?W:0,a="function"===zr(i)?i(x):i,p>0&&Raphael.svg?(r=Raphael.animation({r:.5*M},p),c.shape.animate(r.delay(a))):c.shape.attr({r:.5*M}),u="function"===zr(l)?l(x):l,c.shape.attr(u))}},gr=null!=(qr=br.filter)?qr:br.filter={},gr.__knownFilter={},gr.__patternFills=0,V.prototype.SVG=function(t,r){var e,n;if("string"==typeof t&&(t=window.document.createElementNS("http://www.w3.org/2000/svg",t)),r)for(e in r)n=r[e],t.setAttribute(e,n);return t},S.prototype.addFilter=function(t,r,e){var n,o,i;if(null==e&&(e={}),i=this,n=window.document,null==br.filter[r])throw"unknown filter type "+r;return o=new br.filter[r](e).getFilter(t),i.paper.defs.appendChild(o)},V.prototype.applyFilter=function(t){var r;return r=this,e("."+r.id,r.paper.canvas).attr({filter:"url(#"+t+")"})},V.prototype.applyTexture=function(t,r,e){var n,o,i,a,s,l;for(null==r&&(r=!1),null==e&&(e="#000"),o=this,gr.__patternFills+=1,s=o.paths,l=[],i=0,a=s.length;a>i;i++)n=s[i],!r||r(n.data)?l.push(n.svgPath.attr({fill:"url("+t+")"})):l.push(n.svgPath.attr("fill",e));return l},x=function(){function t(t){this.params=null!=t?t:{}}return t.prototype.getFilter=function(t){var r,e;return e=this,r=e.SVG("filter",{id:t}),e.buildFilter(r),r},t.prototype._getFilter=function(){throw"not implemented"},t.prototype.SVG=function(t,r){var e,n;if("string"==typeof t&&(t=window.document.createElementNS("http://www.w3.org/2000/svg",t)),r)for(e in r)n=r[e],t.setAttribute(e,n);return t},t}(),u=function(t){function r(){return Dr=r.__super__.constructor.apply(this,arguments)}return ae(r,t),r.prototype.buildFilter=function(t){var r,e,n;return n=this,r=n.SVG,e=r("feGaussianBlur",{stdDeviation:n.params.size||4,result:"blur"}),t.appendChild(e)},r}(x),gr.blur=u,_r=function(t){var r,e,n,o;if(t.trim().match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/))return(4===t.length||7===t.length)&&(t=t.substr(1)),3===t.length&&(t=t.split(""),t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),o=parseInt(t,16),n=o>>16,e=255&o>>8,r=255&o,[n,e,r];throw'unknown color format: "'+t+'"'},M=function(t){function r(){return Ur=r.__super__.constructor.apply(this,arguments)}return ae(r,t),r.prototype.buildFilter=function(t){var r,e,n,o,i,a,s,l,u,p,h,c,f;i=this,e=null!=(l=i.params.blur)?l:4,s=null!=(u=i.params.strength)?u:1,a=null!=(p=i.params.color)?p:"#D1BEB0","string"===zr(a)&&(a=_r(a)),n=null!=(h=i.params.inner)?h:!1,o=null!=(c=i.params.knockout)?c:!1,r=null!=(f=i.params.alpha)?f:1,n?i.innerGlow(t,e,s,a,r,o):i.outerGlow(t,e,s,a,r,o)},r.prototype.outerGlow=function(t,r,e,n,o,i){var a,s,l,u,p,h,c;return p=this,a=p.SVG,u=a("feColorMatrix",{"in":"SourceGraphic",type:"matrix",values:"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0   0 0 0 1 0",result:"mask"}),t.appendChild(u),e>0&&(c=a("feMorphology",{"in":"mask",radius:e,operator:"dilate",result:"mask"}),t.appendChild(c)),u=a("feColorMatrix",{"in":"mask",type:"matrix",values:"0 0 0 0 "+n[0]/255+" 0 0 0 0 "+n[1]/255+" 0 0 0 0 "+n[2]/255+"  0 0 0 1 0",result:"r0"}),t.appendChild(u),s=a("feGaussianBlur",{"in":"r0",stdDeviation:r,result:"r1"}),t.appendChild(s),l=a("feComposite",{operator:"out","in":"r1",in2:"mask",result:"comp"}),t.appendChild(l),h=a("feMerge"),i||h.appendChild(a("feMergeNode",{"in":"SourceGraphic"})),h.appendChild(a("feMergeNode",{"in":"r1"})),t.appendChild(h)},r.prototype.innerGlow=function(t,r,e,n,o,i){var a,s,l,u,p,h,c;return p=this,a=p.SVG,xr("innerglow"),u=a("feColorMatrix",{"in":"SourceGraphic",type:"matrix",values:"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0   0 0 0 500 0",result:"mask"}),t.appendChild(u),c=a("feMorphology",{"in":"mask",radius:e,operator:"erode",result:"r1"}),t.appendChild(c),s=a("feGaussianBlur",{"in":"r1",stdDeviation:r,result:"r2"}),t.appendChild(s),u=a("feColorMatrix",{type:"matrix","in":"r2",values:"1 0 0 0 "+n[0]/255+" 0 1 0 0 "+n[1]/255+" 0 0 1 0 "+n[2]/255+" 0 0 0 -1 1",result:"r3"}),t.appendChild(u),l=a("feComposite",{operator:"in","in":"r3",in2:"mask",result:"comp"}),t.appendChild(l),h=a("feMerge"),i||h.appendChild(a("feMergeNode",{"in":"SourceGraphic"})),h.appendChild(a("feMergeNode",{"in":"comp"})),t.appendChild(h)},r}(x),gr.glow=M,S.prototype.addGeoPath=function(t,r,e){var n,o,i;return null==r&&(r=[]),null==e&&(e=""),n=this,i=n.getGeoPathStr(t,r),o=n.paper.path(i),""!==e&&o.node.setAttribute("class",e),o},S.prototype.getGeoPathStr=function(t,r){var e,n,o,i,a,s,l;null==r&&(r=[]),o=this,"string"===zr(r)&&(r=r.split("")),0===r.length&&r.push("M"),i="";for(n in t)a=t[n],e=null!=(l=r[n])?l:"L",s=o.lonlat2xy(a),isNaN(s[0])||isNaN(s[1])||(i+=e+s[0]+","+s[1]);return i},S.prototype.addGeoPolygon=function(t,r){var e,n,o;o=this,e=["M"];for(n in t)e.push("L");return e.push("Z"),o.addGeoPath(t,e,r)},ir=function(){function t(t,r,e){var n,o,i,a;null==t&&(t=[0,1]),null==r&&(r=null),null==e&&(e=null),this.rangedScale=se(this.rangedScale,this),this.scale=se(this.scale,this),o=this,a=[];for(n in t)("function"!==zr(e)||e(t[n])!==!1)&&(i=null!=r?"function"===zr(r)?r(t[n]):t[n][r]:t[n],isNaN(i)||a.push(i));a=a.sort(function(t,r){return t-r}),o.values=a,o._range=[0,1],o.rangedScale.range=function(t){return o._range=t,o.rangedScale}}return t.prototype.scale=function(t){return t},t.prototype.rangedScale=function(t){var r,e;return r=this,t=r.scale(t),e=r._range,t*(e[1]-e[0])+e[0]},t}(),E=function(t){function r(){return this.scale=se(this.scale,this),Qr=r.__super__.constructor.apply(this,arguments)}return ae(r,t),r.prototype.scale=function(t){var r,e;return r=this,e=r.values,(t-e[0])/(e[e.length-1]-e[0])},r}(ir),T=function(t){function r(){return this.scale=se(this.scale,this),Yr=r.__super__.constructor.apply(this,arguments)}return ae(r,t),r.prototype.scale=function(t){var r,e;return r=this,e=r.values,xr=Math.log,(xr(t)-xr(e[0]))/(xr(e[e.length-1])-xr(e[0]))},r}(ir),sr=function(t){function r(){return this.scale=se(this.scale,this),Wr=r.__super__.constructor.apply(this,arguments)}return ae(r,t),r.prototype.scale=function(t){var r,e;return r=this,e=r.values,Math.sqrt((t-e[0])/(e[e.length-1]-e[0]))},r}(ir),K=function(t){function r(){return this.scale=se(this.scale,this),$r=r.__super__.constructor.apply(this,arguments)}return ae(r,t),r.prototype.scale=function(t){var r,e,n,o,i,a;n=this,a=n.values,e=a.length-1;for(r in a){if(i=a[Number(r)],o=a[Number(r)+1],t===i)return r/e;if(e>r&&t>i&&o>t)return r/e+(t-i)/(o-i)}},r}(ir),br.scale={},br.scale.identity=function(){return new ir(domain,prop,gr).rangedScale},br.scale.linear=function(t,r,e){return new E(t,r,e).rangedScale},br.scale.log=function(t,r,e){return new T(t,r,e).rangedScale},br.scale.sqrt=function(t,r,e){return new sr(t,r,e).rangedScale},br.scale.quantile=function(t,r,e){return new K(t,r,e).rangedScale},hr=function(){function t(t){r=this,r.location=t.location,r.data=t.data,r.map=t.map,r.layers=t.layers,r.key=t.key,r.x=t.x,r.y=t.y}var r;return r=null,t.prototype.init=function(){return r},t.prototype.overlaps=function(){return!1},t.prototype.update=function(){return r},t.prototype.nodes=function(){return[]},t.prototype.clear=function(){return r},t}(),br.Symbol=hr,cr=function(){function r(t){this._initTooltips=se(this._initTooltips,this),this._noverlap=se(this._noverlap,this),this._kMeans=se(this._kMeans,this);var e,o,i,a,s,l,u,p,h,c,f,d,y,m,v,g,_,b,x,w;for(n=this,c=["data","location","type","map"],p=["filter","tooltip","click","delay","sortBy","clustering","aggregate","clusteringOpts","mouseenter","mouseleave"],f=0,v=c.length;v>f;f++){if(h=c[f],null==t[h])throw"SymbolGroup: missing argument '"+h+"'";n[h]=t[h]}for(d=0,g=p.length;g>d;d++)h=p[d],null!=t[h]&&(n[h]=t[h]);if(e=n.type,null==e)return Sr("could not resolve symbol type",n.type),void 0;for(x=e.props,y=0,_=x.length;_>y;y++)h=x[y],null!=t[h]&&(n[h]=t[h]);for(n.layers={mapcanvas:n.map.paper},w=e.layers,m=0,b=w.length;b>m;m++)s=w[m],u=r._layerid++,a="sl_"+u,"svg"===s.type?l=n.map.createSVGLayer(a):"html"===s.type&&(l=n.map.createHTMLLayer(a)),n.layers[s.id]=l;n.symbols=[];for(i in n.data)o=n.data[i],"function"===zr(n.filter)?n.filter(o,i)&&n.add(o,i):n.add(o,i);n.layout(),n.render(),n.map.addSymbolGroup(n)}var n;return n=null,r.prototype.add=function(t,r){var e,o,i,a,s,l,u,p;for(n=this,e=n.type,o=n._evaluate(n.location,t,r),"array"===zr(o)&&(o=new br.LonLat(o[0],o[1])),a={layers:n.layers,location:o,data:t,key:null!=r?r:n.symbols.length,map:n.map},p=e.props,l=0,u=p.length;u>l;l++)i=p[l],null!=n[i]&&(a[i]=n._evaluate(n[i],t,r));return s=new e(a),n.symbols.push(s),s},r.prototype.layout=function(){var t,r,e,o,i,a,s,l,u,p;for(u=n.symbols,s=0,l=u.length;l>s;s++){if(i=u[s],r=i.location,"string"===zr(r)){if(p=r.split("."),t=p[0],o=p[1],e=n.map.getLayerPath(t,o),null==e){Sr("could not find layer path "+t+"."+o);continue}a=n.map.viewBC.project(e.path.centroid())}else a=n.map.lonlat2xy(r);i.x=a[0],i.y=a[1]}return"k-means"===n.clustering?n._kMeans():"noverlap"===n.clustering&&n._noverlap(),n},r.prototype.render=function(){var t,r,o,i,a,s,l,u,p,h,c;for(n=this,n.sortBy&&(i="asc","string"===zr(n.sortBy)&&(n.sortBy=n.sortBy.split(" ",2),o=n.sortBy[0],i=null!=(p=n.sortBy[1])?p:"asc"),n.symbols=n.symbols.sort(function(t,r){var e,a,s;return"function"===zr(n.sortBy)?(a=n.sortBy(t.data,t),s=n.sortBy(r.data,r)):(a=t[o],s=r[o]),a===s?0:(e="asc"===i?1:-1,a>s?1*e:-1*e)})),h=n.symbols,a=0,l=h.length;l>a;a++)for(r=h[a],r.render(),c=r.nodes(),s=0,u=c.length;u>s;s++)t=c[s],t.symbol=r;return"function"===zr(n.tooltip)&&n._initTooltips(),e.each(["click","mouseenter","mouseleave"],function(o,i){var a,s,l,u;if("function"===zr(n[i])){for(l=n.symbols,u=[],a=0,s=l.length;s>a;a++)r=l[a],u.push(function(){var o,a,s,l;for(s=r.nodes(),l=[],o=0,a=s.length;a>o;o++)t=s[o],l.push(e(t)[i](function(t){var r;for(r=t.target;!r.symbol;)r=e(r).parent().get(0);return t.stopPropagation(),n[i](r.symbol.data,r.symbol,t)}));return l}.call(this));return u}}),n},r.prototype.tooltips=function(t){return n=this,n.tooltips=t,n._initTooltips(),n},r.prototype.remove=function(t){var r,e,o,i,a,s,l,u,p,h;for(n=this,o=[],u=n.symbols,s=0,l=u.length;l>s;s++)if(a=u[s],null==t||t(a.data))try{a.clear()}catch(c){r=c,Sr("error: symbolgroup.remove")}else o.push(a);if(null==t){p=n.layers,h=[];for(e in p)i=p[e],"mapcanvas"!==e?h.push(i.remove()):h.push(void 0);return h}return n.symbols=o},r.prototype._evaluate=function(t,r,e){var n;return n="function"===zr(t)?t(r,e):t},r.prototype._kMeans=function(){var r,e,o,i,a,s,l,u,p,h,c,f,d,y,m,v,g,_,b,x,w,M,P;for(n=this,null==(x=n.osymbols)&&(n.osymbols=n.symbols),r=n.type,null!=n.clusteringOpts&&(h=n.clusteringOpts.size),null==h&&(h=64),e=t().iterations(16).size(h),w=n.osymbols,f=0,v=w.length;v>f;f++)p=w[f],e.add({x:p.x,y:p.y});for(s=e.means(),l=[],d=0,g=s.length;g>d;d++)if(a=s[d],0!==a.size){for(o=[],M=a.indices,y=0,_=M.length;_>y;y++)i=M[y],o.push(n.osymbols[i].data);for(o=n.aggregate(o),c={layers:n.layers,location:!1,data:o,map:n.map},P=r.props,m=0,b=P.length;b>m;m++)u=P[m],null!=n[u]&&(c[u]=n._evaluate(n[u],o));p=new r(c),p.x=a.x,p.y=a.y,l.push(p)}return n.symbols=l},r.prototype._noverlap=function(){var t,r,e,o,i,a,s,l,u,p,h,c,f,d,y,m,v,g,_,b,x,w,M,P,C,j,A,B,L,S,k,I,N,G,z,E,T,R,F,V,O,H,X,q,D,U,Q;if(n=this,null==(H=n.osymbols)&&(n.osymbols=n.symbols),u=3,t=n.type,le.call(t.props,"radius")<0)return Sr('noverlap layout only available for symbols with property "radius"'),void 0;for(j=n.osymbols.slice(),null!=n.clusteringOpts&&(L=n.clusteringOpts.tolerance,f=n.clusteringOpts.maxRatio),null==L&&(L=.05),null==f&&(f=.8),s=N=0,X=u-1;X>=0?X>=N:N>=X;s=X>=0?++N:--N){for(j.sort(function(t,r){return r.radius-t.radius}),p=j.length,d=[],y=G=0,q=p-3;q>=0?q>=G:G>=q;y=q>=0?++G:--G)if(M=j[y]){for(b=M.radius*(1-L),h=M.x-b,g=M.x+b,A=M.y-b,r=M.y+b,l=[],m=z=D=y+1,U=p-2;U>=D?U>=z:z>=U;m=U>=D?++z:--z)P=j[m],P&&(x=P.radius,c=P.x-x,_=P.x+x,B=P.y-x,e=P.y+x,x/M.radius<f&&(c>g||h>_||B>r||A>e||(i=P.x-M.x,a=P.y-M.y,(b+x)*(b+x)>i*i+a*a&&l.push(m))));if(l.length>0){for(o=[M.data],v=M.radius*M.radius,E=0,T=l.length;T>E;E++)s=l[E],o.push(j[s].data),v+=j[s].radius*j[s].radius;for(o=n.aggregate(o),C={layers:n.layers,location:!1,data:o,map:n.map},Q=t.props,V=0,R=Q.length;R>V;V++)y=Q[V],null!=n[y]&&(C[y]=n._evaluate(n[y],o));for(w=new t(C),S=M.radius*M.radius/v,k=M.x*S,I=M.y*S,O=0,F=l.length;F>O;O++)s=l[O],P=j[s],S=P.radius*P.radius/v,k+=P.x*S,I+=P.y*S,j[s]=void 0;w.x=k,w.y=I,j[y]=void 0,d.push(w)}else d.push(M)}j=d}return n.symbols=j},r.prototype._initTooltips=function(){var t,r,o,i,a,s,l,u,p,h,c;for(n=this,i=n.tooltip,h=n.symbols,s=0,u=h.length;u>s;s++)for(o=h[s],t={position:{target:"mouse",viewport:e(window),adjust:{x:7,y:7}},show:{delay:20},content:{},events:{show:function(t,r){return e(".qtip").filter(function(){return this!==r.elements.tooltip.get(0)}).hide()}}},a=i(o.data,o.key),"string"===zr(a)?t.content.text=a:"array"===zr(a)&&(t.content.title=a[0],t.content.text=a[1]),c=o.nodes(),l=0,p=c.length;p>l;l++)r=c[l],e(r).qtip(t)},r.prototype.onResize=function(){var t,r,e,o;for(n=this,n.layout(),o=n.symbols,r=0,e=o.length;e>r;r++)t=o[r],t.update()},r.prototype.update=function(t,r,e){var o,i,a,s,l,u,p,h;for(n=this,null==t&&(t={}),p=n.symbols,a=0,l=p.length;l>a;a++){for(i=p[a],h=n.type.props,s=0,u=h.length;u>s;s++)o=h[s],null!=t[o]?i[o]=n._evaluate(t[o],i.data):null!=n[o]&&(i[o]=n._evaluate(n[o],i.data));i.update(r,e)}return n},r}(),cr._layerid=0,br.SymbolGroup=cr,S.prototype.addSymbols=function(t){return t.map=this,new cr(t)},br.dorlingLayout=function(t,r){var n,o,i,a,s,l,u,p,h,c,f,d,y,m,v;for(null==r&&(r=40),f=[],e.each(t.symbols,function(t,r){return f.push({i:t,x:r.path.attrs.cx,y:r.path.attrs.cy,r:r.path.attrs.r})}),f.sort(function(t,r){return r.r-t.r}),i=function(){var r,e,n;for(e=0,n=f.length;n>e;e++)r=f[e],t.symbols[r.i].path.attr({cx:r.x,cy:r.y})},d=v=1;r>=1?r>=v:v>=r;d=r>=1?++v:--v)for(h in f)for(c in f)if(c>h){if(n=f[h],o=f[c],n.x+n.r<o.x-o.r||n.x-n.r>o.x+o.r)continue;if(n.y+n.r<o.y-o.r||n.y-n.r>o.y+o.r)continue;l=n.x-o.x,u=n.y-o.y,s=l*l+u*u,y=n.r+o.r,m=y*y,m>s&&(a=Math.sqrt(s),p=10/a,n.x+=l*p*(1-n.r/y),n.y+=u*p*(1-n.r/y),o.x-=l*p*(1-o.r/y),o.y-=u*p*(1-o.r/y))}return i()},p=function(t){function r(t){this.nodes=se(this.nodes,this),this.clear=se(this.clear,this),this.update=se(this.update,this),this.render=se(this.render,this),this.overlaps=se(this.overlaps,this);var e,n,o;e=this,r.__super__.constructor.call(this,t),e.radius=null!=(n=t.radius)?n:4,e.style=t.style,e.attrs=t.attrs,e.title=t.title,e["class"]=null!=(o=t["class"])?o:"bubble"}return ae(r,t),r.prototype.overlaps=function(t){var r,e,n,o,i,a,s,l,u,p,h;return n=this,p=[n.x,n.y,n.radius],a=p[0],l=p[1],o=p[2],h=[t.x,t.y,t.radius],s=h[0],u=h[1],i=h[2],a-o>s+i||s-i>a+o||l-o>u+i||u-i>l+o?!1:(r=a-s,e=l-u,r*r+e*e>(o+i)*(o+i)?!1:!0)},r.prototype.render=function(){var t;return t=this,null==t.path&&(t.path=t.layers.mapcanvas.circle(t.x,t.y,t.radius)),t.update(),t.map.applyCSS(t.path),t},r.prototype.update=function(t,r){var n,o,i;return null==t&&(t=!1),null==r&&(r="expo-out"),o=this,i=o.path,n={cx:o.x,cy:o.y,r:o.radius},null!=o.attrs&&(n=e.extend(n,o.attrs)),t?i.animate(n,t,r):i.attr(n),null!=i.node&&(null!=o.style&&i.node.setAttribute("style",o.style),null!=o["class"]&&i.node.setAttribute("class",o["class"])),null!=o.title&&i.attr("title",o.title),o},r.prototype.clear=function(){var t;return t=this,t.path.remove(),t},r.prototype.nodes=function(){var t;return t=this,[t.path.node]},r}(hr),p.props=["radius","style","class","title","attrs"],p.layers=[],br.Bubble=p,B=function(t){function r(t){var e,n,o,i,a,s;e=this,r.__super__.constructor.call(this,t),e.icon=null!=(n=t.icon)?n:"",e.offset=null!=(o=t.offset)?o:[0,0],e.iconsize=null!=(i=t.iconsize)?i:[10,10],e["class"]=null!=(a=t["class"])?a:"",e.title=null!=(s=t.title)?s:""}return ae(r,t),r.prototype.render=function(){var t,r;return r=this,t=r.map.container,r.img=e("<img />"),r.img.attr({src:r.icon,title:r.title,alt:r.title,width:r.iconsize[0],height:r.iconsize[1]}),r.img.addClass(r["class"]),r.img.css({position:"absolute","z-index":1e3,cursor:"pointer"}),r.img[0].symbol=r,t.append(r.img),r.update()},r.prototype.update=function(){var t;return t=this,t.img.css({left:t.x+t.offset[0]+"px",top:t.y+t.offset[1]+"px"})},r.prototype.clear=function(){var t;return t=this,t.img.remove(),t},r.prototype.nodes=function(){var t;return t=this,[t.img]},r}(br.Symbol),B.props=["icon","offset","class","title","iconsize"],B.layers=[],br.Icon=B,pr=function(t){function r(t){var e,n,o,i,a;e=this,r.__super__.constructor.call(this,t),e.text=null!=(n=t.text)?n:"",e.style=null!=(o=t.style)?o:"",e["class"]=null!=(i=t["class"])?i:"",e.offset=null!=(a=t.offset)?a:[0,0]}return ae(r,t),r.prototype.render=function(){var t,r;return r=this,r.lbl=t=r.layers.mapcanvas.text(r.x,r.y,r.text),r.update(),r},r.prototype.update=function(){var t;return t=this,t.lbl.attr({x:t.x+t.offset[0],y:t.y+t.offset[1]}),t.lbl.node.setAttribute("style",t.style),t.lbl.node.setAttribute("class",t["class"])},r.prototype.clear=function(){var t;return t=this,t.lbl.remove(),t},r.prototype.nodes=function(){var t;return t=this,[t.lbl.node]},r}(br.Symbol),pr.props=["text","style","class","offset"],pr.layers=[],br.Label=pr,A=function(t){function r(t){var e,n,o,i;e=this,r.__super__.constructor.call(this,t),e.text=null!=(n=t.text)?n:"",e.css=null!=(o=t.css)?o:"",e["class"]=null!=(i=t["class"])?i:""}return ae(r,t),r.prototype.render=function(){var t,r,n;return n=this,t=e("<div>"+n.text+"</div>"),t.css({width:"80px",position:"absolute",left:"-40px","text-align":"center"}),n.lbl=r=e('<div class="label" />'),r.append(t),n.layers.lbl.append(r),t.css({height:t.height()+"px",top:t.height()*-.4+"px"}),n.update(),n},r.prototype.update=function(){var t;return t=this,t.lbl.css({position:"absolute",left:t.x+"px",top:t.y+"px"}),t.lbl.css(t.css)},r.prototype.clear=function(){var t;return t=this,t.lbl.remove(),t},r.prototype.nodes=function(){var t;return t=this,[t.lbl[0]]},r}(br.Symbol),A.props=["text","css","class"],A.layers=[{id:"lbl",type:"html"}],br.HtmlLabel=A,N=function(t){function r(t){this.nodes=se(this.nodes,this),this.clear=se(this.clear,this),this.update=se(this.update,this),this.render=se(this.render,this);var e,n,o;e=this,r.__super__.constructor.call(this,t),e.labelattrs=null!=(n=t.labelattrs)?n:{},e.buffer=t.buffer,e.center=null!=(o=t.center)?o:!0}return ae(r,t),r.prototype.render=function(t){var e;return e=this,null!=e.title&&""!==String(e.title).trim()&&(e.buffer&&(e.bufferlabel=e.layers.mapcanvas.text(e.x,e.y,e.title)),e.label=e.layers.mapcanvas.text(e.x,e.y,e.title)),r.__super__.render.call(this,t),e},r.prototype.update=function(t,n){var o,i,a,s,l;return null==t&&(t=!1),null==n&&(n="expo-out"),i=this,r.__super__.update.call(this,t,n),null!=i.label&&(a=i.map.viewport,o=e.extend({},i.labelattrs),s=i.x,l=i.y,i.center?l-=0:s>.5*a.width?(o["text-anchor"]="end",s-=i.radius+5):s<.5*a.width&&(o["text-anchor"]="start",s+=i.radius+5),o.x=s,o.y=l,i.buffer&&(i.bufferlabel.attr(o),i.bufferlabel.attr({stroke:"#fff",fill:"#fff","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":6})),i.label.attr(o),i.label.toFront()),i},r.prototype.clear=function(){var t;return t=this,r.__super__.clear.apply(this,arguments)},r.prototype.nodes=function(){var t,e;return t=this,e=r.__super__.nodes.apply(this,arguments),t.label&&e.push(t.label.node),t.bufferlabel&&e.push(t.bufferlabel.node),e},r}(p),N.props=["radius","style","class","title","labelattrs","buffer","center","attrs"],N.layers=[],br.LabeledBubble=N,Y=function(t){function r(t){var n,o,i,a,s,l,u,p,h,c;e=this,r.__super__.constructor.call(this,t),e.radius=null!=(o=t.radius)?o:4,e.styles=null!=(i=t.styles)?i:"",e.colors=null!=(a=t.colors)?a:["#3cc","#c3c","#33c","#cc3"],e.titles=null!=(s=t.titles)?s:["","","","",""],e.values=null!=(l=t.values)?l:[],e.border=null!=(u=t.border)?u:!1,e.borderWidth=null!=(p=t.borderWidth)?p:2,e["class"]=null!=(h=t["class"])?h:"piechart",null==(c=(n=Raphael.fn).pieChart)&&(n.pieChart=vr)}var e;return ae(r,t),e=null,r.prototype.overlaps=function(t){var r,n,o,i,a,s,l,u,p,h;return p=[e.x,e.y,e.radius],a=p[0],l=p[1],o=p[2],h=[t.x,t.y,t.radius],s=h[0],u=h[1],i=h[2],a-o>s+i||s-i>a+o||l-o>u+i||u-i>l+o?!1:(r=a-s,n=l-u,r*r+n*n>(o+i)*(o+i)?!1:!0)},r.prototype.render=function(){var t;return e=this,null!=e.border&&(t=e.layers.mapcanvas.circle(e.x,e.y,e.radius+e.borderWidth).attr({stroke:"none",fill:e.border})),e.chart=e.layers.mapcanvas.pieChart(e.x,e.y,e.radius,e.values,e.titles,e.colors,"none"),e.chart.push(t),e},r.prototype.update=function(){},r.prototype.clear=function(){var t,r,n,o;for(e=this,o=e.chart,r=0,n=o.length;n>r;r++)t=o[r],t.remove();return e},r.prototype.nodes=function(){var t,r,n,o,i;for(o=e.chart,i=[],r=0,n=o.length;n>r;r++)t=o[r],i.push(t.node);return i},r}(hr),Y.props=["radius","values","styles","class","titles","colors","border","borderWidth"],Y.layers=[],br.PieChart=Y,vr=function(t,r,e,n,o,i,a){var s,l,u,p,h,c,f,d,y,m,v;if(isNaN(t)||isNaN(r)||isNaN(e))return[];for(p=this,c=Math.PI/180,l=p.set(),f=function(t,r,e,n,o,i){var a,s,l,u;return a=t+e*Math.cos(-n*c),s=t+e*Math.cos(-o*c),l=r+e*Math.sin(-n*c),u=r+e*Math.sin(-o*c),p.path(["M",t,r,"L",a,l,"A",e,e,0,+(o-n>180),0,s,u,"z"]).attr(i)},s=-270,d=0,h=function(o){var u,p,h,c,y,m,v;v=n[o],u=360*v/d,m=s+.5*u,p=i[o],c=500,h=30,y=f(t,r,e,s,s+u,{fill:p,stroke:a,"stroke-width":1}),y.mouseover(function(){y.stop().animate({transform:"s1.1 1.1 "+t+" "+r},c,"elastic")
}),y.mouseout(function(){y.stop().animate({transform:""},c,"elastic")}),s+=u,l.push(y)},m=0,v=n.length;v>m;m++)y=n[m],d+=y;for(u in n)h(u);return l},drawStackedBars=function(t,r,e,n,o,i,a,s){function l(t,r,e,n,o){return u.rect(t,r,e,n).attr(o)}for(var u=this,p=this.set(),h=0,c=0,f=function(i){var u=o[i],f=n*u/c,d=t-.5*e,y=r+.5*n-h,m=e,v=a[i],g=500,_=l(d,y-f,m,f,{fill:v,stroke:s,"stroke-width":1});h+=f,_.mouseover(function(){_.stop().animate({transform:"s1.1 1.1 "+t+" "+r},g,"elastic")}).mouseout(function(){_.stop().animate({transform:""},g,"elastic")}),p.push(_)},d=0,y=o.length;y>d;d++)c+=o[d];for(d=0;y>d;d++)f(d);return p},lr=function(t){function r(t){var e,n,o,i,a,s,l,u,p,h;e=this,r.__super__.constructor.call(this,t),e.styles=null!=(o=t.styles)?o:"",e.colors=null!=(i=t.colors)?i:[],e.titles=null!=(a=t.titles)?a:["","","","",""],e.values=null!=(s=t.values)?s:[],e.width=null!=(l=t.width)?l:17,e.height=null!=(u=t.height)?u:30,e["class"]=null!=(p=t["class"])?p:"barchart",null==(h=(n=Raphael.fn).drawStackedBarChart)&&(n.drawStackedBarChart=drawStackedBars)}return ae(r,t),r.prototype.overlaps=function(t){var r,e,n,o,i,a,s,l,u,p,h;return n=this,p=[n.x,n.y,n.radius],a=p[0],l=p[1],o=p[2],h=[t.x,t.y,t.radius],s=h[0],u=h[1],i=h[2],a-o>s+i||s-i>a+o||l-o>u+i||u-i>l+o?!1:(r=a-s,e=l-u,r*r+e*e>(o+i)*(o+i)?!1:!0)},r.prototype.render=function(){var t,r,e,n,o,i;return e=this,n=e.width,r=e.height,o=e.x,i=e.y,t=e.layers.mapcanvas.rect(o-.5*n-2,i-.5*r-2,n+4,r+4).attr({stroke:"none",fill:"#fff"}),e.chart=e.layers.mapcanvas.drawStackedBarChart(e.x,e.y,e.width,e.height,e.values,e.titles,e.colors,"none"),e.chart.push(t),e},r.prototype.update=function(){var t;t=this},r.prototype.clear=function(){var t,r,e,n,o;for(t=this,o=t.chart,e=0,n=o.length;n>e;e++)r=o[e],r.remove();return t.chart=[],t},r.prototype.nodes=function(){var t,r,e,n,o,i;for(r=this,o=r.chart,i=[],e=0,n=o.length;n>e;e++)t=o[e],i.push(t.node);return i},r}(br.Symbol),lr.props=["values","styles","class","titles","colors","width","height"],lr.layers=[],br.StackedBarChart=lr}.call(this);
/*!
 * Piwik - free/libre analytics platform
 *
 * Visitors Map with zoom in continents / countries. Cities + Region view.
 * Using Kartograph.js http://kartograph.org/
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){window.UserCountryMap=window.UserCountryMap||{};var VisitorMap=window.UserCountryMap.VisitorMap=function(config,theWidget){this.config=config;this.theWidget=theWidget||false;this.run();};$.extend(VisitorMap.prototype,{run:function(){var self=this,config=self.config,colorManager=piwik.ColorManager,colorNames=['no-data-color','one-country-color','color-range-start-choropleth','color-range-start-normal','color-range-end-choropleth','color-range-end-normal','country-highlight-color','unknown-region-fill-color','unknown-region-stroke-color','region-stroke-color','invisible-region-background','city-label-color','city-stroke-color','city-highlight-stroke-color','city-highlight-fill-color','city-highlight-label-color','city-label-fill-color','city-selected-color','city-selected-label-color','region-layer-stroke-color','country-selected-color','region-selected-color','region-highlight-color'],colors=colorManager.getColors('visitor-map',colorNames),noDataColor=colors['no-data-color'],oneCountryColor=colors['one-country-color'],colorRangeStartChoropleth=colors['color-range-start-choropleth'],colorRangeStartNormal=colors['color-range-start-normal'],colorRangeEndChoropleth=colors['color-range-end-choropleth'],colorRangeEndNormal=colors['color-range-end-normal'],specialMetricsColorScale=colorManager.getColors('visitor-map',['special-metrics-color-scale-1','special-metrics-color-scale-2','special-metrics-color-scale-3','special-metrics-color-scale-4'],true),countryHighlightColor=colors['country-highlight-color'],countrySelectedColor=colors['country-selected-color'],unknownRegionFillColor=colors['unknown-region-fill-color'],unknownRegionStrokeColor=colors['unknown-region-stroke-color'],regionStrokeColor=colors['region-stroke-color'],regionSelectedColor=colors['region-selected-color'],regionHighlightColor=colors['region-highlight-color'],invisibleRegionBackgroundColor=colors['invisible-region-background'],cityLabelColor=colors['city-label-color'],cityLabelFillColor=colors['city-label-fill-color'],cityStrokeColor=colors['city-stroke-color'],cityHighlightStrokeColor=colors['city-highlight-stroke-color'],cityHighlightFillColor=colors['city-highlight-fill-color'],cityHighlightLabelColor=colors['city-highlight-label-color'],citySelectedColor=colors['city-selected-color'],citySelectedLabelColor=colors['city-selected-label-color'],regionLayerStrokeColor=colors['region-layer-stroke-color'],hasUserZoomed=false;;function $$(selector){return $(selector,self.theWidget?self.theWidget.element:undefined);}
var mapContainer=$$('.UserCountryMap_map').get(0),map=self.map=$K.map(mapContainer),main=$$('.UserCountryMap_container'),width=main.width(),_=config._;config.noDataColor=noDataColor;self.widget=$$('.widgetUserCountryMapvisitorMap').parent();function _reportParams(module,action,countryFilter){var params=$.extend(config.reqParams,{module:'API',method:'API.getProcessedReport',apiModule:module,apiAction:action,filter_limit:-1,limit:-1,format_metrics:0,showRawMetrics:1});if(countryFilter){$.extend(params,{filter_column:'country',filter_sort_column:'nb_visits',filter_pattern:countryFilter});}
return params;}
function ajax(params,dataType){dataType=dataType||'json';params=$.extend({},params);var token_auth=''+params.token_auth;delete params['token_auth'];return $.ajax({url:'index.php?'+$.param(params),dataType:dataType,data:{token_auth:token_auth},type:'POST'});}
function minmax(values){values=values.sort(function(a,b){return Number(a)-Number(b);});return{min:values[0],max:values[values.length-1],median:values[Math.floor(values.length*0.5)],p33:values[Math.floor(values.length*0.33)],p66:values[Math.floor(values.length*0.66)],p90:values[Math.floor(values.length*0.9)]};}
function formatNumber(v,metric,first){v=Number(v);if(v>1000000){return(v / 1000000).toFixed(1)+'m';}
if(v>1000){return(v / 1000).toFixed(1)+'k';}
if(!metric){return v;}
if(metric=='avg_time_on_site'){v+=first?' sec':'s';}else if(metric=='bounce_rate'){v+='%';}else if(metric==='nb_actions_per_visit'){if(parseInt(v,10)===v){return v;}
return v.toFixed(1);}
return v;}
function formatValueForTooltips(data,metric,id){var val=data[metric]%1===0||Number(data[metric])!=data[metric]?data[metric]:data[metric].toFixed(1);if(metric=='bounce_rate'){val=NumberFormatter.formatPercent(val);}else if(metric=='avg_time_on_site'){val=new Date(0,0,0,val / 3600,val%3600 / 60,val%60).toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1");}else{val=NumberFormatter.formatNumber(val);}
var v=_[metric].replace('%s','<strong>'+val+'</strong>');if(val==1&&metric=='nb_visits')v=_.one_visit;if(metric.substr(0,3)=='nb_'&&metric!='nb_actions_per_visit'){var total;if(id.length==3)total=UserCountryMap.countriesByIso[id][metric];else if(id=='world')total=self.config.visitsSummary[metric];else{total=0;$.each(UserCountryMap.countriesByIso,function(iso,country){if(UserCountryMap.ISO3toCONT[iso]==id){total+=country[metric];}});}
if(total){v+=' ('+formatPercentage(data[metric]/ total)+')';}}else if(metric=='avg_time_on_site'){v+='<br/> ('+_.nb_visits.replace('%s',data.nb_visits)+')';}
return v;}
function getColorScale(rows,metric,filter,choropleth){var colscale;function addLegendItem(val,first){var d=$('<div>'),r=$('<div>'),l=$('<div>'),metric=$$('.userCountryMapSelectMetrics').val(),v=formatNumber(Math.round(val),metric,first);d.css({width:17,height:17,float:'left',background:colscale(val)});l.css({'margin-left':20,'line-height':'20px','text-align':'right'}).html(v);r.css({clear:'both',height:19});r.append(d).append(l);$('.UserCountryMap-legend .content').append(r);}
var stats,values=[],id=self.lastSelected,c,showLegend;$.each(rows,function(i,r){if(!$.isFunction(filter)||filter(r)){var v=quantify(r,metric);if(!isNaN(v))values.push(v);}});stats=minmax(values);showLegend=values.length>0;if(stats.min==stats.max){colscale=function(){return chroma.hex(oneCountryColor);};if(choropleth){$('.UserCountryMap-legend .content').html('').show();if(showLegend){addLegendItem(stats.min,true);}}
return colscale;}
colscale=chroma.scale().range([choropleth?colorRangeStartChoropleth:colorRangeStartNormal,choropleth?colorRangeEndChoropleth:colorRangeEndNormal]).domain(values,4,'c').mode('lch');if(metric=='avg_time_on_site'||metric=='nb_actions_per_visit'||metric=='bounce_rate'){if(id.length==3){c=(stats.p90-stats.min)/(stats.max-stats.min);colscale=chroma.scale(specialMetricsColorScale,[0,c,c+0.001,1]).domain(chroma.limits(rows,'c',5,'curMetric',filter),4,'c').mode('hsl');}}
if(choropleth&&showLegend){$('.UserCountryMap-legend .content').html('').show();var itemExists={};$.each(chroma.limits(values,'k',3),function(i,v){if(itemExists[v])return;addLegendItem(v,i===0);itemExists[v]=true;});}else{$('.UserCountryMap-legend .content').hide();}
return colscale;}
function formatPercentage(val){if(val<0.001){return'< '+NumberFormatter.formatPercent(0.1);}
return NumberFormatter.formatPercent(Math.round(1000*val)/ 10);}
function onResizeLazy(){clearTimeout(self._resizeTimer);self._resizeTimer=setTimeout(self.resize.bind(self),300);}
self._onResizeLazy=onResizeLazy;function activateButton(btn){$$('.UserCountryMap-view-mode-buttons a').removeClass('activeIcon');btn.addClass('activeIcon');$$('.UserCountryMap-activeItem').offset({left:btn.offset().left});}
function initUserInterface(){$$('.userCountryMapSelectCountry').off('change').change(function(){hasUserZoomed=true;updateState($$('.userCountryMapSelectCountry').val());});function zoomOut(){hasUserZoomed=true;var t=self.lastSelected,tgt='world';if(t.length==3&&UserCountryMap.ISO3toCONT[t]!==undefined){tgt=UserCountryMap.ISO3toCONT[t];}
updateState(tgt);}
$$('.UserCountryMap-btn-zoom').off('click').click(zoomOut);$$('.UserCountryMap_map').off('click').click(zoomOut);$(window).resize(onResizeLazy);$$('.userCountryMapSelectMetrics').off('change').change(function(){updateState(self.lastSelected);});(function(btn){btn.off('click').click(function(){if(self.lastSelected.length==3){if(self.mode!="city"){self.mode="city";hasUserZoomed=true;updateState(self.lastSelected);}}});})($$('.UserCountryMap-btn-city'));(function(btn){btn.off('click').click(function(){if(self.mode!="region"){$$('.UserCountryMap-view-mode-buttons a').removeClass('activeIcon');self.mode="region";hasUserZoomed=true;updateState(self.lastSelected);}});})($$('.UserCountryMap-btn-region'));var bl=$('<div id="UserCountryMap-black"></div>');bl.hide();$$('.UserCountryMap_map').append(bl);var infobtn=$('.UserCountryMap-info-btn');infobtn.off('mouseenter').on('mouseenter',function(e){$(infobtn.data('tooltip-target')).show();}).off('mouseleave').on('mouseleave',function(e){$(infobtn.data('tooltip-target')).hide();});$('.UserCountryMap-tooltip').hide();}
function updateState(id){if(self.mode=="city"&&id.length!=3){self.mode="region";}
var metric=$$('.userCountryMapSelectMetrics').val();self.widget.dashboardWidget('setParameters',{lastMap:id,viewMode:self.mode,lastMetric:metric});$('.UserCountryMap-info-btn').hide();try{if(id.length==3){renderCountryMap(id,metric);}else{renderWorldMap(id,metric);}}catch(e){$('.UserCountryMap-info .content').html(e);$('.UserCountryMap-info').show();}
_updateUI(id,metric);self.lastSelected=id;}
function _updateUI(id,metric){if(self.mode=="city"){activateButton($$('.UserCountryMap-btn-city'));}else{activateButton($$('.UserCountryMap-btn-region'));}
var countrySelect=$$('.userCountryMapSelectCountry');countrySelect.val(id);var zoom=$$('.UserCountryMap-btn-zoom');if(id=='world')zoom.addClass('inactiveIcon');else zoom.removeClass('inactiveIcon');var flag=$$('.userCountryMapFlag'),regionBtn=$$('.UserCountryMap-btn-region');if(id.length==3){if(UserCountryMap.countriesByIso[id]){flag.css({'background-image':'url('+UserCountryMap.countriesByIso[id].flag+')','background-repeat':'no-repeat','background-position':'5px 5px'});$$('.UserCountryMap-btn-city').removeClass('inactiveIcon').show();$('span',regionBtn).html(regionBtn.data('region'));}else{$$('.UserCountryMap-btn-city').addClass('inactiveIcon');$('.map-stats').html(_.no_data);$('.map-title').html('');return;}}else{flag.css({'background':'none'});$$('.UserCountryMap-btn-city').addClass('inactiveIcon').hide();$('span',regionBtn).html(regionBtn.data('country'));}
var mapTitle=id.length==3?UserCountryMap.countriesByIso[id].name:$$('.userCountryMapSelectCountry option[value='+id+']').html(),totalVisits=0,totalMetricValue=0;$('.map-title').html(mapTitle);$$('.widgetUserCountryMapvisitorMap .widgetName .map-title').html(' – '+mapTitle);if(id.length==3){totalVisits=UserCountryMap.countriesByIso[id]['nb_visits'];totalMetricValue=UserCountryMap.countriesByIso[id][metric];}else if(id.length==2){$.each(UserCountryMap.countriesByIso,function(iso,country){if(UserCountryMap.ISO3toCONT[iso]==id){totalVisits+=country['nb_visits'];totalMetricValue+=country[metric];}});}else{totalVisits=self.config.visitsSummary['nb_visits'];totalMetricValue=self.config.visitsSummary[metric];}
var data={};data[metric]=totalMetricValue;$('.map-stats').html('<strong>'+formatValueForTooltips(data,metric,false)+'</strong>'+
(id!='world'?(' ('+formatPercentage(totalMetricValue / self.config.visitsSummary[metric])+')'):''));}
function renderWorldMap(target,metric){function updateColorsAndTooltips(metric){colscale=getColorScale(UserCountryMap.countryData,metric,function(r){if(target.length==2){return UserCountryMap.ISO3toCONT[r.iso]==target;}else{return true;}},true);function countryFill(data){var d=UserCountryMap.countriesByIso[data.iso];if(d===null){return self.config.noDataColor;}else{return colscale(d[metric]);}}
var countryLayer=map.getLayer('countries');if(countryLayer){countryLayer.style('fill',countryFill).on('mouseenter',function(d,path,evt){if(evt.shiftKey){path.attr('fill',countryHighlightColor);}}).on('mouseleave',function(d,path,evt){if($.inArray(UserCountryMap.countriesByIso[d.iso].name,_rowEvolution.labels)==-1){path.attr('fill',countryFill(d));}});countryLayer.tooltips(function(data){var metric=$$('.userCountryMapSelectMetrics').val(),country=UserCountryMap.countriesByIso[data.iso];return'<h3>'+country.name+'</h3>'+
formatValueForTooltips(country,metric,target);});}}
if(target==self.lastSelected){updateColorsAndTooltips(metric);return;}
_updateMap(target+'.svg',function(){map.addLayer('countries',{name:'context',filter:function(pd){return UserCountryMap.countriesByIso[pd.iso]===undefined;},tooltips:function(pd){var countryName=pd.name;for(var iso in self.config.countryNames){if(UserCountryMap.ISO2toISO3[iso.toUpperCase()]==pd.iso){countryName=self.config.countryNames[iso];break;}}
return'<h3>'+countryName+'</h3>'+_.no_visit;}});map.addLayer('countries',{name:'countryBG',filter:function(pd){return UserCountryMap.countriesByIso[pd.iso]!==undefined;}});map.addLayer('countries',{key:'iso',filter:function(pd){return UserCountryMap.countriesByIso[pd.iso]!==undefined;},click:function(data,path,evt){evt.stopPropagation();if(evt.shiftKey||_rowEvolution.labels.length){if(evt.altKey){path.attr('fill',countrySelectedColor);addMultipleRowEvolution('getCountry',UserCountryMap.countriesByIso[data.iso].name);}else{showRowEvolution('getCountry',UserCountryMap.countriesByIso[data.iso].name);updateColorsAndTooltips(metric);}
return;}
var tgt;if(self.lastSelected!='world'||UserCountryMap.countriesByIso[data.iso]===undefined){tgt=data.iso;}else{tgt=UserCountryMap.ISO3toCONT[data.iso];}
hasUserZoomed=true;updateState(tgt);}});updateColorsAndTooltips(metric);});}
function _updateMap(svgUrl,callback){map.loadMap(config.svgBasePath+svgUrl,function(){map.clear();self.resize();callback();$('.ui-tooltip').remove();},{padding:-3});}
function indicateLoading(){$$('.UserCountryMap-black').show();$$('.UserCountryMap-black').css('opacity',0);$$('.UserCountryMap-black').animate({opacity:0.5},400);$$('.UserCountryMap .loadingPiwik').show();}
function loadingComplete(){$$('.UserCountryMap-black').hide();$$('.UserCountryMap .loadingPiwik').hide();}
function quantify(d,metric){if(!metric)metric=$$('.userCountryMapSelectMetrics').val();switch(metric){default:return d[metric];}}
function aggregate(rows,groupBy){var groups={};$.each(rows,function(i,row){var g_id=groupBy?groupBy(row):'X';g_id=g_id===true?$.isNumeric(i)&&i===Number(i)?false:i:g_id;if(g_id){if(!groups[g_id]){groups[g_id]={nb_visits:0,nb_actions:0,sum_visit_length:0,bounce_count:0};}
$.each(groups[g_id],function(metric){groups[g_id][metric]+=row[metric];});}});$.each(groups,function(g_id,group){var apv=group.nb_actions / group.nb_visits,ats=group.sum_visit_length / group.nb_visits,br=group.bounce_count / group.nb_visits;group['nb_actions_per_visit']=apv;group['avg_time_on_site']=new Date(0,0,0,ats / 3600,ats%3600 / 60,ats%60).toLocaleTimeString();group['bounce_rate']=(br%1!==0?br.toFixed(1):br)+"%";});return groupBy?groups:groups.X;}
function displayUnlocatableCount(unlocated,total,regionOrCity){$('.unlocated-stats').html($('.unlocated-stats').data('tpl').replace('%s',unlocated).replace('%p','('+formatPercentage(unlocated / total)+')').replace('%c',UserCountryMap.countriesByIso[self.lastSelected].name));$('.UserCountryMap-info-btn').show();var zoomTitle='';if(regionOrCity=='region'){zoomTitle=' '+_pk_translate('UserCountryMap_WithUnknownRegion',[unlocated]);}else if(regionOrCity=='city'){zoomTitle=' '+_pk_translate('UserCountryMap_WithUnknownCity',[unlocated]);}
if(unlocated&&zoomTitle){if($('.map-stats .unlocatableCount').length){$('.map-stats .unlocatableCount').html(zoomTitle);}else{$('.map-stats').append('<small class="unlocatableCount">'+zoomTitle+'</small>');}}}
function renderCountryMap(iso){var countryMap={zoomed:false,lastRequest:false,lastResponse:false};function updateRegionColors(){indicateLoading();ajax(_reportParams('UserCountry','getRegion',UserCountryMap.countriesByIso[iso].iso2)).done(function(data){convertBounceRatesToPercents(data);loadingComplete();var regionDict={},totalCountryVisits=UserCountryMap.countriesByIso[iso].nb_visits,unlocated=totalCountryVisits;function regionCode(region){var key=UserCountryMap.keys[iso]||'fips';return key.substr(0,4)=="fips"?(region[key]||"").substr(2):region[key];}
function regionExistsInMap(code){var key=UserCountryMap.keys[iso]||'fips',q={};q[key]=key.substr(0,4)=='fips'?UserCountryMap.countriesByIso[iso].fips+code:code;if(map.getLayer('regions').getPaths(q).length===0){return false;}
return true;}
$.each(data.reportData,function(i,row){regionDict[data.reportMetadata[i].region]=$.extend(row,data.reportMetadata[i],{curMetric:quantify(row,metric)});});var metric=$$('.userCountryMapSelectMetrics').val();if(UserCountryMap.aggregate[iso]){var aggregated=aggregate(regionDict,function(row){var id=row.region,res=false;$.each(UserCountryMap.aggregate[iso].groups,function(group,codes){if($.inArray(id,codes)>-1){res=group;}});return res;});$.each(aggregated,function(id,group){group.curMetric=quantify(group,metric);regionDict[id]=group;});}
$.each(regionDict,function(key,region){if(regionExistsInMap(key))unlocated-=region.nb_visits;});displayUnlocatableCount(unlocated,totalCountryVisits,'region');colscale=getColorScale(regionDict,'curMetric',null,true);function regionFill(data){var code=regionCode(data);return regionDict[code]===undefined?unknownRegionFillColor:colscale(regionDict[code].curMetric);}
map.getLayer('regions').style('fill',regionFill).style('stroke',function(data){return regionDict[regionCode(data)]===undefined?unknownRegionStrokeColor:regionStrokeColor;}).sort(function(data){var code=regionCode(data);return regionDict[code]===undefined?-1:regionDict[code].curMetric;}).tooltips(function(data){var metric=$$('.userCountryMapSelectMetrics').val(),region=regionDict[regionCode(data)];if(region===undefined){return'<h3>'+data.name+'</h3><p>'+_.nb_visits.replace('%s','<strong>0</strong>')+'</p>';}
return'<h3>'+data.name+'</h3>'+
formatValueForTooltips(region,metric,iso);}).on('click',function(d,path,evt){var region=regionDict[regionCode(d)];if(region&&region.label){if(evt.shiftKey){path.attr('fill',regionSelectedColor);addMultipleRowEvolution('getRegion',region.label);}else{map.getLayer('regions').style('fill',regionFill);showRowEvolution('getRegion',region.label);}}}).on('mouseenter',function(d,path,evt){var region=regionDict[regionCode(d)];if(region&&region.label){if(evt.shiftKey){path.attr('fill',regionHighlightColor);}}}).on('mouseleave',function(d,path,evt){var region=regionDict[regionCode(d)];if(region&&region.label){if($.inArray(region.label,_rowEvolution.labels)==-1){path.attr('fill',regionFill(d));}}}).style('cursor',function(d){return regionDict[regionCode(d)]&&regionDict[regionCode(d)].label?'pointer':'default';});$.each(regionDict,function(code,region){if(!regionExistsInMap(code)){console.warn('possible region mismatch!',code,region.nb_visits);}});});}
function updateCitySymbols(){var layerName=self.mode!="region"?"regions2":"regions";if(map.getLayer(layerName))map.getLayer(layerName).style('fill',invisibleRegionBackgroundColor);indicateLoading();ajax(_reportParams('UserCountry','getCity',UserCountryMap.countriesByIso[iso].iso2)).done(function(data){convertBounceRatesToPercents(data);loadingComplete();var metric=$$('.userCountryMapSelectMetrics').val(),colscale,totalCountryVisits=UserCountryMap.countriesByIso[iso].nb_visits,unlocated=totalCountryVisits,cities=[];$.each(data.reportData,function(i,row){unlocated-=row.nb_visits;cities.push($.extend(row,data.reportMetadata[i],{curMetric:quantify(row,metric)}));});displayUnlocatableCount(unlocated,totalCountryVisits,'city');cities.sort(function(a,b){return b.curMetric-a.curMetric;});colscale=getColorScale(cities,metric);var radscale=$K.scale.linear(cities.concat({curMetric:0}),'curMetric');var area=map.container.width()*map.container.height(),sumArea=0,f={nb_visits:0.002,nb_uniq_visitors:0.002,nb_actions:0.002,avg_time_on_site:0.02,nb_actions_per_visit:0.02,bounce_rate:0.02},maxRad;$.each(cities,function(i,city){sumArea+=isNaN(city.curMetric)?0:Math.pow(radscale(city.curMetric),2);});maxRad=Math.sqrt(area*f[metric]/ sumArea);radscale=$K.scale.sqrt(cities.concat({curMetric:0}),'curMetric').range([2,maxRad+2]);var citySymbols=map.addSymbols({type:$K.LabeledBubble,data:cities,clustering:'noverlap',clusteringOpts:{size:128,tolerance:0},title:function(d){var v=d.curMetric;if(isNaN(v)){return'';}
if(metric==='bounce_rate'){v=Number((''+v).replace('%',''));}else if(metric==='avg_time_on_site'){v=Number(v);}
if(isNaN(v)){return'';}
if(radscale(v)>10){return formatNumber(d.curMetric,metric);}
return'';},labelattrs:{fill:cityLabelColor,'font-size':11,stroke:false,cursor:'pointer'},filter:function(d){if(isNaN(d.lat)||isNaN(d.long))return false;return!!d.curMetric&&d.curMetric!=='0';},aggregate:function(rows){var row=aggregate(rows);row.city_names=[];row.label=rows[0].label;$.each(rows,function(i,r){row.city_names=row.city_names.concat(r.city_names?r.city_names:[r.city_name]);});row.city_name=row.city_names[0]+(row.city_names.length>1?' '+_.and_n_others.replace('%s',(row.city_names.length-1)):'');row.curMetric=quantify(row,metric);return row;},sortBy:'radius desc',location:function(city){return[city.long,city.lat];},radius:function(city){var scale=radscale(city.curMetric);if(isNaN(scale)){return 0.01;}
return scale;},tooltip:function(city){return'<h3>'+city.city_name+'</h3>'+
formatValueForTooltips(city,metric,iso);},attrs:function(city){var color=colscale(city.curMetric);if(color&&color.hex){color=color.hex();}
return{fill:color,'fill-opacity':0.7,stroke:cityStrokeColor,cursor:'pointer'};},mouseenter:function(city,symbol,evt){symbol.path.attr({'fill-opacity':1,'stroke':cityHighlightStrokeColor,'stroke-opacity':1,'stroke-width':2});if(evt.shiftKey){symbol.path.attr({fill:cityHighlightFillColor});if(symbol.label)symbol.label.attr({fill:cityHighlightLabelColor});}},mouseleave:function(city,symbol){symbol.path.attr({'fill-opacity':0.7,'stroke-opacity':1,'stroke-width':1,'stroke':cityLabelColor});if($.inArray(city.label,_rowEvolution.labels)==-1){symbol.path.attr({fill:colscale(city.curMetric)});if(symbol.label)symbol.label.attr({fill:cityLabelFillColor});}},click:function(city,symbol,evt){if(evt.shiftKey){addMultipleRowEvolution('getCity',city.label);symbol.path.attr('fill',citySelectedColor);if(symbol.label)symbol.label.attr('fill',citySelectedLabelColor);}else{showRowEvolution('getCity',city.label);citySymbols.update({attrs:function(city){return{fill:colscale(city.curMetric)};}});}}});});}
_updateMap(iso+'.svg',function(){map.addLayer('context',{key:'iso',filter:function(pd){return UserCountryMap.countriesByIso[pd.iso]===undefined;}});map.addLayer('context',{key:'iso',name:'context-clickable',filter:function(pd){return UserCountryMap.countriesByIso[pd.iso]!==undefined;},click:function(path,p,evt){evt.stopPropagation();hasUserZoomed=true;updateState(path.iso);},tooltips:function(data){if(UserCountryMap.countriesByIso[data.iso]===undefined){return'no data';}
var metric=$$('.userCountryMapSelectMetrics').val(),country=UserCountryMap.countriesByIso[data.iso];return'<h3>'+country.name+'</h3>'+
formatValueForTooltips(country,metric,'world');}});function isThisCountry(d){return d.iso==iso;}
map.addLayer("context",{name:"regionBG",filter:isThisCountry});map.addLayer("context",{name:"regionBG-fill",filter:isThisCountry});map.addLayer('regions',{key:'fips',name:self.mode!="region"?"regions2":"regions",styles:{stroke:regionLayerStrokeColor},click:function(d,p,evt){evt.stopPropagation();}});function filtCountryLabels(data){return data.iso!=iso&&map.getLayer('context-clickable')&&map.getLayer('context-clickable').getPath(data.iso)&&Math.abs(map.getLayer('context-clickable').getPath(data.iso).path.area())>700;}
function countryLabelPos(data){var CLP=UserCountryMap.customLabelPositions;if(CLP[iso]&&CLP[iso][data.iso])return CLP[iso][data.iso];return'context-clickable.'+data.iso;}
map.addSymbols({data:map.getLayer('context-clickable').getPathsData(),type:$K.Label,filter:filtCountryLabels,location:countryLabelPos,text:function(data){return UserCountryMap.countriesByIso[data.iso].iso2;},'class':'countryLabelBg'});map.addSymbols({data:map.getLayer('context-clickable').getPathsData(),type:$K.Label,filter:filtCountryLabels,location:countryLabelPos,text:function(data){return UserCountryMap.countriesByIso[data.iso].iso2;},'class':'countryLabel'});if(!UserCountryMap.countriesByIso[iso])return;if(self.mode=="region"){updateRegionColors();}else{updateCitySymbols();}});}
var _rowEvolution={labels:[],method:false};function addMultipleRowEvolution(method,label){if(method!=_rowEvolution.method){_rowEvolution={method:method,labels:[]};}
_rowEvolution.labels.push(label);}
function showRowEvolution(method,label,column){var box=Piwik_Popover.showLoading('Row Evolution'),multiple,oldLabels=_rowEvolution.labels.slice();multiple=method==_rowEvolution.method&&_rowEvolution.labels.length>0;if(multiple){_rowEvolution.labels.push(label);$.each(_rowEvolution.labels,function(i,l){_rowEvolution.labels[i]=l.replace(/, /g,'%2C%20');});}
var requestParams=$.extend({},{apiMethod:'UserCountry.'+method,label:multiple?_rowEvolution.labels.join(','):label.replace(/, /g,'%2C%20'),disableLink:1,module:'CoreHome',idSite:config.reqParams.idSite,period:config.reqParams.period,date:config.reqParams.date,action:multiple?'getMultiRowEvolutionPopover':'getRowEvolutionPopover',token_auth:config.reqParams.token_auth});if(column){requestParams.column=column;}
ajax(requestParams,'html').done(function(html){Piwik_Popover.setContent(html);var title=box.find('div.popover-title');if(title.length){Piwik_Popover.setTitle(title.html());title.remove();}
box.find('.compare-container').hide();box.find('.rowevolution-startmulti').hide();box.find('.multirowevoltion-metric').off('change').change(function(e){_rowEvolution.labels=oldLabels;showRowEvolution(method,label,box.find('.multirowevoltion-metric').val());});});_rowEvolution.labels=[];}
ajax(_reportParams('UserCountry','getCountry')).done(function(report){convertBounceRatesToPercents(report);var metrics=$$('.userCountryMapSelectMetrics option');var countryData=[],countrySelect=$$('.userCountryMapSelectCountry'),countriesByIso={};UserCountryMap.lastReportMetricStats={};$.each(report.reportData,function(i,data){var meta=report.reportMetadata[i],country={name:data.label,iso2:meta.code.toUpperCase(),fips:meta.code.toUpperCase(),iso:UserCountryMap.ISO2toISO3[meta.code.toUpperCase()],flag:meta.logo};if(UserCountryMap.differentFIPS[country.iso2]){country.fips=UserCountryMap.differentFIPS[country.iso2];}
$.each(metrics,function(i,metric){metric=$(metric).val();country[metric]=data[metric];});countryData.push(country);countriesByIso[country.iso]=country;});countryData.sort(function(a,b){return a.name>b.name?1:-1;});UserCountryMap.countryData=countryData;UserCountryMap.countriesByIso=countriesByIso;function postCSSLoad(){$$('.UserCountryMap .loadingPiwik').hide();$('.mapWidgetStatus').height(0);var params=self.widget.dashboardWidget('getWidgetObject').parameters;self.mode=params&&params.viewMode?params.viewMode:'region';if(params&&params.lastMetric)$$('.userCountryMapSelectMetrics').val(params.lastMetric);var isoCodes=[];$.each(countryData,function(i,country){if(!!country.iso){isoCodes.push(country.iso);countrySelect.append('<option value="'+country.iso+'">'+country.name+'</option>');}});if(!hasUserZoomed&&isoCodes.length===1&&isoCodes[0]&&isoCodes[0]!=='UNK'){updateState(isoCodes[0]);}else{updateState(params&&params.lastMap?params.lastMap:'world');}
initUserInterface();}
if(!$("link[href='"+config.mapCssPath+"']").length){map.loadCSS(config.mapCssPath,postCSSLoad);}else{postCSSLoad();}});function hideOverlay(e){var overlay=$('.content',$(e.target).parents('.UserCountryMap-overlay'));if(overlay.data('locked'))return;overlay.data('locked',true);overlay.fadeOut(200);$$('.UserCountryMap').mouseleave(function(){overlay.fadeIn(200);$$('.UserCountryMap').parent().off('mouseleave');setTimeout(function(){overlay.data('locked',false);},1000);});var offset=$$('.UserCountryMap').offset(),dim={x:overlay.offset().left-offset.left,y:overlay.offset().top-offset.top,w:overlay.width(),h:overlay.height()};$$('.UserCountryMap').mousemove(function(e){var mx=e.pageX-offset.left,my=e.pageY-offset.top,pad=20,outside=mx<dim.x-pad||mx>dim.x+dim.w+pad||my<dim.y-pad||my>dim.y+dim.h+pad;if(outside){$$('.UserCountryMap').parent().off('mouseleave');setTimeout(function(){overlay.fadeIn(200);setTimeout(function(){overlay.data('locked',false);},1000);},100);}});}
$('.UserCountryMap-overlay').off('mouseenter').on('mouseenter',hideOverlay);$$('.widgetUserCountryMapvisitorMap .widgetName span').remove();$$('.widgetUserCountryMapvisitorMap .widgetName').append('<span class="map-title"></span>');function convertBounceRatesToPercents(report){$.each(report.reportData,function(i,row){if(row['bounce_rate']){row['bounce_rate']=parseFloat(row['bounce_rate'])*100;}});}},resize:function(){var ratio,w,h,map=this.map;ratio=map.viewAB.width / map.viewAB.height;w=map.container.width();h=w / ratio;if(!this.theWidget&&map.container.parents('.widget').length){var maxHeight=$(window).height()-($('html').height()-map.container.height());h=Math.min(maxHeight,h);}
map.container.height(h-2);map.resize(w,h);if(w<355)$('.UserCountryMap .tableIcon span').hide();else $('.UserCountryMap .tableIcon span').show();},destroy:function(){this.map.clear();$(this.map.container).html('');$(window).off('resize',this._onResizeLazy)}});}());$.extend(UserCountryMap,{ISO2toISO3:{"BD":"BGD","BE":"BEL","BF":"BFA","BG":"BGR","BA":"BIH","BB":"BRB","WF":"WLF","BL":"BLM","BM":"BMU","BN":"BRN","BO":"BOL","BH":"BHR","BI":"BDI","BJ":"BEN","BT":"BTN","JM":"JAM","BV":"BVT","BW":"BWA","WS":"WSM","BQ":"BES","BR":"BRA","BS":"BHS","JE":"JEY","BY":"BLR","BZ":"BLZ","RU":"RUS","RW":"RWA","RS":"SRB","TL":"TLS","RE":"REU","TM":"TKM","TJ":"TJK","RO":"ROU","TK":"TKL","GW":"GNB","GU":"GUM","GT":"GTM","GS":"SGS","GR":"GRC","GQ":"GNQ","GP":"GLP","JP":"JPN","GY":"GUY","GG":"GGY","GF":"GUF","GE":"GEO","GD":"GRD","GB":"GBR","GA":"GAB","SV":"SLV","GN":"GIN","GM":"GMB","GL":"GRL","GI":"GIB","GH":"GHA","OM":"OMN","TN":"TUN","JO":"JOR","HR":"HRV","HT":"HTI","HU":"HUN","HK":"HKG","HN":"HND","HM":"HMD","VE":"VEN","PR":"PRI","PS":"PSE","PW":"PLW","PT":"PRT","SJ":"SJM","PY":"PRY","IQ":"IRQ","PA":"PAN","PF":"PYF","PG":"PNG","PE":"PER","PK":"PAK","PH":"PHL","PN":"PCN","PL":"POL","PM":"SPM","ZM":"ZMB","EH":"ESH","EE":"EST","EG":"EGY","ZA":"ZAF","EC":"ECU","IT":"ITA","VN":"VNM","SB":"SLB","ET":"ETH","SO":"SOM","ZW":"ZWE","SA":"SAU","ES":"ESP","ER":"ERI","ME":"MNE","MD":"MDA","MG":"MDG","MF":"MAF","MA":"MAR","MC":"MCO","UZ":"UZB","MM":"MMR","ML":"MLI","MO":"MAC","MN":"MNG","MH":"MHL","MK":"MKD","MU":"MUS","MT":"MLT","MW":"MWI","MV":"MDV","MQ":"MTQ","MP":"MNP","MS":"MSR","MR":"MRT","IM":"IMN","UG":"UGA","TZ":"TZA","MY":"MYS","MX":"MEX","IL":"ISR","FR":"FRA","IO":"IOT","SH":"SHN","FI":"FIN","FJ":"FJI","FK":"FLK","FM":"FSM","FO":"FRO","NI":"NIC","NL":"NLD","NO":"NOR","NA":"NAM","VU":"VUT","NC":"NCL","NE":"NER","NF":"NFK","NG":"NGA","NZ":"NZL","NP":"NPL","NR":"NRU","NU":"NIU","CK":"COK","XK":"XKX","CI":"CIV","CH":"CHE","CO":"COL","CN":"CHN","CM":"CMR","CL":"CHL","CC":"CCK","CA":"CAN","CG":"COG","CF":"CAF","CD":"COD","CZ":"CZE","CY":"CYP","CX":"CXR","CS":"SCG","CR":"CRI","CW":"CUW","CV":"CPV","CU":"CUB","SZ":"SWZ","SY":"SYR","SX":"SXM","KG":"KGZ","KE":"KEN","SS":"SSD","SR":"SUR","KI":"KIR","KH":"KHM","KN":"KNA","KM":"COM","ST":"STP","SK":"SVK","KR":"KOR","SI":"SVN","KP":"PRK","KW":"KWT","SN":"SEN","SM":"SMR","SL":"SLE","SC":"SYC","KZ":"KAZ","KY":"CYM","SG":"SGP","SE":"SWE","SD":"SDN","DO":"DOM","DM":"DMA","DJ":"DJI","DK":"DNK","VG":"VGB","DE":"DEU","YE":"YEM","DZ":"DZA","US":"USA","UY":"URY","YT":"MYT","UM":"UMI","LB":"LBN","LC":"LCA","LA":"LAO","TV":"TUV","TW":"TWN","TT":"TTO","TR":"TUR","LK":"LKA","LI":"LIE","LV":"LVA","TO":"TON","LT":"LTU","LU":"LUX","LR":"LBR","LS":"LSO","TH":"THA","TF":"ATF","TG":"TGO","TD":"TCD","TC":"TCA","LY":"LBY","VA":"VAT","VC":"VCT","AE":"ARE","AD":"AND","AG":"ATG","AF":"AFG","AI":"AIA","VI":"VIR","IS":"ISL","IR":"IRN","AM":"ARM","AL":"ALB","AO":"AGO","AN":"ANT","AQ":"ATA","AS":"ASM","AR":"ARG","AU":"AUS","AT":"AUT","AW":"ABW","IN":"IND","AX":"ALA","AZ":"AZE","IE":"IRL","ID":"IDN","UA":"UKR","QA":"QAT","MZ":"MOZ"},ISO3toCONT:{"AGO":"AF","DZA":"AF","EGY":"AF","BGD":"AS","NER":"AF","LIE":"EU","NAM":"AF","BGR":"EU","BOL":"SA","GHA":"AF","CCK":"AS","PAK":"AS","CPV":"AF","JOR":"AS","LBR":"AF","LBY":"AF","MYS":"AS","DOM":"NA","PRI":"NA","SXM":"NA","PRK":"AS","PSE":"AS","TZA":"AF","BWA":"AF","KHM":"AS","UMI":"OC","NIC":"NA","TTO":"NA","ETH":"AF","PRY":"SA","HKG":"AS","SAU":"AS","LBN":"AS","SVN":"EU","BFA":"AF","CHE":"EU","MRT":"AF","HRV":"EU","CHL":"SA","CHN":"AS","KNA":"NA","SLE":"AF","JAM":"NA","SMR":"EU","GIB":"EU","DJI":"AF","GIN":"AF","FIN":"EU","URY":"SA","THA":"AS","STP":"AF","SYC":"AF","NPL":"AS","CXR":"AS","LAO":"AS","YEM":"AS","BVT":"AN","ZAF":"AF","KIR":"OC","PHL":"AS","ROU":"EU","VIR":"NA","SYR":"AS","MAC":"AS","MAF":"NA","MLT":"EU","KAZ":"AS","TCA":"NA","PYF":"OC","NIU":"OC","DMA":"NA","BEN":"AF","GUF":"SA","BEL":"EU","MSR":"NA","TGO":"AF","DEU":"EU","GUM":"OC","LKA":"AS","SSD":"AF","FLK":"SA","GBR":"EU","BES":"NA","GUY":"SA","CRI":"NA","CMR":"AF","MAR":"AF","MNP":"OC","LSO":"AF","HUN":"EU","TKM":"AS","SUR":"SA","NLD":"EU","BMU":"NA","HMD":"AN","TCD":"AF","GEO":"AS","MNE":"EU","MNG":"AS","MHL":"OC","MTQ":"NA","BLZ":"NA","NFK":"OC","MMR":"AS","AFG":"AS","BDI":"AF","VGB":"NA","BLR":"EU","BLM":"NA","GRD":"NA","TKL":"OC","GRC":"EU","RUS":"EU","GRL":"NA","SHN":"AF","AND":"EU","MOZ":"AF","TJK":"AS","XKX":"EU","HTI":"NA","MEX":"NA","ANT":"NA","ZWE":"AF","LCA":"NA","IND":"AS","LVA":"EU","BTN":"AS","VCT":"NA","VNM":"AS","NOR":"EU","CZE":"EU","ATF":"AN","ATG":"NA","FJI":"OC","IOT":"AS","HND":"NA","MUS":"AF","ATA":"AN","LUX":"EU","ISR":"AS","FSM":"OC","PER":"SA","REU":"AF","IDN":"AS","VUT":"OC","MKD":"EU","COD":"AF","COG":"AF","ISL":"EU","GLP":"NA","COK":"OC","COM":"AF","COL":"SA","NGA":"AF","TLS":"OC","TWN":"AS","PRT":"EU","MDA":"EU","GGY":"EU","MDG":"AF","ECU":"SA","SEN":"AF","NZL":"OC","MDV":"AS","ASM":"OC","SPM":"NA","CUW":"NA","FRA":"EU","LTU":"EU","RWA":"AF","ZMB":"AF","GMB":"AF","WLF":"OC","JEY":"EU","FRO":"EU","GTM":"NA","DNK":"EU","IMN":"EU","AUS":"OC","AUT":"EU","SJM":"EU","VEN":"SA","PLW":"OC","KEN":"AF","MYT":"AF","WSM":"OC","TUR":"AS","ALB":"EU","OMN":"AS","TUV":"OC","ALA":"EU","BRN":"AS","TUN":"AF","PCN":"OC","BRB":"NA","BRA":"SA","CIV":"AF","SRB":"EU","GNQ":"AF","USA":"NA","QAT":"AS","SWE":"EU","AZE":"AS","GNB":"AF","SWZ":"AF","TON":"OC","CAN":"NA","UKR":"EU","KOR":"AS","AIA":"NA","CAF":"AF","SVK":"EU","CYP":"EU","BIH":"EU","SGP":"AS","SGS":"AN","SOM":"AF","UZB":"AS","ERI":"AF","POL":"EU","KWT":"AS","SCG":"EU","GAB":"AF","CYM":"NA","VAT":"EU","EST":"EU","MWI":"AF","ESP":"EU","IRQ":"AS","SLV":"NA","MLI":"AF","IRL":"EU","IRN":"AS","ABW":"NA","PNG":"OC","PAN":"NA","SDN":"AF","SLB":"OC","ESH":"AF","MCO":"EU","ITA":"EU","JPN":"AS","KGZ":"AS","UGA":"AF","NCL":"OC","ARE":"AS","ARG":"SA","BHS":"NA","BHR":"AS","ARM":"AS","NRU":"OC","CUB":"NA"},aggregate:{GBR:{groups:{"East Midlands":["H5","D2","D3","H7","J1","H4","L4","J8","J9"],"West Midlands":["","O2","P3","F7","Q4","N1","N4","L6"],"South West":["E6","A4","B7","J4","M6","M3","D4","B2","D6","K5","C6","K4","O4","N9","P8"],"North East":["","D1","D8","F5","I5","K9","N3","J6"],"Scotland":["U4","U5","U7","V2","V4","U5","V8","W2","W4","W5","W7","T5","T6","U9","V9","W6","U1","W1","T7","U3","V1","U6","U8","V5","W9","T9","U2","U9","V3","T8","W8"],"South East":["F2","M4","I6","B9","","B6","E2","I3","P6","K2","N7","G2","K6","G5"],"North West":["","E9","C5","A8","H2","C9","P2","I2"],"Yorkshire and the Humber":["G6","J2","J3","Q5","E1","J7","",""],"Northern Ireland":["R3","S6","T3","Q8","S9","R2","R8","S1","S5","R7","Q6","S7","Q9","S3","R4","T1","T2","R9","R6","R1","S4","R5","T4","S2","Q7","S8"],"London":["H9","A1","A6","B5","B8","C4","C8","D9","E3","E7","F1","G1","G3","G4","I4","K8","L1","N8","O5","O9","P1","P5","F6","F9","G7","E8","F3","F4","H1","H6","I8","M8"],"East":["M5","A5","F8","C3","E4","N5","I9","O3","I1","K3"],"Wales":["X7","X6","Y7","Y8","X3","X4","Y3","Y9","X5","Z3","Y5","Z1","X9","Y1","Z4","X1","X8","Y2","X2","Y4","Y6","Z2"]}},SVN:{groups:{"PS":["08","54","B6"],"NO":["I7","00","13","38","91","94"],"KO":["E6","93","A4","00","A5","16","25","74","76","81","A2","C2"],"SP":["14","36","D2","01","06","07","44","46","J5","E1","84","00"],"LJ":["D4","E3","E5","G4","G7","H6","00","00","00","00","05","09","22","32","37","39","I5","61","64","68","71","72","77","C1"],"JP":["19","35","40","49","50","J9","B7"],"JS":["00","J7","L1","00","00","00","00","00","00","17","66","73","B1","B4","B8","D4"],"PD":["42","28","42","87","E9","00","00","00","18","I3","J1","K7","L3","L8","N2","00","00","00","00","00","00","00","00","00","70","00","00","26","45","55","89","98","B3","C8"],"GO":["03","04","32","52","53","62","A3","B9","D5","F1","F2","K5","00","H4","00","12","B2"],"SA":["D7","E2","F3","I9","92","L7","N3","N5","00","00","00","00","00","00","00","00","00","","11","30","08","57","62","79","83","99","A7","A8","C4","C5","C6","C7","C9"],"ZS":["E7","34","C9","C9"],"PM":["02","47","78","80","86","D1","D6","33","I2","00","00","15","59","I6","00","00","00","00","00","10","29","97","97","A1","A6"]}},FRA:{partial:true,groups:{"A5":["A5","B5"]}},POL:{partial:true,groups:{"82":["82","60"],"85":["85","47","H9"]}},CZE:{partial:true,groups:{"82":["82","70","23","20"],"88":["88","41"]}},BEL:{partial:true,groups:{"12":["12","02"]}},DNK:{partial:true,groups:{"19":["19","07"],"18":["18","15"],"20":["20","12"],"21":["21","11","04"]}}},keys:{"SVN":"region","GBR":"region","ESP":"fips-","USA":"p","CAN":"p"},customLabelPositions:{CZE:{DEU:[12.3,49]},DEU:{AUT:[13.9,48.1]},ESP:{PRT:[-8.5,39.6]},NLD:{BEL:[4.6,51,1],DEU:[6.9,51.5]},CHE:{FRA:[6.2,47.2],AUT:[9.95,47.2],ITA:[9.7,46.0],DEU:[8.14,47.83]},USA:{MEX:[-102,24],CAN:[-97,52]},BIH:{HRV:[15.3,45]}},differentFIPS:{AD:'AN',AG:'AC',AI:'AV',AQ:'AY',AS:'AQ',AT:'AU',AU:'AS',AW:'AA',AZ:'AJ',BA:'BK',BD:'BG',BF:'UV',BG:'BU',BH:'BA',BI:'BY',BJ:'BN',BL:'TB',BM:'BD',BN:'BX',BO:'BL',BS:'BF',BW:'BC',BY:'BO',BZ:'BH',CC:'CK',CD:'CG',CF:'CT',CG:'CF',CH:'SZ',CI:'IV',CK:'CW',CL:'CI',CN:'CH',CR:'CS',CW:'UC',CX:'KT',CZ:'EZ',DE:'GM',DK:'DA',DM:'DO',DO:'DR',DZ:'AG',EE:'EN',EH:'WI',ES:'SP',GA:'GB',GB:'UK',GD:'GJ',GE:'GG',GF:'FG',GG:'GK',GM:'GA',GN:'GV',GQ:'EK',GS:'SX',GU:'GQ',GW:'PU',HN:'HO',HT:'HA',IE:'EI',IL:'IS',IQ:'IZ',IS:'IC',JP:'JA',KH:'CB',KI:'KR',KM:'CN',KN:'SC',KP:'KN',KR:'KS',XK:'KV',KW:'KU',KY:'CJ',LB:'LE',LC:'ST',LI:'LS',LK:'CE',LR:'LI',LS:'LT',LT:'LH',LV:'LG',MA:'MO',MC:'MN',ME:'MJ',MF:'RN',MG:'MA',MH:'RM',MM:'BM',MN:'MG',MO:'MC',MP:'CQ',MQ:'MB',MS:'MH',MU:'MP',MW:'MI',NA:'WA',NE:'NG',NG:'NI',NI:'NU',NU:'NE',OM:'MU',PA:'PM',PF:'FP',PG:'PP',PH:'RP',PM:'SB',PN:'PC',PR:'RQ',PS:'WE',PT:'PO',PW:'PS',PY:'PA',RS:'RI',RU:'RS',SB:'BP',SC:'SE',SD:'SU',SS:'OD',SE:'SW',SG:'SN',SJ:'SV',SK:'LO',SN:'SG',SR:'NS',ST:'TP',SV:'ES',SX:'NN',SZ:'WZ',TC:'TK',TD:'CD',TF:'FS',TG:'TO',TJ:'TI',TK:'TL',TL:'TT',TM:'TX',TN:'TS',TO:'TN',TR:'TU',TT:'TD',UA:'UP',VA:'VT',VG:'VI',VI:'VQ',VN:'VM',VU:'NH',YE:'YM',YT:'MF',ZA:'SF',ZM:'ZA',ZW:'ZI',CS:'YI',AN:'NT'},cont2cont:{afr:'AF',eur:'EU',amn:'NA',ams:'SA',asi:'AS',oce:'OC',amc:'SA'}});
/*!
 * Matomo - free/libre analytics platform
 *
 * Real time visitors map
 * Using Kartograph.js http://kartograph.org/
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){var UIControl=require('piwik/UI').UIControl;var RealtimeMap=window.UserCountryMap.RealtimeMap=function(element){UIControl.call(this,element);this._init();this.run();};RealtimeMap.initElements=function(){UIControl.initElements(this,'.RealTimeMap');};$.extend(RealtimeMap.prototype,UIControl.prototype,{_init:function(){var $element=this.$element;this.config=JSON.parse($element.attr('data-config'));if($element.attr('data-standalone')==1){this._initStandaloneMap();}
if($('#dashboardWidgetsArea').length){var $widgetContent=$element.closest('.widgetContent');var self=this;$widgetContent.on('widget:maximise',function(){self.resize();}).on('widget:minimise',function(){self.resize();});}
this.uniqueId='RealTimeMap_map-'+this._controlId;$('.RealTimeMap_map',$element).attr('id',this.uniqueId);this.map=$K.map('#'+this.uniqueId);$element.focus();},_initStandaloneMap:function(){var $rootScope=piwikHelper.getAngularDependency('$rootScope');$rootScope.$emit('hidePeriodSelector');$('.realTimeMap_overlay').css('top','0px');$('.realTimeMap_datetime').css('top','20px');},run:function(){var self=this,config=self.config,_=config._,map=self.map,maxVisits=config.maxVisits||100,changeVisitAlpha=typeof config.changeVisitAlpha==='undefined'?true:config.changeVisitAlpha,removeOldVisits=typeof config.removeOldVisits==='undefined'?true:config.removeOldVisits,doNotRefreshVisits=typeof config.doNotRefreshVisits==='undefined'?false:config.doNotRefreshVisits,enableAnimation=typeof config.enableAnimation==='undefined'?true:config.enableAnimation,forceNowValue=typeof config.forceNowValue==='undefined'?false:+config.forceNowValue,lastTimestamp=-1,lastVisits=[],visitSymbols,tokenAuth=''+config.reqParams.token_auth,oldest,isFullscreenWidget=$('.widget').parent().get(0)==document.body,now,nextReqTimer,symbolFadeInTimer=[],colorMode='default',currentMap='world',yesterday=false,userHasZoomed=false,colorManager=piwik.ColorManager,colors=colorManager.getColors('realtime-map',['white-bg','white-fill','black-bg','black-fill','visit-stroke','website-referrer-color','direct-referrer-color','search-referrer-color','live-widget-highlight','live-widget-unhighlight','symbol-animate-fill','region-stroke-color']),currentTheme='white',colorTheme={white:{bg:colors['white-bg'],fill:colors['white-fill']},black:{bg:colors['black-bg'],fill:colors['black-fill']}},visitStrokeColor=colors['visit-stroke'],referrerColorWebsite=colors['referrer-color-website'],referrerColorDirect=colors['referrer-color-direct'],referrerColorSearch=colors['referrer-color-search'],liveWidgetHighlightColor=colors['live-widget-highlight'],liveWidgetUnhighlightColor=colors['live-widget-unhighlight'],symbolAnimateFill=colors['symbol-animate-fill'];self.widget=$('#widgetRealTimeMaprealtimeMap').parent();var preset=self.widget.dashboardWidget('getWidgetObject').parameters;if(preset){currentTheme=preset.colorTheme;colorMode=preset.colorMode;currentMap=preset.lastMap;}
function _reportParams(firstRun){return $.extend(config.reqParams,{module:'API',method:'Live.getLastVisitsDetails',filter_limit:maxVisits,showColumns:['latitude','longitude','actions','lastActionTimestamp','visitLocalTime','city','country','countryCode','referrerType','referrerName','referrerTypeName','browserIcon','operatingSystemIcon','deviceType','deviceModel','countryFlag','idVisit','actionDetails','continentCode','actions','searches','goalConversions','visitorId','userId'].join(','),minTimestamp:firstRun?0:lastTimestamp});}
function ajax(params){delete params['token_auth'];return $.ajax({url:'index.php?'+$.param(params),dataType:'json',data:{token_auth:tokenAuth},type:'POST'});}
function _updateMap(svgUrl,callback){if(svgUrl===undefined)return;map.loadMap(config.svgBasePath+svgUrl,function(){map.clear();self.resize();callback();$('.ui-tooltip').remove();},{padding:-3});}
function onResizeLazy(){clearTimeout(self._resizeTimer);self._resizeTimer=setTimeout(self.resize.bind(self),300);}
function age(r){var nowSecs=Math.floor(now);var o=(r.lastActionTimestamp-oldest)/(nowSecs-oldest);return Math.min(1,Math.max(0,o));}
function relativeTime(ds){var val=function(val){return'<strong>'+Math.round(val)+'</strong>';};return(ds<90?_.seconds_ago.replace('%s',val(ds)):ds<5400?_.minutes_ago.replace('%s',val(ds / 60)):ds<129600?_.hours_ago.replace('%s',val(ds / 3600)):_.days_ago.replace('%s',val(ds / 86400)));}
function visitTooltip(r){var ds=new Date().getTime()/ 1000-r.lastActionTimestamp,ad=r.actionDetails,ico=function(src){return'<img height="16px" src="'+src+'" alt="" class="icon" />&nbsp;';};return'<h3>'+(r.city?$('<span>').text(r.city).html()+' / ':'')+$('<span>').text(r.country).html()+'</h3>'+
ico(r.countryFlag)+ico(r.browserIcon)+ico(r.operatingSystemIcon)+'<br/>'+
r.deviceType+' ('+r.deviceModel+')<br/>'+
(r.userId?_pk_translate('General_UserId')+':&nbsp;'+$('<span>').text(r.userId).html()+'<br/>':'')+
(ad&&ad.length&&ad[ad.length-1].pageTitle?''+$('<span>').text(ad[ad.length-1].pageTitle).html()+'<br/>':'')+'<div class="rel-time" data-actiontime="'+r.lastActionTimestamp+'">'+relativeTime(ds)+'</div>'+
(r.referrerType=="direct"?r.referrerTypeName:_.from+': '+$('<span>').text(r.referrerName).html())+'<br />'+'<small>'+_.local_time+': '+r.visitLocalTime+'</small><br />'+
(self.config.siteHasGoals&&r.goalConversions?'<small>'+_.goal_conversions.replace('%s','<strong>'+r.goalConversions+'</strong>')+
(r.searches>0?', '+_.searches.replace('%s',r.searches):'')+'</small><br />':'')+'<small>'+_.actions.replace('%s','<strong>'+r.actions+'</strong>')+
(r.searches>0?', '+_.searches.replace('%s','<strong>'+r.searches+'</strong>'):'')+'</small>';}
function visitRadius(r){return Math.pow(age(r),4)*(self.maxRad-self.minRad)+self.minRad;}
function visitColor(r){var col,engaged=self.config.siteHasGoals?r.goalConversions>0:r.actions>4;if(colorMode=='referrerType'){col=({website:referrerColorWebsite,direct:referrerColorDirect,search:referrerColorSearch})[r.referrerType];}
else col=chroma.hsl(42*age(r),Math.sqrt(age(r)),(engaged?0.65:0.5)-(1-age(r))*0.45);return col;}
function visitSymbolAttrs(r){var result={fill:visitColor(r).hex(),stroke:visitStrokeColor,'stroke-width':1*age(r),r:visitRadius(r),cursor:'pointer'};if(changeVisitAlpha){result['fill-opacity']=Math.pow(age(r),2)*0.8+0.2;result['stroke-opacity']=Math.pow(age(r),1.7)*0.8+0.2;}
return result;}
function highlightVisit(r){$('#visitsLive').find('li#'+r.idVisit+' .datetime').css('background',liveWidgetHighlightColor);}
function unhighlightVisit(r){$('#visitsLive').find('li#'+r.idVisit+' .datetime').css({background:liveWidgetUnhighlightColor});}
function animateSymbol(s){var c=map.paper.circle().attr(s.path.attrs);c.insertBefore(s.path);c.attr({fill:false});c.animate({r:c.attrs.r*3,'stroke-width':7,opacity:0},2500,'linear',function(){c.remove();});var col=s.path.attrs.fill,rad=s.path.attrs.r;s.path.show();s.path.attr({fill:symbolAnimateFill,r:0.1,opacity:1});s.path.animate({fill:col,r:rad},700,'bounce');}
this.$element.on('mapClick',function(e,visit,mapPath){var VisitorProfileControl=require('piwik/UI').VisitorProfileControl;if(visit&&VisitorProfileControl&&!self.$element.closest('.visitor-profile').length){VisitorProfileControl.showPopover(visit.visitorId);}else{var cont=UserCountryMap.cont2cont[mapPath.data.continentCode];if(cont&&cont!=currentMap){updateMap(cont);}}});function refreshVisits(firstRun){if(lastTimestamp!=-1&&doNotRefreshVisits&&!firstRun){return;}
function gotNewReport(report){if(!self.map||!self.$element.length||!$.contains(document,self.$element[0])){return;}
nextReqTimer=setTimeout(refreshVisits,config.liveRefreshAfterMs);$('.realTimeMap_overlay img').hide();$('.realTimeMap_overlay .loading_data').hide();now=forceNowValue||(new Date().getTime()/ 1000);if(firstRun){visitSymbols=map.addSymbols({data:[],type:$K.Bubble,sortBy:function(r){return r.lastActionTimestamp;},radius:visitRadius,location:function(r){return[r.longitude,r.latitude];},attrs:visitSymbolAttrs,tooltip:visitTooltip,mouseenter:highlightVisit,mouseleave:unhighlightVisit,click:function(visit,mapPath,evt){evt.stopPropagation();self.$element.trigger('mapClick',[visit,mapPath]);}});lastVisits=[];}
if(report.length){report=$.grep(report,function(r){return r.latitude!==null;});$('#realTimeMapNoVisitsInfo').toggle(!report.length);}
if(!report.length){$('.realTimeMap_overlay .showing_visits_of').hide();$('.realTimeMap_overlay .no_data').show();return;}else{$('.realTimeMap_overlay .showing_visits_of').show();$('.realTimeMap_overlay .no_data').hide();if(yesterday===false){yesterday=report[0].lastActionTimestamp-24*60*60;}
lastVisits=[].concat(report).concat(lastVisits).slice(0,maxVisits);oldest=Math.max(lastVisits[lastVisits.length-1].lastActionTimestamp,yesterday);var _removed=0;if(removeOldVisits){visitSymbols.remove(function(r){if(r.lastActionTimestamp<oldest)_removed++;return r.lastActionTimestamp<oldest;});}
visitSymbols.update({radius:function(d){return visitSymbolAttrs(d).r;},attrs:visitSymbolAttrs},true);var newSymbols=[];$.each(report,function(i,r){newSymbols.push(visitSymbols.add(r));});visitSymbols.layout().render();if(enableAnimation){$.each(newSymbols,function(i,s){if(i>10)return false;s.path.hide();var t=setTimeout(function(){animateSymbol(s);},1000*(s.data.lastActionTimestamp-now)+config.liveRefreshAfterMs);symbolFadeInTimer.push(t);});}
lastTimestamp=report[0].lastActionTimestamp;var dur=lastTimestamp-oldest,d;if(dur<60)d=dur+' '+_.seconds;else if(dur<3600)d=Math.ceil(dur / 60)+' '+_.minutes;else d=Math.ceil(dur / 3600)+' '+_.hours;$('.realTimeMap_timeSpan').html(d);if(!userHasZoomed){var usedContinents=[];var usedCountries=[];var aSymbol;for(var z=0;z<visitSymbols.symbols.length;z++){aSymbol=visitSymbols.symbols[z];if(aSymbol&&aSymbol.data){if(aSymbol.data.continentCode&&-1===usedContinents.indexOf(aSymbol.data.continentCode)){usedContinents.push(aSymbol.data.continentCode);}
if(aSymbol.data.countryCode&&-1===usedCountries.indexOf(aSymbol.data.countryCode)){usedCountries.push(aSymbol.data.countryCode);}}}
if(usedCountries.length===1&&usedCountries[0]&&usedCountries[0]!=='unk'){updateMap(UserCountryMap.ISO2toISO3[usedCountries[0].toUpperCase()],false);}else if(usedContinents.length===1&&usedContinents[0]&&usedContinents[0]!=='unk'){updateMap(UserCountryMap.cont2cont[usedContinents[0]],false);}}}
firstRun=false;}
if(firstRun&&lastVisits.length){gotNewReport(lastVisits.slice());}else if(Visibility.hidden()){nextReqTimer=setTimeout(refreshVisits,config.liveRefreshAfterMs);}else{$('.realTimeMap_overlay img').show();ajax(_reportParams(firstRun)).done(gotNewReport);}}
function initMap(){$('#widgetRealTimeMapliveMap .loadingPiwik, .RealTimeMap .loadingPiwik').hide();map.addLayer(currentMap.length==3?'context':'countries',{styles:{fill:colorTheme[currentTheme].fill,stroke:colorTheme[currentTheme].bg,'stroke-width':0.2},click:function(d,p,evt){evt.stopPropagation();userHasZoomed=true;if(currentMap.length==2){updateMap(d.iso);}else if(currentMap!='world'){updateMap('world');}else{updateMap(UserCountryMap.ISO3toCONT[d.iso]);}},title:function(d){return d.name;}});if(currentMap.length==3){map.addLayer('regions',{styles:{stroke:colors['region-stroke-color']}});}
refreshVisits(true);}
function storeSettings(){self.widget.dashboardWidget('setParameters',{lastMap:currentMap,theme:colorTheme,colorMode:colorMode});}
function updateMap(_map,_storeSettings){if('undefined'===typeof _storeSettings){_storeSettings=true;}
if(_map&&currentMap===_map&&_map!=='world'){return;}
clearTimeout(nextReqTimer);$.each(symbolFadeInTimer,function(i,t){clearTimeout(t);});symbolFadeInTimer=[];try{map.removeSymbols();}catch(e){}
currentMap=_map;_updateMap(currentMap+'.svg',initMap);if(_storeSettings){storeSettings();}}
updateMap(location.hash&&(location.hash=='#world'||location.hash.match(/^#[A-Z]{2,3}$/))?location.hash.substr(1):'world');$('.RealTimeMap_map',this.$element).off('click').click(function(){if(currentMap!='world'){userHasZoomed=true;updateMap('world');}});this.$element.on('keydown',function(evt){if(evt.shiftKey&&evt.altKey&&evt.keyCode==67){colorMode=({'default':'referrerType',referrerType:'default'})[colorMode];storeSettings();}
function switchTheme(){self.$element.css({background:colorTheme[currentTheme].bg});if(isFullscreenWidget){$('body').css({background:colorTheme[currentTheme].bg});$('.widget').css({'border-width':1});}
map.getLayer('countries').style('fill',colorTheme[currentTheme].fill).style('stroke',colorTheme[currentTheme].bg);storeSettings();}
if(evt.shiftKey&&evt.altKey&&evt.keyCode==66){currentTheme='black';switchTheme();}
if(evt.shiftKey&&evt.altKey&&evt.keyCode==87){currentTheme='white';switchTheme();}});$(window).on('resize.'+this.uniqueId,onResizeLazy);this._tooltipUpdateInterval=setInterval(function(){$('.qtip .rel-time').each(function(i,el){el=$(el);var ds=new Date().getTime()/ 1000-el.data('actiontime');el.html(relativeTime(ds));});var d=new Date(),datetime=d.toTimeString().substr(0,8);$('.realTimeMap_datetime').html(datetime);},1000);},resize:function(){var ratio,w,h,map=this.map;ratio=map.viewAB.width / map.viewAB.height;w=map.container.width();h=Math.min(w / ratio,$(window).height()-30);var radScale=Math.pow((h*ratio*h)/ 130000,0.3);this.maxRad=10*radScale;this.minRad=4*radScale;map.container.height(h-2);map.resize(w,h);if(map.symbolGroups&&map.symbolGroups.length>0){map.symbolGroups[0].update();}
if(w<355)$('.UserCountryMap .tableIcon span').hide();else $('.UserCountryMap .tableIcon span').show();},_destroy:function(){UIControl.prototype._destroy.call(this);if(this._tooltipUpdateInterval){clearInterval(this._tooltipUpdateInterval);}
$(window).off('resize.'+this.uniqueId);this.map.clear();$(this.map.container).html('');delete this.map;}});}());
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($){$.widget('piwik.liveWidget',{options:{maxRows:10,interval:3000,maxInterval:300000,dataUrlParams:null,onUpdate:null,fadeInSpeed:'slow'},currentInterval:null,updated:false,updateInterval:null,isStarted:true,_update:function(){this.updated=false;var that=this;var ajaxRequest=new ajaxHelper();ajaxRequest.addParams(this.options.dataUrlParams,'GET');ajaxRequest.setFormat('html');ajaxRequest.setCallback(function(r){if(that.options.replaceContent){$(that.element).html(r);if(that.options.fadeInSpeed){$(that.element).effect("highlight",{},that.options.fadeInSpeed);}}else{that._parseResponse(r);}
if(!that.updated){that.currentInterval+=that.options.interval;}else{that.currentInterval=that.options.interval;if(that.options.onUpdate)that.options.onUpdate();}
if(that.options.maxInterval<that.currentInterval){that.currentInterval=that.options.maxInterval;}
if(that.isStarted){window.clearTimeout(that.updateInterval);if(that.element.length&&$.contains(document,that.element[0])){that.updateInterval=window.setTimeout(function(){that._update()},that.currentInterval);}}});ajaxRequest.send();},_parseResponse:function(data){if(!data||!data.length){this.updated=false;return;}
var items=$('li.visit',$(data));for(var i=items.length;i--;){this._parseItem(items[i]);}
this._initTooltips();},_initTooltips:function(){$('li.visit').tooltip({items:'.visitorLogIconWithDetails',track:true,show:false,hide:false,content:function(){return $('<ul>').html($('ul',$(this)).html());},tooltipClass:'small'});},_parseItem:function(item){var visitId=$(item).attr('id');if($('#'+visitId,this.element).length){if($('#'+visitId,this.element).html()!=$(item).html()){this.updated=true;}
$('#'+visitId,this.element).remove();$(this.element).prepend(item);}else{this.updated=true;$(item).hide();$(this.element).prepend(item);$(item).fadeIn(this.options.fadeInSpeed);}
$('li.visit:gt('+(this.options.maxRows-1)+')',this.element).remove();},_create:function(){if(!this.options.dataUrlParams){console&&console.error('liveWidget error: dataUrlParams needs to be defined in settings.');return;}
this.currentInterval=this.options.interval;if(0===$(this.element).parents('.widget').length){var $rootScope=piwikHelper.getAngularDependency('$rootScope');$rootScope.$emit('hidePeriodSelector');}
var self=this;window.setTimeout(function(){self._initTooltips();},250);this.updateInterval=window.setTimeout(function(){self._update();},this.currentInterval);},_destroy:function(){this.stop();},update:function(){this._update();},start:function(){this.isStarted=true;this.currentInterval=0;this._update();},stop:function(){this.isStarted=false;window.clearTimeout(this.updateInterval);},started:function(){return this.isStarted;},setInterval:function(interval){this.currentInterval=interval;}});})(jQuery);$(function(){var refreshWidget=function(element,refreshAfterXSecs){if(!element.length||!$.contains(document,element[0])){return;}
function scheduleAnotherRequest(){setTimeout(function(){refreshWidget(element,refreshAfterXSecs);},refreshAfterXSecs*1000);}
if(Visibility.hidden()){scheduleAnotherRequest();return;}
var lastMinutes=$(element).attr('data-last-minutes')||3,translations=JSON.parse($(element).attr('data-translations'));var ajaxRequest=new ajaxHelper();ajaxRequest.addParams({module:'API',method:'Live.getCounters',format:'json',lastMinutes:lastMinutes},'get');ajaxRequest.setFormat('json');ajaxRequest.setCallback(function(data){data=data[0];var visitors=data['visitors'];if(visitors==1){var visitorsCountMessage=translations['one_visitor'];}
else{var visitorsCountMessage=sprintf(translations['visitors'],visitors);}
$('.simple-realtime-visitor-counter',element).attr('title',visitorsCountMessage).find('div').text(visitors);var metrics=$('.simple-realtime-metric',element);var visitsText=data['visits']==1?translations['one_visit']:sprintf(translations['visits'],data['visits']);$(metrics[0]).text(visitsText);var actionsText=data['actions']==1?translations['one_action']:sprintf(translations['actions'],data['actions']);$(metrics[1]).text(actionsText);var lastMinutesText=lastMinutes==1?translations['one_minute']:sprintf(translations['minutes'],lastMinutes);$(metrics[2]).text(lastMinutesText);scheduleAnotherRequest();});ajaxRequest.send();};var exports=require("piwik/Live");exports.initSimpleRealtimeVisitorWidget=function(){$('.simple-realtime-visitor-widget').each(function(){var $this=$(this),refreshAfterXSecs=$this.attr('data-refreshAfterXSecs');if($this.attr('data-inited')){return;}
$this.attr('data-inited',1);setTimeout(function(){refreshWidget($this,refreshAfterXSecs);},refreshAfterXSecs*1000);});};});function onClickPause(){$('#pauseImage').hide();$('#playImage').show();return $('#visitsLive').liveWidget('stop');}
function onClickPlay(){$('#playImage').hide();$('#pauseImage').show();return $('#visitsLive').liveWidget('start');}
(function(){if(!Visibility.isSupported()){return;}
var isStoppedByBlur=false;function isStarted(){return $('#visitsLive').liveWidget('started');}
function onTabBlur(){if(isStarted()){isStoppedByBlur=true;onClickPause();}}
function onTabFocus(){if(isStoppedByBlur&&!isStarted()){isStoppedByBlur=false;onClickPlay();}}
Visibility.change(function(event,state){if(Visibility.hidden()){onTabBlur();}else{onTabFocus();}});})();
var SegmentedVisitorLog=function(){function getDataTableFromApiMethod(apiMethod){var div=$(require('piwik/UI').DataTable.getDataTableByReport(apiMethod));if(div.length&&div.data('uiControlObject')){return div.data('uiControlObject');}}
function getLabelFromTr($tr,apiMethod){var label;if(apiMethod&&0===apiMethod.indexOf('Actions.')){label=$tr.attr('data-url-label');}
if(!label){label=$tr.find('.label .value').text();}
if(label){label=$.trim(label);}
return label;}
function getDimensionFromApiMethod(apiMethod){if(!apiMethod){return;}
var dataTable=getDataTableFromApiMethod(apiMethod);var metadata=getMetadataFromDataTable(dataTable);if(metadata&&metadata.dimension){return metadata.dimension;}}
function getMetadataFromDataTable(dataTable){if(dataTable){return dataTable.getReportMetadata();}}
function findTitleOfRowHavingRawSegmentValue(apiMethod,rawSegmentValue){var $tr=$('[data-report="'+apiMethod+'"] tr[data-segment-filter="'+rawSegmentValue+'"]').first();return getLabelFromTr($tr,apiMethod);}
function setPopoverTitle(apiMethod,segment,index){var dataTable=getDataTableFromApiMethod(apiMethod);if(!dataTable){if(index<15){setTimeout(function(){setPopoverTitle(apiMethod,segment,index+1);},150);}
return;}
var segmentName=getDimensionFromApiMethod(apiMethod);var segmentValue=findTitleOfRowHavingRawSegmentValue(apiMethod,segment);if(!segmentName||(segment&&segment.indexOf(';')>0)){segmentName=_pk_translate('General_Segment');var segmentParts=segment.split(';');segmentValue=segmentParts.join(' '+_pk_translate('General_And')+' ');}
segmentName=piwikHelper.escape(segmentName);segmentName=piwikHelper.htmlEntities(segmentName);segmentValue=piwikHelper.escape(segmentValue);segmentValue=piwikHelper.htmlEntities(segmentValue);segmentName=segmentName.replace(/(&amp;)(#[0-9]{2,5};)/g,'&$2');segmentValue=segmentValue.replace(/(&amp;)(#[0-9]{2,5};)/g,'&$2');var title=_pk_translate('Live_SegmentedVisitorLogTitle',[segmentName,segmentValue]);Piwik_Popover.setTitle(title);}
function show(apiMethod,segment,extraParams){var box=Piwik_Popover.showLoading('Segmented Visit Log');box.addClass('segmentedVisitorLogPopover');var callback=function(html){Piwik_Popover.setContent(html);var title=box.find('h2[piwik-enriched-headline]');var defaultTitle=title.text();if(title.length){title.remove();}
Piwik_Popover.setTitle(defaultTitle);setPopoverTitle(apiMethod,segment,0);};var requestParams={module:'Live',action:'indexVisitorLog',segment:encodeURIComponent(segment),disableLink:1,small:1,enableAddNewSegment:1,};$.extend(requestParams,extraParams);var ajaxRequest=new ajaxHelper();ajaxRequest.addParams(requestParams,'get');ajaxRequest.setCallback(callback);ajaxRequest.setFormat('html');ajaxRequest.send();}
return{show:show}}();
function initializeVisitorActions(elem){var tooltipIsOpened=false;$('a',elem).on('focus',function(){if(tooltipIsOpened){elem.tooltip('close');}});elem.tooltip({items:'[title],.visitorLogIconWithDetails',track:true,show:false,hide:false,content:function(){if($(this).hasClass('visitorLogIconWithDetails')){return $('<ul>').html($('ul',$(this)).html());}
var title=$(this).attr('title');return $('<a>').text(title).html().replace(/\n/g,'<br />');},tooltipClass:'small',open:function(){tooltipIsOpened=true;},close:function(){tooltipIsOpened=false;}});$("ol.visitorLog",elem).each(function(){var $actions=$(this).find("li");$actions.each(function(index){var $li=$(this);if(!$li.is('.content')){return;}
if(!$actions[index-1]||!$($actions[index-1]).is('.content')||!$actions[index-2]||!$($actions[index-2]).is('.content')){return;}
var $collapsedContents=$li;while($collapsedContents.prev().is('.content')){$collapsedContents=$collapsedContents.prev();}
if(!$collapsedContents.is('.collapsed-contents')){$collapsedContents=makeCollapsedContents();$collapsedContents.insertBefore($($actions[index-2]));addContentItem($collapsedContents,$($actions[index-2]));addContentItem($collapsedContents,$($actions[index-1]));}
addContentItem($collapsedContents,$li);function makeCollapsedContents(){var $li=$('<li/>').attr('class','content collapsed-contents').attr('title',_pk_translate('Live_ClickToSeeAllContents'));$('<div>').html('<img src="plugins/Morpheus/images/contentimpression.svg" class="action-list-action-icon"/>'+' <span class="content-impressions">0</span> content impressions <span class="content-interactions">0</span> interactions').appendTo($li);return $li;}
function addContentItem($collapsedContents,$otherLi){if($otherLi.find('.content-interaction').length){var $interactions=$collapsedContents.find('.content-interactions');$interactions.text(parseInt($interactions.text())+1);}else{var $impressions=$collapsedContents.find('.content-impressions');$impressions.text(parseInt($impressions.text())+1);}
$otherLi.addClass('duplicate').addClass('collapsed-content-item').val('').attr('style','');}});});$("li.pageviewActions",elem).each(function(){var $divider=$(this).find('.refresh-divider');$divider.prevUntil().addClass('duplicate');$divider.remove();var viewCount=+$(this).attr('data-view-count');if(viewCount<=1||isNaN(viewCount)){return;}
var $pageviewAction=$(this).prev();$pageviewAction.find('>div').prepend($("<span>"+viewCount+"</span>").attr({'class':'repeat icon-refresh','title':_pk_translate('Live_PageRefreshed')}));var actionsCount=+$(this).attr('data-actions-on-page');if(actionsCount===0){$pageviewAction.addClass('noPageviewActions');}
$('a',$(this)).on('focus',function(){if(tooltipIsOpened){$(this).tooltip('close');}});var $this=$(this);$pageviewAction.attr('origtitle',$pageviewAction.attr('title'));$pageviewAction.attr('title',_pk_translate('Live_ClickToViewAllActions'));$pageviewAction.click(function(e){e.preventDefault();e.stopPropagation();$pageviewAction.addClass('refreshesExpanded');$this.children('.actionList').children().first().removeClass('duplicate').nextUntil('li:not(.duplicate)').removeClass('duplicate');window.setTimeout(function(){$pageviewAction.attr('title',$pageviewAction.attr('origtitle'));$pageviewAction.attr('origtitle',null);},150);$pageviewAction.off('click').find('.icon-refresh').hide();$pageviewAction.triggerHandler('mouseleave');});});$("ol.actionList",elem).each(function(){var actionsToDisplayCollapsed=+piwik.visitorLogActionsToDisplayCollapsed;var $items=$(this).find("li:not(.pageviewActions):not(.actionsForPageExpander):not(.duplicate)");var hasMoreItemsThanLimit=$items.length>actionsToDisplayCollapsed;$(this).children('.actionsForPageExpander').toggle(hasMoreItemsThanLimit).find('.show-actions-count').text($items.length-actionsToDisplayCollapsed);setLastActionClass($(this));});elem.on('click','.collapsed-contents',function(){$(this).nextUntil(':not(.content)').toggleClass('duplicate');setLastActionClass($(this).closest('ol.actionList'));});elem.on('click','.show-less-actions,.show-more-actions',function(e){e.preventDefault();var actionsToDisplayCollapsed=+piwik.visitorLogActionsToDisplayCollapsed;var $actions=$(e.target).closest('.actionList').find('li:not(.duplicate):not(.actionsForPageExpander)');$actions.each(function(){if($actions.index(this)>=actionsToDisplayCollapsed){$(this).toggle({duration:250});}});$(e.target).parent().find('.show-less-actions,.show-more-actions').toggle();$(e.target).closest('li').toggleClass('expanded collapsed');});elem.find('.show-less-actions:visible').click();function setLastActionClass($list){$list.children(':not(.actionsForPageExpander):not(.duplicate)').removeClass('last-action').last().addClass('last-action');}}
(function($,require){var piwik=require('piwik'),exports=require('piwik/UI'),UIControl=exports.UIControl;var VisitorProfileControl=function(element){UIControl.call(this,element);this._setupControl();this._bindEventCallbacks();};VisitorProfileControl.initElements=function(){UIControl.initElements(this,'.visitor-profile');};VisitorProfileControl.showPopover=function(visitorId,idSite){var url='module=Live&action=getVisitorProfilePopup&visitorId='+encodeURIComponent(visitorId);if(idSite){url+='&idSite='+idSite;}
if($('.RealTimeMap').length>0){url+='&showMap=0';}
var ajaxRequest=new ajaxHelper();ajaxRequest.removeDefaultParameter('segment');Piwik_Popover.createPopupAndLoadUrl(url,_pk_translate('Live_VisitorProfile'),'visitor-profile-popup',ajaxRequest);};$.extend(VisitorProfileControl.prototype,UIControl.prototype,{_setupControl:function(){this.$element.focus();},_bindEventCallbacks:function(){var self=this,$element=this.$element;$element.on('click','.visitor-profile-close',function(e){e.preventDefault();try{$element.tooltip('destroy');}catch(e){}
broadcast.propagateNewPopoverParameter(false);return false;});$element.on('click','.visitor-profile-toggle-actions',function(e){e.preventDefault();$(this).toggleClass('minimized');if($(this).hasClass('minimized')){$('.visitor-profile-actions',$element).slideUp();}else{$('.visitor-profile-actions',$element).slideDown();}
return false;});$element.on('click','.visitor-profile-more-info>a',function(e){e.preventDefault();self._loadMoreVisits();return false;});$element.on('click','.visitor-profile-visit-title',function(){$('.visitor-profile-visit-details-extended',$(this).parents('li')).slideToggle();});$element.on('click','.visitor-profile-show-actions',function(){$('.visitor-profile-actions',$(this).parents('li')).slideToggle();return false;});$element.on('click','.visitor-profile-prev-visitor',function(e){e.preventDefault();self._loadPreviousVisitor();return false;});$element.on('click','.visitor-profile-next-visitor',function(e){e.preventDefault();self._loadNextVisitor();return false;});$element.on('keydown',function(e){if(e.which==37&&!e.altKey){self._loadPreviousVisitor();}else if(e.which==39&&!e.altKey){self._loadNextVisitor();}});$element.on('click','.visitor-profile-show-map',function(e){e.preventDefault();self.toggleMap();return false;});$element.on('mousedown','.visitor-profile-export',function(e){var url=$(this).attr('href');if(url.indexOf('&token_auth=')==-1){$(this).attr('href',url+'&token_auth='+piwik.token_auth);}});initializeVisitorActions($element);},toggleMap:function(){var $element=this.$element,$map=$('.visitor-profile-map',$element);if(!$map.children().length){this._loadMap($map);return;}
if($map.is(':hidden')){if($map.height()<1){$map.resize();}
$map.slideDown('slow');var newLabel='Live_HideMap';piwikHelper.lazyScrollTo($('.visitor-profile-location',$element)[0],400);}else{$map.slideUp('slow');var newLabel='Live_ShowMap';}
newLabel=_pk_translate(newLabel).replace(' ','\xA0');$('.visitor-profile-show-map',$element).text('('+newLabel+')');},_loadMap:function($map){var self=this;var ajax=new ajaxHelper();ajax.setUrl($map.attr('data-href'));ajax.setCallback(function(response){$map.html(response);self.toggleMap();});ajax.setFormat('html');ajax.setLoadingElement($('.visitor-profile-location > p > .loadingPiwik',self.$element));ajax.send();},_loadMoreVisits:function(){var self=this,$element=this.$element;var loading=$('.visitor-profile-more-info > .loadingPiwik',$element);loading.show();var ajax=new ajaxHelper();ajax.removeDefaultParameter('segment');ajax.addParams({module:'Live',action:'getVisitList',period:'',date:'',visitorId:$element.attr('data-visitor-id'),filter_offset:$('.visitor-profile-visits>li',$element).length,start_number:$('.visitor-profile-visits>li:last',$element).data('number')-1},'GET');ajax.setCallback(function(response){if(response==""){self._showNoMoreVisitsSpan();}else{response=$(response);loading.hide();$('.visitor-profile-visits',$element).append(response);if(response.filter('li').length<10){self._showNoMoreVisitsSpan();}
piwikHelper.lazyScrollTo($(response)[0],400,true);}});ajax.setFormat('html');ajax.send();},_showNoMoreVisitsSpan:function(){var noMoreSpan=$('<span/>').text(_pk_translate('Live_NoMoreVisits')).addClass('visitor-profile-no-visits');$('.visitor-profile-more-info',this.$element).html(noMoreSpan);},_loadPreviousVisitor:function(){this._gotoAdjacentVisitor(this.$element.attr('data-prev-visitor'));},_loadNextVisitor:function(){this._gotoAdjacentVisitor(this.$element.attr('data-next-visitor'));},_gotoAdjacentVisitor:function(idVisitor){if(!idVisitor){return;}
if(this._inPopover()){broadcast.propagateNewPopoverParameter('visitorProfile',idVisitor);}else if(this._inWidget()){this.$element.closest('[widgetid]').dashboardWidget('reload',false,true,{visitorId:idVisitor});}},_getFirstVisitId:function(){return $('.visitor-profile-visits>li:first-child>h2',this.$element).attr('data-idvisit');},_inPopover:function(){return!!this.$element.closest('#Piwik_Popover').length;},_inWidget:function(){return!!this.$element.closest('.widget').length;}});exports.VisitorProfileControl=VisitorProfileControl;broadcast.addPopoverHandler('visitorProfile',VisitorProfileControl.showPopover);})(jQuery,require);
(function($,require){var exports=require('piwik/UI'),DataTable=exports.DataTable,dataTablePrototype=DataTable.prototype;exports.VisitorLog=function(element){DataTable.call(this,element);};$.extend(exports.VisitorLog.prototype,dataTablePrototype,{handleColumnHighlighting:function(){},setFixWidthToMakeEllipsisWork:function(){},init:function(){dataTablePrototype.init.call(this);var self=this;initializeVisitorActions(this.$element);this.$element.on('click','.visitor-log-visitor-profile-link',function(e){e.preventDefault();broadcast.propagateNewPopoverParameter('visitorProfile',$(this).attr('data-visitor-id'));return false;});this.$element.on('click','.addSegmentToMatomo.dataTableAction',function(e){e.preventDefault();e.stopPropagation();var url=window.location.href;url=broadcast.updateParamValue('addSegmentAsNew='+decodeURIComponent(self.param.segment),url);url=broadcast.updateParamValue('popover=',url);url=broadcast.updateParamValue('category=General_Visitors',url);url=broadcast.updateParamValue('subcategory=Live_VisitorLog',url);url=broadcast.updateParamValue('segment='+self.param.segment,url);window.open(url,"_blank");});},_destroy:function(){try{this.$element.tooltip('destroy');}catch(e){}
dataTablePrototype._destroy.call(this);}});})(jQuery,require);
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){var actionName='SegmentVisitorLog';function getRawSegmentValueFromRow(tr){return $(tr).attr('data-segment-filter');}
function getDataTableFromApiMethod(apiMethod){var div=$(require('piwik/UI').DataTable.getDataTableByReport(apiMethod));if(div.length&&div.data('uiControlObject')){return div.data('uiControlObject');}}
function getMetadataFromDataTable(dataTable){if(dataTable){return dataTable.getReportMetadata();}}
function getDimensionFromApiMethod(apiMethod){if(!apiMethod){return;}
var dataTable=getDataTableFromApiMethod(apiMethod);var metadata=getMetadataFromDataTable(dataTable);if(metadata&&metadata.dimension){return metadata.dimension;}}
function DataTable_RowActions_SegmentVisitorLog(dataTable){this.dataTable=dataTable;this.actionName=actionName;this.trEventName='piwikTriggerSegmentVisitorLogAction';}
DataTable_RowActions_SegmentVisitorLog.prototype=new DataTable_RowAction();DataTable_RowActions_SegmentVisitorLog.prototype.openPopover=function(apiMethod,segment,extraParams){var urlParam=apiMethod+':'+encodeURIComponent(segment)+':'+encodeURIComponent(JSON.stringify(extraParams));broadcast.propagateNewPopoverParameter('RowAction',actionName+':'+urlParam);};DataTable_RowActions_SegmentVisitorLog.prototype.trigger=function(tr,e,subTableLabel){var segment=getRawSegmentValueFromRow(tr);if(this.dataTable.param.segment){segment=decodeURIComponent(this.dataTable.param.segment)+';'+segment;}
if(this.dataTable.props.segmented_visitor_log_segment_suffix){segment=segment+';'+this.dataTable.props.segmented_visitor_log_segment_suffix;}
this.performAction(segment,tr,e);};DataTable_RowActions_SegmentVisitorLog.prototype.performAction=function(segment,tr,e,originalRow){var apiMethod=this.dataTable.param.module+'.'+this.dataTable.param.action;var extraParams={};if(this.dataTable.param.date&&this.dataTable.param.period){extraParams={date:this.dataTable.param.date,period:this.dataTable.param.period};}
var paramOverride=$(originalRow||tr).data('param-override');if(typeof paramOverride!=='object'){paramOverride={};}
$.extend(extraParams,paramOverride);$.each(this.dataTable.param,function(index,value){if(index!=='idSite'&&index.indexOf('id')===0&&$.isNumeric(value)){extraParams[index]=value;}});this.openPopover(apiMethod,segment,extraParams);};DataTable_RowActions_SegmentVisitorLog.prototype.doOpenPopover=function(urlParam){var urlParamParts=urlParam.split(':');var apiMethod=urlParamParts.shift();var segment=decodeURIComponent(urlParamParts.shift());var extraParamsString=urlParamParts.shift(),extraParams={};try{extraParams=JSON.parse(decodeURIComponent(extraParamsString));}catch(e){}
SegmentedVisitorLog.show(apiMethod,segment,extraParams);};DataTable_RowActions_Registry.register({name:actionName,dataTableIcon:'icon-segmented-visits-log',order:30,dataTableIconTooltip:[_pk_translate('Live_RowActionTooltipTitle'),_pk_translate('Live_RowActionTooltipDefault')],isAvailableOnReport:function(dataTableParams,undefined){return true;},isAvailableOnRow:function(dataTableParams,tr){var value=getRawSegmentValueFromRow(tr);if('undefined'===(typeof value)){return false;}
var reportTitle=null;var apiMethod=$(tr).parents('div.dataTable').last().attr('data-report');var dimension=getDimensionFromApiMethod(apiMethod);if(dimension){reportTitle=_pk_translate('Live_RowActionTooltipWithDimension',[dimension])}else{reportTitle=_pk_translate('Live_RowActionTooltipDefault');}
this.dataTableIconTooltip[1]=reportTitle;return true;},createInstance:function(dataTable,param){if(dataTable!==null&&typeof dataTable.segmentVisitorLogInstance!='undefined'){return dataTable.segmentVisitorLogInstance;}
if(dataTable===null&&param){var report=param.split(':')[0];var tempTable=getDataTableFromApiMethod(report);if(tempTable){dataTable=tempTable;if(typeof dataTable.segmentVisitorLogInstance!='undefined'){return dataTable.segmentVisitorLogInstance;}}}
var instance=new DataTable_RowActions_SegmentVisitorLog(dataTable);if(dataTable!==null){dataTable.segmentVisitorLogInstance=instance;}
return instance;}});})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikLiveWidgetRefresh',piwikLiveWidgetRefresh);piwikLiveWidgetRefresh.$inject=['piwik','$timeout'];function piwikLiveWidgetRefresh(piwik,$timeout){return{restrict:'A',scope:{liveRefreshAfterMs:'@'},compile:function(element,attrs){return function(scope,element,attrs){$timeout(function(){var segment=broadcast.getValueFromHash('segment');if(!segment){segment=broadcast.getValueFromUrl('segment');}
$(element).find('#visitsLive').liveWidget({interval:scope.liveRefreshAfterMs,onUpdate:function(){var ajaxRequest=new ajaxHelper();ajaxRequest.setFormat('html');ajaxRequest.addParams({module:'Live',action:'ajaxTotalVisitors',segment:segment},'GET');ajaxRequest.setCallback(function(r){$(element).find("#visitsTotal").html(r);});ajaxRequest.send();},maxRows:10,fadeInSpeed:600,dataUrlParams:{module:'Live',action:'getLastVisitsStart',segment:segment}});});};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').factory('manageCustomVarsModel',manageCustomVarsModel);manageCustomVarsModel.$inject=['piwikApi'];function manageCustomVarsModel(piwikApi){var model={customVariables:[],extractions:[],isLoading:false,fetchUsages:fetchUsages,hasCustomVariablesInGeneral:false,hasAtLeastOneUsage:false,numSlotsAvailable:5,};return model;function fetchCustomVariables(){return piwikApi.fetch({method:'CustomVariables.getCustomVariables',period:'year',date:'today',filter_limit:1}).then(function(customVariables){model.hasCustomVariablesInGeneral=(customVariables&&customVariables.length>0);});}
function fetchUsages(){model.isLoading=true;fetchCustomVariables().then(function(){return piwikApi.fetch({method:'CustomVariables.getUsagesOfSlots',filter_limit:'-1'});}).then(function(customVariables){model.customVariables=customVariables;angular.forEach(customVariables,function(customVar){if(customVar.index>model.numSlotsAvailable){model.numSlotsAvailable=customVar.index;}
if(customVar.usages&&customVar.usages.length>0){model.hasAtLeastOneUsage=true;}});})['finally'](function(){model.isLoading=false;});}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('ManageCustomVarsController',ManageCustomVarsController);ManageCustomVarsController.$inject=['manageCustomVarsModel','piwik','$filter'];function ManageCustomVarsController(manageCustomVarsModel,piwik,$filter){manageCustomVarsModel.fetchUsages();this.model=manageCustomVarsModel;this.siteName=piwik.siteName;this.scopes=[{value:'visit',name:_pk_translate('General_TrackingScopeVisit')},{value:'page',name:_pk_translate('General_TrackingScopePage')}];}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikManageCustomVars',piwikManageCustomVars);piwikManageCustomVars.$inject=['piwik'];function piwikManageCustomVars(piwik){return{restrict:'A',scope:{},templateUrl:'plugins/CustomVariables/angularjs/manage-custom-vars/manage-custom-vars.directive.html?cb='+piwik.cacheBuster,controller:'ManageCustomVarsController',controllerAs:'manageCustomVars'};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp.service').factory('reportDeletionModel',reportDeletionModel);reportDeletionModel.$inject=['piwik','piwikApi'];function reportDeletionModel(piwik,piwikApi){var currentRequest;var isFirstLoad=true;var model={settings:{},showEstimate:false,loadingEstimation:false,estimation:'',isModified:false,isEitherDeleteSectionEnabled:isEitherDeleteSectionEnabled,reloadDbStats:reloadDbStats,savePurageDataSettings:savePurageDataSettings,updateSettings:updateSettings,initSettings:initSettings};return model;function updateSettings(settings){initSettings(settings);model.isModified=true;}
function initSettings(settings){model.settings=angular.merge({},model.settings,settings);model.reloadDbStats();}
function savePurageDataSettings(controller,apiMethod,settings){controller.isLoading=true;model.isModified=false;return piwikApi.post({module:'API',method:apiMethod},settings).then(function(){controller.isLoading=false;var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(_pk_translate('CoreAdminHome_SettingsSaveSuccess'),{context:'success',id:'privacyManagerSettings'});notification.scrollToNotification();},function(){controller.isLoading=false;});}
function isEitherDeleteSectionEnabled(){return('1'===model.settings.enableDeleteLogs||'1'===model.settings.enableDeleteReports);}
function isManualEstimationLinkShowing(){return $('#getPurgeEstimateLink').length>0;}
function reloadDbStats(forceEstimate){if(currentRequest){currentRequest.abort();}
if(forceEstimate!==true&&(!isEitherDeleteSectionEnabled()||isManualEstimationLinkShowing())){return;}
model.loadingEstimation=true;model.estimation='';model.showEstimate=false;var formData=model.settings;if(forceEstimate===true){formData['forceEstimate']=1;}
currentRequest=piwikApi.post({module:'PrivacyManager',action:'getDatabaseSize',format:'html'},formData).then(function(data){currentRequest=undefined;model.estimation=data;model.showEstimate=true;model.loadingEstimation=false;},function(){model.loadingEstimation=true;});}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('ScheduleReportDeletionController',ScheduleReportDeletionController);ScheduleReportDeletionController.$inject=['reportDeletionModel','piwikApi','$timeout'];function ScheduleReportDeletionController(reportDeletionModel,piwikApi,$timeout){var self=this;this.isLoading=false;this.dataWasPurged=false;this.showPurgeNowLink=true;this.model=reportDeletionModel;this.save=function(){var method='PrivacyManager.setScheduleReportDeletionSettings';self.model.savePurageDataSettings(this,method,{deleteLowestInterval:this.deleteLowestInterval});};this.executeDataPurgeNow=function(){if(reportDeletionModel.isModified){piwikHelper.modalConfirm('#saveSettingsBeforePurge',{yes:function(){}});return;}
piwikHelper.modalConfirm('#confirmPurgeNow',{yes:function(){self.loadingDataPurge=true;self.showPurgeNowLink=false;piwikApi.withTokenInUrl();var ajaxRequest=piwikApi.fetch({module:'PrivacyManager',action:'executeDataPurge',format:'html'}).then(function(){self.loadingDataPurge=false;reportDeletionModel.reloadDbStats();self.dataWasPurged=true;$timeout(function(){self.dataWasPurged=false;self.showPurgeNowLink=true;},2000);},function(){self.loadingDataPurge=false;});}});};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('AnonymizeIpController',AnonymizeIpController);AnonymizeIpController.$inject=['piwikApi'];function AnonymizeIpController(piwikApi){var self=this;this.isLoading=false;this.save=function(){this.isLoading=true;piwikApi.post({module:'API',method:'PrivacyManager.setAnonymizeIpSettings'},{anonymizeIPEnable:this.enabled?'1':'0',anonymizeUserId:this.anonymizeUserId?'1':'0',anonymizeOrderId:this.anonymizeOrderId?'1':'0',maskLength:this.maskLength,useAnonymizedIpForVisitEnrichment:parseInt(this.useAnonymizedIpForVisitEnrichment,10)?'1':'0'}).then(function(success){self.isLoading=false;var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(_pk_translate('CoreAdminHome_SettingsSaveSuccess'),{context:'success',id:'privacyManagerSettings'});notification.scrollToNotification();},function(){self.isLoading=false;});};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('DoNotTrackPreferenceController',DoNotTrackPreferenceController);DoNotTrackPreferenceController.$inject=['piwikApi'];function DoNotTrackPreferenceController(piwikApi){var self=this;this.isLoading=false;this.save=function(){this.isLoading=true;var action='deactivateDoNotTrack';if(this.enabled==='1'){action='activateDoNotTrack';}
piwikApi.post({module:'API',method:'PrivacyManager.'+action}).then(function(success){self.isLoading=false;var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(_pk_translate('CoreAdminHome_SettingsSaveSuccess'),{context:'success',id:'privacyManagerSettings'});notification.scrollToNotification();},function(){self.isLoading=false;});};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('DeleteOldLogsController',DeleteOldLogsController);DeleteOldLogsController.$inject=['reportDeletionModel','piwikApi','$timeout'];function DeleteOldLogsController(reportDeletionModel,piwikApi,$timeout){var self=this;this.isLoading=false;function saveSettings(){var method='PrivacyManager.setDeleteLogsSettings';reportDeletionModel.savePurageDataSettings(self,method,self.getSettings());}
this.getSettings=function(){return{enableDeleteLogs:this.enabled?'1':'0',deleteLogsOlderThan:this.deleteOlderThan};}
this.reloadDbStats=function(){reportDeletionModel.updateSettings(this.getSettings());}
$timeout(function(){reportDeletionModel.initSettings(self.getSettings());});this.save=function(){if(this.enabled){var confirmId='deleteLogsConfirm';if(reportDeletionModel.settings&&'1'===reportDeletionModel.settings.enableDeleteReports){confirmId='deleteBothConfirm';}
$('#confirmDeleteSettings').find('>h2').hide();$("#"+confirmId).show();piwikHelper.modalConfirm('#confirmDeleteSettings',{yes:saveSettings});}else{saveSettings();}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('DeleteOldReportsController',DeleteOldReportsController);DeleteOldReportsController.$inject=['reportDeletionModel','piwikApi','$timeout'];function DeleteOldReportsController(reportDeletionModel,piwikApi,$timeout){var self=this;this.isLoading=false;function getInt(value){return value?'1':'0';}
function saveSettings(){var method='PrivacyManager.setDeleteReportsSettings';reportDeletionModel.savePurageDataSettings(self,method,self.getSettings());}
this.getSettings=function(){return{enableDeleteReports:this.enabled?'1':'0',deleteReportsOlderThan:this.deleteOlderThan,keepBasic:getInt(this.keepBasic),keepDay:getInt(this.keepDataForDay),keepWeek:getInt(this.keepDataForWeek),keepMonth:getInt(this.keepDataForMonth),keepYear:getInt(this.keepDataForYear),keepRange:getInt(this.keepDataForRange),keepSegments:getInt(this.keepDataForSegments),};}
this.reloadDbStats=function(){reportDeletionModel.updateSettings(this.getSettings());}
$timeout(function(){reportDeletionModel.initSettings(self.getSettings());});this.save=function(){if(this.enabled){var confirmId='deleteReportsConfirm';if(reportDeletionModel.settings&&'1'===reportDeletionModel.settings.enableDeleteLogs){confirmId='deleteBothConfirm';}
$('#confirmDeleteSettings').find('>h2').hide();$("#"+confirmId).show();piwikHelper.modalConfirm('#confirmDeleteSettings',{yes:saveSettings});}else{saveSettings();}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('OptOutCustomizerController',OptOutCustomizerController);OptOutCustomizerController.$inject=["$scope"];function OptOutCustomizerController($scope){var vm=this;vm.piwikurl=$scope.piwikurl;vm.language=$scope.language;vm.fontSizeUnit='px';vm.fontSizeWithUnit='';vm.backgroundColor='';vm.fontColor='';vm.fontSize='';vm.fontFamily='';vm.updateFontSize=function(){if(vm.fontSize){vm.fontSizeWithUnit=vm.fontSize+vm.fontSizeUnit;}else{vm.fontSizeWithUnit="";}
this.onUpdate();};vm.onUpdate=function(){if(vm.piwikurl){if(vm.backgroundColor===''&&vm.fontColor!==''&&vm.nearlyWhite(vm.fontColor.substr(1))){$('#previewIframe').addClass('withBg');}else{$('#previewIframe').removeClass('withBg');}
var value=vm.piwikurl+"index.php?module=CoreAdminHome&action=optOut&language="+vm.language+"&backgroundColor="+vm.backgroundColor.substr(1)+"&fontColor="+vm.fontColor.substr(1)+"&fontSize="+vm.fontSizeWithUnit+"&fontFamily="+encodeURIComponent(vm.fontFamily);var isAnimationAlreadyRunning=$('.optOutCustomizer pre').queue('fx').length>0;if(value!==vm.iframeUrl&&!isAnimationAlreadyRunning){$('.optOutCustomizer pre').effect("highlight",{},1500);}
vm.iframeUrl=value;}else{vm.iframeUrl="";};}
vm.nearlyWhite=function(hex){var bigint=parseInt(hex,16);var r=(bigint>>16)&255;var g=(bigint>>8)&255;var b=bigint&255;return(r>=225&&g>=225&&b>=225);}
vm.onUpdate();$scope.$watch('piwikurl',function(val,oldVal){vm.onUpdate();});}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikOptOutCustomizer',piwikOptOutCustomizer);piwikOptOutCustomizer.$inject=['piwik'];function piwikOptOutCustomizer(piwik){var defaults={};return{restrict:'A',scope:{language:'@',piwikurl:'@'},templateUrl:'plugins/PrivacyManager/angularjs/opt-out-customizer/opt-out-customizer.directive.html?cb='+piwik.cacheBuster,controller:'OptOutCustomizerController',controllerAs:'optOutCustomizer',compile:function(element,attrs){for(var index in defaults){if(defaults.hasOwnProperty(index)&&attrs[index]===undefined){attrs[index]=defaults[index];}}
return function(scope,element,attrs){};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('ManageGdprController',ManageGdprController);ManageGdprController.$inject=["$scope","piwikApi","piwik","$timeout"];function ManageGdprController($scope,piwikApi,piwik,$timeout){var self=this;this.isLoading=false;this.isDeleting=false;this.site={id:'all',name:'All Websites'};this.segment_filter='userId==';this.dataSubjects=[];this.toggleAll=true;this.hasSearched=false
var sitesPromise=piwikApi.fetch({method:'SitesManager.getSitesIdWithAdminAccess',filter_limit:'-1'});this.linkTo=function(action){var currentUrl=window.location.pathname+window.location.search;var newUrl=piwik.broadcast.updateParamValue('module=PrivacyManager',currentUrl);newUrl=piwik.broadcast.updateParamValue('action='+action,newUrl);return newUrl;}
function showSuccessNotification(message){var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(message,{context:'success',id:'manageGdpr'});$timeout(function(){notification.scrollToNotification();},200);}
this.toggleActivateAll=function(){var toggleAll=this.toggleAll;angular.forEach(this.dataSubjects,function(dataSubject){dataSubject.dataSubjectActive=toggleAll;});};this.hasActiveDataSubjects=function(){return!!this.getActivatedDataSubjects().length;};this.getActivatedDataSubjects=function(){var visitsToDelete=[];angular.forEach(this.dataSubjects,function(visit){if(visit.dataSubjectActive){visitsToDelete.push({idsite:visit.idSite,idvisit:visit.idVisit});}});return visitsToDelete;}
this.showProfile=function(visitorId,idSite){require('piwik/UI').VisitorProfileControl.showPopover(visitorId,idSite);};this.exportDataSubject=function(){var visitsToDelete=this.getActivatedDataSubjects();piwikApi.post({module:'API',method:'PrivacyManager.exportDataSubjects',format:'json',filter_limit:-1,},{visits:visitsToDelete}).then(function(visits){showSuccessNotification('Visits were successfully exported');piwik.helper.sendContentAsDownload('exported_data_subjects.json',JSON.stringify(visits));});};this.deleteDataSubject=function(){piwik.helper.modalConfirm('#confirmDeleteDataSubject',{yes:function(){self.isDeleting=true;var visitsToDelete=self.getActivatedDataSubjects();piwikApi.post({module:'API',method:'PrivacyManager.deleteDataSubjects',filter_limit:-1,},{visits:visitsToDelete}).then(function(visits){self.dataSubjects=[];self.isDeleting=false;showSuccessNotification('Visits were successfully deleted');self.findDataSubjects();},function(){self.isDeleting=false;});}});};this.addFilter=function(segment,value){this.segment_filter+=','+segment+'=='+value;this.findDataSubjects();};this.findDataSubjects=function(){this.dataSubjects=[];this.isLoading=true;this.toggleAll=true;function addDatePadding(number){if(number<10){return'0'+number;}
return number;}
var now=new Date();var dateString=(now.getFullYear()+2)+'-'+addDatePadding(now.getMonth()+1)+'-'+addDatePadding(now.getDay());sitesPromise.then(function(idsites){var siteIds=self.site.id;if(siteIds==='all'&&!piwik.hasSuperUserAccess){siteIds=idsites;if(angular.isArray(idsites)){siteIds=idsites.join(',');}}
piwikApi.fetch({idSite:siteIds,period:'range',date:'1998-01-01,today',module:'API',method:'Live.getLastVisitsDetails',segment:self.segment_filter,filter_limit:401,doNotFetchActions:1}).then(function(visits){self.hasSearched=true;angular.forEach(visits,function(visit){visit.dataSubjectActive=true;});self.dataSubjects=visits;self.isLoading=false;},function(){self.isLoading=false;});});};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('matomoManageGdpr',matomoManageGdpr);matomoManageGdpr.$inject=['piwik'];function matomoManageGdpr(piwik){return{restrict:'A',scope:{},templateUrl:'plugins/PrivacyManager/angularjs/manage-gdpr/managegdpr.directive.html?cb='+piwik.cacheBuster,controller:'ManageGdprController',controllerAs:'manageGdpr',compile:function(element,attrs){}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('AnonymizeLogDataController',AnonymizeLogDataController);AnonymizeLogDataController.$inject=["$scope","piwikApi","piwik","$timeout"];function AnonymizeLogDataController($scope,piwikApi,piwik,$timeout){function sub(value){if(value<10){return'0'+value;}
return value;}
var self=this;var now=new Date();this.isLoading=false;this.isDeleting=false;this.anonymizeIp=false;this.anonymizeLocation=false;this.anonymizeUserId=false;this.site={id:'all',name:'All Websites'};this.availableVisitColumns=[];this.availableActionColumns=[];this.selectedVisitColumns=[{column:''}];this.selectedActionColumns=[{column:''}];this.start_date=now.getFullYear()+'-'+sub(now.getMonth()+1)+'-'+sub(now.getDay()+1);this.end_date=this.start_date;piwikApi.fetch({method:'PrivacyManager.getAvailableVisitColumnsToAnonymize'}).then(function(columns){self.availableVisitColumns=[];angular.forEach(columns,function(column){self.availableVisitColumns.push({key:column.column_name,value:column.column_name});});});piwikApi.fetch({method:'PrivacyManager.getAvailableLinkVisitActionColumnsToAnonymize'}).then(function(columns){self.availableActionColumns=[];angular.forEach(columns,function(column){self.availableActionColumns.push({key:column.column_name,value:column.column_name});});});this.onVisitColumnChange=function(){var hasAll=true;angular.forEach(this.selectedVisitColumns,function(visitColumn){if(!visitColumn||!visitColumn.column){hasAll=false;}});if(hasAll){this.addVisitColumn();}};this.addVisitColumn=function(){this.selectedVisitColumns.push({column:''});};this.removeVisitColumn=function(index){if(index>-1){var lastIndex=this.selectedVisitColumns.length-1;if(lastIndex===index){this.selectedVisitColumns[index]={column:''};}else{this.selectedVisitColumns.splice(index,1);}}};this.onActionColumnChange=function(){var hasAll=true;angular.forEach(this.selectedActionColumns,function(actionColumn){if(!actionColumn||!actionColumn.column){hasAll=false;}});if(hasAll){this.addActionColumn();}};this.addActionColumn=function(){this.selectedActionColumns.push({column:''});};this.removeActionColumn=function(index){if(index>-1){var lastIndex=this.selectedActionColumns.length-1;if(lastIndex===index){this.selectedActionColumns[index]={column:''};}else{this.selectedActionColumns.splice(index,1);}}};this.scheduleAnonymization=function(){var date=this.start_date+','+this.end_date;if(this.start_date===this.end_date){date=this.start_date;}
var params={date:date};params.idSites=this.site.id;params.anonymizeIp=this.anonymizeIp?'1':'0';params.anonymizeLocation=this.anonymizeLocation?'1':'0';params.anonymizeUserId=this.anonymizeUserId?'1':'0';params.unsetVisitColumns=[];params.unsetLinkVisitActionColumns=[];angular.forEach(this.selectedVisitColumns,function(column){if(column.column){params.unsetVisitColumns.push(column.column);}});angular.forEach(this.selectedActionColumns,function(column){if(column.column){params.unsetLinkVisitActionColumns.push(column.column);}});piwik.helper.modalConfirm('#confirmAnonymizeLogData',{yes:function(){piwikApi.post({method:'PrivacyManager.anonymizeSomeRawData'},params).then(function(){location.reload(true);});}});};$timeout(function(){var options1=piwik.getBaseDatePickerOptions(null);var options2=piwik.getBaseDatePickerOptions(null);$(".anonymizeStartDate").datepicker(options1);$(".anonymizeEndDate").datepicker(options2);});}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('matomoAnonymizeLogData',anonymizeLogData);anonymizeLogData.$inject=['piwik'];function anonymizeLogData(piwik){return{restrict:'A',scope:{},templateUrl:'plugins/PrivacyManager/angularjs/anonymize-log-data/anonymize-log-data.directive.html?cb='+piwik.cacheBuster,controller:'AnonymizeLogDataController',controllerAs:'anonymizeLogData',compile:function(element,attrs){}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($,piwik){var annotationsApi={getAnnotationManager:function(idSite,date,period,lastN,callback){var ajaxParams={module:'Annotations',action:'getAnnotationManager',idSite:idSite,date:date,period:period,filter_limit:'-1'};if(lastN){ajaxParams.lastN=lastN;}
var ajaxRequest=new ajaxHelper();ajaxRequest.addParams(ajaxParams,'get');ajaxRequest.setCallback(callback);ajaxRequest.setFormat('html');ajaxRequest.send();},addAnnotation:function(idSite,managerDate,managerPeriod,date,note,callback){var ajaxParams={module:'Annotations',action:'addAnnotation',idSite:idSite,date:date,managerDate:managerDate,managerPeriod:managerPeriod,note:note};var ajaxRequest=new ajaxHelper();ajaxRequest.addParams(ajaxParams,'get');ajaxRequest.withTokenInUrl();ajaxRequest.setCallback(callback);ajaxRequest.setFormat('html');ajaxRequest.send();},saveAnnotation:function(idSite,idNote,date,noteData,callback){var ajaxParams={module:'Annotations',action:'saveAnnotation',idSite:idSite,idNote:idNote,date:date};for(var key in noteData){ajaxParams[key]=noteData[key];}
var ajaxRequest=new ajaxHelper();ajaxRequest.addParams(ajaxParams,'get');ajaxRequest.withTokenInUrl();ajaxRequest.setCallback(callback);ajaxRequest.setFormat('html');ajaxRequest.send();},deleteAnnotation:function(idSite,idNote,managerDate,managerPeriod,callback){var ajaxParams={module:'Annotations',action:'deleteAnnotation',idSite:idSite,idNote:idNote,date:managerDate,period:managerPeriod};var ajaxRequest=new ajaxHelper();ajaxRequest.addParams(ajaxParams,'get');ajaxRequest.withTokenInUrl();ajaxRequest.setCallback(callback);ajaxRequest.setFormat('html');ajaxRequest.send();},getEvolutionIcons:function(idSite,date,period,lastN,callback){var ajaxParams={module:'Annotations',action:'getEvolutionIcons',idSite:idSite,date:date,period:period,filter_limit:'-1'};if(lastN){ajaxParams.lastN=lastN;}
var ajaxRequest=new ajaxHelper();ajaxRequest.addParams(ajaxParams,'get');ajaxRequest.setFormat('html');ajaxRequest.setCallback(callback);ajaxRequest.send();}};var today=new Date();var getDatePickerOptions=function(annotation){var annotationDateStr=annotation.attr('data-date'),parts=annotationDateStr.split('-'),annotationDate=new Date(parts[0],parts[1]-1,parts[2]);var result=piwik.getBaseDatePickerOptions(annotationDate);result.showButtonPanel=true;result.currentText=_pk_translate('Intl_Today');var piwikMinDate=result.minDate;result.beforeShowDay=function(date){var valid=true;if(date>today||date<piwikMinDate){valid=false;}
return[valid,''];};result.onSelect=function(dateText){$('.annotation-period-edit>a',annotation).text(dateText);$('.datepicker',annotation).hide();};return result;};var toggleAnnotationMode=function(inAnnotationElement){var annotation=$(inAnnotationElement).closest('.annotation');annotation.toggleClass('edit')
$('.annotation-period,.annotation-period-edit,.delete-annotation,'+'.annotation-edit-mode,.annotation-view-mode',annotation).toggle();return $(inAnnotationElement).find('.annotation-value');};var createDatePicker=function(annotation){$('.datepicker',annotation).datepicker(getDatePickerOptions(annotation)).hide();};var createDatePickers=function(manager){$('.annotation-period-edit',manager).each(function(){createDatePicker($(this).parent().parent());});};var replaceAnnotationManager=function(manager,html){var newManager=$(html);manager.html(newManager.html()).attr('data-date',newManager.attr('data-date')).attr('data-period',newManager.attr('data-period'));createDatePickers(manager);};var isAnnotationStarred=function(annotation){return!!(+$('.annotation-star',annotation).attr('data-starred')==1);};var replaceAnnotationHtml=function(annotation,html){var newHtml=$(html);annotation.html(newHtml.html()).attr('data-date',newHtml.attr('data-date'));createDatePicker(annotation);};var bindAnnotationManagerEvents=function(manager,idSite,onAnnotationCountChange){if(!onAnnotationCountChange){onAnnotationCountChange=function(){};}
manager.on('click','.add-annotation',function(e){e.preventDefault();var $newRow=$('.new-annotation-row',manager);$newRow.show();$(this).hide();return false;});manager.on('click','.new-annotation-cancel',function(){var newAnnotationRow=$(this).parent().parent();newAnnotationRow.hide();$('.add-annotation',newAnnotationRow.closest('.annotation-manager')).show();});manager.on('click','.new-annotation-save',function(){var addRow=$(this).parent().parent(),addNoteInput=addRow.find('.new-annotation-edit'),noteDate=addRow.find('.annotation-period-edit>a').text();if(!addNoteInput.val()){return;}
addNoteInput.attr('disabled','disabled');$(this).attr('disabled','disabled');annotationsApi.addAnnotation(idSite,manager.attr('data-date'),manager.attr('data-period'),noteDate,addNoteInput.val(),function(response){replaceAnnotationManager(manager,response);onAnnotationCountChange(noteDate,1,0);});});manager.on('keypress','.new-annotation-edit',function(e){if(e.which==13){$(this).parent().find('.new-annotation-save').click();}});manager.on('click','.annotation-enter-edit-mode',function(e){e.preventDefault();var annotationContent=toggleAnnotationMode(this);annotationContent.find('.annotation-edit').focus();return false;});manager.on('click','.annotation-cancel',function(){toggleAnnotationMode(this);});manager.on('click','.annotation-edit-mode .annotation-save',function(){var annotation=$(this).parent().parent().parent(),input=$('.annotation-edit',annotation),dateEditText=$('.annotation-period-edit>a',annotation).text();if(input[0].defaultValue==input.val()&&dateEditText==annotation.attr('data-date')){toggleAnnotationMode(this);return;}
input.attr('disabled','disabled');$(this).attr('disabled','disabled');annotationsApi.saveAnnotation(idSite,annotation.attr('data-id'),dateEditText,{note:input.val()},function(response){response=$(response);var newDate=response.attr('data-date'),isStarred=isAnnotationStarred(response),originalDate=annotation.attr('data-date');replaceAnnotationHtml(annotation,response);if(originalDate!=newDate){onAnnotationCountChange(originalDate,-1,isStarred?-1:0);onAnnotationCountChange(newDate,1,isStarred?1:0);}});});manager.on('keypress','.annotation-value input',function(e){if(e.which==13){$(this).parent().find('.annotation-save').click();}});manager.on('click','.delete-annotation',function(e){e.preventDefault();var annotation=$(this).parent().parent();$(this).attr('disabled','disabled');annotationsApi.deleteAnnotation(idSite,annotation.attr('data-id'),manager.attr('data-date'),manager.attr('data-period'),function(response){replaceAnnotationManager(manager,response);var isStarred=isAnnotationStarred(annotation);onAnnotationCountChange(annotation.attr('data-date'),-1,isStarred?-1:0);});return false;});manager.on('click','.annotation-star-changeable',function(e){var annotation=$(this).parent().parent(),newStarredVal=$(this).attr('data-starred')==0?1:0;annotationsApi.saveAnnotation(idSite,annotation.attr('data-id'),annotation.attr('data-date'),{starred:newStarredVal},function(response){replaceAnnotationHtml(annotation,response);onAnnotationCountChange(annotation.attr('data-date'),0,newStarredVal==0?-1:1);});});manager.on('click','.annotation-period-edit>a',function(e){e.preventDefault();$('.datepicker',$(this).parent()).toggle();return false;});$('body').on('mouseup',function(e){var container=$('.annotation-period-edit>.datepicker:visible').parent();if(!container.has(e.target).length){container.find('.datepicker').hide();}});};var loadingAnnotationManager=false;var showAnnotationViewer=function(domElem,idSite,date,period,lastN,callback){var addToAnnotationCount=function(date,amt,starAmt){if(date.indexOf(',')!=-1){date=date.split(',')[0];}
$('.evolution-annotations>span[data-date]',domElem).each(function(){if($(this).attr('data-date')==date){var starredCount=+$(this).attr('data-starred'),annotationCount=+$(this).attr('data-count');var newStarCount=starredCount+starAmt;var newAnno='icon-annotation';if(newStarCount>0){newAnno+=' starred';}
$(this).attr('data-starred',newStarCount).find('span').attr('class',newAnno);var newCount=annotationCount+amt;$(this).attr('data-count',newCount).css('opacity',newCount>0?1:0);return false;}});};var manager=$('.annotation-manager',domElem);if(manager.length){if(manager.attr('data-date')==date&&manager.attr('data-period')==period){if(manager.is(':hidden')){manager.slideDown('slow',function(){if(callback)callback(manager)});}
else{manager.slideUp('slow',function(){if(callback)callback(manager)});}}
else{$('.annotations',manager).html('');$('.loadingPiwik',manager).show();annotationsApi.getAnnotationManager(idSite,date,period,lastN,function(response){replaceAnnotationManager(manager,response);createDatePickers(manager);if(manager.is(':hidden')){manager.slideDown('slow',function(){if(callback)callback(manager)});}
else{if(callback){callback(manager);}}});}}
else{if(loadingAnnotationManager){return;}
loadingAnnotationManager=true;$('.loadingPiwikBelow',domElem).insertAfter($('.evolution-annotations',domElem));var loading=$('.loadingPiwikBelow',domElem).css({display:'block'});annotationsApi.getAnnotationManager(idSite,date,period,lastN,function(response){var manager=$(response).hide();if(!manager.hasClass('annotation-manager')){return;}
createDatePickers(manager);bindAnnotationManagerEvents(manager,idSite,addToAnnotationCount);loading.css('visibility','hidden');manager.insertAfter($('.evolution-annotations',domElem));manager.slideDown('slow',function(){loading.hide().css('visibility','visible');loadingAnnotationManager=false;if(callback)callback(manager)});});}};var placeEvolutionIcons=function(annotations,graphElem){var canvases=$('.piwik-graph .jqplot-xaxis canvas',graphElem),noteSize=16;if(!canvases||canvases.length==0){$('span[data-date]',annotations).hide();return true;}
$('span[data-date]',annotations).each(function(i){var canvas=$(canvases[i]),canvasCenterX=canvas.position().left+(canvas.width()/ 2);$(this).css({left:canvasCenterX-noteSize / 2,opacity:+$(this).attr('data-count')>0?1:0});});};piwik.annotations={showAnnotationViewer:showAnnotationViewer,placeEvolutionIcons:placeEvolutionIcons,api:annotationsApi};}(jQuery,piwik));
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('DelegateMobileMessagingSettingsController',DelegateMobileMessagingSettingsController);DelegateMobileMessagingSettingsController.$inject=['piwikApi','piwik'];function DelegateMobileMessagingSettingsController(piwikApi,piwik){var self=this;this.isLoading=false;this.save=function(){this.isLoading=true;piwikApi.post({method:'MobileMessaging.setDelegatedManagement'},{delegatedManagement:(this.enabled=='1')?'true':'false'}).then(function(){var UI=require('piwik/UI');var notification=new UI.Notification();notification.show(_pk_translate('CoreAdminHome_SettingsSaveSuccess'),{id:'mobileMessagingSettings',context:'success'});notification.scrollToNotification();piwik.helper.redirect();self.isLoading=false;},function(){self.isLoading=false;});};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('ManageSmsProviderController',ManageSmsProviderController);ManageSmsProviderController.$inject=['piwikApi','piwik'];function ManageSmsProviderController(piwikApi,piwik){var self=this;this.isDeletingAccount=false;this.isUpdatingAccount=false;this.showAccountForm=false;this.isUpdateAccountPossible=false;this.credentials='{}';function deleteApiAccount(){self.isDeletingAccount=true;piwikApi.fetch({method:'MobileMessaging.deleteSMSAPICredential'},{placeat:'#ajaxErrorManageSmsProviderSettings'}).then(function(){self.isDeletingAccount=false;piwik.helper.redirect();},function(){self.isDeletingAccount=false;});}
this.showUpdateAccount=function(){this.showAccountForm=true;};this.isUpdateAccountPossible=function(){var self=this;self.canBeUpdated=!!this.smsProvider;var credentials=angular.fromJson(this.credentials);angular.forEach(credentials,function(value,key){if(value==''){self.canBeUpdated=false;}});return self.canBeUpdated;};this.updateAccount=function(){if(this.isUpdateAccountPossible()){this.isUpdatingAccount=true;piwikApi.post({method:'MobileMessaging.setSMSAPICredential'},{provider:this.smsProvider,credentials:angular.fromJson(this.credentials)},{placeat:'#ajaxErrorManageSmsProviderSettings'}).then(function(){self.isUpdatingAccount=false;piwik.helper.redirect();},function(){self.isUpdatingAccount=false;});}};this.deleteAccount=function(){piwikHelper.modalConfirm('#confirmDeleteAccount',{yes:deleteApiAccount});};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('ManageMobilePhoneNumbersController',ManageMobilePhoneNumbersController);ManageMobilePhoneNumbersController.$inject=['piwikApi','piwik'];function ManageMobilePhoneNumbersController(piwikApi,piwikk){var self=this;this.isAddingPhonenumber=false;this.canAddNumber=false;this.isActivated={};this.validateActivationCode=function(phoneNumber,index){if(!this.validationCode||!this.validationCode[index]||this.validationCode[index]==''){return;}
var verificationCode=this.validationCode[index];var success=function(response){self.isChangingPhoneNumber=false;var UI=require('piwik/UI');var notification=new UI.Notification();if(!response||!response.value){var message=_pk_translate('MobileMessaging_Settings_InvalidActivationCode');notification.show(message,{context:'error',id:'MobileMessaging_ValidatePhoneNumber'});}
else{var message=_pk_translate('MobileMessaging_Settings_PhoneActivated')
notification.show(message,{context:'success',id:'MobileMessaging_ValidatePhoneNumber'});self.isActivated[index]=true;}
notification.scrollToNotification();};this.isChangingPhoneNumber=true;piwikApi.post({method:'MobileMessaging.validatePhoneNumber'},{phoneNumber:phoneNumber,verificationCode:verificationCode},{placeat:'#invalidVerificationCodeAjaxError'}).then(success,function(){self.isChangingPhoneNumber=false;});}
this.removePhoneNumber=function(phoneNumber){if(!phoneNumber){return;}
this.isChangingPhoneNumber=true;piwikApi.post({method:'MobileMessaging.removePhoneNumber'},{phoneNumber:phoneNumber},{placeat:'#invalidVerificationCodeAjaxError'}).then(function(){self.isChangingPhoneNumber=false;piwik.helper.redirect();},function(){self.isChangingPhoneNumber=false;});}
this.validateNewPhoneNumberFormat=function(){this.showSuspiciousPhoneNumber=$.trim(this.newPhoneNumber).lastIndexOf('0',0)===0;this.canAddNumber=!!this.newPhoneNumber&&this.newPhoneNumber!='';};this.addPhoneNumber=function(){var phoneNumber='+'+this.countryCallingCode+this.newPhoneNumber;if(this.canAddNumber&&phoneNumber.length>1){this.isAddingPhonenumber=true;piwikApi.post({method:'MobileMessaging.addPhoneNumber'},{phoneNumber:phoneNumber},{placeat:'#ajaxErrorAddPhoneNumber'}).then(function(){self.isAddingPhonenumber=false;piwik.helper.redirect();},function(){self.isAddingPhonenumber=false;});}}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('smsProviderCredentials',smsProviderCredentials);function smsProviderCredentials(){return{restrict:'A',require:"^ngModel",transclude:true,scope:{provider:'=',credentials:'=value'},template:'<ng-include src="getTemplateUrl()"/>',controllerAs:'ProviderCredentials',controller:function($scope){$scope.getTemplateUrl=function(){return'?module=MobileMessaging&action=getCredentialFields&provider='+$scope.provider;};},link:function(scope,elm,attrs,ctrl){if(!ctrl){return;}
scope.$watch('credentials',function(val,oldVal){ctrl.$setViewValue(JSON.stringify(val));},true);scope.$watch('provider',function(val,oldVal){if(val!=oldVal){scope.credentials={};}},true);}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
function DataTable_RowActions_Overlay(dataTable){this.dataTable=dataTable;}
DataTable_RowActions_Overlay.prototype=new DataTable_RowAction;DataTable_RowActions_Overlay.registeredReports=[];DataTable_RowActions_Overlay.registerReport=function(handler){DataTable_RowActions_Overlay.registeredReports.push(handler);};DataTable_RowActions_Overlay.prototype.onClick=function(actionA,tr,e,originalRow){if(!actionA.data('overlay-manipulated')){actionA.data('overlay-manipulated',1);var segment,link;var i=0;for(i;i<DataTable_RowActions_Overlay.registeredReports.length;i++){var report=DataTable_RowActions_Overlay.registeredReports[i];if(report&&report.onClick&&report.isAvailableOnReport&&report.isAvailableOnReport(this.dataTable.param)){var result=report.onClick.apply(this,arguments);if(!result||!result.link){return;}
link=result.link;if(result.segment){segment=result.segment;}
break;}}
var paramOverride=$(originalRow||tr).data('param-override');if(typeof paramOverride==='object'&&paramOverride.segment){if(segment){segment+=';'+paramOverride.segment;}else{segment=paramOverride.segment;}}
if(link){var href=Overlay_Helper.getOverlayLink(this.dataTable.param.idSite,'month','today',segment,link);actionA.attr({target:'_blank',href:href});}}
return true;};DataTable_RowActions_Registry.register({name:'Overlay',dataTableIcon:'icon-overlay',order:30,dataTableIconTooltip:[_pk_translate('General_OverlayRowActionTooltipTitle'),_pk_translate('General_OverlayRowActionTooltip')],createInstance:function(dataTable){return new DataTable_RowActions_Overlay(dataTable);},isAvailableOnReport:function(dataTableParams){if(!window.DataTable_RowActions_Transitions){return false;}
var i=0;for(i;i<DataTable_RowActions_Overlay.registeredReports.length;i++){var report=DataTable_RowActions_Overlay.registeredReports[i];if(report&&report.isAvailableOnReport&&report.isAvailableOnReport(dataTableParams)){return true;}}
return false;},isAvailableOnRow:function(dataTableParams,tr){var transitions=DataTable_RowActions_Registry.getActionByName('Transitions');return transitions.isAvailableOnRow(dataTableParams,tr);}});
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
var Overlay_Helper={encodeFrameUrl:function(url){return encodeURIComponent(url).replace(/%/g,'$')},decodeFrameUrl:function(url){return decodeURIComponent(url.replace(/\$/g,'%'));},getOverlayLink:function(idSite,period,date,segment,link){var url='index.php?module=Overlay&period='+encodeURIComponent(period)+'&date='+encodeURIComponent(date)+'&idSite='+encodeURIComponent(idSite);if(segment){url+='&segment='+encodeURIComponent(segment);}
var token_auth=piwik.broadcast.getValueFromUrl("token_auth");if(token_auth.length&&piwik.shouldPropagateTokenAuth){url+='&token_auth='+encodeURIComponent(token_auth);}
if(link){url+='#?l='+Overlay_Helper.encodeFrameUrl(link);}
return url;}};
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
Segmentation=(function($){piwikHelper.registerShortcut('s',_pk_translate('CoreHome_ShortcutSegmentSelector'),function(event){if(event.altKey){return;}
if(event.preventDefault){event.preventDefault();}else{event.returnValue=false;}
$('.segmentListContainer .segmentationContainer .title').trigger('click').focus();});var segmentation=function segmentation(config){if(!config.target){throw new Error("target property must be set in config to segment editor control element");}
var self=this;self.currentSegmentStr="";self.segmentAccess="read";self.availableSegments=[];for(var item in config){self[item]=config[item];}
self.editorTemplate=self.editorTemplate.detach();self.timer="";self.searchAllowed=true;self.filterTimer="";self.filterAllowed=true;self.availableMatches=[];self.availableMatches["metric"]=[];self.availableMatches["metric"]["=="]=self.translations['General_OperationEquals'];self.availableMatches["metric"]["!="]=self.translations['General_OperationNotEquals'];self.availableMatches["metric"]["<="]=self.translations['General_OperationAtMost'];self.availableMatches["metric"][">="]=self.translations['General_OperationAtLeast'];self.availableMatches["metric"]["<"]=self.translations['General_OperationLessThan'];self.availableMatches["metric"][">"]=self.translations['General_OperationGreaterThan'];self.availableMatches["dimension"]=[];self.availableMatches["dimension"]["=="]=self.translations['General_OperationIs'];self.availableMatches["dimension"]["!="]=self.translations['General_OperationIsNot'];self.availableMatches["dimension"]["=@"]=self.translations['General_OperationContains'];self.availableMatches["dimension"]["!@"]=self.translations['General_OperationDoesNotContain'];self.availableMatches["dimension"]["=^"]=self.translations['General_OperationStartsWith'];self.availableMatches["dimension"]["=$"]=self.translations['General_OperationEndsWith'];segmentation.prototype.setAvailableSegments=function(segments){this.availableSegments=segments;};segmentation.prototype.getSegment=function(){var self=this;return self.currentSegmentStr;};segmentation.prototype.setSegment=function(segmentStr){this.currentSegmentStr=segmentStr;};segmentation.prototype.setTooltip=function(segmentDescription){var title=_pk_translate('SegmentEditor_ChooseASegment')+'.';title+=' '+_pk_translate('SegmentEditor_CurrentlySelectedSegment',[segmentDescription]);$(this.content).attr('title',title);};segmentation.prototype.markComparedSegments=function(){var comparisonService=piwikHelper.getAngularDependency('piwikComparisonsService');var comparedSegments=comparisonService.getSegmentComparisons().map(function(comparison){return comparison.params.segment;});$('div.segmentList ul li[data-definition]',this.target).removeClass('comparedSegment').filter(function(){var definition=$(this).attr('data-definition');return comparedSegments.indexOf(definition)!==-1||comparedSegments.indexOf(decodeURIComponent(definition))!==-1;}).each(function(){$(this).addClass('comparedSegment');});};segmentation.prototype.markCurrentSegment=function(){var current=this.getSegment();var segmentationTitle=$(this.content).find(".segmentationTitle");var title;if(current!=""){var selector='div.segmentList ul li[data-definition="'+current+'"]';var foundItems=$(selector,this.target);if(foundItems.length===0){try{currentDecoded=piwikHelper.htmlDecode(current);selector='div.segmentList ul li[data-definition="'+currentDecoded+'"]';foundItems=$(selector,this.target);}catch(e){}}
if(foundItems.length===0){try{currentDecoded=piwikHelper.htmlDecode(decodeURIComponent(current));selector='div.segmentList ul li[data-definition="'+currentDecoded+'"]';foundItems=$(selector,this.target);}catch(e){}}
if(foundItems.length>0){var idSegment=$(foundItems).first().attr('data-idsegment');title=getSegmentName(getSegmentFromId(idSegment));}else{title=_pk_translate('SegmentEditor_CustomSegment');}
segmentationTitle.addClass('segment-clicked').html(title);this.setTooltip(title);}
else{title=this.translations['SegmentEditor_DefaultAllVisits'];segmentationTitle.text(title);this.setTooltip(title);}};function handleAddNewSegment(){var segmentToAdd=broadcast.getValueFromHash('addSegmentAsNew')||broadcast.getValueFromUrl('addSegmentAsNew');if(segmentToAdd){showAddNewSegmentForm({definition:decodeURIComponent(segmentToAdd)});}}
var getSegmentFromId=function(id){if(self.availableSegments.length>0){for(var i=0;i<self.availableSegments.length;i++){var segment=self.availableSegments[i];if(segment.idsegment==id){return segment;}}}
return false;};var getListHtml=function(){var html=self.editorTemplate.find("> .listHtml").clone();var segment,injClass;var listHtml='<li data-idsegment="" '+
(self.currentSegmentStr==""?" class='segmentSelected'":"")
+' data-definition=""><span class="segname" tabindex="4">'+self.translations['SegmentEditor_DefaultAllVisits']
+' '+self.translations['General_DefaultAppended']
+'</span>';var comparisonService=piwikHelper.getAngularDependency('piwikComparisonsService');if(comparisonService.isComparisonEnabled()||comparisonService.isComparisonEnabled()===null){listHtml+='<span class="compareSegment allVisitsCompareSegment" title="'+_pk_translate('SegmentEditor_CompareThisSegment')+'"></span>';}
listHtml+='</li>';var isVisibleToSuperUserNoticeAlreadyDisplayedOnce=false;var isVisibleToSuperUserNoticeShouldBeClosed=false;var isSharedWithMeBySuperUserNoticeAlreadyDisplayedOnce=false;var isSharedWithMeBySuperUserNoticeShouldBeClosed=false;if(self.availableSegments.length>0){for(var i=0;i<self.availableSegments.length;i++){segment=self.availableSegments[i];if(isSegmentSharedWithMeBySuperUser(segment)&&!isSharedWithMeBySuperUserNoticeAlreadyDisplayedOnce){isSharedWithMeBySuperUserNoticeAlreadyDisplayedOnce=true;isSharedWithMeBySuperUserNoticeShouldBeClosed=true;listHtml+='<span class="segmentsSharedWithMeBySuperUser"><hr> '+_pk_translate('SegmentEditor_SharedWithYou')+':<br/><br/>';}
if(isSegmentVisibleToSuperUserOnly(segment)&&!isVisibleToSuperUserNoticeAlreadyDisplayedOnce){if(isSharedWithMeBySuperUserNoticeShouldBeClosed){isSharedWithMeBySuperUserNoticeShouldBeClosed=false;listHtml+='</span>';}
isVisibleToSuperUserNoticeAlreadyDisplayedOnce=true;isVisibleToSuperUserNoticeShouldBeClosed=true;listHtml+='<span class="segmentsVisibleToSuperUser"><hr> '+_pk_translate('SegmentEditor_VisibleToSuperUser')+':<br/><br/>';}
injClass="";var checkSelected=segment.definition;if(checkSelected==self.currentSegmentStr||checkSelected==decodeURIComponent(self.currentSegmentStr)){injClass='class="segmentSelected"';}
listHtml+='<li data-idsegment="'+segment.idsegment+'" data-definition="'+(segment.definition).replace(/"/g,'&quot;')+'" '
+injClass+' title="'+getSegmentTooltipEnrichedWithUsername(segment)+'"><span class="segname" tabindex="4">'+getSegmentName(segment)+'</span>';if(self.segmentAccess=="write"){listHtml+='<span class="editSegment" title="'+self.translations['General_Edit'].toLocaleLowerCase()+'"></span>';}
if(comparisonService.isComparisonEnabled()||comparisonService.isComparisonEnabled()===null){listHtml+='<span class="compareSegment" title="'+_pk_translate('SegmentEditor_CompareThisSegment')+'"></span>';}
listHtml+='</li>';}
if(isVisibleToSuperUserNoticeShouldBeClosed){listHtml+='</span>';}
if(isSharedWithMeBySuperUserNoticeShouldBeClosed){listHtml+='</span>';}
$(html).find(".segmentList > ul").append(listHtml);if(self.segmentAccess==="write"){$(html).find(".add_new_segment").html(self.translations['SegmentEditor_AddNewSegment']);}
else{$(html).find(".add_new_segment").hide();}}
else{$(html).find(".segmentList > ul").append(listHtml);}
return html;};var isSegmentVisibleToSuperUserOnly=function(segment){return hasSuperUserAccessAndSegmentCreatedByAnotherUser(segment)&&segment.enable_all_users==0;};var isSegmentSharedWithMeBySuperUser=function(segment){return segment.login!=piwik.userLogin&&segment.enable_all_users==1;};var hasSuperUserAccessAndSegmentCreatedByAnotherUser=function(segment){return piwik.hasSuperUserAccess&&segment.login!=piwik.userLogin;};var getSegmentTooltipEnrichedWithUsername=function(segment){var segmentName=segment.name;if(hasSuperUserAccessAndSegmentCreatedByAnotherUser(segment)){segmentName+=' (';segmentName+=_pk_translate('General_CreatedByUser',[segment.login]);if(segment.enable_all_users==0){segmentName+=', '+_pk_translate('SegmentEditor_VisibleToSuperUser');}
segmentName+=')';}
return sanitiseSegmentName(segmentName);};var getSegmentName=function(segment){return sanitiseSegmentName(segment.name);};var sanitiseSegmentName=function(segment){segment=piwikHelper.escape(segment);return segment;};var getFormHtml=function(){var html=self.editorTemplate.find("> .segment-element").clone();var segmentsDropdown=$(html).find(".available_segments_select");var segment,newOption;newOption='<option data-idsegment="" data-definition="" title="'
+self.translations['SegmentEditor_AddNewSegment']
+'">'+self.translations['SegmentEditor_AddNewSegment']
+'</option>';segmentsDropdown.append(newOption);for(var i=0;i<self.availableSegments.length;i++){segment=self.availableSegments[i];newOption='<option data-idsegment="'+segment.idsegment+'" data-definition="'+(segment.definition).replace(/"/g,'&quot;')+'" title="'+getSegmentTooltipEnrichedWithUsername(segment)+'">'+getSegmentName(segment)+'</option>';segmentsDropdown.append(newOption);}
$(html).find(".segment-content > h3").after('<div piwik-segment-generator add-initial-condition="true"></div>').show();return html;};var closeAllOpenLists=function(){$(".segmentationContainer",self.target).each(function(){if($(this).closest('.segmentEditorPanel').hasClass("expanded"))
$(this).trigger("click");});};var openEditForm=function(segment){addForm("edit",segment);$(self.form).find(".segment-content > h3 > span").html(getSegmentName(segment)).prop('title',getSegmentTooltipEnrichedWithUsername(segment));$(self.form).find('.available_segments_select > option[data-idsegment="'+segment.idsegment+'"]').prop("selected",true);$(self.form).find('.available_segments a.dropList').html(getSegmentName(segment)).prop('title',getSegmentTooltipEnrichedWithUsername(segment));$(self.form).find(".metricList").each(function(){$(this).trigger("change",true);});};var displayFormAddNewSegment=function(segment){closeAllOpenLists();addForm("new",segment);};function showAddNewSegmentForm(segment){var parameters={isAllowed:true};var $rootScope=piwikHelper.getAngularDependency('$rootScope');$rootScope.$emit('Segmentation.initAddSegment',parameters);if(parameters&&!parameters.isAllowed){return;}
displayFormAddNewSegment(segment);}
var filterSegmentList=function(keyword){var curTitle;clearFilterSegmentList();$(self.target).find(" .filterNoResults").remove();$(self.target).find(".segmentList li").each(function(){curTitle=$(this).prop('title');$(this).hide();if(curTitle.toLowerCase().indexOf(keyword.toLowerCase())!==-1){$(this).show();}});if($(self.target).find(".segmentList li:visible").length==0){$(self.target).find(".segmentList li:first").before("<li class=\"filterNoResults grayed\">"+self.translations['General_SearchNoResults']+"</li>");}
if($(self.target).find(".segmentList .segmentsVisibleToSuperUser li:visible").length==0){$(self.target).find(".segmentList .segmentsVisibleToSuperUser").hide();}
if($(self.target).find(".segmentList .segmentsSharedWithMeBySuperUser li:visible").length==0){$(self.target).find(".segmentList .segmentsSharedWithMeBySuperUser").hide();}};var clearFilterSegmentList=function(){$(self.target).find(" .filterNoResults").remove();$(self.target).find(".segmentList li").each(function(){$(this).show();});$(self.target).find(".segmentList .segmentsVisibleToSuperUser").show();$(self.target).find(".segmentList .segmentsSharedWithMeBySuperUser").show();};var bindEvents=function(){self.target.on('click','.segmentationContainer',function(e){if(self.content.closest('.segmentEditorPanel').hasClass("expanded")){if($(e.target).hasClass("jspDrag")===true||$(e.target).hasClass("segmentFilterContainer")===true||$(e.target).parents().hasClass("segmentFilterContainer")===true||$(e.target).hasClass("filterNoResults")){e.stopPropagation();}else{if(self.jscroll){self.jscroll.destroy();}
self.target.closest('.segmentEditorPanel').removeClass('expanded');}}else{closeAllOpenLists();self.target.closest('.segmentEditorPanel').addClass('expanded');self.target.find('.segmentFilter').val(self.translations['General_Search']).trigger('keyup');self.jscroll=self.target.find(".segmentList").jScrollPane({autoReinitialise:true,showArrows:true}).data().jsp;}});self.target.on('click','.editSegment',function(e){$(this).closest(".segmentationContainer").trigger("click");var target=$(this).parent("li");openEditFormGivenSegment(target);e.stopPropagation();e.preventDefault();});self.target.on('click','.compareSegment',function(e){e.stopPropagation();e.preventDefault();var comparisonService=piwikHelper.getAngularDependency('piwikComparisonsService');comparisonService.addSegmentComparison({segment:$(e.target).closest('li').data('definition'),});self.markComparedSegments();closeAllOpenLists();});self.target.on("click",".segmentList li",function(e){if($(e.currentTarget).hasClass("grayed")!==true){var idsegment=$(this).attr("data-idsegment");segmentDefinition=$(this).data("definition");if(!piwikHelper.isAngularRenderingThePage()){self.setSegment(segmentDefinition);}
self.markCurrentSegment();self.segmentSelectMethod(segmentDefinition);toggleLoadingMessage(segmentDefinition.length);}});self.target.on('click','.add_new_segment',function(e){e.stopPropagation();showAddNewSegmentForm();});self.target.on("keyup",".segmentList li, .add_new_segment",function(event){var keycode=(event.keyCode?event.keyCode:(event.which?event.which:event.key));if(keycode=='13'){$(this).trigger('click');}});self.target.on('click',".segmentFilterContainer span",function(e){$(e.target).parent().find(".segmentFilter").val(self.translations['General_Search']).trigger('keyup');});self.target.on('blur',".segmentFilter",function(e){if($(e.target).parent().find(".segmentFilter").val()==""){$(e.target).parent().find(".segmentFilter").val(self.translations['General_Search'])}});self.target.on('click',".segmentFilter",function(e){if($(e.target).val()==self.translations['General_Search']){$(e.target).val("");}});self.target.on('keyup',".segmentFilter",function(e){var search=$(e.currentTarget).val();if(search==self.translations['General_Search']){search="";}
if(search.length>=2){clearTimeout(self.filterTimer);self.filterAllowed=true;self.filterTimer=setTimeout(function(){filterSegmentList(search);},500);}
else{self.filterTimer=false;clearFilterSegmentList();}});self.target.on('click',"a.editSegmentName",function(e){var $h3=$(e.currentTarget).parents("h3");$h3.css({'margin':'0 0 0 6px'});var oldName=$h3.find("span").text();$h3.find("span").hide();$(e.currentTarget).hide();$(e.currentTarget).before('<input class="edit_segment_name" type="text"/>');$(e.currentTarget).siblings(".edit_segment_name").focus().val(oldName);});self.target.on("click",".segmentName",function(e){$(self.form).find("a.editSegmentName").trigger('click');});self.target.on('blur',"input.edit_segment_name",function(e){var newName=$(this).val();var segmentNameNode=$(e.currentTarget).parents("h3").find("span");if(newName.trim()){segmentNameNode.text(newName);}else{$(this).val(segmentNameNode.text());}});self.target.on('click','.segment-element',function(e){e.stopPropagation();e.preventDefault();});self.target.on('change','.available_segments_select',function(e){var option=$(e.currentTarget).find('option:selected');openEditFormGivenSegment(option);});self.target.on('click',".delete",function(){var segmentName=$(self.form).find(".segment-content > h3 > span").text();var segmentId=$(self.form).find(".available_segments_select option:selected").attr("data-idsegment");var params={"idsegment":segmentId};$('#segment-delete-confirm').find('#name').text(segmentName);if(segmentId!=""){piwikHelper.modalConfirm($('#segment-delete-confirm'),{yes:function(){self.deleteMethod(params);}});}});self.target.on("click","a.close",function(e){$(".segmentListContainer",self.target).show();closeForm();});$("body").on("keyup",function(e){if(e.keyCode=="27"||e.which===27){if(self.target.find('[uicontrol="expandable-select"] .expandableList:visible').length){return;}
if(Piwik_Popover.isOpen()){Piwik_Popover.close();return;}
$(".segmentListContainer",self.target).show();closeForm();}});};var getAddOrBlockButtonHtml=function(){if(typeof addOrBlockButton==="undefined"){var addOrBlockButton=self.editorTemplate.find("div.segment-add-or").clone();}
return addOrBlockButton.clone();};function openEditFormGivenSegment(option){var idsegment=option.attr("data-idsegment");if(idsegment.length==0){displayFormAddNewSegment();}else{var segment=getSegmentFromId(idsegment);segment.definition=option.data("definition");openEditForm(segment);}}
var normalizeSearchString=function(search){search=search.replace(/^\s+|\s+$/g,'');search=search.toLowerCase();var from="àáäâèéëêìíïîòóöôùúüûñç·/_,:;";var to="aaaaeeeeiiiioooouuuunc------";for(var i=0,l=from.length;i<l;i++){search=search.replace(new RegExp(from.charAt(i),'g'),to.charAt(i));}
search=search.replace(/[^a-z0-9 -]/g,'').replace(/\s+/g,'_').replace(/-+/g,'-');return search;};var addForm=function(mode,segment){self.target.find(".segment-element:visible").unbind().remove();if(typeof self.form!=="undefined"){closeForm();}
self.form=getFormHtml();self.target.prepend(self.form);piwikHelper.setMarginLeftToBeInViewport(self.form);if(self.form.width()+self.target.offset().left>$(window).width()&&self.form.width()<self.target.offset().left+self.target.width()){self.form.addClass('anchorRight');}
if(mode=="edit"){$(self.form).find('.enable_all_users_select > option[value="'+segment.enable_all_users+'"]').prop("selected",true);if(hasSuperUserAccessAndSegmentCreatedByAnotherUser(segment)){$(self.form).find('.enable_all_users_select > option[value="'+0+'"]').text(segment.login);}
$(self.form).find('.visible_to_website_select > option[value="'+segment.enable_only_idsite+'"]').prop("selected",true);$(self.form).find('.auto_archive_select > option[value="'+segment.auto_archive+'"]').prop("selected",true);}
if(segment!==undefined&&segment.definition!=""){self.form.find('[piwik-segment-generator]').attr('segment-definition',segment.definition);}
makeDropList(".enable_all_users",".enable_all_users_select");makeDropList(".visible_to_website",".visible_to_website_select");makeDropList(".auto_archive",".auto_archive_select");makeDropList(".available_segments",".available_segments_select");$(self.form).find(".saveAndApply").bind("click",function(e){e.preventDefault();parseFormAndSave();});$(self.form).find(".testSegment").bind("click",function(e){e.preventDefault();testSegment();});if(typeof mode!=="undefined"&&mode=="new"){$(self.form).find(".editSegmentName").trigger('click');}
$(".segmentListContainer",self.target).hide();self.target.closest('.segmentEditorPanel').addClass('editing');piwikHelper.compileAngularComponents(self.target);};var closeForm=function(){$(self.form).unbind().remove();self.target.closest('.segmentEditorPanel').removeClass('editing');};function getSegmentGeneratorController(){return angular.element(self.form.find('.segment-generator')).scope().segmentGenerator;}
var parseFormAndSave=function(){var segmentName=$(self.form).find(".segment-content > h3 >span").text();var segmentStr=getSegmentGeneratorController().getSegmentString();var segmentId=$(self.form).find('.available_segments_select > option:selected').attr("data-idsegment");var user=$(self.form).find(".enable_all_users_select option:selected").val();var autoArchive=$(self.form).find(".auto_archive_select option:selected").val()||0;var params={"name":segmentName,"definition":segmentStr,"enabledAllUsers":user,"autoArchive":autoArchive,"idSite":$(self.form).find(".visible_to_website_select option:selected").val()};if(segmentId===""){self.addMethod(params);}
else{jQuery.extend(params,{"idSegment":segmentId});if(segmentStr!=getSegmentFromId(segmentId).definition&&$('.segment-definition-change-confirm').data('hideMessage')!=1){var isBrowserArchivingAvailableForSegments=$('.segment-definition-change-confirm').data('segmentProcessedOnRequest');var isRealTimeSegment=(autoArchive==0);var segmentNotProcessedOnRequest=!isBrowserArchivingAvailableForSegments||!isRealTimeSegment;$('.process-on-request, .no-process-on-request').hide();if(segmentNotProcessedOnRequest){$('.no-process-on-request').show();}else{$('.process-on-request').show();}
piwikHelper.modalConfirm('.segment-definition-change-confirm',{yes:function(){if($('#hideSegmentMessage:checked').length){var ajaxHandler=new ajaxHelper();ajaxHandler.setLoadingElement();ajaxHandler.addParams({"module":'API',"format":'json',"method":'UsersManager.setUserPreference',"userLogin":piwik.userLogin,"preferenceName":"hideSegmentDefinitionChangeMessage","preferenceValue":"1"},'GET');ajaxHandler.useCallbackInCaseOfError();ajaxHandler.setCallback(function(response){self.updateMethod(params);});ajaxHandler.send();}else{self.updateMethod(params);}}});}else{self.updateMethod(params);}}};var testSegment=function(){var segmentStr=getSegmentGeneratorController().getSegmentString();var encSegment=jQuery(jQuery('.segmentEditorPanel').get(0)).data('uiControlObject').uriEncodeSegmentDefinition(segmentStr);var url=window.location.href;url=url.replace(/\?[\S]*\?/,'?');url=broadcast.updateParamValue('viewDataTable=VisitorLog',url);url=broadcast.updateParamValue('module=Live',url);url=broadcast.updateParamValue('action=getLastVisitsDetails',url);url=broadcast.updateParamValue('segment='+encSegment,url);url=broadcast.updateParamValue('inPopover=1',url);Piwik_Popover.createPopupAndLoadUrl(url,_pk_translate('Live_VisitsLog'));};var makeDropList=function(spanId,selectId){var select=$(self.form).find(selectId).hide();var dropList=$('<a class="dropList dropdown">').insertAfter(select).text(select.children(':selected').text()).autocomplete({delay:0,minLength:0,appendTo:"body",source:function(request,response){response(select.children("option").map(function(){var text=$(this).text();return{label:text,value:this.value,option:this};}));},select:function(event,ui){event.preventDefault();ui.item.option.selected=true;$(spanId+' option[value="'+ui.item.value+'"]',self.editorTemplate).prop('selected',true);dropList.text(ui.item.label);$(self.form).find(selectId).trigger("change");}}).click(function(){$("a.dropList").autocomplete("close");if($(this).autocomplete("widget").is(":visible")){$(this).autocomplete("close");return;}
$(this).autocomplete("search","");});$('body').on('mouseup',function(e){if(!$(e.target).parents(spanId).length&&!$(e.target).is(spanId)&&!$(e.target).parents(spanId).length&&!$(e.target).parents(".ui-autocomplete").length&&!$(e.target).is(".ui-autocomplete")&&!$(e.target).parents(".ui-autocomplete").length){dropList.autocomplete().autocomplete("close");}});};function toggleLoadingMessage(segmentIsSet){if(segmentIsSet){$('#ajaxLoadingDiv').find('.loadingSegment').show();}else{$('#ajaxLoadingDiv').find('.loadingSegment').hide();}}
this.initHtml=function(){var self=this;var html=getListHtml();if(typeof self.content!=="undefined"){this.content.html($(html).html());}else{this.target.append(html);this.content=this.target.find(".segmentationContainer");}
this.markCurrentSegment();setTimeout(function(){self.markComparedSegments();});var segmentIsSet=this.getSegment().length;toggleLoadingMessage(segmentIsSet);};if(piwikHelper.isAngularRenderingThePage()){angular.element(document).injector().invoke(function($rootScope,$location){$rootScope.$on('$locationChangeSuccess',function(){var $search=$location.search();var segment='';if('undefined'!==typeof $search.segment&&null!==$search.segment){segment=$search.segment}
if(self.getSegment()!=segment){self.setSegment(segment);self.initHtml();}else{setTimeout(function(){self.markComparedSegments();});}});});}
this.initHtml();bindEvents();handleAddNewSegment();};return segmentation;})(jQuery);$(document).ready(function(){var exports=require('piwik/UI');var UIControl=exports.UIControl;var SegmentSelectorControl=function(element){UIControl.call(this,element);if((typeof this.props.isSegmentNotAppliedBecauseBrowserArchivingIsDisabled!="undefined")&&this.props.isSegmentNotAppliedBecauseBrowserArchivingIsDisabled){piwikHelper.modalConfirm($('.pleaseChangeBrowserAchivingDisabledSetting',this.$element),{yes:function(){}});}
var self=this;this.uriEncodeSegmentDefinition=function(segmentDefinition){segmentDefinition=cleanupSegmentDefinition(segmentDefinition);segmentDefinition=encodeURIComponent(segmentDefinition);return segmentDefinition;};this.changeSegment=function(segmentDefinition){if(piwikHelper.isAngularRenderingThePage()){angular.element(document).injector().invoke(function($location,$rootScope){var $search=$location.search();if(segmentDefinition!==$search.segment){$search.segment=segmentDefinition.replace(/%$/,'%25').replace(/%([^\d].)/g,"%25$1");$location.search($search);setTimeout(function(){try{$rootScope.$apply();}catch(e){}},1);}});return false;}else{return this.forceSegmentReload(segmentDefinition);}};this.forceSegmentReload=function(segmentDefinition){segmentDefinition=this.uriEncodeSegmentDefinition(segmentDefinition);if(piwikHelper.isAngularRenderingThePage()){return broadcast.propagateNewPage('',true,'addSegmentAsNew=&segment='+segmentDefinition,['compareSegments','comparePeriods']);}else{return broadcast.propagateNewPage('segment='+segmentDefinition,true,'addSegmentAsNew=&segment='+segmentDefinition,['compareSegments','comparePeriods']);}};this.changeSegmentList=function(){};var cleanupSegmentDefinition=function(definition){definition=definition.replace(/'/g,"%27");definition=definition.replace(/&/g,"%26");return definition;};var addSegment=function(params){var ajaxHandler=new ajaxHelper();ajaxHandler.setLoadingElement();params.definition=cleanupSegmentDefinition(params.definition);ajaxHandler.addParams($.extend({},params,{"module":'API',"format":'json',"method":'SegmentEditor.add'}),'GET');ajaxHandler.useCallbackInCaseOfError();ajaxHandler.setCallback(function(response){if(response&&response.result=='error'){alert(response.message);}else{params.idsegment=response.value;self.props.availableSegments.push(params);self.rebuild();self.impl.markCurrentSegment();self.$element.find('a.close').click();self.forceSegmentReload(params.definition);self.changeSegmentList(self.props.availableSegments);}});ajaxHandler.send();};var updateSegment=function(params){var ajaxHandler=new ajaxHelper();ajaxHandler.setLoadingElement();params.definition=cleanupSegmentDefinition(params.definition);ajaxHandler.addParams($.extend({},params,{"module":'API',"format":'json',"method":'SegmentEditor.update'}),'GET');ajaxHandler.useCallbackInCaseOfError();ajaxHandler.setCallback(function(response){if(response&&response.result=='error'){alert(response.message);}else{params.idsegment=params.idSegment;var idx=null;for(idx in self.props.availableSegments){if(self.props.availableSegments[idx].idsegment==params.idSegment){break;}}
$.extend(self.props.availableSegments[idx],params);self.rebuild();self.impl.markCurrentSegment();self.$element.find('a.close').click();self.forceSegmentReload(params.definition);self.changeSegmentList(self.props.availableSegments);}});ajaxHandler.send();};var deleteSegment=function(params){var ajaxHandler=new ajaxHelper();ajaxHandler.addParams({module:'API',format:'json',method:'SegmentEditor.delete'},'GET');ajaxHandler.addParams({idSegment:params.idsegment},'POST');ajaxHandler.setLoadingElement();ajaxHandler.useCallbackInCaseOfError();ajaxHandler.setCallback(function(response){if(response&&response.result=='error'){alert(response.message);}else{self.impl.setSegment('');self.impl.markCurrentSegment();var idx=null;for(idx in self.props.availableSegments){if(self.props.availableSegments[idx].idsegment==params.idsegment){break;}}
self.props.availableSegments.splice(idx,1);self.rebuild();self.$element.find('a.close').click();self.forceSegmentReload('');$('.ui-dialog-content').dialog('close');self.changeSegmentList(self.props.availableSegments);}});ajaxHandler.send();};function getSegmentFromRequest(){var hashStr=broadcast.getHashFromUrl();var segmentFromRequest;if(hashStr&&hashStr.indexOf('segment=')!==-1){segmentFromRequest=broadcast.getValueFromHash('segment');}else{segmentFromRequest=broadcast.getValueFromHash('segment')||encodeURIComponent(self.props.selectedSegment)||broadcast.getValueFromUrl('segment');}
segmentFromRequest=decodeURIComponent(segmentFromRequest);return segmentFromRequest;}
var segmentFromRequest=getSegmentFromRequest();var userSegmentAccess=(this.props.authorizedToCreateSegments)?"write":"read";this.impl=new Segmentation({"target":this.$element.find(".segmentListContainer"),"editorTemplate":$('.SegmentEditor',self.$element),"segmentAccess":userSegmentAccess,"availableSegments":this.props.availableSegments,"addMethod":addSegment,"updateMethod":updateSegment,"deleteMethod":deleteSegment,"segmentSelectMethod":function(){self.changeSegment.apply(self,arguments);},"currentSegmentStr":segmentFromRequest,"translations":this.props.segmentTranslations});this.onMouseUp=function(e){if($(e.target).closest('.segment-element').length===0&&!$(e.target).is('.segment-element')&&$(e.target).hasClass("ui-corner-all")==false&&$(e.target).hasClass("ddmetric")==false&&$(e.target).hasClass("ui-icon-closethick")==false&&$(e.target).hasClass("ui-button-text")==false&&$(".segment-element:visible",self.$element).length==1){if(Piwik_Popover.isOpen()){Piwik_Popover.close();}else{$(".segment-element:visible a.close",self.$element).click();}}
if($(e.target).closest('.segmentListContainer').length===0&&self.$element.hasClass("expanded")){$(".segmentationContainer",self.$element).trigger("click");}};$('body').on('mouseup',this.onMouseUp);initTopControls();piwikHelper.getAngularDependency('$rootScope').$emit('piwikSegmentationInited');};SegmentSelectorControl.initElements=function(){UIControl.initElements(this,'.segmentEditorPanel');};$.extend(SegmentSelectorControl.prototype,UIControl.prototype,{getSegment:function(){return this.impl.getSegment();},setSegment:function(segment){return this.impl.setSegment(segment);},rebuild:function(){this.impl.setAvailableSegments(this.props.availableSegments);this.impl.initHtml();},_destroy:function(){UIControl.prototype._destroy.call(this);$('body').off('mouseup',null,this.onMouseUp);}});exports.SegmentSelectorControl=SegmentSelectorControl;});
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').factory('segmentGeneratorModel',segmentGeneratorModel);segmentGeneratorModel.$inject=['piwikApi','piwik'];function segmentGeneratorModel(piwikApi,piwik){var initialSegments=null;var limitPromise=null;var fetchedSiteId=null;var model={isLoading:false,segments:[],loadSegments:loadSegments};return model;function loadSegments(siteId,visitSegmentsOnly){if(model.isLoading){if(limitPromise){limitPromise.abort();limitPromise=null;}}
model.isLoading=true;if(fetchedSiteId!=siteId){limitPromise=null;fetchedSiteId=siteId;}
if(!limitPromise){var params={method:'API.getSegmentsMetadata',filter_limit:'-1','_hideImplementationData':0};if(siteId==='all'||!siteId){params.idSites='all';params.idSite='all';}else if(siteId){params.idSites=siteId;params.idSite=siteId;}
limitPromise=piwikApi.fetch(params);}
return limitPromise.then(function(response){model.isLoading=false;if(angular.isDefined(response)){if(visitSegmentsOnly){model.segments=[];angular.forEach(response,function(segment){if(segment.sqlSegment&&segment.sqlSegment.match(/log_visit\./)){model.segments.push(segment);}});}else{model.segments=response;}}
return model.segments;}).finally(function(){model.isLoading=false;});}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('SegmentGeneratorController',SegmentGeneratorController);SegmentGeneratorController.$inject=['$scope','piwik','piwikApi','segmentGeneratorModel','$filter','$timeout'];var findAndExplodeByMatch=function(metric){var matches=["==","!=","<=",">=","=@","!@","<",">","=^","=$"];var newMetric={};var minPos=metric.length;var match,index;var singleChar=false;for(var key=0;key<matches.length;key++){match=matches[key];index=metric.indexOf(match);if(index!==-1){if(index<minPos){minPos=index;if(match.length===1){singleChar=true;}}}}
if(minPos<metric.length){if(singleChar==true){newMetric.segment=metric.substr(0,minPos);newMetric.matches=metric.substr(minPos,1);newMetric.value=decodeURIComponent(metric.substr(minPos+1));}else{newMetric.segment=metric.substr(0,minPos);newMetric.matches=metric.substr(minPos,2);newMetric.value=decodeURIComponent(metric.substr(minPos+2));}
if(newMetric.value==='""'){newMetric.value="";}}
try{newMetric.value=decodeURIComponent(newMetric.value);}catch(e){}
return newMetric;};function generateUniqueId(){var id='';var chars='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';for(var i=1;i<=10;i++){id+=chars.charAt(Math.floor(Math.random()*chars.length));}
return id;}
function stripTags(text){if(text){text=(''+text).replace(/(<([^>]+)>)/ig,"");}
return text;}
function SegmentGeneratorController($scope,piwik,piwikApi,segmentGeneratorModel,$filter,$timeout){var translate=$filter('translate');var self=this;var firstSegment='';var firstMatch='';this.conditions=[];this.model=segmentGeneratorModel;this.segments={};this.matches={metric:[{key:'==',value:translate('General_OperationEquals')},{key:'!=',value:translate('General_OperationNotEquals')},{key:'<=',value:translate('General_OperationAtMost')},{key:'>=',value:translate('General_OperationAtLeast')},{key:'<',value:translate('General_OperationLessThan')},{key:'>',value:translate('General_OperationGreaterThan')}],dimension:[{key:'==',value:translate('General_OperationIs')},{key:'!=',value:translate('General_OperationIsNot')},{key:'=@',value:translate('General_OperationContains')},{key:'!@',value:translate('General_OperationDoesNotContain')},{key:'=^',value:translate('General_OperationStartsWith')},{key:'=$',value:translate('General_OperationEndsWith')}],};this.matches['']=this.matches.dimension;this.andConditionLabel='';this.addNewAndCondition=function(){var condition={orConditions:[]};this.addAndCondition(condition);this.addNewOrCondition(condition);return condition;};this.addAndCondition=function(condition){this.andConditionLabel=translate('SegmentEditor_OperatorAND');this.conditions.push(condition);this.updateSegmentDefinition();}
this.addNewOrCondition=function(condition){var orCondition={segment:firstSegment,matches:firstMatch,value:''};this.addOrCondition(condition,orCondition);};this.addOrCondition=function(condition,orCondition){orCondition.isLoading=false;orCondition.id=generateUniqueId();condition.orConditions.push(orCondition);this.updateSegmentDefinition();$timeout(function(){self.updateAutocomplete(orCondition);});};this.updateAutocomplete=function(orCondition){orCondition.isLoading=true;this.updateSegmentDefinition();var resolved=false;var promise=piwikApi.fetch({module:'API',format:'json',method:'API.getSuggestedValuesForSegment',segmentName:orCondition.segment},{createErrorNotification:false});promise.then(function(response){orCondition.isLoading=false;resolved=true;var inputElement=$('.orCondId'+orCondition.id+" .metricValueBlock input");if(response&&response.result!='error'){inputElement.autocomplete({source:response,minLength:0,select:function(event,ui){event.preventDefault();orCondition.value=ui.item.value;self.updateSegmentDefinition();$timeout(function(){$scope.$apply();});}});}
inputElement.off('click');inputElement.click(function(e){$(inputElement).autocomplete('search',orCondition.value);});},function(response){resolved=true;orCondition.isLoading=false;var inputElement=$('.orCondId'+orCondition.id+" .metricValueBlock input");inputElement.autocomplete({source:[],minLength:0});$(inputElement).autocomplete('search',orCondition.value);});$timeout(function(){if(!resolved){promise.abort();}},20000);};this.removeOrCondition=function(condition,orCondition){var index=condition.orConditions.indexOf(orCondition);if(index>-1){condition.orConditions.splice(index,1);}
if(condition.orConditions.length===0){var index=self.conditions.indexOf(condition);if(index>-1){self.conditions.splice(index,1);}
if(self.conditions.length===0){self.andConditionLabel='';}}
this.updateSegmentDefinition();};this.getSegmentString=function(){var segmentStr='';angular.forEach(this.conditions,function(conditions){var subSegmentStr='';angular.forEach(conditions.orConditions,function(orCondition){if(subSegmentStr!==''){subSegmentStr+=",";}
subSegmentStr+=orCondition.segment+orCondition.matches+encodeURIComponent(encodeURIComponent(orCondition.value));});if(segmentStr!==''){segmentStr+=";";}
segmentStr+=subSegmentStr;});return segmentStr;};this.setSegmentString=function(segmentStr){var orCondition,condition;this.conditions=[];if(!segmentStr){return;}
var blocks=segmentStr.split(';');for(var key=0;key<blocks.length;key++){condition={orConditions:[]};this.addAndCondition(condition);blocks[key]=blocks[key].split(',');for(var innerkey=0;innerkey<blocks[key].length;innerkey++){orCondition=findAndExplodeByMatch(blocks[key][innerkey]);this.addOrCondition(condition,orCondition);}}};this.updateSegmentDefinition=function(){$scope.segmentDefinition=this.getSegmentString();};if($scope.segmentDefinition){this.setSegmentString($scope.segmentDefinition);}
$scope.$watch('idsite',function(newValue,oldValue){if(newValue!=oldValue){reloadSegments(newValue,$scope.visitSegmentsOnly);}});reloadSegments($scope.idsite,$scope.visitSegmentsOnly);function reloadSegments(idsite,visitSegmentsOnly){segmentGeneratorModel.loadSegments(idsite,visitSegmentsOnly).then(function(segments){self.segmentList=[];var groups={};angular.forEach(segments,function(segment){if(!segment.category){segment.category='Others';}
if(!firstSegment){firstSegment=segment.segment;if(segment.type&&self.matches[segment.type]){firstMatch=self.matches[segment.type][0].key;}else{firstMatch=self.matches[''][0].key}}
self.segments[segment.segment]=segment;var segmentData={group:segment.category,key:segment.segment,value:segment.name};if('acceptedValues'in segment&&segment.acceptedValues){segmentData.tooltip=stripTags(segment.acceptedValues);}
self.segmentList.push(segmentData);});if($scope.addInitialCondition&&self.conditions.length===0){self.addNewAndCondition();}});}}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikSegmentGenerator',piwikSegmentGenerator);piwikSegmentGenerator.$inject=['$document','piwik','$filter','$timeout'];function piwikSegmentGenerator($document,piwik,$filter,$timeout){var defaults={segmentDefinition:'',addInitialCondition:false,visitSegmentsOnly:false,idsite:piwik.idSite};return{restrict:'A',scope:{segmentDefinition:'@',addInitialCondition:'=',visitSegmentsOnly:'=',idsite:'='},require:"?ngModel",templateUrl:'plugins/SegmentEditor/angularjs/segment-generator/segmentgenerator.directive.html?cb='+piwik.cacheBuster,controller:'SegmentGeneratorController',controllerAs:'segmentGenerator',compile:function(element,attrs){for(var index in defaults){if(attrs[index]===undefined){attrs[index]=defaults[index];}}
return function(scope,element,attrs,ngModel){if(ngModel){ngModel.$render=function(){scope.segmentDefinition=ngModel.$viewValue;if(scope.segmentDefinition){scope.segmentGenerator.setSegmentString(scope.segmentDefinition);}else{scope.segmentGenerator.setSegmentString('');}};}
scope.$watch('segmentDefinition',function(newValue){if(ngModel){ngModel.$setViewValue(newValue);}});};}};}})();
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($,require){var exports=require('piwik/UI'),DataTable=exports.DataTable,dataTablePrototype=DataTable.prototype;var UIControl=exports.UIControl;function getValueFromEvent(event){return event.target.value?event.target.value:$(event.target).attr('value');}
exports.InsightsDataTable=function(element){this.parentAttributeParent='';this.parentId='';this.disabledRowDom={};if($(element).attr('data-table-onlyinsightsinit')){UIControl.call(this,element);this._init($(element));this.workingDivId=this._createDivId();$(element).attr('id',this.workingDivId);}else{DataTable.call(this,element);}};$.extend(exports.InsightsDataTable.prototype,dataTablePrototype,{handleRowActions:function(){},_init:function(domElem){this.initShowIncreaseOrDecrease(domElem);this.initOrderBy(domElem);this.initComparedToXPeriodsAgo(domElem);this.initFilterBy(domElem);this.setFixWidthToMakeEllipsisWork(domElem);$(domElem).find('select').material_select();},setFixWidthToMakeEllipsisWork:function(domElem){var width=domElem.width();if(width){$('td.label',domElem).width(parseInt(width*0.50,10));}
var self=this;if(!this.windowResizeTableAttached){this.windowResizeTableAttached=true;var timeout=null;var resizeDataTable=function(){if(timeout){clearTimeout(timeout);}
timeout=setTimeout(function(){var isInDom=domElem&&domElem[0]&&document&&document.body&&document.body.contains(domElem[0]);if(isInDom){$('td.label',domElem).width('');self.setFixWidthToMakeEllipsisWork(domElem);}else{$(window).off('resize',resizeDataTable);}
timeout=null;},Math.floor((Math.random()*80)+220));}
$(window).on('resize',resizeDataTable);}},_changeParameter:function(params){var widgetParams={};for(var index in params){if(params.hasOwnProperty(index)){this.param[index]=params[index];widgetParams[index]=params[index];}}
this.notifyWidgetParametersChange(this.$element,widgetParams);},_changeParameterAndReload:function(params){this._changeParameter(params);this.reloadAjaxDataTable(true);},initShowIncreaseOrDecrease:function(domElem){var self=this;$('[name=showIncreaseOrDecrease]',domElem).bind('change',function(event){var value=getValueFromEvent(event);self._changeParameterAndReload({limit_increaser:(value=='both'||value=='increase')?'5':'0',limit_decreaser:(value=='both'||value=='decrease')?'5':'0'});});},initOrderBy:function(domElem){var self=this;$('[name=orderBy]',domElem).bind('change',function(event){self._changeParameterAndReload({order_by:getValueFromEvent(event)});});$('th[name=orderBy]',domElem).bind('click',function(event){self._changeParameterAndReload({order_by:getValueFromEvent(event)});});},initComparedToXPeriodsAgo:function(domElem){var self=this;$('[name=comparedToXPeriodsAgo]',domElem).bind('change',function(event){self._changeParameterAndReload({compared_to_x_periods_ago:getValueFromEvent(event)});});},initFilterBy:function(domElem){var self=this;$('[name=filterBy]',domElem).bind('change',function(event){self._changeParameterAndReload({filter_by:getValueFromEvent(event)});});}});})(jQuery,require);
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function($,require){var exports=require('piwik/UI'),DataTable=exports.DataTable,dataTablePrototype=DataTable.prototype;exports.ContentsDataTable=function(element){DataTable.call(this,element);};$.extend(exports.ContentsDataTable.prototype,dataTablePrototype,{_init:function(domElem){domElem.find('table > tbody > tr').each(function(index,tr){var $tr=$(tr);var $td=$tr.find('.label .value');var text=$td.text().trim();if(text.search('^https?:\/\/[^\/]+')!==-1){if(text.match(/(.jpg|.gif|.png|.svg)$/)){if(window.encodeURI){text=window.encodeURI(text);}
$td.tooltip({track:true,items:'span',content:'<p><img style="max-width: 150px;max-height:150px;" src="'+text+'"/><br />'+text+'</p>',tooltipClass:'rowActionTooltip',show:false,hide:false});}}});}});})(jQuery,require);
/*!
 * Piwik - free/libre analytics platform
 *
 * @link http://piwik.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){var actionName='visitorDetails';function DataTable_RowActions_VisitorDetails(dataTable){this.dataTable=dataTable;this.actionName=actionName;this.trEventName='piwikTriggerVisitorDetailsAction';}
DataTable_RowActions_VisitorDetails.prototype=new DataTable_RowAction();DataTable_RowActions_VisitorDetails.prototype.performAction=function(label,tr,e){var visitorId=this.getRowMetadata($(tr)).idvisitor||'';visitorId=encodeURIComponent(visitorId);if(visitorId.length>0){DataTable_RowAction.prototype.openPopover.apply(this,['module=Live&action=getVisitorProfilePopup&visitorId='+visitorId]);}};DataTable_RowActions_VisitorDetails.prototype.doOpenPopover=function(urlParam){Piwik_Popover.createPopupAndLoadUrl(urlParam,_pk_translate('Live_VisitorProfile'),'visitor-profile-popup');};DataTable_RowActions_Registry.register({name:actionName,instance:null,dataTableIcon:'icon-visitor-profile',order:30,dataTableIconTooltip:[_pk_translate('Live_ViewVisitorProfile'),''],isAvailableOnReport:function(dataTableParams,undefined){return dataTableParams.module=='UserId';},isAvailableOnRow:function(dataTableParams,tr){return DataTable_RowAction.prototype.getRowMetadata(tr).hasOwnProperty('idvisitor');},createInstance:function(dataTable,param){if(dataTable!==null&&typeof dataTable.visitorDetailsInstance!='undefined'){return dataTable.segmentVisitorLogInstance;}
var instance=new DataTable_RowActions_VisitorDetails(dataTable);if(dataTable!==null){dataTable.visitorDetailsInstance=instance;}
this.instance=instance;return instance;}});})();
var tourEngagement={skipChallenge:function(key){var $challenge=$('.tourEngagement .'+key+' ');$challenge.find('.icon-hide').removeClass('icon-hide').addClass('icon-ok');var ajaxRequest=new ajaxHelper();ajaxRequest.addParams({module:'API',method:'Tour.skipChallenge',id:key},'get');ajaxRequest.withTokenInUrl();ajaxRequest.setFormat('json');ajaxRequest.send();},goToPage:function(page){var ajaxRequest=new ajaxHelper();ajaxRequest.addParams({module:'Tour',action:'getEngagement',page:page},'get');ajaxRequest.withTokenInUrl();ajaxRequest.setFormat('html');ajaxRequest.setCallback(function(callback){$('.widgetBody.tourEngagement').parent().html(callback);})
ajaxRequest.send();}};
/*!
 * jquery-timepicker v1.11.1 - A jQuery timepicker plugin inspired by Google Calendar. It supports both mouse and keyboard navigation.
 * Copyright (c) 2016 Jon Thornton - http://jonthornton.github.com/jquery-timepicker/
 * License: MIT
 */

!function(a){"object"==typeof exports&&exports&&"object"==typeof module&&module&&module.exports===exports?a(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(a){var b=a[0];return b.offsetWidth>0&&b.offsetHeight>0}function c(b){if(b.minTime&&(b.minTime=t(b.minTime)),b.maxTime&&(b.maxTime=t(b.maxTime)),b.durationTime&&"function"!=typeof b.durationTime&&(b.durationTime=t(b.durationTime)),"now"==b.scrollDefault)b.scrollDefault=function(){return b.roundingFunction(t(new Date),b)};else if(b.scrollDefault&&"function"!=typeof b.scrollDefault){var c=b.scrollDefault;b.scrollDefault=function(){return b.roundingFunction(t(c),b)}}else b.minTime&&(b.scrollDefault=function(){return b.roundingFunction(b.minTime,b)});if("string"===a.type(b.timeFormat)&&b.timeFormat.match(/[gh]/)&&(b._twelveHourTime=!0),b.showOnFocus===!1&&-1!=b.showOn.indexOf("focus")&&b.showOn.splice(b.showOn.indexOf("focus"),1),b.disableTimeRanges.length>0){for(var d in b.disableTimeRanges)b.disableTimeRanges[d]=[t(b.disableTimeRanges[d][0]),t(b.disableTimeRanges[d][1])];b.disableTimeRanges=b.disableTimeRanges.sort(function(a,b){return a[0]-b[0]});for(var d=b.disableTimeRanges.length-1;d>0;d--)b.disableTimeRanges[d][0]<=b.disableTimeRanges[d-1][1]&&(b.disableTimeRanges[d-1]=[Math.min(b.disableTimeRanges[d][0],b.disableTimeRanges[d-1][0]),Math.max(b.disableTimeRanges[d][1],b.disableTimeRanges[d-1][1])],b.disableTimeRanges.splice(d,1))}return b}function d(b){var c=b.data("timepicker-settings"),d=b.data("timepicker-list");if(d&&d.length&&(d.remove(),b.data("timepicker-list",!1)),c.useSelect){d=a("<select />",{"class":"ui-timepicker-select"});var g=d}else{d=a("<ul />",{"class":"ui-timepicker-list"});var g=a("<div />",{"class":"ui-timepicker-wrapper",tabindex:-1});g.css({display:"none",position:"absolute"}).append(d)}if(c.noneOption)if(c.noneOption===!0&&(c.noneOption=c.useSelect?"Time...":"None"),a.isArray(c.noneOption)){for(var i in c.noneOption)if(parseInt(i,10)==i){var k=e(c.noneOption[i],c.useSelect);d.append(k)}}else{var k=e(c.noneOption,c.useSelect);d.append(k)}if(c.className&&g.addClass(c.className),(null!==c.minTime||null!==c.durationTime)&&c.showDuration){"function"==typeof c.step?"function":c.step;g.addClass("ui-timepicker-with-duration"),g.addClass("ui-timepicker-step-"+c.step)}var l=c.minTime;"function"==typeof c.durationTime?l=t(c.durationTime()):null!==c.durationTime&&(l=c.durationTime);var n=null!==c.minTime?c.minTime:0,o=null!==c.maxTime?c.maxTime:n+u-1;n>o&&(o+=u),o===u-1&&"string"===a.type(c.timeFormat)&&c.show2400&&(o=u);var p=c.disableTimeRanges,v=0,x=p.length,y=c.step;"function"!=typeof y&&(y=function(){return c.step});for(var i=n,z=0;o>=i;z++,i+=60*y(z)){var A=i,B=s(A,c);if(c.useSelect){var C=a("<option />",{value:B});C.text(B)}else{var C=a("<li />");C.addClass(43200>A%86400?"ui-timepicker-am":"ui-timepicker-pm"),C.data("time",86400>=A?A:A%86400),C.text(B)}if((null!==c.minTime||null!==c.durationTime)&&c.showDuration){var D=r(i-l,c.step);if(c.useSelect)C.text(C.text()+" ("+D+")");else{var E=a("<span />",{"class":"ui-timepicker-duration"});E.text(" ("+D+")"),C.append(E)}}x>v&&(A>=p[v][1]&&(v+=1),p[v]&&A>=p[v][0]&&A<p[v][1]&&(c.useSelect?C.prop("disabled",!0):C.addClass("ui-timepicker-disabled"))),d.append(C)}if(g.data("timepicker-input",b),b.data("timepicker-list",g),c.useSelect)b.val()&&d.val(f(t(b.val()),c)),d.on("focus",function(){a(this).data("timepicker-input").trigger("showTimepicker")}),d.on("blur",function(){a(this).data("timepicker-input").trigger("hideTimepicker")}),d.on("change",function(){m(b,a(this).val(),"select")}),m(b,d.val(),"initial"),b.hide().after(d);else{var F=c.appendTo;"string"==typeof F?F=a(F):"function"==typeof F&&(F=F(b)),F.append(g),j(b,d),d.on("mousedown click","li",function(c){b.off("focus.timepicker"),b.on("focus.timepicker-ie-hack",function(){b.off("focus.timepicker-ie-hack"),b.on("focus.timepicker",w.show)}),h(b)||b[0].focus(),d.find("li").removeClass("ui-timepicker-selected"),a(this).addClass("ui-timepicker-selected"),q(b)&&(b.trigger("hideTimepicker"),d.on("mouseup.timepicker click.timepicker","li",function(a){d.off("mouseup.timepicker click.timepicker"),g.hide()}))})}}function e(b,c){var d,e,f;return"object"==typeof b?(d=b.label,e=b.className,f=b.value):"string"==typeof b?d=b:a.error("Invalid noneOption value"),c?a("<option />",{value:f,"class":e,text:d}):a("<li />",{"class":e,text:d}).data("time",String(f))}function f(a,b){return a=b.roundingFunction(a,b),null!==a?s(a,b):void 0}function g(b){if(b.target!=window){var c=a(b.target);c.closest(".ui-timepicker-input").length||c.closest(".ui-timepicker-wrapper").length||(w.hide(),a(document).unbind(".ui-timepicker"),a(window).unbind(".ui-timepicker"))}}function h(a){var b=a.data("timepicker-settings");return(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&b.disableTouchKeyboard}function i(b,c,d){if(!d&&0!==d)return!1;var e=b.data("timepicker-settings"),f=!1,d=e.roundingFunction(d,e);return c.find("li").each(function(b,c){var e=a(c);if("number"==typeof e.data("time"))return e.data("time")==d?(f=e,!1):void 0}),f}function j(a,b){b.find("li").removeClass("ui-timepicker-selected");var c=t(l(a),a.data("timepicker-settings"));if(null!==c){var d=i(a,b,c);if(d){var e=d.offset().top-b.offset().top;(e+d.outerHeight()>b.outerHeight()||0>e)&&b.scrollTop(b.scrollTop()+d.position().top-d.outerHeight()),d.addClass("ui-timepicker-selected")}}}function k(b,c){if(""!==this.value&&"timepicker"!=c){var d=a(this);if(!d.is(":focus")||b&&"change"==b.type){var e=d.data("timepicker-settings"),f=t(this.value,e);if(null===f)return void d.trigger("timeFormatError");var g=!1;null!==e.minTime&&f<e.minTime&&null!==e.maxTime&&f>e.maxTime&&(g=!0),a.each(e.disableTimeRanges,function(){return f>=this[0]&&f<this[1]?(g=!0,!1):void 0}),e.forceRoundTime&&(f=e.roundingFunction(f,e));var h=s(f,e);g?m(d,h,"error")&&d.trigger("timeRangeError"):m(d,h)}}}function l(a){return a.is("input")?a.val():a.data("ui-timepicker-value")}function m(a,b,c){if(a.is("input")){a.val(b);var d=a.data("timepicker-settings");d.useSelect&&"select"!=c&&"initial"!=c&&a.data("timepicker-list").val(f(t(b),d))}return a.data("ui-timepicker-value")!=b?(a.data("ui-timepicker-value",b),"select"==c?a.trigger("selectTime").trigger("changeTime").trigger("change","timepicker"):"error"!=c&&a.trigger("changeTime"),!0):(a.trigger("selectTime"),!1)}function n(a){switch(a.keyCode){case 13:case 9:return;default:a.preventDefault()}}function o(c){var d=a(this),e=d.data("timepicker-list");if(!e||!b(e)){if(40!=c.keyCode)return!0;w.show.call(d.get(0)),e=d.data("timepicker-list"),h(d)||d.focus()}switch(c.keyCode){case 13:return q(d)&&w.hide.apply(this),c.preventDefault(),!1;case 38:var f=e.find(".ui-timepicker-selected");return f.length?f.is(":first-child")||(f.removeClass("ui-timepicker-selected"),f.prev().addClass("ui-timepicker-selected"),f.prev().position().top<f.outerHeight()&&e.scrollTop(e.scrollTop()-f.outerHeight())):(e.find("li").each(function(b,c){return a(c).position().top>0?(f=a(c),!1):void 0}),f.addClass("ui-timepicker-selected")),!1;case 40:return f=e.find(".ui-timepicker-selected"),0===f.length?(e.find("li").each(function(b,c){return a(c).position().top>0?(f=a(c),!1):void 0}),f.addClass("ui-timepicker-selected")):f.is(":last-child")||(f.removeClass("ui-timepicker-selected"),f.next().addClass("ui-timepicker-selected"),f.next().position().top+2*f.outerHeight()>e.outerHeight()&&e.scrollTop(e.scrollTop()+f.outerHeight())),!1;case 27:e.find("li").removeClass("ui-timepicker-selected"),w.hide();break;case 9:w.hide();break;default:return!0}}function p(c){var d=a(this),e=d.data("timepicker-list"),f=d.data("timepicker-settings");if(!e||!b(e)||f.disableTextInput)return!0;switch(c.keyCode){case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:f.typeaheadHighlight?j(d,e):e.hide()}}function q(a){var b=a.data("timepicker-settings"),c=a.data("timepicker-list"),d=null,e=c.find(".ui-timepicker-selected");return e.hasClass("ui-timepicker-disabled")?!1:(e.length&&(d=e.data("time")),null!==d&&("string"!=typeof d&&(d=s(d,b)),m(a,d,"select")),!0)}function r(a,b){a=Math.abs(a);var c,d,e=Math.round(a/60),f=[];return 60>e?f=[e,v.mins]:(c=Math.floor(e/60),d=e%60,30==b&&30==d&&(c+=v.decimal+5),f.push(c),f.push(1==c?v.hr:v.hrs),30!=b&&d&&(f.push(d),f.push(v.mins))),f.join(" ")}function s(b,c){if("number"!=typeof b)return null;var d=parseInt(b%60),e=parseInt(b/60%60),f=parseInt(b/3600%24),g=new Date(1970,0,2,f,e,d,0);if(isNaN(g.getTime()))return null;if("function"===a.type(c.timeFormat))return c.timeFormat(g);for(var h,i,j="",k=0;k<c.timeFormat.length;k++)switch(i=c.timeFormat.charAt(k)){case"a":j+=g.getHours()>11?v.pm:v.am;break;case"A":j+=g.getHours()>11?v.PM:v.AM;break;case"g":h=g.getHours()%12,j+=0===h?"12":h;break;case"G":h=g.getHours(),b===u&&(h=c.show2400?24:0),j+=h;break;case"h":h=g.getHours()%12,0!==h&&10>h&&(h="0"+h),j+=0===h?"12":h;break;case"H":h=g.getHours(),b===u&&(h=c.show2400?24:0),j+=h>9?h:"0"+h;break;case"i":var e=g.getMinutes();j+=e>9?e:"0"+e;break;case"s":d=g.getSeconds(),j+=d>9?d:"0"+d;break;case"\\":k++,j+=c.timeFormat.charAt(k);break;default:j+=i}return j}function t(a,b){if(""===a||null===a)return null;if("object"==typeof a)return 3600*a.getHours()+60*a.getMinutes()+a.getSeconds();if("string"!=typeof a)return a;a=a.toLowerCase().replace(/[\s\.]/g,""),("a"==a.slice(-1)||"p"==a.slice(-1))&&(a+="m");var c="("+v.am.replace(".","")+"|"+v.pm.replace(".","")+"|"+v.AM.replace(".","")+"|"+v.PM.replace(".","")+")?",d=new RegExp("^"+c+"([0-9]?[0-9])\\W?([0-5][0-9])?\\W?([0-5][0-9])?"+c+"$"),e=a.match(d);if(!e)return null;var f=parseInt(1*e[2],10);if(f>24){if(b&&b.wrapHours===!1)return null;f%=24}var g=e[1]||e[5],h=f;if(12>=f&&g){var i=g==v.pm||g==v.PM;h=12==f?i?12:0:f+(i?12:0)}var j=1*e[3]||0,k=1*e[4]||0,l=3600*h+60*j+k;if(12>f&&!g&&b&&b._twelveHourTime&&b.scrollDefault){var m=l-b.scrollDefault();0>m&&m>=u/-2&&(l=(l+u/2)%u)}return l}var u=86400,v={am:"am",pm:"pm",AM:"AM",PM:"PM",decimal:".",mins:"mins",hr:"hr",hrs:"hrs"},w={init:function(b){return this.each(function(){var e=a(this),f=[];for(var g in a.fn.timepicker.defaults)e.data(g)&&(f[g]=e.data(g));var h=a.extend({},a.fn.timepicker.defaults,f,b);if(h.lang&&(v=a.extend(v,h.lang)),h=c(h),e.data("timepicker-settings",h),e.addClass("ui-timepicker-input"),h.useSelect)d(e);else{if(e.prop("autocomplete","off"),h.showOn)for(var i in h.showOn)e.on(h.showOn[i]+".timepicker",w.show);e.on("change.timepicker",k),e.on("keydown.timepicker",o),e.on("keyup.timepicker",p),h.disableTextInput&&e.on("keydown.timepicker",n),k.call(e.get(0))}})},show:function(c){var e=a(this),f=e.data("timepicker-settings");if(c&&c.preventDefault(),f.useSelect)return void e.data("timepicker-list").focus();h(e)&&e.blur();var k=e.data("timepicker-list");if(!e.prop("readonly")&&(k&&0!==k.length&&"function"!=typeof f.durationTime||(d(e),k=e.data("timepicker-list")),!b(k))){e.data("ui-timepicker-value",e.val()),j(e,k),w.hide(),k.show();var m={};f.orientation.match(/r/)?m.left=e.offset().left+e.outerWidth()-k.outerWidth()+parseInt(k.css("marginLeft").replace("px",""),10):m.left=e.offset().left+parseInt(k.css("marginLeft").replace("px",""),10);var n;n=f.orientation.match(/t/)?"t":f.orientation.match(/b/)?"b":e.offset().top+e.outerHeight(!0)+k.outerHeight()>a(window).height()+a(window).scrollTop()?"t":"b","t"==n?(k.addClass("ui-timepicker-positioned-top"),m.top=e.offset().top-k.outerHeight()+parseInt(k.css("marginTop").replace("px",""),10)):(k.removeClass("ui-timepicker-positioned-top"),m.top=e.offset().top+e.outerHeight()+parseInt(k.css("marginTop").replace("px",""),10)),k.offset(m);var o=k.find(".ui-timepicker-selected");if(!o.length){var p=t(l(e));null!==p?o=i(e,k,p):f.scrollDefault&&(o=i(e,k,f.scrollDefault()))}if(o&&o.length){var q=k.scrollTop()+o.position().top-o.outerHeight();k.scrollTop(q)}else k.scrollTop(0);return f.stopScrollPropagation&&a(document).on("wheel.ui-timepicker",".ui-timepicker-wrapper",function(b){b.preventDefault();var c=a(this).scrollTop();a(this).scrollTop(c+b.originalEvent.deltaY)}),a(document).on("touchstart.ui-timepicker mousedown.ui-timepicker",g),a(window).on("resize.ui-timepicker",g),f.closeOnWindowScroll&&a(document).on("scroll.ui-timepicker",g),e.trigger("showTimepicker"),this}},hide:function(c){var d=a(this),e=d.data("timepicker-settings");return e&&e.useSelect&&d.blur(),a(".ui-timepicker-wrapper").each(function(){var c=a(this);if(b(c)){var d=c.data("timepicker-input"),e=d.data("timepicker-settings");e&&e.selectOnBlur&&q(d),c.hide(),d.trigger("hideTimepicker")}}),this},option:function(b,e){return"string"==typeof b&&"undefined"==typeof e?a(this).data("timepicker-settings")[b]:this.each(function(){var f=a(this),g=f.data("timepicker-settings"),h=f.data("timepicker-list");"object"==typeof b?g=a.extend(g,b):"string"==typeof b&&(g[b]=e),g=c(g),f.data("timepicker-settings",g),h&&(h.remove(),f.data("timepicker-list",!1)),g.useSelect&&d(f)})},getSecondsFromMidnight:function(){return t(l(this))},getTime:function(a){var b=this,c=l(b);if(!c)return null;var d=t(c);if(null===d)return null;a||(a=new Date);var e=new Date(a);return e.setHours(d/3600),e.setMinutes(d%3600/60),e.setSeconds(d%60),e.setMilliseconds(0),e},isVisible:function(){var a=this,c=a.data("timepicker-list");return!(!c||!b(c))},setTime:function(a){var b=this,c=b.data("timepicker-settings");if(c.forceRoundTime)var d=f(t(a),c);else var d=s(t(a),c);return a&&null===d&&c.noneOption&&(d=a),m(b,d),b.data("timepicker-list")&&j(b,b.data("timepicker-list")),this},remove:function(){var a=this;if(a.hasClass("ui-timepicker-input")){var b=a.data("timepicker-settings");return a.removeAttr("autocomplete","off"),a.removeClass("ui-timepicker-input"),a.removeData("timepicker-settings"),a.off(".timepicker"),a.data("timepicker-list")&&a.data("timepicker-list").remove(),b.useSelect&&a.show(),a.removeData("timepicker-list"),this}}};a.fn.timepicker=function(b){return this.length?w[b]?this.hasClass("ui-timepicker-input")?w[b].apply(this,Array.prototype.slice.call(arguments,1)):this:"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.timepicker"):w.init.apply(this,arguments):this},a.fn.timepicker.defaults={appendTo:"body",className:null,closeOnWindowScroll:!1,disableTextInput:!1,disableTimeRanges:[],disableTouchKeyboard:!1,durationTime:null,forceRoundTime:!1,maxTime:null,minTime:null,noneOption:!1,orientation:"l",roundingFunction:function(a,b){if(null===a)return null;if("number"!=typeof b.step)return a;var c=a%(60*b.step);return c>=30*b.step?a+=60*b.step-c:a-=c,a==u&&b.show2400?a:a%u},scrollDefault:null,selectOnBlur:!1,show2400:!1,showDuration:!1,showOn:["click","focus"],showOnFocus:!0,step:30,stopScrollPropagation:!1,timeFormat:"g:ia",typeaheadHighlight:!0,useSelect:!1,wrapHours:!0}});
(function($){var tagManagerHelper={};tagManagerHelper.editTrigger=function($scope,idContainer,idContainerVersion,idTag,callback){if(!$scope){$scope=piwikHelper.getAngularDependency('$rootScope');}
var childScope=$scope.$new(true,$scope);var template=$('<div class="tag-ui-confirm"><div piwik-trigger-edit id-container="idContainer" on-change-trigger="onChangeTrigger(trigger)" id-container-version="idContainerVersion" id-trigger="'+parseInt(idTag,10)+'"></div><input role="no" type="button" value="'+_pk_translate('General_Cancel')+'"/></div>')
var params={idContainer:idContainer,idContainerVersion:idContainerVersion,onChangeTrigger:function(trigger){if('function'===typeof callback){callback(trigger);}
template.parents('.modal.open').closeModal();}};piwikHelper.compileAngularComponents(template,{scope:childScope,params:params});piwikHelper.modalConfirm(template,{},{extraWide:true,complete:function(){childScope.$destroy();template.empty();}});};tagManagerHelper.createNewVersion=function(){var piwikUrl=piwikHelper.getAngularDependency('piwikUrl');var containerId=piwikUrl.getSearchParam('idContainer');this.editVersion(null,containerId,0,function(){window.location.reload();});};tagManagerHelper.editVersion=function($scope,idContainer,idContainerVersion,callback){if(!$scope){$scope=piwikHelper.getAngularDependency('$rootScope');}
var childScope=$scope.$new(true,$scope);var template=$('<div class="tag-ui-confirm"><div piwik-version-edit id-container="idContainer" on-change-version="onChangeVersion(version)" id-container-version="idContainerVersion"></div><input role="no" type="button" value="'+_pk_translate('General_Cancel')+'"/></div>')
var params={idContainer:idContainer,idContainerVersion:parseInt(idContainerVersion,10),onChangeVersion:function(version){if('function'===typeof callback){callback(version);}
template.parents('.modal.open').closeModal();}};piwikHelper.compileAngularComponents(template,{scope:childScope,params:params});piwikHelper.modalConfirm(template,{},{extraWide:true,complete:function(){childScope.$destroy();template.empty();}});};tagManagerHelper.editVariable=function($scope,idContainer,idContainerVersion,idVariable,callback,variableType){if(!$scope){$scope=piwikHelper.getAngularDependency('$rootScope');}
var childScope=$scope.$new(true,$scope);var template=$('<div class="tag-ui-confirm"><div piwik-variable-edit id-container="idContainer" variable-type="variableType" on-change-variable="onChangeVariable(variable)" id-container-version="idContainerVersion" id-variable="idVariable"></div><input role="no" type="button" value="'+_pk_translate('General_Cancel')+'"/></div>')
var params={idContainer:idContainer,idVariable:idVariable,variableType:variableType,idContainerVersion:parseInt(idContainerVersion,10),onChangeVariable:function(variable){if('function'===typeof callback){callback(variable);}
template.parents('.modal.open').closeModal();}};piwikHelper.compileAngularComponents(template,{scope:childScope,params:params});piwikHelper.modalConfirm(template,{},{extraWide:true,complete:function(){childScope.$destroy();template.empty();}});};tagManagerHelper.selectVariable=function(callback){var $scope=piwikHelper.getAngularDependency('$rootScope');var piwikUrl=piwikHelper.getAngularDependency('piwikUrl');var containerId=piwikUrl.getSearchParam('idContainer');var childScope=$scope.$new(true,$scope);var template=$('<div class="ui-confirm"><h2>Select a variable</h2><div piwik-variable-select id-container="idContainer" on-select-variable="onSelectVariable(variable)"></div><input role="no" type="button" value="'+_pk_translate('General_Cancel')+'"/></div>')
var params={idContainer:containerId,onSelectVariable:function(variable){if('function'===typeof callback){callback(variable);}
template.parents('.modal.open').closeModal();}};piwikHelper.compileAngularComponents(template,{scope:childScope,params:params});piwikHelper.modalConfirm(template,{},{complete:function(){childScope.$destroy();template.empty();}});};tagManagerHelper.insertTextSnippetAtElement=function(inputField,textToAdd){if(!inputField||!textToAdd){return;}
var scrollPos=inputField.scrollTop;var startPos=inputField.selectionStart;var endPos=inputField.selectionEnd;var value=String(inputField.value);var valueBefore=value.substring(0,startPos);var valueAfter=value.substring(endPos,value.length);inputField.value=valueBefore+textToAdd+valueAfter;inputField.selectionStart=startPos+textToAdd.length;inputField.selectionEnd=startPos+textToAdd.length;inputField.focus();inputField.scrollTop=scrollPos;$(inputField).change();};tagManagerHelper.showInstallCode=function(idContainer){var $scope=piwikHelper.getAngularDependency('$rootScope');var childScope=$scope.$new(true,$scope);var template=$('<div class="tag-ui-confirm"><div piwik-manage-install-tag-code id-container="{{ idContainer }}"></div><input role="no" type="button" value="'+_pk_translate('General_Cancel')+'"/>')
var params={idContainer:idContainer};piwikHelper.compileAngularComponents(template,{scope:childScope,params:params});piwikHelper.modalConfirm(template,{},{extraWide:true,complete:function(){childScope.$destroy();template.empty();}});};tagManagerHelper.enablePreviewMode=function(idContainer,idContainerVersion){if(!idContainerVersion){idContainerVersion=0;}
var piwikApi=piwikHelper.getAngularDependency('piwikApi');var params={method:'TagManager.enablePreviewMode',idContainer:idContainer,idContainerVersion:idContainerVersion};piwikHelper.modalConfirm('<h2>'+_pk_translate('TagManager_EnablingPreviewPleaseWait')+'</h2>',{});piwikApi.fetch(params).then(function(){window.location.reload();});};tagManagerHelper.disablePreviewMode=function(idContainer){var piwikApi=piwikHelper.getAngularDependency('piwikApi');var params={method:'TagManager.disablePreviewMode',idContainer:idContainer};piwikHelper.modalConfirm('<h2>'+_pk_translate('TagManager_DisablingPreviewPleaseWait')+'</h2>',{});piwikApi.fetch(params).then(function(){window.location.reload();});};tagManagerHelper.importVersion=function($scope,idContainer){var childScope=$scope.$new(true,$scope);var template=$('<div class="ui-confirm"><div piwik-import-version id-container="idContainer"></div><input role="no" type="button" value="'+_pk_translate('General_Cancel')+'"/>')
var params={idContainer:idContainer};piwikHelper.compileAngularComponents(template,{scope:childScope,params:params});piwikHelper.modalConfirm(template,{},{extraWide:true,complete:function(){childScope.$destroy();template.empty();}});};window.tagManagerHelper=tagManagerHelper;})(jQuery);
(function(){angular.module('piwikApp').factory('tagManagerContainerModel',tagManagerContainerModel);tagManagerContainerModel.$inject=['piwikApi','$q','$filter'];function tagManagerContainerModel(piwikApi,$q,$filter){var fetchPromise=null;var contextPromise=null;var translate=$filter('translate');var model={containers:[],isLoading:false,isUpdating:false,findContainer:findContainer,createOrUpdateContainer:createOrUpdateContainer,deleteContainer:deleteContainer,fetchAvailableContexts:fetchAvailableContexts,reload:reload,fetchContainers:fetchContainers};return model;function reload(){model.containers=[];fetchPromise=null;return fetchContainers();}
function fetchContainers(){var params={method:'TagManager.getContainers',filter_limit:'-1'};if(!fetchPromise){fetchPromise=piwikApi.fetch(params);}
model.isLoading=true;model.containers=[];return fetchPromise.then(function(containers){model.containers=containers;model.isLoading=false;return containers;},function(){model.isLoading=false;});}
function fetchAvailableContexts(){if(!contextPromise){var params={method:'TagManager.getAvailableContexts',filter_limit:'-1'};contextPromise=piwikApi.fetch(params);}
return contextPromise;}
function findContainer(idContainer){var found;angular.forEach(model.containers,function(container){if(!found&&container.idcontainer===idContainer){found=container;}});if(found){var deferred=$q.defer();deferred.resolve(found);return deferred.promise;}
model.isLoading=true;return piwikApi.fetch({idContainer:idContainer,method:'TagManager.getContainer',filter_limit:'-1'}).then(function(record){model.isLoading=false;return record;},function(error){model.isLoading=false;});}
function deleteContainer(idContainer){model.isUpdating=true;model.containers=[];piwikApi.withTokenInUrl();return piwikApi.fetch({idContainer:idContainer,method:'TagManager.deleteContainer'}).then(function(response){model.isUpdating=false;return{type:'success'};},function(error){model.isUpdating=false;return{type:'error',message:error};});}
function createOrUpdateContainer(container,method){container=angular.copy(container);container.method=method;var map={idContainer:'idcontainer',};angular.forEach(map,function(value,key){if(typeof container[value]!=='undefined'){container[key]=container[value];delete container[value];}});var postParams=[];var post={};for(var i=0;i<postParams.length;i++){var postParam=postParams[i];if(typeof container[postParam]!=='undefined'){post[postParam]=container[postParam];delete container[postParam];}}
model.isUpdating=true;piwikApi.withTokenInUrl();return piwikApi.post(container,post).then(function(response){model.isUpdating=false;return{type:'success',response:response};},function(error){model.isUpdating=false;return{type:'error',message:error};});}}})();
(function(){angular.module('piwikApp').controller('ContainerListController',ContainerListController);ContainerListController.$inject=['$scope','tagManagerContainerModel','piwik','piwikApi','$location'];function ContainerListController($scope,tagManagerContainerModel,piwik,piwikApi,$location){this.model=tagManagerContainerModel;this.hasWriteAccess=piwik.hasUserCapability('tagmanager_write');if(this.hasWriteAccess){this.containerDefaultAction='dashboard';}else{this.containerDefaultAction='manageTags';}
var self=this;this.contexts={};this.createContainer=function(){this.editContainer(0);};this.editContainer=function(idContainer){var $search=$location.search();$search.idContainer=idContainer;$location.search($search);};this.installCode=function(idContainer){tagManagerHelper.showInstallCode(idContainer);};this.deleteContainer=function(container){function doDelete(){tagManagerContainerModel.deleteContainer(container.idcontainer).then(function(){tagManagerContainerModel.reload();});}
piwik.helper.modalConfirm('#confirmDeleteContainer',{yes:doDelete});};this.truncateText=function(text,length){if(text&&(text+'').length>length){return String(text).substr(0,length-3)+'...';}
return text;};this.model.fetchContainers();this.model.fetchAvailableContexts().then(function(contexts){self.contexts={};angular.forEach(contexts,function(context){self.contexts[context.id]=context.name;});});}})();
(function(){angular.module('piwikApp').directive('piwikContainerList',piwikContainerList);piwikContainerList.$inject=['piwik'];function piwikContainerList(piwik){return{restrict:'A',scope:{},templateUrl:'plugins/TagManager/angularjs/manageContainer/list.directive.html?cb='+piwik.cacheBuster,controller:'ContainerListController',controllerAs:'containerList'};}})();
(function(){angular.module('piwikApp').controller('ContainerEditController',ContainerEditController);ContainerEditController.$inject=['$scope','tagManagerContainerModel','piwik','$location','$filter','$timeout','$rootScope'];function ContainerEditController($scope,tagManagerContainerModel,piwik,$location,$filter,$timeout,$rootScope){var self=this;var currentId=null;var notificationId='containertagmanagement';var translate=$filter('translate');this.isDirty=false;this.model=tagManagerContainerModel;this.contexts=[];tagManagerContainerModel.fetchAvailableContexts().then(function(contexts){self.contexts=[];angular.forEach(contexts,function(context){self.contexts.push({key:context.id,value:context.name});});});function getNotification(){var UI=require('piwik/UI');return new UI.Notification();}
function removeAnyContainerNotification(){var notification=getNotification();notification.remove(notificationId);notification.remove('ajaxHelper');}
function showNotification(message,context){var notification=getNotification();notification.show(message,{context:context,id:notificationId});$timeout(function(){notification.scrollToNotification();},200);}
function showErrorFieldNotProvidedNotification(title){var message=_pk_translate('TagManager_ErrorXNotProvided',[title]);showNotification(message,'error');}
function init(idContainer){self.create=idContainer=='0';self.edit=!self.create;self.container={};piwik.helper.lazyScrollToContent();if(self.edit&&idContainer){self.editTitle=translate('TagManager_EditContainer');self.model.findContainer(idContainer).then(function(container){if(!container){return;}
self.container=angular.copy(container);self.isDirty=false;});}else if(self.create){self.editTitle=translate('TagManager_CreateNewContainer');self.container={idSite:piwik.idSite,name:'',context:'web',description:''};self.isDirty=false;}}
this.cancel=function(){$scope.idContainer=null;currentId=null;var $search=$location.search();delete $search.idContainer;$location.search($search);};$scope.$on('$destroy',function(){$scope.idContainer=null;currentId=null;});function checkRequiredFieldsAreSet(){var title;if(!self.container.name){title=_pk_translate('General_Name');showErrorFieldNotProvidedNotification(title);return false;}
return true;}
this.createContainer=function(){removeAnyContainerNotification();if(!checkRequiredFieldsAreSet()){return;}
this.isUpdating=true;tagManagerContainerModel.createOrUpdateContainer(this.container,'TagManager.addContainer').then(function(response){self.isUpdating=false;if(!response||response.type==='error'||!response.response){return;}
self.isDirty=false;var idContainer=response.response.value;showNotification(translate('TagManager_CreatedX',translate('TagManager_Container')),response.type);var currentUrl=window.location.pathname+window.location.search;var newUrl=piwik.broadcast.updateParamValue('module=TagManager',currentUrl);newUrl=piwik.broadcast.updateParamValue('action=dashboard',newUrl);newUrl=piwik.broadcast.updateParamValue('idContainer='+idContainer,newUrl);window.location.href=newUrl;},function(){self.isUpdating=false;});};this.setValueHasChanged=function(){this.isDirty=true;};this.updateContainer=function(){removeAnyContainerNotification();if(!checkRequiredFieldsAreSet()){return;}
this.isUpdating=true;tagManagerContainerModel.createOrUpdateContainer(this.container,'TagManager.updateContainer').then(function(response){if(response.type==='error'){return;}
var idContainer=self.container.idcontainer;self.isDirty=false;self.container={};tagManagerContainerModel.reload().then(function(){init(idContainer);});showNotification(translate('TagManager_UpdatedX',translate('TagManager_Container')),response.type);});};$scope.$watch('idContainer',function(newValue,oldValue){if(newValue===null){return;}
if(newValue!=oldValue||currentId===null){currentId=newValue;init(newValue);}});}})();
(function(){angular.module('piwikApp').directive('piwikContainerEdit',piwikContainerEdit);piwikContainerEdit.$inject=['piwik'];function piwikContainerEdit(piwik){return{restrict:'A',scope:{idContainer:'='},templateUrl:'plugins/TagManager/angularjs/manageContainer/edit.directive.html?cb='+piwik.cacheBuster,controller:'ContainerEditController',controllerAs:'editContainer'};}})();
(function(){angular.module('piwikApp').controller('ManageContainerController',ManageContainerController);ManageContainerController.$inject=['$scope','$rootScope','$location'];function ManageContainerController($scope,$rootScope,$location){this.editMode=false;var self=this;function removeAnyContainerNotification(){var UI=require('piwik/UI');new UI.Notification().remove('containertagmanagement');}
function initState(){var $search=$location.search();if('idContainer'in $search){if($search.idContainer===0||$search.idContainer==='0'){var parameters={isAllowed:true};$rootScope.$emit('TagManager.initAddContainer',parameters);if(parameters&&!parameters.isAllowed){self.editMode=false;self.idContainer=null;return;}}
self.editMode=true;self.idContainer=$search.idContainer;}else{self.editMode=false;self.idContainer=null;}
removeAnyContainerNotification();}
initState();var onChangeSuccess=$rootScope.$on('$locationChangeSuccess',initState);$scope.$on('$destroy',function(){if(onChangeSuccess){onChangeSuccess();}});}})();
(function(){angular.module('piwikApp').directive('piwikContainerManage',piwikContainerManage);piwikContainerManage.$inject=['piwik'];function piwikContainerManage(piwik){return{restrict:'A',templateUrl:'plugins/TagManager/angularjs/manageContainer/manage.directive.html?cb='+piwik.cacheBuster,controller:'ManageContainerController',controllerAs:'manageContainer'};}})();
(function(){angular.module('piwikApp').factory('tagManagerVersionModel',tagManagerVersionModel);tagManagerVersionModel.$inject=['piwikApi','$q','$filter'];function tagManagerVersionModel(piwikApi,$q,$filter){var fetchPromise=null;var environmentPublishPromise=null;var translate=$filter('translate');var model={versions:[],isLoading:false,isUpdating:false,findVersion:findVersion,createOrUpdateVersion:createOrUpdateVersion,deleteVersion:deleteVersion,publishVersion:publishVersion,fetchAvailableEnvironmentsWithPublishPermission:fetchAvailableEnvironmentsWithPublishPermission,reload:reload,fetchVersions:fetchVersions};return model;function reload(idContainer){model.versions=[];fetchPromise=null;return fetchVersions(idContainer);}
function fetchVersions(idContainer){var params={method:'TagManager.getContainerVersions',idContainer:idContainer,filter_limit:'-1'};if(!fetchPromise){fetchPromise=piwikApi.fetch(params);}
model.isLoading=true;model.versions=[];return fetchPromise.then(function(versions){model.versions=versions;model.isLoading=false;return versions;},function(){model.isLoading=false;});}
function fetchAvailableEnvironmentsWithPublishPermission(){if(!environmentPublishPromise){var params={method:'TagManager.getAvailableEnvironmentsWithPublishCapability',filter_limit:'-1'};environmentPublishPromise=piwikApi.fetch(params);}
return environmentPublishPromise;}
function findVersion(idContainer,idContainerVersion){var found;angular.forEach(model.versions,function(version){if(!found&&parseInt(version.idcontainerversion,10)===idContainerVersion){found=version;}});if(found){var deferred=$q.defer();deferred.resolve(found);return deferred.promise;}
model.isLoading=true;return piwikApi.fetch({idContainerVersion:idContainerVersion,idContainer:idContainer,method:'TagManager.getContainerVersion',filter_limit:'-1'}).then(function(record){model.isLoading=false;return record;},function(error){model.isLoading=false;});}
function deleteVersion(idContainer,idContainerVersion){model.isUpdating=true;model.versions=[];piwikApi.withTokenInUrl();return piwikApi.fetch({idContainer:idContainer,idContainerVersion:idContainerVersion,method:'TagManager.deleteContainerVersion'}).then(function(response){model.isUpdating=false;return{type:'success'};},function(error){model.isUpdating=false;return{type:'error',message:error};});}
function publishVersion(idContainer,idContainerVersion,environment){model.isUpdating=true;var params={idContainer:idContainer,idContainerVersion:idContainerVersion,environment:environment,method:'TagManager.publishContainerVersion'};return piwikApi.fetch(params).then(function(response){model.isUpdating=false;return{type:'success'};},function(error){model.isUpdating=false;return{type:'error',message:error};});}
function createOrUpdateVersion(version,method){version=angular.copy(version);version.method=method;var map={idContainerVersion:'idcontainerversion',idContainer:'idcontainer',};angular.forEach(map,function(value,key){if(typeof version[value]!=='undefined'){version[key]=version[value];delete version[value];}});var postParams=[];var post={};for(var i=0;i<postParams.length;i++){var postParam=postParams[i];if(typeof version[postParam]!=='undefined'){post[postParam]=version[postParam];delete version[postParam];}}
model.isUpdating=true;piwikApi.withTokenInUrl();return piwikApi.post(version,post).then(function(response){model.isUpdating=false;return{type:'success',response:response};},function(error){model.isUpdating=false;return{type:'error',message:error};});}}})();
(function(){angular.module('piwikApp').factory('tagManagerVersionDiff',tagManagerVersionDiff);tagManagerVersionDiff.$inject=['piwikApi','$q'];function tagManagerVersionDiff(piwikApi,$q){var model={diffDraftVersion:diffDraftVersion};return model;function diffDraftVersion(idContainer,idContainerVersionNew,idContainerVersionPrevious){function findEntryInArray(array,name){for(var j=0;j<array.length;j++){if(name===array[j].name){return array[j];}}}
function getDifference(entityType,array1,array2,keysToCheck){var diff=[];var i;for(i=0;i<array1.length;i++){var matchingEntry=findEntryInArray(array2,array1[i].name);var found=false;if(!!matchingEntry){found=true;var j;for(j=0;j<keysToCheck.length;j++){if(JSON.stringify(array1[i][keysToCheck[j]])!==JSON.stringify(matchingEntry[keysToCheck[j]])){diff.push({entityType:entityType,type:'TagManager_DiffModified',name:array1[i].name,lastChanged:array1[i].updated_date_pretty});break;}}}
if(!found){diff.push({entityType:entityType,type:'TagManager_DiffAdded',name:array1[i].name,lastChanged:array1[i].updated_date_pretty});}}
for(i=0;i<array2.length;i++){if(!findEntryInArray(array1,array2[i].name)){diff.push({entityType:entityType,type:'TagManager_DiffDeleted',name:array2[i].name,lastChanged:array2[i].updated_date_pretty});}}
return diff;}
function mixinTagTriggers(tags,triggers){angular.forEach(tags,function(tag){tag.fire_triggers=[];tag.block_triggers=[];angular.forEach(tag.fire_trigger_ids,function(idtrigger){angular.forEach(triggers,function(trigger){if(trigger.idtrigger===idtrigger){tag.fire_triggers.push(trigger.name);}});});angular.forEach(tag.block_trigger_ids,function(idtrigger){angular.forEach(triggers,function(trigger){if(trigger.idtrigger===idtrigger){tag.block_triggers.push(trigger.name);}});});});}
var draftVersion={module:'API',method:'TagManager.exportContainerVersion',format:'json',idContainer:idContainer,filter_limit:-1,};if(idContainerVersionNew){draftVersion.idContainerVersion=idContainerVersionNew;}
var lastVersion={module:'API',method:'TagManager.exportContainerVersion',format:'json',idContainer:idContainer,idContainerVersion:idContainerVersionPrevious,filter_limit:-1,};var deferred=$q.defer();piwikApi.bulkFetch([draftVersion,lastVersion]).then(function(response){mixinTagTriggers(response[0].tags,response[0].triggers);mixinTagTriggers(response[1].tags,response[1].triggers);var diff1=getDifference('TagManager_Tag',response[0].tags,response[1].tags,['name','type','fire_limit','priority','fire_delay','fire_triggers','block_triggers','parameters']);var diff2=getDifference('TagManager_Trigger',response[0].triggers,response[1].triggers,['name','type','conditions','parameters']);var diff3=getDifference('TagManager_Variable',response[0].variables,response[1].variables,['name','type','lookup_table','default_value','parameters']);var diff=[];diff=diff.concat(diff1,diff2,diff3);deferred.resolve(diff);});return deferred.promise;}}})();
(function(){angular.module('piwikApp').controller('VersionListController',VersionListController);VersionListController.$inject=['$scope','tagManagerVersionModel','piwik','piwikApi','$location'];function VersionListController($scope,tagManagerVersionModel,piwik,piwikApi,$location){this.model=tagManagerVersionModel;this.hasWriteAccess=piwik.hasUserCapability('tagmanager_write');var self=this;this.idContainer=$scope.idContainer;this.token_auth=piwik.token_auth;this.environments=[];this.versionToBePublished=null;this.idSite=piwik.idSite;this.canPublishToLive=piwik.hasUserCapability('tagmanager_publish_live_container');tagManagerVersionModel.fetchAvailableEnvironmentsWithPublishPermission().then(function(environments){self.environments=[];angular.forEach(environments,function(environment){self.environments.push({key:environment.id,value:environment.name});});});this.createVersion=function(){this.editVersion(0);};this.truncateText=function(text,length){if(text&&(text+'').length>length){return String(text).substr(0,length-3)+'...';}
return text;};this.publishVersion=function(version){version.deployEnvironment='';version.availableEnvironments=[];angular.forEach(this.environments,function(env){var found=false;if(version.releases){angular.forEach(version.releases,function(release){if(env&&env.key==release.environment){found=true;}});}
if(!found){if(!version.deployEnvironment){version.deployEnvironment=env.key;}
version.availableEnvironments.push(env);}});this.versionToBePublished=version;piwik.helper.modalConfirm('#confirmPublishVersion',{yes:function(){if(version.deployEnvironment){self.model.publishVersion(version.idcontainer,version.idcontainerversion,version.deployEnvironment).then(function(){self.model.reload(self.idContainer);});}}});};this.enableDebugMode=function(idContainerVersion){tagManagerHelper.enablePreviewMode(self.idContainer,idContainerVersion);};this.exportVersion=function(idContainerVersion,versionName){var params={module:'API',method:'TagManager.exportContainerVersion',format:'json',idContainer:self.idContainer,filter_limit:-1,};if(idContainerVersion){params.idContainerVersion=idContainerVersion;}
var filename='container_'+self.idContainer;if(versionName){filename+='_'+versionName;}
piwikApi.fetch(params).then(function(exportedContainer){piwik.helper.sendContentAsDownload(filename+'.json',JSON.stringify(exportedContainer));});};this.editVersion=function(idContainerVersion){var $search=$location.search();$search.idContainerVersion=idContainerVersion;$location.search($search);};this.importVersion=function(){tagManagerHelper.importVersion($scope,self.idContainer);}
this.deleteVersion=function(version){function doDelete(){tagManagerVersionModel.deleteVersion(self.idContainer,version.idcontainerversion).then(function(){tagManagerVersionModel.reload(self.idContainer);});}
piwik.helper.modalConfirm('#confirmDeleteVersion',{yes:doDelete});};this.model.fetchVersions(this.idContainer);}})();
(function(){angular.module('piwikApp').directive('piwikVersionList',piwikVersionList);piwikVersionList.$inject=['piwik'];function piwikVersionList(piwik){return{restrict:'A',scope:{idContainer:'='},templateUrl:'plugins/TagManager/angularjs/manageVersion/list.directive.html?cb='+piwik.cacheBuster,controller:'VersionListController',controllerAs:'versionList'};}})();
(function(){angular.module('piwikApp').controller('VersionEditController',VersionEditController);VersionEditController.$inject=['$scope','tagManagerVersionModel','tagManagerContainerModel','tagManagerVersionDiff','piwik','$location','$filter','$timeout','$rootScope'];function VersionEditController($scope,tagManagerVersionModel,tagManagerContainerModel,tagManagerVersionDiff,piwik,$location,$filter,$timeout,$rootScope){var self=this;var currentId=null;var notificationId='versiontagmanagement';var translate=$filter('translate');this.isDirty=false;this.model=tagManagerVersionModel;this.environments=[];this.idContainer=$scope.idContainer;this.isEmbedded=!!$scope.onChangeVersion;this.lastVersion=null;this.versionChanges=[];this.isLoadingVersionChanges=false;this.canPublishToLive=piwik.hasUserCapability('tagmanager_publish_live_container');tagManagerVersionModel.fetchAvailableEnvironmentsWithPublishPermission().then(function(environments){self.environments=[];angular.forEach(environments,function(environment){self.environments.push({key:environment.id,value:environment.name});});});function getNotification(){var UI=require('piwik/UI');return new UI.Notification();}
function removeAnyVersionNotification(){var notification=getNotification();notification.remove(notificationId);notification.remove('ajaxHelper');}
function showNotification(message,context){var notification=getNotification();notification.show(message,{context:context,id:notificationId});$timeout(function(){notification.scrollToNotification();},200);}
function showErrorFieldNotProvidedNotification(title){var message=translate('TagManager_ErrorXNotProvided',[title]);showNotification(message,'error');}
function init(idContainerVersion){self.create=idContainerVersion=='0';self.edit=!self.create;self.version={};self.lastVersion=null;self.versionChanges=[];self.isLoadingVersionChanges=true;tagManagerContainerModel.findContainer(self.idContainer).then(function(container){self.isLoadingVersionChanges=false;self.lastVersion=null;if(!container||!container.versions||!angular.isArray(container.versions)||!container.versions.length){return;}
container=angular.copy(container);var versions=container.versions;versions.sort(function(a,b){return a.revision<b.revision;});var lastContainerVersion=null;if(self.create&&versions[0]&&versions[0].name){self.lastVersion=versions[0].name;lastContainerVersion=versions[0].idcontainerversion;}else if(self.edit){for(var i=0;i<(versions.length-1);i++){if(versions[i].idcontainerversion===parseInt(idContainerVersion,10)&&versions[i+1]){self.lastVersion=versions[i+1].name;lastContainerVersion=versions[i+1].idcontainerversion;}}}
if(self.lastVersion){self.isLoadingVersionChanges=true;tagManagerVersionDiff.diffDraftVersion(self.idContainer,idContainerVersion,lastContainerVersion).then(function(diff){self.versionChanges=diff;self.isLoadingVersionChanges=false;});if(self.create&&!self.version.name&&/^\d+$/.test(self.lastVersion)){self.version.name=parseInt(self.lastVersion,10)+1;}}});piwik.helper.lazyScrollToContent();if(self.edit&&idContainerVersion){self.editTitle=translate('TagManager_EditVersion');self.model.findVersion(self.idContainer,idContainerVersion).then(function(version){if(!version){return;}
self.version=angular.copy(version);self.isDirty=false;});}else if(self.create){self.editTitle=translate('TagManager_CreateNewVersion');self.version={idSite:piwik.idSite,idcontainer:self.idContainer,name:'',environment:'',description:''};if(self.canPublishToLive){self.version.environment='live';}else if(angular.isArray(self.environments)&&self.environments.length&&self.environments[0]){self.version.environment=self.environments[0].key;}
self.isDirty=false;}}
this.cancel=function(){$scope.idContainerVersion=null;currentId=null;var $search=$location.search();delete $search.idContainerVersion;$location.search($search);};$scope.$on('$destroy',function(){$scope.idContainerVersion=null;currentId=null;});function checkRequiredFieldsAreSet(){var title;if(!self.version.name){title=_pk_translate('General_Name');showErrorFieldNotProvidedNotification(title);return false;}
return true;}
this.createVersion=function(){removeAnyVersionNotification();if(!checkRequiredFieldsAreSet()){return;}
this.isUpdating=true;tagManagerVersionModel.createOrUpdateVersion(this.version,'TagManager.createContainerVersion').then(function(response){self.isUpdating=false;if(!response||response.type==='error'||!response.response){return;}
self.isDirty=false;var idContainerVersion=response.response.value;if('function'===typeof $scope.onChangeVersion){self.version.idcontainerversion=idContainerVersion;$scope.onChangeVersion({version:self.version});return;}
tagManagerVersionModel.reload(self.idContainer).then(function(){var $search=$location.search();$search.idContainerVersion=idContainerVersion;$location.search($search);$timeout(function(){showNotification(translate('TagManager_CreatedX',translate('TagManager_Version')),response.type);},200);});},function(){self.isUpdating=false;});};this.createVersionAndPublish=function(){removeAnyVersionNotification();if(!checkRequiredFieldsAreSet()){return;}
this.isUpdating=true;tagManagerVersionModel.createOrUpdateVersion(this.version,'TagManager.createContainerVersion').then(function(response){if(!response||response.type==='error'||!response.response||!response.response.value){self.isUpdating=false;return;}
var idContainerVersion=response.response.value;self.version.idcontainerversion=idContainerVersion;tagManagerVersionModel.publishVersion(self.idContainer,idContainerVersion,self.version.environment).then(function(response){self.isUpdating=false;if(!response||response.type==='error'){return;}
self.isDirty=false;if('function'===typeof $scope.onChangeVersion){$scope.onChangeVersion({version:self.version});return;}
tagManagerVersionModel.reload(self.idContainer).then(function(){var $search=$location.search();$search.idContainerVersion=idContainerVersion;$location.search($search);$timeout(function(){showNotification(translate('TagManager_VersionPublishSuccess'),response.type);},200);});});},function(){self.isUpdating=false;});}
this.setValueHasChanged=function(){this.isDirty=true;};this.updateVersion=function(){removeAnyVersionNotification();if(!checkRequiredFieldsAreSet()){return;}
this.isUpdating=true;tagManagerVersionModel.createOrUpdateVersion(this.version,'TagManager.updateContainerVersion').then(function(response){if(response.type==='error'){return;}
var idContainerVersion=self.version.idcontainerversion;if('function'===typeof $scope.onChangeVersion){$scope.onChangeVersion({version:self.version});return;}
self.isDirty=false;self.version={};tagManagerVersionModel.reload(self.idContainer).then(function(){init(idContainerVersion);});showNotification(translate('TagManager_UpdatedX',translate('TagManager_Version')),response.type);});};$scope.$watch('idContainerVersion',function(newValue,oldValue){if(newValue===null){return;}
if(newValue!=oldValue||currentId===null){currentId=newValue;init(newValue);}});}})();
(function(){angular.module('piwikApp').directive('piwikVersionEdit',piwikVersionEdit);piwikVersionEdit.$inject=['piwik'];function piwikVersionEdit(piwik){return{restrict:'A',scope:{idContainerVersion:'=',idContainer:'=',onChangeVersion:'&?'},templateUrl:'plugins/TagManager/angularjs/manageVersion/edit.directive.html?cb='+piwik.cacheBuster,controller:'VersionEditController',controllerAs:'editVersion'};}})();
(function(){angular.module('piwikApp').controller('ManageVersionController',ManageVersionController);ManageVersionController.$inject=['$scope','$rootScope','$location'];function ManageVersionController($scope,$rootScope,$location){this.editMode=false;var self=this;this.idContainer=$scope.idContainer;function removeAnyVersionNotification(){var UI=require('piwik/UI');new UI.Notification().remove('versiontagmanagement');}
function initState(){var $search=$location.search();if('idContainerVersion'in $search){if($search.idContainerVersion===0||$search.idContainerVersion==='0'){var parameters={isAllowed:true};$rootScope.$emit('TagManager.initAddVersion',parameters);if(parameters&&!parameters.isAllowed){self.editMode=false;self.idContainerVersion=null;return;}}
self.editMode=true;self.idContainerVersion=parseInt($search.idContainerVersion,10);}else{self.editMode=false;self.idContainerVersion=null;}
removeAnyVersionNotification();}
initState();var onChangeSuccess=$rootScope.$on('$locationChangeSuccess',initState);$scope.$on('$destroy',function(){if(onChangeSuccess){onChangeSuccess();}});}})();
(function(){angular.module('piwikApp').directive('piwikVersionManage',piwikVersionManage);piwikVersionManage.$inject=['piwik'];function piwikVersionManage(piwik){return{restrict:'A',scope:{idContainer:'@'},templateUrl:'plugins/TagManager/angularjs/manageVersion/manage.directive.html?cb='+piwik.cacheBuster,controller:'ManageVersionController',controllerAs:'manageVersion'};}})();
(function(){angular.module('piwikApp').factory('tagManagerTriggerModel',tagManagerTriggerModel);tagManagerTriggerModel.$inject=['piwikApi','$q','$filter'];function tagManagerTriggerModel(piwikApi,$q,$filter){var fetchPromise=null;var triggersPromise={};var lookUpPromise=null;var translate=$filter('translate');var model={triggers:[],isLoading:false,isUpdating:false,findTrigger:findTrigger,createOrUpdateTrigger:createOrUpdateTrigger,fetchAvailableTriggers:fetchAvailableTriggers,fetchContainer:fetchContainer,suggestNameForType:suggestNameForType,fetchAvailableComparisons:fetchAvailableComparisons,fetchAvailableContainerVariables:fetchAvailableContainerVariables,deleteTrigger:deleteTrigger,reload:reload,fetchTriggersIfNotLoaded:fetchTriggersIfNotLoaded,fetchTriggers:fetchTriggers};return model;function arrayFilter(array,filter){var entries=[];angular.forEach(array,function(value){if(filter(value)){entries.push(value);}});return entries;}
function filterTriggerConditions(conditions){return arrayFilter(conditions,function(condition){return!!condition&&condition.actual&&condition.expected&&condition.comparison;});}
function fetchTriggersIfNotLoaded(){if(!fetchPromise){model.fetchTriggers();}}
function fetchAvailableContainerVariables(idContainer,idContainerVersion){var params={method:'TagManager.getAvailableContainerVariables',filter_limit:'-1',idContainer:idContainer,idContainerVersion:idContainerVersion};return piwikApi.fetch(params);}
function reload(idContainer,idContainerVersion){model.triggers=[];fetchPromise=null;triggersPromise={};lookUpPromise=null;return fetchTriggers(idContainer,idContainerVersion);}
function fetchAvailableTriggers(idContext){if(!triggersPromise[idContext]){var params={method:'TagManager.getAvailableTriggerTypesInContext',idContext:idContext,filter_limit:'-1'};triggersPromise[idContext]=piwikApi.fetch(params);}
return triggersPromise[idContext];}
function fetchContainer(idContainer){var params={method:'TagManager.getContainer',idContainer:idContainer,filter_limit:'-1'};return piwikApi.fetch(params);}
function fetchAvailableComparisons(){if(!lookUpPromise){var params={method:'TagManager.getAvailableComparisons',filter_limit:'-1'};lookUpPromise=piwikApi.fetch(params);}
return lookUpPromise;}
function suggestNameForType(templateId){var counter;for(counter=0;counter<100;counter++){var name=templateId;if(counter){name=name+' ('+counter+')';}
var isFree=true;angular.forEach(model.triggers,function(trigger){if(trigger&&trigger.name===name){isFree=false;}});if(isFree){return name;}}}
function fetchTriggers(idContainer,idContainerVersion){var params={method:'TagManager.getContainerTriggers',idContainer:idContainer,idContainerVersion:idContainerVersion,filter_limit:'-1'};if(!fetchPromise){fetchPromise=piwikApi.fetch(params);}
model.isLoading=true;model.triggers=[];return fetchPromise.then(function(triggers){model.triggers=triggers;model.isLoading=false;return triggers;},function(){model.isLoading=false;});}
function findTrigger(idContainer,idContainerVersion,idTrigger){var found;angular.forEach(model.triggers,function(trigger){if(!found&&parseInt(trigger.idtrigger,10)===idTrigger){found=trigger;}});if(found){var deferred=$q.defer();deferred.resolve(found);return deferred.promise;}
model.isLoading=true;return piwikApi.fetch({idTrigger:idTrigger,idContainer:idContainer,idContainerVersion:idContainerVersion,method:'TagManager.getContainerTrigger',filter_limit:'-1'}).then(function(record){model.isLoading=false;return record;},function(error){model.isLoading=false;});}
function deleteTrigger(idContainer,idContainerVersion,idTrigger){model.isUpdating=true;model.triggers=[];piwikApi.withTokenInUrl();return piwikApi.fetch({idTrigger:idTrigger,idContainerVersion:idContainerVersion,idContainer:idContainer,method:'TagManager.deleteContainerTrigger'}).then(function(response){model.isUpdating=false;return{type:'success'};},function(error){model.isUpdating=false;return{type:'error',message:error};});}
function createOrUpdateTrigger(trigger,method){trigger=angular.copy(trigger);trigger.method=method;trigger.parameters={};angular.forEach(trigger.typeMetadata.parameters,function(setting){var value=setting.value;if(value===false){value='0';}else if(value===true){value='1';}
trigger.parameters[setting.name]=value;});delete trigger.typeMetadata;var map={idTrigger:'idtrigger',idContainer:'idcontainer',idContainerVersion:'idcontainerversion'};angular.forEach(map,function(value,key){if(typeof trigger[value]!=='undefined'){trigger[key]=trigger[value];delete trigger[value];}});trigger.conditions=filterTriggerConditions(trigger.conditions);var postParams=['parameters','conditions'];var post={};for(var i=0;i<postParams.length;i++){var postParam=postParams[i];if(typeof trigger[postParam]!=='undefined'){post[postParam]=trigger[postParam];delete trigger[postParam];}}
model.isUpdating=true;piwikApi.withTokenInUrl();return piwikApi.post(trigger,post).then(function(response){model.isUpdating=false;return{type:'success',response:response};},function(error){model.isUpdating=false;return{type:'error',message:error};});}}})();
(function(){angular.module('piwikApp').controller('TriggerListController',TriggerListController);TriggerListController.$inject=['$scope','tagManagerTriggerModel','piwik','piwikApi','$location'];function TriggerListController($scope,tagManagerTriggerModel,piwik,piwikApi,$location){this.model=tagManagerTriggerModel;this.hasWriteAccess=piwik.hasUserCapability('tagmanager_write');var self=this;this.idContainer=$scope.idContainer;this.idContainerVersion=$scope.idContainerVersion;this.triggerReferences=[];this.createTrigger=function(){this.editTrigger(0);};this.editTrigger=function(idTrigger){var $search=$location.search();$search.idTrigger=idTrigger;$location.search($search);};this.deleteTrigger=function(trigger){piwikApi.fetch({method:'TagManager.getContainerTriggerReferences',idContainer:this.idContainer,idContainerVersion:this.idContainerVersion,idTrigger:trigger.idtrigger}).then(function(references){if(!references||!references.length){self.triggerReferences=[];function doDelete(){tagManagerTriggerModel.deleteTrigger(self.idContainer,self.idContainerVersion,trigger.idtrigger).then(function(){tagManagerTriggerModel.reload(self.idContainer,self.idContainerVersion);});}
piwik.helper.modalConfirm('#confirmDeleteTrigger',{yes:doDelete});}else{self.triggerReferences=references;piwik.helper.modalConfirm('#confirmDeleteTriggerNotPossible',{});}});};this.model.fetchTriggers(this.idContainer,this.idContainerVersion);}})();
(function(){angular.module('piwikApp').directive('piwikTriggerList',piwikTriggerList);piwikTriggerList.$inject=['piwik'];function piwikTriggerList(piwik){return{restrict:'A',scope:{idContainer:'=',idContainerVersion:'='},templateUrl:'plugins/TagManager/angularjs/manageTrigger/list.directive.html?cb='+piwik.cacheBuster,controller:'TriggerListController',controllerAs:'triggerList'};}})();
(function(){angular.module('piwikApp').controller('TriggerEditController',TriggerEditController);TriggerEditController.$inject=['$scope','tagManagerTriggerModel','piwik','$location','$filter','$timeout','$rootScope'];function TriggerEditController($scope,tagManagerTriggerModel,piwik,$location,$filter,$timeout,$rootScope){var self=this;var currentId=null;var notificationId='tagtriggermanagement';var translate=$filter('translate');this.isDirty=false;this.model=tagManagerTriggerModel;this.idContainer=$scope.idContainer;this.idContainerVersion=$scope.idContainerVersion;this.chooseTriggerType=false;this.isEmbedded=!!$scope.onChangeTrigger;this.canUseCustomTemplates=piwik.hasUserCapability('tagmanager_use_custom_templates');this.availableTriggers=[];this.availableComparisons=[];this.availableVariables=[];this.variableIdToName={};this.model.fetchAvailableComparisons().then(function(comparisons){self.availableComparisons=[];angular.forEach(comparisons,function(comparison){self.availableComparisons.push({key:comparison.id,value:comparison.name});});});this.model.fetchAvailableContainerVariables(this.idContainer,this.idContainerVersion).then(function(variables){self.availableVariables=[];angular.forEach(variables,function(category){angular.forEach(category.types,function(variable){self.variableIdToName[variable.id]=variable.name;self.availableVariables.push({key:variable.id,value:variable.name,group:category.name});});});});this.model.fetchTriggersIfNotLoaded();function enrichTemplateType(template){template.isDisabled=!self.canUseCustomTemplates&&template&&template.isCustomTemplate;return template;}
function getNotification(){var UI=require('piwik/UI');return new UI.Notification();}
function removeAnyTriggerNotification(){var notification=getNotification();notification.remove(notificationId);notification.remove('ajaxHelper');}
function showNotification(message,context){var notification=getNotification();notification.show(message,{context:context,id:notificationId});$timeout(function(){notification.scrollToNotification();},200);}
function showErrorFieldNotProvidedNotification(title){var message=translate('TagManager_ErrorXNotProvided',[title]);showNotification(message,'error');}
var deregisterWatches=[];function init(idTrigger){self.create=idTrigger=='0';self.edit=!self.create;self.trigger={};self.chooseTriggerType=false;self.editTitle='';var dereg;for(dereg=0;dereg<deregisterWatches.length;dereg++){if('function'===typeof deregisterWatches[dereg]){deregisterWatches[dereg]();}}
piwik.helper.lazyScrollToContent();self.availableTriggers=[];self.model.fetchContainer(self.idContainer).then(function(container){return self.model.fetchAvailableTriggers(container.context);}).then(function(triggers){angular.forEach(triggers,function(triggersGroup){angular.forEach(triggersGroup.types,function(trigger){enrichTemplateType(trigger);});});self.availableTriggers=triggers;}).then(function(){if(self.edit&&idTrigger){self.editTitle=translate('TagManager_EditTrigger');self.model.findTrigger(self.idContainer,self.idContainerVersion,idTrigger).then(function(trigger){if(!trigger){return;}
self.trigger=angular.copy(trigger);self.trigger.idcontainer=self.idContainer;if(self.trigger.typeMetadata){enrichTemplateType(self.trigger.typeMetadata);}
self.addConditionEntryIfNoneExists();self.onConditionChange();self.addParameterWatch();self.isDirty=false;});}else if(self.create){self.editTitle=translate('TagManager_ChooseTriggerToContinue');self.chooseTriggerType=true;}});};this.addParameterWatch=function(){var index;if(this.trigger.typeMetadata&&this.trigger.typeMetadata.parameters){for(index=0;index<this.trigger.typeMetadata.parameters.length;index++){deregisterWatches.push($scope.$watch('editTrigger.trigger.typeMetadata.parameters['+index+'].value',function(val,oldVal){if(val!==oldVal){self.isDirty=true;}}));}}};this.onConditionChange=function(){var hasAll=true;angular.forEach(this.trigger.conditions,function(condition){if(!condition||!condition.expected){hasAll=false;}});if(hasAll){this.addConditionEntry();}};this.getDefaultCondition=function(){var defaultActual='PageUrl';if(this.trigger&&this.trigger.typeMetadata){var types={'AllElementsClick':'ClickId','AllLinksClick':'ClickId','DownloadClick':'ClickId','ElementVisibility':'VisibleElementClasses','FormSubmit':'FormId','JavaScriptError':'ErrorMessage'};var type=this.trigger.typeMetadata.id;if(type in types){defaultActual=types[type];}}
return{comparison:'equals',actual:defaultActual,expected:''};}
this.addConditionEntryIfNoneExists=function(){if(!this.trigger.conditions||!angular.isArray(this.trigger.conditions)){this.trigger.conditions=[];}
if(!this.trigger.conditions.length){this.trigger.conditions.push(this.getDefaultCondition());}};this.addConditionEntry=function(){this.trigger.conditions.push(this.getDefaultCondition());this.isDirty=true;};this.removeConditionEntry=function(index){if(index>-1){var lastIndex=this.trigger.conditions.length-1;if(lastIndex===index){this.trigger.conditions[index]=this.getDefaultCondition();}else{this.trigger.conditions.splice(index,1);}
this.isDirty=true;}};this.createTriggerType=function(triggerTemplate){if(triggerTemplate&&triggerTemplate.isDisabled){return;}
this.chooseTriggerType=false;this.editTitle=translate('TagManager_CreateNewTrigger');this.trigger={idSite:piwik.idSite,name:this.model.suggestNameForType(triggerTemplate.name),type:triggerTemplate.id,idcontainer:self.idContainer,idcontainerversion:self.idContainerVersion,parameters:{},conditions:[],typeMetadata:triggerTemplate};this.addConditionEntry();this.addParameterWatch();this.isDirty=true;$timeout(function(){var $editTrigger=$('.editTrigger');if($editTrigger.length&&$editTrigger[0]){$editTrigger[0].scrollIntoView()}
$('.editTrigger #name').focus();},1);};this.cancel=function(){$scope.idTrigger=null;currentId=null;var $search=$location.search();delete $search.idTrigger;$location.search($search);};$scope.$on('$destroy',function(){$scope.idTrigger=null;currentId=null;});function checkRequiredFieldsAreSet(){var title;if(!self.trigger.name){title=_pk_translate('General_Name');showErrorFieldNotProvidedNotification(title);return false;}
return true;}
this.createTrigger=function(){removeAnyTriggerNotification();if(!checkRequiredFieldsAreSet()){return;}
this.isUpdating=true;tagManagerTriggerModel.createOrUpdateTrigger(this.trigger,'TagManager.addContainerTrigger').then(function(response){self.isUpdating=false;if(!response||response.type==='error'||!response.response){return;}
var idTrigger=response.response.value;if('function'===typeof $scope.onChangeTrigger){self.model.reload(self.idContainer,self.idContainerVersion);self.trigger.idtrigger=idTrigger;$scope.onChangeTrigger({trigger:self.trigger});return;}
self.isDirty=false;tagManagerTriggerModel.reload(self.idContainer,self.idContainerVersion).then(function(){var $search=$location.search();$search.idTrigger=idTrigger;$location.search($search);$timeout(function(){showNotification(translate('TagManager_CreatedX',translate('TagManager_Trigger'))+' '+translate('TagManager_WantToDeployThisChangeCreateVersion','<a onclick="tagManagerHelper.createNewVersion()">','</a>'),response.type);},200);});},function(){self.isUpdating=false;});};this.setValueHasChanged=function(){this.isDirty=true;};this.updateTrigger=function(){removeAnyTriggerNotification();if(!checkRequiredFieldsAreSet()){return;}
this.isUpdating=true;tagManagerTriggerModel.createOrUpdateTrigger(this.trigger,'TagManager.updateContainerTrigger').then(function(response){if(response.type==='error'){return;}
if('function'===typeof $scope.onChangeTrigger){self.trigger.idtrigger=idTrigger;$scope.onChangeTrigger({trigger:self.trigger});return;}
var idTrigger=self.trigger.idtrigger;self.isDirty=false;self.trigger={};tagManagerTriggerModel.reload(self.idContainer,self.idContainerVersion).then(function(){init(idTrigger);});showNotification(translate('TagManager_UpdatedX',translate('TagManager_Trigger'))+' '+translate('TagManager_WantToDeployThisChangeCreateVersion','<a onclick="tagManagerHelper.createNewVersion()">','</a>'),response.type);});};$scope.$watch('idTrigger',function(newValue,oldValue){if(newValue===null){return;}
if(newValue!=oldValue||currentId===null){currentId=newValue;init(newValue);}});}})();
(function(){angular.module('piwikApp').directive('piwikTriggerEdit',piwikTriggerEdit);piwikTriggerEdit.$inject=['piwik'];function piwikTriggerEdit(piwik){return{restrict:'A',scope:{idTrigger:'=',idContainer:'=',idContainerVersion:'=',newTriggerType:'=',onChangeTrigger:'&?'},templateUrl:'plugins/TagManager/angularjs/manageTrigger/edit.directive.html?cb='+piwik.cacheBuster,controller:'TriggerEditController',controllerAs:'editTrigger'};}})();
(function(){angular.module('piwikApp').controller('ManageTriggerController',ManageTriggerController);ManageTriggerController.$inject=['$scope','$rootScope','$location'];function ManageTriggerController($scope,$rootScope,$location){this.editMode=false;var self=this;this.idContainer=$scope.idContainer;this.idContainerVersion=$scope.idContainerVersion;function removeAnyTriggerNotification(){var UI=require('piwik/UI');new UI.Notification().remove('triggertriggermanagement');}
function initState(){var $search=$location.search();if('idTrigger'in $search){if($search.idTrigger===0||$search.idTrigger==='0'){var parameters={isAllowed:true};$rootScope.$emit('TagManager.initAddTrigger',parameters);if(parameters&&!parameters.isAllowed){self.editMode=false;self.idTrigger=null;return;}}
self.editMode=true;self.idTrigger=parseInt($search.idTrigger,10);}else{self.editMode=false;self.idTrigger=null;}
removeAnyTriggerNotification();}
initState();var onChangeSuccess=$rootScope.$on('$locationChangeSuccess',initState);$scope.$on('$destroy',function(){if(onChangeSuccess){onChangeSuccess();}});}})();
(function(){angular.module('piwikApp').directive('piwikTriggerManage',piwikTriggerManage);piwikTriggerManage.$inject=['piwik'];function piwikTriggerManage(piwik){return{restrict:'A',scope:{idContainerVersion:'@',idContainer:'@'},templateUrl:'plugins/TagManager/angularjs/manageTrigger/manage.directive.html?cb='+piwik.cacheBuster,controller:'ManageTriggerController',controllerAs:'manageTrigger'};}})();
(function(){angular.module('piwikApp').factory('tagManagerTagModel',tagManagerTagModel);tagManagerTagModel.$inject=['piwikApi','$q','$filter'];function tagManagerTagModel(piwikApi,$q,$filter){var fetchPromise=null;var tagsPromise={};var fireLimitsPromise=null;var translate=$filter('translate');var model={tags:[],isLoading:false,isUpdating:false,findTag:findTag,createOrUpdateTag:createOrUpdateTag,fetchAvailableTags:fetchAvailableTags,fetchContainerTriggers:fetchContainerTriggers,fetchContainer:fetchContainer,fetchAvailableFireLimits:fetchAvailableFireLimits,suggestNameForType:suggestNameForType,deleteTag:deleteTag,reload:reload,onReload:null,fetchTags:fetchTags};return model;function reload(idContainer,idContainerVersion){model.tags=[];fetchPromise=null;tagsPromise={};fireLimitsPromise=null;if(model.onReload){model.onReload();}
return fetchTags(idContainer,idContainerVersion);}
function fetchAvailableTags(idContext){if(!tagsPromise[idContext]){var params={method:'TagManager.getAvailableTagTypesInContext',idContext:idContext,filter_limit:'-1'};tagsPromise[idContext]=piwikApi.fetch(params);}
return tagsPromise[idContext];}
function fetchContainerTriggers(idContainer,idContainerVersion){var params={method:'TagManager.getContainerTriggers',idContainer:idContainer,idContainerVersion:idContainerVersion,filter_limit:'-1'};return piwikApi.fetch(params);}
function fetchContainer(idContainer){var params={method:'TagManager.getContainer',idContainer:idContainer,filter_limit:'-1'};return piwikApi.fetch(params);}
function fetchAvailableFireLimits(){if(!fireLimitsPromise){var params={method:'TagManager.getAvailableTagFireLimits',filter_limit:'-1'};fireLimitsPromise=piwikApi.fetch(params);}
return fireLimitsPromise;}
function fetchTags(idContainer,idContainerVersion){var params={method:'TagManager.getContainerTags',idContainer:idContainer,idContainerVersion:idContainerVersion,filter_limit:'-1'};if(!fetchPromise){fetchPromise=piwikApi.fetch(params);}
model.isLoading=true;model.tags=[];return fetchPromise.then(function(tags){model.tags=tags;model.isLoading=false;return tags;},function(){model.isLoading=false;});}
function findTag(idContainer,idContainerVersion,idTag){var found;angular.forEach(model.tags,function(tag){if(!found&&parseInt(tag.idtag,10)===idTag){found=tag;}});if(found){var deferred=$q.defer();deferred.resolve(found);return deferred.promise;}
model.isLoading=true;return piwikApi.fetch({idTag:idTag,idContainer:idContainer,idContainerVersion:idContainerVersion,method:'TagManager.getContainerTag',filter_limit:'-1'}).then(function(record){model.isLoading=false;return record;},function(error){model.isLoading=false;});}
function deleteTag(idContainer,idContainerVersion,idTag){model.isUpdating=true;model.tags=[];piwikApi.withTokenInUrl();return piwikApi.fetch({idTag:idTag,idContainerVersion:idContainerVersion,idContainer:idContainer,method:'TagManager.deleteContainerTag'}).then(function(response){model.isUpdating=false;return{type:'success'};},function(error){model.isUpdating=false;return{type:'error',message:error};});}
function suggestNameForType(templateId){var counter;for(counter=0;counter<100;counter++){var name=templateId;if(counter){name=name+' ('+counter+')';}
var isFree=true;angular.forEach(model.tags,function(tag){if(tag&&tag.name===name){isFree=false;}});if(isFree){return name;}}}
function createOrUpdateTag(tag,method){tag=angular.copy(tag);tag.method=method;tag.parameters={};angular.forEach(tag.typeMetadata.parameters,function(setting){var value=setting.value;if(value===false){value='0';}else if(value===true){value='1';}
tag.parameters[setting.name]=value;});delete tag.typeMetadata;var map={idTag:'idtag',idContainer:'idcontainer',idContainerVersion:'idcontainerversion',startDate:'start_date',endDate:'end_date',fireLimit:'fire_limit',fireDelay:'fire_delay'};tag.fireTriggerIds=[];angular.forEach(tag.fire_triggers,function(trigger){if(trigger&&trigger.idtrigger){tag.fireTriggerIds.push(trigger.idtrigger);}});tag.blockTriggerIds=[];angular.forEach(tag.block_triggers,function(trigger){if(trigger&&trigger.idtrigger){tag.blockTriggerIds.push(trigger.idtrigger);}});delete tag.block_triggers;delete tag.block_trigger_ids;delete tag.fire_triggers;delete tag.fire_trigger_ids;angular.forEach(map,function(value,key){if(typeof tag[value]!=='undefined'){tag[key]=tag[value];delete tag[value];}});var postParams=['parameters','fireTriggerIds','blockTriggerIds'];var post={};for(var i=0;i<postParams.length;i++){var postParam=postParams[i];if(typeof tag[postParam]!=='undefined'){post[postParam]=tag[postParam];delete tag[postParam];}}
model.isUpdating=true;piwikApi.withTokenInUrl();return piwikApi.post(tag,post).then(function(response){model.isUpdating=false;return{type:'success',response:response};},function(error){model.isUpdating=false;return{type:'error',message:error};});}}})();
(function(){angular.module('piwikApp').controller('TagListController',TagListController);TagListController.$inject=['$scope','tagManagerTagModel','tagManagerTriggerModel','piwik','piwikApi','$location'];function TagListController($scope,tagManagerTagModel,tagManagerTriggerModel,piwik,piwikApi,$location){this.model=tagManagerTagModel;this.hasWriteAccess=piwik.hasUserCapability('tagmanager_write');var self=this;this.idContainer=$scope.idContainer;this.idContainerVersion=$scope.idContainerVersion;this.triggers={};function updateTriggers(){tagManagerTriggerModel.reload(self.idContainer,self.idContainerVersion).then(function(triggers){self.triggers={};angular.forEach(triggers,function(trigger){self.triggers[trigger.idtrigger]=trigger.name;});});}
this.model.onReload=function(){updateTriggers();};this.createTag=function(){this.editTag(0);};this.editTrigger=function(idTrigger){tagManagerHelper.editTrigger($scope,this.idContainer,this.idContainerVersion,idTrigger,function(){updateTriggers();});};this.editTag=function(idTag){var $search=$location.search();$search.idTag=idTag;$location.search($search);};this.deleteTag=function(tag){function doDelete(){tagManagerTagModel.deleteTag(self.idContainer,self.idContainerVersion,tag.idtag).then(function(){tagManagerTagModel.reload(self.idContainer,self.idContainerVersion);});}
piwik.helper.modalConfirm('#confirmDeleteTag',{yes:doDelete});};this.model.fetchTags(this.idContainer,this.idContainerVersion);updateTriggers();}})();
(function(){angular.module('piwikApp').directive('piwikTagList',piwikTagList);piwikTagList.$inject=['piwik'];function piwikTagList(piwik){return{restrict:'A',scope:{idContainer:'=',idContainerVersion:'='},templateUrl:'plugins/TagManager/angularjs/manageTag/list.directive.html?cb='+piwik.cacheBuster,controller:'TagListController',controllerAs:'tagList'};}})();
(function(){angular.module('piwikApp').controller('TagEditController',TagEditController);TagEditController.$inject=['$scope','tagManagerTagModel','piwik','$location','$filter','$timeout','$rootScope'];function TagEditController($scope,tagManagerTagModel,piwik,$location,$filter,$timeout,$rootScope){var self=this;var currentId=null;var notificationId='tagtagmanagement';var translate=$filter('translate');this.isDirty=false;this.model=tagManagerTagModel;this.idContainer=$scope.idContainer;this.idContainerVersion=$scope.idContainerVersion;this.showAdvanced=false;this.chooseTagType=false;this.canUseCustomTemplates=piwik.hasUserCapability('tagmanager_use_custom_templates');this.availableTags=[];this.availableFireLimits=[];this.containerTriggers=[];this.currentTime=null;function prefixDateZeroIfNeeded(number){var datePart=String(number);if(datePart.length===1){datePart='0'+datePart;}
return datePart;}
function convertLocalDateToUtc(dateTime){if(dateTime){dateTime=dateTime.replace(/-/g,'/');}
try{var localDate=new Date(dateTime)
var formatted='';formatted+=localDate.getUTCFullYear()+'-'+prefixDateZeroIfNeeded(localDate.getUTCMonth()+1)+'-'+prefixDateZeroIfNeeded(localDate.getUTCDate());formatted+=' ';formatted+=prefixDateZeroIfNeeded(localDate.getUTCHours())+':'+prefixDateZeroIfNeeded(localDate.getUTCMinutes())+':'+prefixDateZeroIfNeeded(localDate.getUTCSeconds());return formatted;}catch(e){return dateTime;}}
function convertUtcToLocalDate(dateTime){if(!dateTime){return;}
var isoDate=dateTime;var result,datePart,timePart,dateParts,timeParts,newTime;if(isoDate){isoDate=(isoDate+'').replace(/-/g,'/');try{result=new Date(isoDate+' UTC');return result;}catch(e){try{result=Date.parse(isoDate+' UTC');result=new Date(result);return result;}catch(ex){datePart=isoDate.substr(0,10);timePart=isoDate.substr(11);dateParts=datePart.split('/');timeParts=timePart.split(':');if(dateParts.length===3&&timeParts.length===3){result=new Date(dateParts[0],dateParts[1]-1,dateParts[2],timeParts[0],timeParts[1],timeParts[2]);newTime=result.getTime()+(result.getTimezoneOffset()*60000);result=new Date(newTime);return result;}}}}};function convertUtcDateToLocalDatePart(isoDateTime){var localStartDate=convertUtcToLocalDate(isoDateTime);if(localStartDate){return localStartDate.getFullYear()+'-'+prefixDateZeroIfNeeded(localStartDate.getMonth()+1)+'-'+prefixDateZeroIfNeeded(localStartDate.getDate());}
var parts=isoDateTime.split(' ');return parts[0];}
function convertUtcDateToLocalTimePart(isoDateTime){var localStartDate=convertUtcToLocalDate(isoDateTime);if(localStartDate){return prefixDateZeroIfNeeded(localStartDate.getHours())+':'+prefixDateZeroIfNeeded(localStartDate.getMinutes())+':'+prefixDateZeroIfNeeded(localStartDate.getSeconds());}
var parts=isoDateTime.split(' ');return parts[1];}
function enrichTemplateType(template){template.isDisabled=!self.canUseCustomTemplates&&template&&template.isCustomTemplate;return template;}
function updateAvailableTriggers(){self.model.fetchContainerTriggers(self.idContainer,self.idContainerVersion).then(function(triggers){self.containerTriggers=[];angular.forEach(triggers,function(trigger){self.containerTriggers.push({key:trigger.idtrigger,value:trigger.name});});});}
updateAvailableTriggers();function getCurrentTime(){var date=new Date();if(date&&date.toString){return date.toString();}}
function setCurrentTime(){self.currentTime=getCurrentTime();$timeout(setCurrentTime,10000);}
setCurrentTime();this.model.fetchAvailableFireLimits().then(function(fireLimits){self.availableFireLimits=[];angular.forEach(fireLimits,function(fireLimit){self.availableFireLimits.push({key:fireLimit.id,value:fireLimit.name});});});function getNotification(){var UI=require('piwik/UI');return new UI.Notification();}
function removeAnyTagNotification(){var notification=getNotification();notification.remove(notificationId);notification.remove('ajaxHelper');}
function showNotification(message,context){var notification=getNotification();notification.show(message,{context:context,id:notificationId});$timeout(function(){notification.scrollToNotification();},200);}
function showErrorFieldNotProvidedNotification(title){var message=_pk_translate('TagManager_ErrorXNotProvided',[title]);showNotification(message,'error');}
var deregisterWatches=[];function init(idTag){self.create=idTag=='0';self.edit=!self.create;self.tag={};self.chooseTagType=false;self.editTitle='';var dereg;for(dereg=0;dereg<deregisterWatches.length;dereg++){if('function'===typeof deregisterWatches[dereg]){deregisterWatches[dereg]();}}
piwik.helper.lazyScrollToContent();self.availableTags=[];self.model.fetchContainer(self.idContainer).then(function(container){return self.model.fetchAvailableTags(container.context);}).then(function(tags){angular.forEach(tags,function(tagsGroup){angular.forEach(tagsGroup.types,function(tag){enrichTemplateType(tag);});});self.availableTags=tags;}).then(function(){if(self.edit&&idTag){self.editTitle=translate('TagManager_EditTag');self.model.findTag(self.idContainer,self.idContainerVersion,idTag).then(function(tag){if(!tag){return;}
self.tag=angular.copy(tag);self.tag.idcontainer=self.idContainer;self.tag.block_triggers=[];self.tag.fire_triggers=[];if(self.tag.typeMetadata){enrichTemplateType(self.tag.typeMetadata);}
if(angular.isArray(self.tag.block_trigger_ids)){angular.forEach(self.tag.block_trigger_ids,function(id){self.tag.block_triggers.push({idtrigger:id});});}
if(!self.tag.block_triggers.length){self.tag.block_triggers.push({idtrigger:''});}
if(angular.isArray(self.tag.fire_trigger_ids)){angular.forEach(self.tag.fire_trigger_ids,function(id){self.tag.fire_triggers.push({idtrigger:id});});}
if(!self.tag.fire_triggers.length){self.tag.fire_triggers.push({idtrigger:''});}
if(self.tag.start_date){self.tag.start_date_date=convertUtcDateToLocalDatePart(self.tag.start_date);self.tag.start_date_time=convertUtcDateToLocalTimePart(self.tag.start_date)}
if(self.tag.end_date){self.tag.end_date_date=convertUtcDateToLocalDatePart(self.tag.end_date);self.tag.end_date_time=convertUtcDateToLocalTimePart(self.tag.end_date)}
self.addParameterWatch();self.onFireTriggerChange();self.onBlockTriggerChange();self.isDirty=false;});}else if(self.create){self.editTitle=translate('TagManager_ChooseTagToContinue');self.chooseTagType=true;}});};this.addParameterWatch=function(){var index;if(this.tag.typeMetadata&&this.tag.typeMetadata.parameters){for(index=0;index<this.tag.typeMetadata.parameters.length;index++){deregisterWatches.push($scope.$watch('editTag.tag.typeMetadata.parameters['+index+'].value',function(val,oldVal){if(val!==oldVal){self.isDirty=true;}}));}}};this.onCreateNewBlockTrigger=function(callback){this.openEditTrigger(function(trigger){var indexLastEntry=self.tag.block_triggers.length-1;if(!self.tag.block_triggers[indexLastEntry]||!self.tag.block_triggers[indexLastEntry].idtrigger){self.tag.block_triggers[indexLastEntry]={idtrigger:trigger.idtrigger};}else{self.tag.block_triggers.push({idtrigger:trigger.idtrigger});}
self.onBlockTriggerChange();},0);};this.onCreateNewFireTrigger=function(){this.openEditTrigger(function(trigger){var indexLastEntry=self.tag.fire_triggers.length-1;if(!self.tag.fire_triggers[indexLastEntry]||!self.tag.fire_triggers[indexLastEntry].idtrigger){self.tag.fire_triggers[indexLastEntry]={idtrigger:trigger.idtrigger};}else{self.tag.fire_triggers.push({idtrigger:trigger.idtrigger});}
self.onFireTriggerChange();},0);};this.editTrigger=function(idTrigger){this.openEditTrigger(function(trigger){},idTrigger);};this.openEditTrigger=function(callback,idTag){tagManagerHelper.editTrigger($scope,this.idContainer,this.idContainerVersion,idTag,function(trigger){updateAvailableTriggers();callback(trigger);});};this.onBlockTriggerChange=function(){var hasAll=true;angular.forEach(this.tag.block_triggers,function(trigger){if(!trigger||!trigger.idtrigger){hasAll=false;}});if(hasAll){this.addBlockTrigger();}};this.addBlockTrigger=function(){this.tag.block_triggers.push({idtrigger:''});this.isDirty=true;};this.removeBlockTrigger=function(index){if(index>-1){var lastIndex=this.tag.block_triggers.length-1;if(lastIndex===index){this.tag.block_triggers[index]={idtrigger:''};}else{this.tag.block_triggers.splice(index,1);}
this.isDirty=true;}};this.onFireTriggerChange=function(){var hasAll=true;angular.forEach(this.tag.fire_triggers,function(trigger){if(!trigger||!trigger.idtrigger){hasAll=false;}});if(hasAll){this.addFireTrigger();}};this.addFireTrigger=function(){this.tag.fire_triggers.push({idtrigger:''});this.isDirty=true;};this.removeFireTrigger=function(index){if(index>-1){var lastIndex=this.tag.fire_triggers.length-1;if(lastIndex===index){this.tag.block_triggers[index]={idtrigger:''};}else{this.tag.fire_triggers.splice(index,1);}
this.isDirty=true;}};this.createTagType=function(tagTemplate){if(tagTemplate&&tagTemplate.isDisabled){return;}
this.chooseTagType=false;this.editTitle=translate('TagManager_CreateNewTag');this.tag={idSite:piwik.idSite,name:this.model.suggestNameForType(tagTemplate.name),type:tagTemplate.id,idcontainer:self.idContainer,idcontainerversion:self.idContainerVersion,parameters:{},fire_limit:'unlimited',priority:999,fire_delay:0,block_triggers:[{idtrigger:''}],fire_triggers:[{idtrigger:''}],typeMetadata:tagTemplate};this.addParameterWatch();this.isDirty=false;$timeout(function(){var editTag=$('.editTag');if(editTag.length&&editTag[0]){editTag[0].scrollIntoView()}
$('.editTag #name').focus();},1);};this.cancel=function(){$scope.idTag=null;currentId=null;var $search=$location.search();delete $search.idTag;$location.search($search);};$scope.$on('$destroy',function(){$scope.idTag=null;currentId=null;});function checkRequiredFieldsAreSet(){var title;if(!self.tag.name){title=translate('General_Name');showErrorFieldNotProvidedNotification(title);return false;}
if(!self.tag.fire_triggers||!self.tag.fire_triggers.length){showNotification(translate('TagManager_TagFireTriggerRequirement'),'error');return false;}
return true;}
this.onAnyDateChange=function(){if(this.tag.start_date_date){if(!this.tag.start_date_time){this.tag.start_date_time='00:00:00';}
this.tag.start_date=convertLocalDateToUtc(this.tag.start_date_date+' '+this.tag.start_date_time);}else{this.tag.start_date=null;}
if(this.tag.end_date_date){if(!this.tag.end_date_time){this.tag.end_date_time='23:59:59';}
this.tag.end_date=convertLocalDateToUtc(this.tag.end_date_date+' '+this.tag.end_date_time);}else{this.tag.end_date=null;}};this.createTag=function(){removeAnyTagNotification();if(!checkRequiredFieldsAreSet()){return;}
this.isUpdating=true;tagManagerTagModel.createOrUpdateTag(this.tag,'TagManager.addContainerTag').then(function(response){self.isUpdating=false;if(!response||response.type==='error'||!response.response){return;}
self.isDirty=false;var idTag=response.response.value;tagManagerTagModel.reload(self.idContainer,self.idContainerVersion).then(function(){var $search=$location.search();$search.idTag=idTag;$location.search($search);$timeout(function(){showNotification(translate('TagManager_CreatedX',translate('TagManager_Tag'))+' '+translate('TagManager_WantToDeployThisChangeCreateVersion','<a onclick="tagManagerHelper.createNewVersion()">','</a>'),response.type);},200);});},function(){self.isUpdating=false;});};this.setValueHasChanged=function(){this.isDirty=true;};this.updateTag=function(){removeAnyTagNotification();if(!checkRequiredFieldsAreSet()){return;}
this.isUpdating=true;tagManagerTagModel.createOrUpdateTag(this.tag,'TagManager.updateContainerTag').then(function(response){if(response.type==='error'){return;}
var idTag=self.tag.idtag;self.isDirty=false;self.tag={};tagManagerTagModel.reload(self.idContainer,self.idContainerVersion).then(function(){init(idTag);});showNotification(translate('TagManager_UpdatedX',translate('TagManager_Tag'))+' '+translate('TagManager_WantToDeployThisChangeCreateVersion','<a onclick="tagManagerHelper.createNewVersion()">','</a>'),response.type);});};var options1=piwik.getBaseDatePickerOptions(null);delete options1.maxDate;options1.minDate=new Date();var options2=angular.copy(options1);$timeout(function(){$(".tagStartDateInput").datepicker(options1);$(".tagEndDateInput").datepicker(options2);$('.tagStartTimeInput').timepicker({timeFormat:'H:i:s'});$('.tagEndTimeInput').timepicker({timeFormat:'H:i:s'});});$scope.$watch('idTag',function(newValue,oldValue){if(newValue===null){return;}
if(newValue!=oldValue||currentId===null){currentId=newValue;init(newValue);}});}})();
(function(){angular.module('piwikApp').directive('piwikTagEdit',piwikTagEdit);piwikTagEdit.$inject=['piwik'];function piwikTagEdit(piwik){return{restrict:'A',scope:{idTag:'=',idContainer:'=',idContainerVersion:'=',newTagType:'='},templateUrl:'plugins/TagManager/angularjs/manageTag/edit.directive.html?cb='+piwik.cacheBuster,controller:'TagEditController',controllerAs:'editTag'};}})();
(function(){angular.module('piwikApp').controller('ManageTagController',ManageTagController);ManageTagController.$inject=['$scope','$rootScope','$location'];function ManageTagController($scope,$rootScope,$location){this.editMode=false;var self=this;this.idContainer=$scope.idContainer;this.idContainerVersion=$scope.idContainerVersion;function removeAnyTagNotification(){var UI=require('piwik/UI');new UI.Notification().remove('tagtagmanagement');}
function initState(){var $search=$location.search();if('idTag'in $search){if($search.idTag===0||$search.idTag==='0'){var parameters={isAllowed:true};$rootScope.$emit('TagManager.initAddTag',parameters);if(parameters&&!parameters.isAllowed){self.editMode=false;self.idTag=null;return;}}
self.editMode=true;self.idTag=parseInt($search.idTag,10);}else{self.editMode=false;self.idTag=null;}
removeAnyTagNotification();}
initState();var onChangeSuccess=$rootScope.$on('$locationChangeSuccess',initState);$scope.$on('$destroy',function(){if(onChangeSuccess){onChangeSuccess();}});}})();
(function(){angular.module('piwikApp').directive('piwikTagManage',piwikTagManage);piwikTagManage.$inject=['piwik'];function piwikTagManage(piwik){return{restrict:'A',scope:{idContainerVersion:'@',idContainer:'@'},templateUrl:'plugins/TagManager/angularjs/manageTag/manage.directive.html?cb='+piwik.cacheBuster,controller:'ManageTagController',controllerAs:'manageTag'};}})();
(function(){angular.module('piwikApp').factory('tagManagerVariableModel',tagManagerVariableModel);tagManagerVariableModel.$inject=['piwikApi','$q','$filter'];function tagManagerVariableModel(piwikApi,$q,$filter){var fetchPromise=null;var variablesPromise={};var comparisonPromise=null;var preconfiguredVarsPromise=null;var translate=$filter('translate');var model={variables:[],isLoading:false,isUpdating:false,findVariable:findVariable,createOrUpdateVariable:createOrUpdateVariable,fetchAvailableVariables:fetchAvailableVariables,fetchContainer:fetchContainer,fetchAvailableComparisons:fetchAvailableComparisons,suggestNameForType:suggestNameForType,deleteVariable:deleteVariable,reload:reload,fetchVariables:fetchVariables,fetchVariablesIfNotLoaded:fetchVariablesIfNotLoaded,fetchAvailableContainerVariables:fetchAvailableContainerVariables};return model;function arrayFilter(array,filter){var entries=[];angular.forEach(array,function(value){if(filter(value)){entries.push(value);}});return entries;}
function filterLookupTable(lookups){return arrayFilter(lookups,function(lookup){return!!lookup&&lookup.out_value&&lookup.comparison;});}
function reload(idContainer,idContainerVersion){model.variables=[];fetchPromise=null;variablesPromise={};comparisonPromise=null;return fetchVariables(idContainer,idContainerVersion);}
function fetchVariablesIfNotLoaded(idContainer,idContainerVersion){if(!fetchPromise){model.fetchVariables(idContainer,idContainerVersion);}}
function fetchAvailableVariables(idContext){if(!variablesPromise[idContext]){var params={method:'TagManager.getAvailableVariableTypesInContext',idContext:idContext,filter_limit:'-1'};variablesPromise[idContext]=piwikApi.fetch(params);}
return variablesPromise[idContext];}
function fetchAvailableContainerVariables(idContainer,idContainerVersion){if(!preconfiguredVarsPromise){var params={method:'TagManager.getAvailableContainerVariables',idContainer:idContainer,idContainerVersion:idContainerVersion,filter_limit:'-1'};preconfiguredVarsPromise=piwikApi.fetch(params);}
return preconfiguredVarsPromise;}
function fetchContainer(idContainer){var params={method:'TagManager.getContainer',idContainer:idContainer,filter_limit:'-1'};return piwikApi.fetch(params);}
function fetchAvailableComparisons(){if(!comparisonPromise){var params={method:'TagManager.getAvailableComparisons',filter_limit:'-1'};comparisonPromise=piwikApi.fetch(params);}
return comparisonPromise;}
function suggestNameForType(templateId){var counter;for(counter=0;counter<100;counter++){var name=templateId;if(counter){name=name+' ('+counter+')';}
var isFree=true;angular.forEach(model.variables,function(variable){if(variable&&variable.name===name){isFree=false;}});if(isFree){return name;}}}
function fetchVariables(idContainer,idContainerVersion){var params={method:'TagManager.getContainerVariables',idContainer:idContainer,idContainerVersion:idContainerVersion,filter_limit:'-1'};if(!fetchPromise){fetchPromise=piwikApi.fetch(params);}
model.isLoading=true;model.variables=[];return fetchPromise.then(function(variables){model.variables=variables;model.isLoading=false;return variables;},function(){model.isLoading=false;});}
function findVariable(idContainer,idContainerVersion,idVariable){var found;angular.forEach(model.variables,function(variable){if(!found&&parseInt(variable.idvariable,10)===idVariable){found=variable;}});if(found){var deferred=$q.defer();deferred.resolve(found);return deferred.promise;}
model.isLoading=true;return piwikApi.fetch({idVariable:idVariable,idContainer:idContainer,idContainerVersion:idContainerVersion,method:'TagManager.getContainerVariable',filter_limit:'-1'}).then(function(record){model.isLoading=false;return record;},function(error){model.isLoading=false;});}
function deleteVariable(idContainer,idContainerVersion,idVariable){model.isUpdating=true;model.variables=[];piwikApi.withTokenInUrl();return piwikApi.fetch({idVariable:idVariable,idContainerVersion:idContainerVersion,idContainer:idContainer,method:'TagManager.deleteContainerVariable'}).then(function(response){model.isUpdating=false;return{type:'success'};},function(error){model.isUpdating=false;return{type:'error',message:error};});}
function createOrUpdateVariable(variable,method){variable=angular.copy(variable);variable.method=method;variable.parameters={};angular.forEach(variable.typeMetadata.parameters,function(setting){var value=setting.value;if(value===false){value='0';}else if(value===true){value='1';}
variable.parameters[setting.name]=value;});delete variable.typeMetadata;var map={idVariable:'idvariable',idContainer:'idcontainer',idContainerVersion:'idcontainerversion',lookupTable:'lookup_table',defaultValue:'default_value'};angular.forEach(map,function(value,key){if(typeof variable[value]!=='undefined'){variable[key]=variable[value];delete variable[value];}});variable.lookupTable=filterLookupTable(variable.lookupTable);var postParams=['parameters','lookupTable'];var post={};for(var i=0;i<postParams.length;i++){var postParam=postParams[i];if(typeof variable[postParam]!=='undefined'){post[postParam]=variable[postParam];delete variable[postParam];}}
model.isUpdating=true;piwikApi.withTokenInUrl();return piwikApi.post(variable,post).then(function(response){model.isUpdating=false;return{type:'success',response:response};},function(error){model.isUpdating=false;return{type:'error',message:error};});}}})();
(function(){angular.module('piwikApp').controller('VariableListController',VariableListController);VariableListController.$inject=['$scope','tagManagerVariableModel','piwik','piwikApi','$location'];function VariableListController($scope,tagManagerVariableModel,piwik,piwikApi,$location){this.model=tagManagerVariableModel;this.hasWriteAccess=piwik.hasUserCapability('tagmanager_write');var self=this;this.idContainer=$scope.idContainer;this.idContainerVersion=$scope.idContainerVersion;this.variableReferences=[];this.createVariable=function(){this.editVariable(0);};this.editVariable=function(idVariable){var $search=$location.search();$search.idVariable=idVariable;$location.search($search);};this.deleteVariable=function(variable){piwikApi.fetch({method:'TagManager.getContainerVariableReferences',idContainer:this.idContainer,idContainerVersion:this.idContainerVersion,idVariable:variable.idvariable}).then(function(references){if(!references||!references.length){self.variableReferences=[];function doDelete(){tagManagerVariableModel.deleteVariable(self.idContainer,self.idContainerVersion,variable.idvariable).then(function(){tagManagerVariableModel.reload(self.idContainer,self.idContainerVersion);});}
piwik.helper.modalConfirm('#confirmDeleteVariable',{yes:doDelete});}else{self.variableReferences=references;piwik.helper.modalConfirm('#confirmDeleteVariableNotPossible',{});}});};this.model.fetchVariables(this.idContainer,this.idContainerVersion);this.model.fetchAvailableContainerVariables(this.idContainer,this.idContainerVersion).then(function(variables){self.containerVariables=variables;});}})();
(function(){angular.module('piwikApp').directive('piwikVariableList',piwikVariableList);piwikVariableList.$inject=['piwik'];function piwikVariableList(piwik){return{restrict:'A',scope:{idContainer:'=',idContainerVersion:'='},templateUrl:'plugins/TagManager/angularjs/manageVariable/list.directive.html?cb='+piwik.cacheBuster,controller:'VariableListController',controllerAs:'variableList'};}})();
(function(){angular.module('piwikApp').controller('VariableEditController',VariableEditController);VariableEditController.$inject=['$scope','tagManagerVariableModel','piwik','$location','$filter','$timeout','$rootScope'];function VariableEditController($scope,tagManagerVariableModel,piwik,$location,$filter,$timeout,$rootScope){var self=this;var currentId=null;var notificationId='tagvariablemanagement';var translate=$filter('translate');this.isDirty=false;this.model=tagManagerVariableModel;this.idContainer=$scope.idContainer;this.idContainerVersion=$scope.idContainerVersion;this.showAdvanced=false;this.chooseVariableType=false;this.isEmbedded=!!$scope.onChangeVariable;this.canUseCustomTemplates=piwik.hasUserCapability('tagmanager_use_custom_templates');this.availableVariables=[];this.availableLookUpComparisons=[];this.model.fetchAvailableComparisons().then(function(lookUpComparisons){self.availableLookUpComparisons=[];angular.forEach(lookUpComparisons,function(lookupComparison){self.availableLookUpComparisons.push({key:lookupComparison.id,value:lookupComparison.name});});});this.model.fetchVariablesIfNotLoaded(this.idContainer,this.idContainerVersion);function enrichTemplateType(template){template.isDisabled=!self.canUseCustomTemplates&&template&&template.isCustomTemplate;return template;}
function getNotification(){var UI=require('piwik/UI');return new UI.Notification();}
function removeAnyVariableNotification(){var notification=getNotification();notification.remove(notificationId);notification.remove('ajaxHelper');}
function showNotification(message,context){var notification=getNotification();notification.show(message,{context:context,id:notificationId});$timeout(function(){notification.scrollToNotification();},200);}
function showErrorFieldNotProvidedNotification(title){var message=translate('TagManager_ErrorXNotProvided',[title]);showNotification(message,'error');}
var deregisterWatches=[];function init(idVariable){self.create=idVariable=='0';self.edit=!self.create;self.variable={};self.chooseVariableType=false;self.editTitle='';var dereg;for(dereg=0;dereg<deregisterWatches.length;dereg++){if('function'===typeof deregisterWatches[dereg]){deregisterWatches[dereg]();}}
piwik.helper.lazyScrollToContent();self.availableVariables=[];self.model.fetchContainer(self.idContainer).then(function(container){return self.model.fetchAvailableVariables(container.context);}).then(function(variables){angular.forEach(variables,function(variablesGroup){angular.forEach(variablesGroup.types,function(variable){enrichTemplateType(variable);});});self.availableVariables=variables;}).then(function(){if(self.edit&&idVariable){self.editTitle=translate('TagManager_EditVariable');self.model.findVariable(self.idContainer,self.idContainerVersion,idVariable).then(function(variable){if(!variable){return;}
self.variable=angular.copy(variable);self.variable.idcontainer=self.idContainer;if(self.variable.typeMetadata){enrichTemplateType(self.variable.typeMetadata);}
if(self.variable.lookup_table&&self.variable.lookup_table.length){self.showAdvanced=true;}else if(self.variable.default_value){self.showAdvanced=true;}
self.addLookUpEntryIfNoneExists();self.onLookupChange();self.addParameterWatch();self.isDirty=false;});}else if(self.create){var found=false;if($scope.variableType){angular.forEach(self.availableVariables,function(variablesCategory){angular.forEach(variablesCategory.types,function(variable){if(!found&&variable&&variable.id===$scope.variableType){self.createVariableType(variable);found=true;}})});}
if(!found){self.editTitle=translate('TagManager_ChooseVariableToContinue');self.chooseVariableType=true;}}});};this.addParameterWatch=function(){var index;if(this.variable.typeMetadata&&this.variable.typeMetadata.parameters){for(index=0;index<this.variable.typeMetadata.parameters.length;index++){deregisterWatches.push($scope.$watch('editVariable.variable.typeMetadata.parameters['+index+'].value',function(val,oldVal){if(val!==oldVal){self.isDirty=true;}},true));}}}
this.addLookUpEntryIfNoneExists=function(){if(!this.variable.lookup_table||!angular.isArray(this.variable.lookup_table)){this.variable.lookup_table=[];}
if(!this.variable.lookup_table.length){this.variable.lookup_table.push({comparison:'equals',match_value:'',out_value:''});}};this.onLookupChange=function(){var hasAll=true;angular.forEach(this.variable.lookup_table,function(table){if(!table||!table.out_value){hasAll=false;}});if(hasAll){this.addLookUpEntry();}};this.addLookUpEntry=function(){this.variable.lookup_table.push({comparison:'equals',match_value:'',out_value:''});this.isDirty=true;};this.removeLookUpEntry=function(index){if(index>-1){this.variable.lookup_table.splice(index,1);this.isDirty=true;}};this.createVariableType=function(variableTemplate){if(variableTemplate&&variableTemplate.isDisabled){return;}
this.chooseVariableType=false;this.editTitle=translate('TagManager_CreateNewVariable');this.variable={idSite:piwik.idSite,name:this.model.suggestNameForType(variableTemplate.name),type:variableTemplate.id,idcontainer:self.idContainer,idcontainerversion:self.idContainerVersion,parameters:{},default_value:'',lookup_table:[],typeMetadata:variableTemplate};this.addLookUpEntry();this.addParameterWatch();this.isDirty=true;$timeout(function(){var editVariable=$('.editVariable');if(editVariable.length&&editVariable[0]){editVariable[0].scrollIntoView()}
$('.editVariable #name').focus();},1);};this.cancel=function(){$scope.idVariable=null;currentId=null;var $search=$location.search();delete $search.idVariable;$location.search($search);};$scope.$on('$destroy',function(){$scope.idVariable=null;currentId=null;});function checkRequiredFieldsAreSet(){var title;if(!self.variable.name){title=_pk_translate('General_Name');showErrorFieldNotProvidedNotification(title);return false;}
return true;}
this.createVariable=function(){removeAnyVariableNotification();if(!checkRequiredFieldsAreSet()){return;}
this.isUpdating=true;tagManagerVariableModel.createOrUpdateVariable(this.variable,'TagManager.addContainerVariable').then(function(response){self.isUpdating=false;if(!response||response.type==='error'||!response.response){return;}
self.isDirty=false;var idVariable=response.response.value;if('function'===typeof $scope.onChangeVariable){self.model.reload(self.idContainer,self.idContainerVersion);self.variable.idvariable=idVariable;$scope.onChangeVariable({variable:self.variable});return;}
tagManagerVariableModel.reload(self.idContainer,self.idContainerVersion).then(function(){if(piwik.helper.isAngularRenderingThePage()){var $search=$location.search();$search.idVariable=idVariable;$location.search($search);}else{$location.url('/?idVariable='+idVariable);}
$timeout(function(){showNotification(translate('TagManager_CreatedX',translate('TagManager_Variable'))+' '+translate('TagManager_WantToDeployThisChangeCreateVersion','<a onclick="tagManagerHelper.createNewVersion()">','</a>'),response.type);},200);});},function(){self.isUpdating=false;});};this.setValueHasChanged=function(){this.isDirty=true;};this.updateVariable=function(){removeAnyVariableNotification();if(!checkRequiredFieldsAreSet()){return;}
this.isUpdating=true;tagManagerVariableModel.createOrUpdateVariable(this.variable,'TagManager.updateContainerVariable').then(function(response){if(response.type==='error'){return;}
var idVariable=self.variable.idvariable;if('function'===typeof $scope.onChangeVariable){$scope.onChangeVariable({variable:self.variable});return;}
self.isDirty=false;self.variable={};tagManagerVariableModel.reload(self.idContainer,self.idContainerVersion).then(function(){init(idVariable);});showNotification(translate('TagManager_UpdatedX',translate('TagManager_Variable'))+' '+translate('TagManager_WantToDeployThisChangeCreateVersion','<a onclick="tagManagerHelper.createNewVersion()">','</a>'),response.type);});};$scope.$watch('idVariable',function(newValue,oldValue){if(newValue===null){return;}
if(newValue!=oldValue||currentId===null){currentId=newValue;init(newValue);}});}})();
(function(){angular.module('piwikApp').directive('piwikVariableEdit',piwikVariableEdit);piwikVariableEdit.$inject=['piwik'];function piwikVariableEdit(piwik){return{restrict:'A',scope:{idVariable:'=',idContainer:'=',idContainerVersion:'=',variableType:'=?',onChangeVariable:'&?'},templateUrl:'plugins/TagManager/angularjs/manageVariable/edit.directive.html?cb='+piwik.cacheBuster,controller:'VariableEditController',controllerAs:'editVariable'};}})();
(function(){angular.module('piwikApp').controller('ManageVariableController',ManageVariableController);ManageVariableController.$inject=['$scope','$rootScope','$location'];function ManageVariableController($scope,$rootScope,$location){this.editMode=false;var self=this;this.idContainer=$scope.idContainer;this.idContainerVersion=$scope.idContainerVersion;function removeAnyVariableNotification(){var UI=require('piwik/UI');new UI.Notification().remove('variablevariablemanagement');}
function initState(){var $search=$location.search();if('idVariable'in $search){if($search.idVariable===0||$search.idVariable==='0'){var parameters={isAllowed:true};$rootScope.$emit('TagManager.initAddVariable',parameters);if(parameters&&!parameters.isAllowed){self.editMode=false;self.idVariable=null;return;}}
self.editMode=true;self.idVariable=parseInt($search.idVariable,10);}else{self.editMode=false;self.idVariable=null;}
removeAnyVariableNotification();}
initState();var onChangeSuccess=$rootScope.$on('$locationChangeSuccess',initState);$scope.$on('$destroy',function(){if(onChangeSuccess){onChangeSuccess();}});}})();
(function(){angular.module('piwikApp').directive('piwikVariableManage',piwikVariableManage);piwikVariableManage.$inject=['piwik'];function piwikVariableManage(piwik){return{restrict:'A',scope:{idContainerVersion:'@',idContainer:'@'},templateUrl:'plugins/TagManager/angularjs/manageVariable/manage.directive.html?cb='+piwik.cacheBuster,controller:'ManageVariableController',controllerAs:'manageVariable'};}})();
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('ManageInstallTagCodeController',ManageInstallTagCodeController);ManageInstallTagCodeController.$inject=['$scope','piwikApi','$q','$filter','$timeout'];function ManageInstallTagCodeController($scope,piwikApi,$q,$filter,$timeout){var self=this;this.idContainer=$scope.idContainer;this.environments=[];this.environment='live';this.installInstructions='';this.releases=[];this.isLoading=false;var environmentsPromise=piwikApi.fetch({method:'TagManager.getAvailableEnvironments',filter_limit:'-1'});this.fetchInstallInstructions=function(environment){this.installInstructions={};this.isLoading=true;piwikApi.fetch({method:'TagManager.getContainerInstallInstructions',filter_limit:'-1',idContainer:this.idContainer,environment:environment}).then(function(instructions){self.installInstructions=instructions;self.isLoading=false;$timeout(function(){var codeBlock=$('.manageInstallTagCode .codeblock');codeBlock.each(function(i,element){$(element).effect("highlight",{},1500);});});},function(){self.isLoading=false;});};this.fetchReleases=function(){this.environments=[];this.isLoading=true;var containerPromise=piwikApi.fetch({method:'TagManager.getContainer',idContainer:this.idContainer,filter_limit:'-1'})
$q.all([containerPromise,environmentsPromise]).then(function(response){var container=response[0];var environments=response[1];self.releases=container.releases;self.environments=[];self.isLoading=false;var hasLive=false;angular.forEach(environments,function(environment){self.environments.push({key:environment.id,value:environment.name});})
angular.forEach(self.releases,function(release){angular.forEach(container.versions,function(version){if(version.idcontainerversion===release.idcontainerversion){release.version=version;}});if(release.environment==='live'){hasLive=true;}});if(!hasLive&&self.environments&&self.environments[0]&&self.environments[0].key){self.environment=self.environments[0].key;}else if(!hasLive){self.environment='';}
if(self.environment){self.fetchInstallInstructions(self.environment);}},function(){self.isLoading=false;});};this.fetchReleases();}})();
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikManageInstallTagCode',piwikManageInstallTagCode);piwikManageInstallTagCode.$inject=['piwik'];function piwikManageInstallTagCode(piwik){return{restrict:'A',scope:{idContainer:'@'},templateUrl:'plugins/TagManager/angularjs/manageInstallCode/manage-install-tag-code.directive.html?cb='+piwik.cacheBuster,controller:'ManageInstallTagCodeController',controllerAs:'manageInstallTagCode',compile:function(element,attrs){return function(scope,element,attrs){};}};}})();
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('ContainerDashboardController',ContainerDashboardController);ContainerDashboardController.$inject=['$scope','piwikApi','$q','piwik','$filter'];function ContainerDashboardController($scope,piwikApi,$q,piwik,$filter){var self=this;var translate=$filter('translate');this.availableContexts={};this.idContainer=$scope.idContainer;this.container=null;this.containerVersion=null;this.isLoading=true;var containerPromise=piwikApi.fetch({method:'TagManager.getContainer',idContainer:this.idContainer}).then(function(container){self.container=container;if(container&&container.versions){self.container.lastVersions=self.container.versions.slice(-5);}
if(container&&container.releases){angular.forEach(container.releases,function(release){if(release.version_name){release.versionName=translate('TagManager_ReleaseVersionInfo',release.version_name);}else{release.versionName='';}});}});var versionPromise=piwikApi.fetch({method:'TagManager.exportContainerVersion',idContainer:this.idContainer}).then(function(containerVersion){self.containerVersion=containerVersion;});$q.all([containerPromise,versionPromise]).then(function(){self.isLoading=false;},function(){self.isLoading=false;});piwikApi.fetch({method:'TagManager.getAvailableContexts'}).then(function(contexts){angular.forEach(contexts,function(context){self.availableContexts[context.id]=context.name;});});this.linkTo=function(action,hash){var currentUrl=window.location.pathname+window.location.search;var newUrl=piwik.broadcast.updateParamValue('module=TagManager',currentUrl);newUrl=piwik.broadcast.updateParamValue('action='+action,newUrl);if('undefined'!==typeof hash&&hash){newUrl+='#?'+hash;}
return newUrl;}
this.createNewVersion=function(){$('.tagVersionManager .title').click();};}})();
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikContainerDashboard',piwikContainerDashboard);piwikContainerDashboard.$inject=['piwik'];function piwikContainerDashboard(piwik){return{restrict:'A',scope:{idContainer:'@'},templateUrl:'plugins/TagManager/angularjs/containerDashboard/container-dashboard.directive.html?cb='+piwik.cacheBuster,controller:'ContainerDashboardController',controllerAs:'containerDashboard',compile:function(element,attrs){return function(scope,element,attrs){};}};}})();
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('ContainerSelectorController',ContainerSelectorController);ContainerSelectorController.$inject=['$scope','piwikApi','piwik','$filter'];function ContainerSelectorController($scope,piwikApi,piwik,$filter){var self=this;this.containers=[];this.isLoading=false;this.hasWriteAccess=piwik.hasUserCapability('tagmanager_write');var translate=$filter('translate');if($scope.containerName){this.containerName=translate('TagManager_ContainerX',$scope.containerName);}else{this.containerName='Choose container';}
this.fetchContainers=function(){this.isLoading=true;this.containers=[];piwikApi.fetch({method:'TagManager.getContainers'}).then(function(containers){self.isLoading=false;self.containers=containers;},function(){self.isLoading=false;});};this.linkTo=function(idContainer){var currentUrl=window.location.pathname+window.location.search;currentUrl=piwik.broadcast.updateParamValue('idContainer='+idContainer,currentUrl);var action=piwik.broadcast.getValueFromUrl('idContainer')
if(!action||action==='manageContainers'){if(this.hasWriteAccess){currentUrl=piwik.broadcast.updateParamValue('action=dashboard',currentUrl);}else{currentUrl=piwik.broadcast.updateParamValue('action=manageTags',currentUrl);}}
return currentUrl;};}})();
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').directive('piwikContainerSelector',piwikContainerSelector);piwikContainerSelector.$inject=['piwik'];function piwikContainerSelector(piwik){return{restrict:'A',scope:{containerName:'@?'},templateUrl:'plugins/TagManager/angularjs/containerSelector/container-selector.directive.html?cb='+piwik.cacheBuster,controller:'ContainerSelectorController',controllerAs:'containerSelector',compile:function(element,attrs){return function(scope,element,attrs){};}};}})();
(function(){angular.module('piwikApp').controller('VariableSelectController',VariableSelectController);VariableSelectController.$inject=['$scope','piwikApi'];function VariableSelectController($scope,piwikApi){var self=this;this.preconfiguredVariables=[];this.containerVariables=[];this.isLoading=false;this.idContainer=$scope.idContainer;this.idContainerVersion=null;function getContainer(){self.isLoading=true;var params={method:'TagManager.getContainer',filter_limit:'-1',idContainer:self.idContainer};return piwikApi.fetch(params);}
function fetchAvailableVariables(){self.preconfiguredVariables=[];self.containerVariables=[];getContainer().then(function(container){self.isLoading=true;self.idContainerVersion=container.draft.idcontainerversion;var params={method:'TagManager.getAvailableContainerVariables',filter_limit:'-1',idContainer:self.idContainer,idContainerVersion:self.idContainerVersion};return piwikApi.fetch(params).then(function(variables){self.preconfiguredVariables=[];self.containerVariables=[];self.isLoading=false;angular.forEach(variables,function(category){var preConfig=angular.copy(category);preConfig.types=[];angular.forEach(category.types,function(variable,index){if(variable.is_pre_configured){preConfig.types.push(variable);}else{self.containerVariables.push(variable);}});if(preConfig&&preConfig.types&&preConfig.types.length){self.preconfiguredVariables.push(preConfig);}});},function(){self.isLoading=false;});});}
fetchAvailableVariables();this.editVariable=function(variable){if(!this.idContainerVersion){return;}
tagManagerHelper.editVariable($scope,this.idContainer,this.idContainerVersion,variable.idvariable,function(){fetchAvailableVariables();});};this.createVariable=function(){if(!this.idContainerVersion){return;}
tagManagerHelper.editVariable($scope,this.idContainer,this.idContainerVersion,0,function(){fetchAvailableVariables();});};this.selectVariable=function(variable){if('function'===typeof $scope.onSelectVariable){$scope.onSelectVariable({variable:variable});return;}}}})();
(function(){angular.module('piwikApp').directive('piwikVariableSelect',piwikVariableSelect);piwikVariableSelect.$inject=['piwik'];function piwikVariableSelect(piwik){return{restrict:'A',scope:{idContainer:'=',idContainerVersion:'=',onSelectVariable:'&?'},templateUrl:'plugins/TagManager/angularjs/selectVariable/select-variable.directive.html?cb='+piwik.cacheBuster,controller:'VariableSelectController',controllerAs:'variableSelect'};}})();
(function(){angular.module('piwikApp').controller('VariableSelectTypeController',VariableSelectTypeController);VariableSelectTypeController.$inject=['$scope','piwikApi','piwikUrl'];function VariableSelectTypeController($scope,piwikApi,piwikUrl){var self=this;this.containerVariables=[];this.isLoading=false;this.idContainer=piwikUrl.getSearchParam('idContainer');this.idContainerVersion=null;this.variableType=$scope.variableType;this.variable=$scope.variable;this.variableTypeName=$scope.variableTypeName;function getContainer(){self.isLoading=true;var params={method:'TagManager.getContainer',filter_limit:'-1',idContainer:self.idContainer};return piwikApi.fetch(params);}
function fetchAvailableVariables(){self.containerVariables=[];getContainer().then(function(container){self.isLoading=true;self.idContainerVersion=container.draft.idcontainerversion;var params={method:'TagManager.getAvailableContainerVariables',filter_limit:'-1',idContainer:self.idContainer,idContainerVersion:self.idContainerVersion};return piwikApi.fetch(params).then(function(variables){self.containerVariables=[];self.isLoading=false;angular.forEach(variables,function(category){angular.forEach(category.types,function(variable,index){if(variable.type===$scope.variableType){self.containerVariables.push({key:'{{'+variable.id+'}}',value:variable.name});}});});if(!self.variable&&self.containerVariables.length===1){self.variable=self.containerVariables[0].key;self.onChange();}},function(){self.isLoading=false;});});}
fetchAvailableVariables();this.onChange=function(){$scope.variable=self.variable;};this.createVariable=function(){if(!this.idContainerVersion){return;}
tagManagerHelper.editVariable($scope,this.idContainer,this.idContainerVersion,0,function(variable){fetchAvailableVariables();if(variable){self.variable='{{'+variable.name+'}}';$scope.variable=self.variable;}},$scope.variableType);};this.selectVariable=function(variable){if('function'===typeof $scope.onSelectVariable){$scope.onSelectVariable({variable:variable});return;}}}})();
(function(){angular.module('piwikApp').directive('piwikVariableSelectType',piwikVariableSelectType);piwikVariableSelectType.$inject=['piwik'];function piwikVariableSelectType(piwik){return{restrict:'A',scope:{variableTypeName:'@',variable:'=',variableType:'@'},require:"?ngModel",templateUrl:'plugins/TagManager/angularjs/selectVariableType/select-variable-type.directive.html?cb='+piwik.cacheBuster,controller:'VariableSelectTypeController',controllerAs:'variableSelectType'};}})();
(function(){angular.module('piwikApp').controller('ImportVersionController',ImportVersionController);ImportVersionController.$inject=['$scope','piwikApi','piwik','$timeout','$filter'];function ImportVersionController($scope,piwikApi,piwik,$timeout,$filter){var self=this;this.isUpdating=false;this.idContainer=$scope.idContainer;this.backupName='';var notificationId='importContainerVersion';var translate=$filter('translate');function getNotification(){var UI=require('piwik/UI');return new UI.Notification();}
function removeAnyTagNotification(){var notification=getNotification();notification.remove(notificationId);notification.remove('ajaxHelper');}
function showNotification(message,context){var notification=getNotification();notification.show(message,{context:context,id:notificationId});$timeout(function(){notification.scrollToNotification();},200);}
this.importVersion=function(backupName,version){if(!version){return;}
var parsed;try{parsed=JSON.parse(version);}catch(e){showNotification(translate('TagManager_ErrorInvalidContainerImportFormat'),'error');return;}
if('tags'in parsed&&'triggers'in parsed&&'variables'in parsed&&'idcontainer'in parsed&&'context'in parsed){piwik.helper.modalConfirm('#confirmImportContainerVersion',{yes:function(){self.isUpdating=true;var params={method:'TagManager.importContainerVersion',idContainer:self.idContainer,backupName:backupName};var post={exportedContainerVersion:version};piwikApi.post(params,post).then(function(){showNotification(translate('TagManager_VersionImportSuccess'),'success');self.isUpdating=false;window.location.reload();},function(){self.isUpdating=false;});}});}else{showNotification(translate('TagManager_ErrorContainerVersionImportIncomplete'),'error');}};}})();
(function(){angular.module('piwikApp').directive('piwikImportVersion',piwikImportVersion);piwikImportVersion.$inject=['piwik'];function piwikImportVersion(piwik){return{restrict:'A',scope:{idContainer:'='},templateUrl:'plugins/TagManager/angularjs/importVersion/import-version.directive.html?cb='+piwik.cacheBuster,controller:'ImportVersionController',controllerAs:'importVersion'};}})();
(function(){angular.module('piwikApp').controller('TagManagerTrackingCodeController',TagManagerTrackingCodeController);TagManagerTrackingCodeController.$inject=['$scope','piwikApi','piwikUrl','$timeout','$filter','piwik'];function TagManagerTrackingCodeController($scope,piwikApi,piwikUrl,$timeout,$filter,piwik){var self=this;this.containerVariables=[];this.isLoading=false;this.idContainer=0
this.environment='';this.environmentNameMap={};this.environments=[];this.containers=[];this.containerMap={};this.site=null;this.matomoConfigs=[];this.releases=[];this.installInstructions=[];this.noReleaseFound=false;var translate=$filter('translate');var ucfirst=$filter('ucfirst');var environmentsPromise=piwikApi.fetch({method:'TagManager.getAvailableEnvironments',filter_limit:'-1'});environmentsPromise.then(function(environments){angular.forEach(environments,function(environment){self.environmentNameMap[environment.id]=environment.name;});});this.onSiteChange=function(){this.installInstructions=[];this.containers=[];this.environments=[];this.matomoConfigs=[];this.idContainer='';if(!this.site||!this.site.id){return;}
this.isLoading=true;piwikApi.fetch({method:'TagManager.getContainers',filter_limit:'-1',idSite:this.site.id}).then(function(containers){self.isLoading=false;self.containers=[];if(!containers||!containers.length){self.idContainer='';self.containers.push({key:'',value:translate('TagManager_NoContainersFound')});return;}
angular.forEach(containers,function(container){if(!self.idContainer){self.idContainer=container.idcontainer;}
self.containerMap[container.idcontainer]=container;self.containers.push({key:container.idcontainer,value:container.name});});self.onContainerChange();},function(){self.isLoading=false;});};this.onContainerChange=function(){this.noReleaseFound=false;if(!this.idContainer){return;}
this.installInstructions=[];var container=this.containerMap[this.idContainer];var draftVersion=container.draft.idcontainerversion;this.environment='';this.environments=[];angular.forEach(container.releases,function(release){if(release.environment==='live'){self.environment=release.environment;}});angular.forEach(container.releases,function(release){if(release.environment==='preview'){return;}
if(!self.environment){self.environment=release.environment;}
var name=ucfirst(release.environment);if(release.environment in self.environmentNameMap){name=self.environmentNameMap[release.environment];}
self.environments.push({key:release.environment,value:name});});if(!this.environments.length){this.noReleaseFound=true;this.environments.push({key:'',value:translate('TagManager_NoReleasesFound')});}
this.fetchInstallInstructions();this.fetchVariables(draftVersion);};this.linkTo=function(action,idContainer,hash){var currentUrl=window.location.pathname+window.location.search;var newUrl=piwik.broadcast.updateParamValue('module=TagManager',currentUrl);newUrl=piwik.broadcast.updateParamValue('action='+action,newUrl);newUrl=piwik.broadcast.updateParamValue('idContainer='+idContainer,newUrl);if('undefined'!==typeof hash&&hash){newUrl+='#?'+hash;}
return newUrl;};this.fetchInstallInstructions=function(){this.installInstructions={};if(!this.idContainer||!this.environment||!this.site||!this.site.id){return;}
this.isLoading=true;piwikApi.fetch({method:'TagManager.getContainerInstallInstructions',filter_limit:'-1',idContainer:this.idContainer,environment:this.environment,idSite:this.site.id}).then(function(instructions){self.installInstructions=instructions;self.isLoading=false;$timeout(function(){var codeBlock=$('.tagManagerTrackingCode .codeblock');codeBlock.effect("highlight",{},1500);});},function(){self.isLoading=false;});};this.fetchVariables=function(containerDraftVersion){this.matomoConfigs=[];if(!this.idContainer||!this.site||!this.site.id||!containerDraftVersion){return;}
piwikApi.fetch({method:'TagManager.getContainerVariables',filter_limit:'-1',idContainer:this.idContainer,idContainerVersion:containerDraftVersion,idSite:this.site.id}).then(function(variables){self.matomoConfigs=[];angular.forEach(variables,function(variable){if(variable.type==='MatomoConfiguration'){self.matomoConfigs.push(variable);}});},function(){self.isLoading=false;});};$scope.$watch('tagTrackingCode.site.id',function(val,oldVal){if(val!==oldVal){self.onSiteChange();}});}})();
(function(){angular.module('piwikApp').directive('matomoTagmanagerTrackingCode',matomoTagManagerTrackingCode);matomoTagManagerTrackingCode.$inject=['piwik'];function matomoTagManagerTrackingCode(piwik){return{restrict:'A',scope:{},templateUrl:'plugins/TagManager/angularjs/tagmanagerTrackingCode/tagmanager.directive.html?cb='+piwik.cacheBuster,controller:'TagManagerTrackingCodeController',controllerAs:'tagTrackingCode'};}})();
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
(function(){angular.module('piwikApp').controller('MtmDebugController',MtmDebugController);MtmDebugController.$inject=['$scope','$window'];function MtmDebugController($scope,$window){var self=this;this.mtmEvents=[];this.mtmLogs=[];this.selectedEventIndex=0;this.contentTab='tags';this.selectedEvent=null;this.selectEvent=function(eventIndex){if(this.mtmEvents[eventIndex]){this.selectedEventIndex=eventIndex;this.selectedEvent=this.mtmEvents[eventIndex];var tagsFired=[];angular.forEach(this.mtmEvents,function(event,index){if(index<=eventIndex){angular.forEach(event.tags,function(tag){tagsFired.push(tag.name);});}});var tagsNotFired=[];angular.forEach(this.selectedEvent.container.tags,function(tag){if(tagsFired.indexOf&&tagsFired.indexOf(tag.name)===-1){tagsNotFired.push(tag);}});this.selectedEvent.notFiredTags=tagsNotFired;}};if($window.mtmEvents&&$window.mtmEvents.events){this.mtmEvents=$window.mtmEvents.events;this.selectEvent(this.selectedEventIndex);}
if($window.mtmLogs&&$window.mtmLogs.logs){this.mtmLogs=$window.mtmLogs.logs;}
$(function(){self.mtmEvents=$window.mtmEvents.events||[];self.mtmLogs=$window.mtmLogs.logs||[];self.selectEvent(self.selectedEventIndex);});$scope.$watch(function(){return $window.mtmEvents;},function(n,o){if(n!==o){self.mtmEvents=$window.mtmEvents;if(!self.selectedEvent){self.selectEvent(self.selectedEventIndex);}}});$scope.$watch(function(){return $window.mtmLogs;},function(n,o){if(n!==o){self.mtmLogs=$window.mtmLogs;}});}})();